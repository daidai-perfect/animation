import{_ as le}from"./new-position-title.e31b3462.js";import{_ as ue}from"./token-warning.25c15a3a.js";import{_ as re}from"./status-block.ee60516f.js";import{_ as Yo}from"./auto-pool-apy-tips.24b88f64.js";import{u as qo,a as M,d as Oo,c as lo,b as Ro,s as to,f as de}from"./sha256.de7acfa8.js";import{u as Do,g as ce,b as Z,p as zo,a as Go,T as bo,c as me,V as Vo,C as Ho}from"./pool.f9585ea2.js";import{i as ko}from"./import-icon.de3e6c66.js";import{u as No,a as Zo}from"./autoPool.c968178a.js";import{a as Co,l as r,r as S,m as So,q as Q,e as wo,s as jo,o as c,f as w,h as e,t as vo,i as K,v as p,j as To,x as po,u as U,p as Bo,k as Lo,y as Eo,z as Jo,A as Wo,c as E,w as $o,B as Ko,C as ve,L as pe,I as fe,S as Qo,D as _e,b as xo,F as be,E as ye,G as he}from"./entry.ad32dc49.js";import{_ as ge}from"./assets-card.e525446c.js";import{_ as Ie}from"./coin-lock.bce36a9e.js";import{_ as oe,a as ee}from"./auto-pool-remove-modal.79cb7275.js";import{D as f}from"./decimal.0bdeb344.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./back.343ffe00.js";import"./swap-setting.5405273f.js";/* empty css              */import"./icon-error_2x.c0a55c63.js";import"./index.31084607.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.d1f48e3b.js";const $e=Co({components:{AutoPoolApyTips:Yo},setup(){const o=qo(),n=r(()=>o),O=Do(),q=r(()=>O),L=r(()=>n.value.theme),I=s=>{var t;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((t=q.value.tokensObj[s==null?void 0:s.address])==null?void 0:t.logo_url)||(L.value==="default"?ko("/image/coins/unknown.png"):ko("/image/coins/sui-unknown.png"))},g=S(!0),_=No(),v=r(()=>_),$=So(),a=S();Q(()=>[v.value.positionInfoObj,$.params.id],([s,t])=>{s&&!lo(s)&&t&&(a.value=s[t])},{immediate:!0,deep:!0});const i=r(()=>{var s;return(s=a.value)==null?void 0:s.needReverse}),b=r(()=>{var s,t;return v.value.apyObj&&((t=v.value.apyObj[(s=a.value)==null?void 0:s.id])==null?void 0:t.tvl)||"--"}),m=r(()=>{var s,t;return v.value.apyObj&&((t=v.value.apyObj[(s=a.value)==null?void 0:s.id])==null?void 0:t.apr)||"--"});return{positionInfo:a,tvl:b,store:n,indexStore:o,needReverse:i,getCoinIcon:I,getExplorerUrl:ce,addCommom:M,decimalUi:Oo,direct:g,apy:m}}});const Ao=o=>(Bo("data-v-29428918"),o=o(),Lo(),o),ke={class:"auto-position-info"},Ce={class:"pool-info"},Se={class:"left"},we={class:"coin-a"},Ae={alt:""},Pe={class:"coin-b"},Te={alt:""},qe={class:"position-name"},Re={key:0,class:"pool-fee"},Ne=Ao(()=>e("span",null,"Fee tier",-1)),Be={class:"right"},Le={class:"price-info"},Me={class:"current-price"},Oe=Ao(()=>e("span",null,"Current Price",-1)),De={class:"coin-rate"},je=Ao(()=>e("div",null,[e("svg",{class:"icon icon-up","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Ue=Ao(()=>e("div",null,[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Fe=[je,Ue],We={key:0},Ee={key:1},Xe={class:"apy-and-tvl"},ze={class:"apy"},Ve=Ao(()=>e("div",{class:"apy-title"},"APY",-1)),He={class:"apy-text"},Ye={class:"tvl"},Ge=Ao(()=>e("div",{class:"tvl-title"},"TVL",-1)),Ze={class:"tvl-text"};function Je(o,n,O,q,L,I){var a,i,b,m,s,t,l,k,A,y,Y,B,C,V,F,X,P,eo,x,J,G,oo,so,io,Po,uo,ao,ro,ho,fo,co,d,D;const g=ue,_=re,v=Yo,$=jo("image");return c(),w("div",ke,[e("div",Ce,[e("div",Se,[e("div",we,[vo(e("img",Ae,null,512),[[$,o.needReverse?o.getCoinIcon((i=o.positionInfo)==null?void 0:i.token_b):o.getCoinIcon((a=o.positionInfo)==null?void 0:a.token_a)]]),K(g,{address:o.needReverse?(t=(s=o.positionInfo)==null?void 0:s.token_b)==null?void 0:t.address:(m=(b=o.positionInfo)==null?void 0:b.token_a)==null?void 0:m.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",Pe,[vo(e("img",Te,null,512),[[$,o.needReverse?o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a):o.getCoinIcon((l=o.positionInfo)==null?void 0:l.token_b)]]),K(g,{address:o.needReverse?(B=(Y=o.positionInfo)==null?void 0:Y.token_a)==null?void 0:B.address:(y=(A=o.positionInfo)==null?void 0:A.token_b)==null?void 0:y.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),e("div",qe,p(o.needReverse?(V=(C=o.positionInfo)==null?void 0:C.token_b)==null?void 0:V.symbol:(X=(F=o.positionInfo)==null?void 0:F.token_a)==null?void 0:X.symbol)+" - "+p(o.needReverse?(eo=(P=o.positionInfo)==null?void 0:P.token_a)==null?void 0:eo.symbol:(J=(x=o.positionInfo)==null?void 0:x.token_b)==null?void 0:J.symbol),1),(G=o.positionInfo)!=null&&G.fee?(c(),w("div",Re,[Ne,To(" "+p(((oo=o.positionInfo)==null?void 0:oo.fee)*100)+"% ",1)])):po("",!0)]),e("div",Be,[K(_,{"current-status":(so=o.positionInfo)==null?void 0:so.currentStatus},null,8,["current-status"])])]),e("div",Le,[e("div",Me,[e("div",null,[Oe,e("div",De,[e("div",{onClick:n[0]||(n[0]=mo=>o.direct=!o.direct)},Fe)])]),(o.needReverse?!o.direct:o.direct)?(c(),w("div",We,[To(p(("addCommom"in o?o.addCommom:U(M))(("decimalUi"in o?o.decimalUi:U(Oo))((io=o.positionInfo)==null?void 0:io.price,6)))+"   ",1),e("span",null,p((uo=(Po=o.positionInfo)==null?void 0:Po.token_b)==null?void 0:uo.symbol)+" per "+p((ro=(ao=o.positionInfo)==null?void 0:ao.token_a)==null?void 0:ro.symbol),1)])):(c(),w("div",Ee,[To(p(("addCommom"in o?o.addCommom:U(M))(("decimalUi"in o?o.decimalUi:U(Oo))(1/((ho=o.positionInfo)==null?void 0:ho.price),6)))+"   ",1),e("span",null,p((co=(fo=o.positionInfo)==null?void 0:fo.token_a)==null?void 0:co.symbol)+" per "+p((D=(d=o.positionInfo)==null?void 0:d.token_b)==null?void 0:D.symbol),1)]))]),e("div",Xe,[e("div",ze,[Ve,e("div",He,[To(p(o.apy)+" ",1),K(v)])]),e("div",Ye,[Ge,e("div",Ze,"$"+p(("addCommom"in o?o.addCommom:U(M))(o.tvl,2)),1)])])])])}const ne=wo($e,[["render",Je],["__scopeId","data-v-29428918"]]),Ke=Co({setup(){const o=No(),n=r(()=>o),O=So(),q=r(()=>n.value.positionInfoObj[O.params.id]),L=r(()=>{var v;return(v=q.value)==null?void 0:v.needReverse}),I=Ro(),g=r(()=>I);return{positionInfo:q,needReverse:L,addCommom:M,wallet:g,getCoinIcon:v=>(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||ko("/image/coins/sui-unknown.png")}}});const yo=o=>(Bo("data-v-d7d8a0d5"),o=o(),Lo(),o),Qe={class:"auto-position-liquidity"},xe={class:"my-liquidity"},on={class:"left"},en=yo(()=>e("div",null,"My Liquidity",-1)),nn={key:0},tn={key:1},sn={class:"right"},an=yo(()=>e("div",null,"My share",-1)),ln={key:0},un={key:1},rn={class:"my-liquidity-info"},dn={class:"lp-info"},cn={class:"lp-bg"},mn={alt:""},vn={key:0,class:"lp-num"},pn={key:1,class:"lp-num"},fn=yo(()=>e("div",{class:"assets-pooled-title"}," Pooled Assets ",-1)),_n={class:"assets-pooled"},bn={alt:""},yn={key:0},hn={key:1},gn=yo(()=>e("p",null,"--",-1)),In=yo(()=>e("p",null,"--",-1)),$n=[gn,In],kn={alt:""},Cn={key:0},Sn={key:1},wn=yo(()=>e("p",null,"--",-1)),An=yo(()=>e("p",null,"--",-1)),Pn=[wn,An];function Tn(o,n,O,q,L,I){var _,v,$,a,i,b,m,s,t,l,k,A,y,Y,B,C,V,F,X,P,eo,x,J,G,oo,so,io;const g=jo("image");return c(),w("div",Qe,[e("div",xe,[e("div",on,[en,(_=o.wallet)!=null&&_.connected?(c(),w("div",nn,"$"+p(("addCommom"in o?o.addCommom:U(M))((v=o.positionInfo)==null?void 0:v.myLiquidityUSD)),1)):(c(),w("div",tn,"--"))]),e("div",sn,[an,($=o.wallet)!=null&&$.connected?(c(),w("div",ln,p((a=o.positionInfo)==null?void 0:a.myShare)+"%",1)):(c(),w("div",un,"--%"))])]),e("div",rn,[e("div",dn,[e("div",cn,[vo(e("img",mn,null,512),[[g,((b=(i=o.positionInfo)==null?void 0:i.lpInfo)==null?void 0:b.logo_url)||o.getCoinIcon((m=o.positionInfo)==null?void 0:m.lpInfo)]])]),(s=o.wallet)!=null&&s.connected?(c(),w("div",vn,p(("addCommom"in o?o.addCommom:U(M))((t=o.positionInfo)==null?void 0:t.myLiquidity))+" LP",1)):(c(),w("div",pn,"-- LP"))]),fn,e("div",_n,[e("div",null,[vo(e("img",bn,null,512),[[g,o.needReverse?o.getCoinIcon((l=o.positionInfo)==null?void 0:l.token_b):o.getCoinIcon((k=o.positionInfo)==null?void 0:k.token_a)]]),(A=o.wallet)!=null&&A.connected?(c(),w("div",yn,[e("p",null,p((y=o.positionInfo)==null?void 0:y.myAmountAUSD),1),e("p",null,p(("addCommom"in o?o.addCommom:U(M))((Y=o.positionInfo)==null?void 0:Y.amountA))+" "+p(o.needReverse?(C=(B=o.positionInfo)==null?void 0:B.token_b)==null?void 0:C.symbol:(F=(V=o.positionInfo)==null?void 0:V.token_a)==null?void 0:F.symbol),1)])):(c(),w("div",hn,$n))]),e("div",null,[vo(e("img",kn,null,512),[[g,o.needReverse?o.getCoinIcon((X=o.positionInfo)==null?void 0:X.token_a):o.getCoinIcon((P=o.positionInfo)==null?void 0:P.token_b)]]),(eo=o.wallet)!=null&&eo.connected?(c(),w("div",Cn,[e("p",null,p((x=o.positionInfo)==null?void 0:x.myAmountBUSD),1),e("p",null,p(("addCommom"in o?o.addCommom:U(M))((J=o.positionInfo)==null?void 0:J.amountB))+" "+p(o.needReverse?(oo=(G=o.positionInfo)==null?void 0:G.token_a)==null?void 0:oo.symbol:(io=(so=o.positionInfo)==null?void 0:so.token_b)==null?void 0:io.symbol),1)])):(c(),w("div",Sn,Pn))])])])])}const te=wo(Ke,[["render",Tn],["__scopeId","data-v-d7d8a0d5"]]),qn=Co({components:{AutoPoolAddModal:oe},setup(){const o=Ro(),n=S(!1),O=qo(),q=r(()=>O),L=r(()=>q.value.chainName),I=r(()=>o),g=No(),_=r(()=>g),v=Do(),$=r(()=>v),a=S(),i=So();Q(()=>[_.value.positionInfoObj,i.params.id],([u,h])=>{u&&!lo(u)&&h&&(a.value=u[h])},{immediate:!0,deep:!0});const b=r(()=>{var u;return(u=a.value)==null?void 0:u.needReverse}),m=S(),s=S(),t=S(),l=S(),k=S(!0),A=r(()=>I.value.assets&&m.value&&I.value.assets[m.value.address]?zo(I.value.assets[m.value.address].balance,m.value.decimals):0),y=r(()=>I.value.assets&&s.value&&I.value.assets[s.value.address]?zo(I.value.assets[s.value.address].balance,s.value.decimals):0),Y=u=>{u==="fromCoin"?(k.value=!0,t.value=A.value>0?m.value.symbol=="SUI"?new f(Number(A.value)).sub(new f(.05)).lt(new f(0))?"0":new f(Number(A.value)).sub(new f(.05)).toString():String(A.value):""):(k.value=!1,l.value=y.value>0?s.value.symbol=="SUI"?new f(Number(y.value)).sub(new f(.05)).lt(new f(0))?"0":new f(Number(y.value)).sub(new f(.05)).toString():String(y.value):"")},B=u=>{u==="fromCoin"?(k.value=!0,t.value=A.value>0?to(new f(Number(A.value)).div(2).toString(),m.value.decimals).toString():""):(k.value=!1,l.value=y.value>0?to(new f(Number(y.value)).div(2).toString(),s.value.decimals).toString():"")},C=r(()=>L.value?Go(L.value):{}),V=r(()=>q.value.slippage),F=S("--"),X=S("--"),P=u=>{const h=new f(a.value.autoPoolPositionInfo.liquidity),N=new f(u.toString());if(h.toNumber()>0&&N.toNumber()>0){const T=N.add(h),W=N.div(T).mul(100).toString(),R=me(W),z=R==-1?2:R+2,no=to(N.div(T).mul(100).toString(),z),H=new f(1).div(new f(Math.pow(10,a.value.lpInfo.decimals))).toString();Number(no)<Number(H)?F.value=`<${H}`:F.value=no}else N.toNumber()>0&&h.toNumber()<=0?F.value="100":F.value="--"},eo=u=>{const h=new f(u.toString()),N=h.mul(new f(V.value).div(100)),T=new f(Math.pow(10,a.value.lpInfo.decimals));X.value=to(h.minus(N).div(T).toString(),a.value.lpInfo.decimals)},x=S(!1),J=S(!1),G=()=>{if(!a.value)return;const u=a.value.autoPoolPositionInfo.tick_lower_index,h=a.value.autoPoolPositionInfo.tick_upper_index,N=bo.sqrtPriceX64ToTickIndex(new Z(a.value.current_sqrt_price));N<u&&(b.value?x.value=!0:J.value=!0),N>h&&(b.value?J.value=!0:x.value=!0);let T;if(t.value||l.value){if(k.value){const j=new f(t.value).mul(Math.pow(10,m.value.decimals)).toString();T=new Z(j)}else{const j=new f(l.value).mul(Math.pow(10,s.value.decimals)).toString();T=new Z(j)}const{liquidityAmount:W,tokenMaxA:R,tokenMaxB:z,tokenMaxAOrigin:no,tokenMaxBOrigin:H}=C.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:m.value,tokenB:s.value,lowerTick:u,upperTick:h,coinAmount:T,iscoinA:k.value,roundUp:!0,slippage:Number(V.value)/100,curSqrtPrice:new Z(a.value.current_sqrt_price)});k.value?l.value=Number(z)>0?z:"":t.value=Number(R)>0?R:"",P(W),eo(W)}};Q(()=>a.value,u=>{u&&!lo(u)&&(m.value=u==null?void 0:u.token_a,s.value=u==null?void 0:u.token_b,x.value=!1,J.value=!1,G())},{immediate:!0});const oo=r(()=>$.value.RATES),so=r(()=>{var u,h,N,T,W,R,z,no;if((h=oo.value[(u=m.value)==null?void 0:u.address])!=null&&h.price&&((T=oo.value[(N=s.value)==null?void 0:N.address])!=null&&T.price)){const H=new f(t.value||0).mul(new f((R=oo.value[(W=m.value)==null?void 0:W.address])==null?void 0:R.price)),j=new f(l.value||0).mul(new f((no=oo.value[(z=s.value)==null?void 0:z.address])==null?void 0:no.price));return Oo(H.add(j).toString(),2)}else return"--"});Q(t,(u,h)=>{u&&G(),u==""&&(F.value="--",l.value="",X.value="--")}),Q(l,(u,h)=>{u&&G(),u==""&&(t.value="",F.value="--",X.value="--")});const{t:io,locale:Po}=Eo(),uo=r(()=>{const u=Number(t.value)>Number(A.value),h=Number(l.value)>Number(y.value);return!t.value&&!l.value?io("button.enterAmount"):u?io("button.insufficientBalance",{name:m.value.symbol}):h?io("button.insufficientBalance",{name:s.value.symbol}):"Add Liquidity"}),ao=r(()=>{const u=Number(t.value)>Number(A.value),h=Number(l.value)>Number(y.value);return!!(!t.value&&!l.value||u||h||t.value<=0&&l.value<=0)}),ro=S(!0),{setIsShowSuccess:ho,setIsShowRejected:fo,setIsShowWaiting:co,setTransactionDesc:d,setTransactionTxid:D,setPositiomNum:mo}=O,_o=Zo("Sui");return{wallet:I,positionInfo:a,isShowAddModal:n,needReverse:b,fromCoin:m,toCoin:s,fromCoinAmount:t,toCoinAmount:l,fromCoinBlance:A,toCoinBlance:y,fixedFromCoin:k,maxBtnSelect:Y,halfBtnSelect:B,totalAmountUSD:so,addCommom:M,shareOfPool:F,minimumReceivedLP:X,addLiquidityBtnText:uo,addLiquidityBtnDisabled:ao,toAdd:async()=>{var no,H;n.value=!1,ro.value=!0,D("");const u=`${M(t.value)} ${(no=m.value)==null?void 0:no.symbol}`,h=`${M(l.value)} ${(H=s.value)==null?void 0:H.symbol}`;d(`Deposit ${t.value>0?u:""} ${l.value>0&&t.value>0?"and":""} ${l.value>0?h:""}`),co(!0);const N=k.value,T=a.value.autoPoolPositionInfo.tick_lower_index,W=a.value.autoPoolPositionInfo.tick_upper_index;let R;if(k.value){const j=new f(t.value).mul(Math.pow(10,m.value.decimals)).toString();R=new Z(j)}else{const j=new f(l.value).mul(Math.pow(10,s.value.decimals)).toString();R=new Z(j)}const z=a.value.rewarderInfo.map(j=>j.coinAddress);try{const j={lowerTick:T,upperTick:W,coinAmount:R,fix_amount_a:N,slippage:Number(V.value)/100,curSqrtPrice:new Z(a.value.current_sqrt_price),id:a.value.id,clmm_pool:a.value.autoPoolPositionInfo.pool,lp_token_type:a.value.lp_token_type,coinTypeA:a.value.autoPoolPositionInfo.coin_type_a,coinTypeB:a.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:z},Xo=await _o.deposit(j),ae=await C.value.signAndExecuteTransactionBlock(I.value.currentWallet,Xo);let Io=C.value.handleTx(ae);if(console.log("toAdd###tx###",Io),Io&&Io.hash){D(Io.hash),co(!1),ho(!0);const Fo={title:"Supplied",desc:`Deposit ${t.value>0?u:""} ${l.value>0&&t.value>0?"and":""} ${l.value>0?h:""}`,hash:Io.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deposit ${t.value>0?u:""} ${l.value>0&&t.value>0?"and":""} ${l.value>0?h:""}`};L.value!=="Aptos"&&(Fo.res=Io.res),C.value.showTransitionPending(Fo),await C.value.watchTransaction(Fo)&&setTimeout(()=>{g.updatePositionItem(a.value.id),C.value.getAccount(I.value.address)},1e3),mo()}else co(!1),fo(!0);t.value="",l.value="",ro.value=!1}catch(j){t.value="",l.value="",console.log("addError###",j),ro.value=!1,co(!1),fo(!0)}},showToCoinLock:J,showFromCoinLock:x}}});const Mo=o=>(Bo("data-v-7ec8823b"),o=o(),Lo(),o),Rn={class:"auto-pool-add"},Nn={class:"auto-pool-add-content"},Bn={class:"liquidity-action-tab"},Ln=Mo(()=>e("div",{class:"increase tab-active"},"Add",-1)),Mn={class:"card-item"},On={class:"card-item"},Dn={class:"add-info"},jn={class:"total-amount"},Un=Mo(()=>e("span",null,"Total Amount",-1)),Fn={class:"total-amount"},Wn=Mo(()=>e("span",null,"Share of Pool",-1)),En={class:"total-amount"},Xn=Mo(()=>e("span",null,"Minimum Received LP",-1)),zn=Mo(()=>e("span",null,"Pool Closed",-1));function Vn(o,n,O,q,L,I){var a,i,b,m,s;const g=ge,_=Ie,v=Ko,$=oe;return c(),w("div",Rn,[e("div",Nn,[e("div",Bn,[Ln,e("div",{class:"remove",onClick:n[0]||(n[0]=Jo(t=>o.$emit("changeCurrentTab"),["stop"]))},"Remove")]),e("div",{class:Wo(o.needReverse?"card-container reverse":"card-container")},[e("div",Mn,[K(g,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=t=>o.fromCoinAmount=t),"input-value":o.fromCoinAmount,"coin-symbol":o.fromCoin?o.fromCoin.symbol:null,"coin-name":o.fromCoin?o.fromCoin.name:null,balance:o.fromCoinBlance,"coin-icon":o.fromCoin?o.fromCoin.logoURI:"",address:o.fromCoin?o.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=t=>o.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=t=>o.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=t=>{o.fromCoinAmount=t}),onOnFocus:n[5]||(n[5]=()=>{o.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showFromCoinLock?(c(),E(_,{key:0})):po("",!0)]),e("div",On,[K(g,{modelValue:o.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=t=>o.toCoinAmount=t),"input-value":o.toCoinAmount,"coin-symbol":o.toCoin?o.toCoin.symbol:null,"coin-name":o.toCoin?o.toCoin.name:null,balance:o.toCoinBlance,"swap-direct":"To","coin-icon":o.toCoin?o.toCoin.logoURI:"",address:o.toCoin?o.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=t=>o.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=t=>o.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=t=>{o.toCoinAmount=t}),onOnFocus:n[10]||(n[10]=()=>{o.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),o.showToCoinLock?(c(),E(_,{key:0})):po("",!0)])],2),e("div",Dn,[e("div",jn,[Un,e("span",null,"$"+p(("addCommom"in o?o.addCommom:U(M))(o.totalAmountUSD)),1)]),e("div",Fn,[Wn,e("span",null,p(o.shareOfPool)+"%",1)]),e("div",En,[Xn,e("span",null,p(("addCommom"in o?o.addCommom:U(M))(o.minimumReceivedLP))+" "+p(o.needReverse?(a=o.toCoin)==null?void 0:a.symbol:(i=o.fromCoin)==null?void 0:i.symbol)+"-"+p(o.needReverse?(b=o.fromCoin)==null?void 0:b.symbol:(m=o.toCoin)==null?void 0:m.symbol),1)])])]),(s=o.positionInfo)!=null&&s.is_pause?(c(),E(v,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:$o(()=>[zn]),_:1})):o.wallet.connected?(c(),E(v,{key:1,class:"big-btn liquidity-btn",disabled:o.addLiquidityBtnDisabled,onClick:n[11]||(n[11]=t=>o.isShowAddModal=!0)},{default:$o(()=>[e("span",null,p(o.addLiquidityBtnText),1)]),_:1},8,["disabled"])):(c(),E(v,{key:2,class:"big-btn",onClick:n[12]||(n[12]=t=>o.wallet.setIsShowWalletModal(!0))},{default:$o(()=>[e("span",null,p(o.$t("button.connectWallet")),1)]),_:1})),o.isShowAddModal?(c(),E($,{key:3,"pool-info":o.positionInfo,"from-coin":o.needReverse?o.positionInfo.token_b:o.positionInfo.token_a,"to-coin":o.needReverse?o.positionInfo.token_a:o.positionInfo.token_b,"from-coin-amount":o.needReverse?o.toCoinAmount:o.fromCoinAmount,"to-coin-amount":o.needReverse?o.fromCoinAmount:o.toCoinAmount,"total-amount":o.totalAmountUSD,"share-of-pool":o.shareOfPool,"minimum-received-l-p":o.minimumReceivedLP,onOnClose:n[13]||(n[13]=t=>o.isShowAddModal=!1),onToAdd:o.toAdd},null,8,["pool-info","from-coin","to-coin","from-coin-amount","to-coin-amount","total-amount","share-of-pool","minimum-received-l-p","onToAdd"])):po("",!0)])}const se=wo(qn,[["render",Vn],["__scopeId","data-v-7ec8823b"]]),Hn=Co({props:{inputValue:{type:String,default:""},balance:{type:String,default:""},lpDecimals:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},inputDisabled:{type:Boolean,default:!1},positionInfo:{default:()=>({})}},setup(o,n){const{t:O,locale:q}=Eo(),L=qo(),I=r(()=>L),g=r(()=>new f(Number(o.balance)).div(2)),_=ve(pe,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});function v(){this.$emit("onSelect")}const $=y=>{const Y=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${o.lpDecimals&&o.lpDecimals}})?).*$`);y.target.value=y.target.value.replace(Y,"$1")},a=Ro(),i=r(()=>a),b=Do(),m=r(()=>b),s=r(()=>m.value.tokensWarningObj);Q(()=>m.value.RATES,y=>{},{immediate:!0});const t=r(()=>m.value.tokensObj),l=r(()=>I.value.theme);return{route:So(),theme:l,tokensObj:t,pool:m,halfBalance:g,t:O,addCommom:M,store:I,wallet:i,indicator:_,inputChange:$,importIcon:ko,selectCoin:v,formatNumber:de,tokensWarningObj:s,checkNullObj:lo,getCoinIcon:y=>(y==null?void 0:y.logoURI)||(y==null?void 0:y.logo_url)||ko("/image/coins/sui-unknown.png")}}});const Yn=o=>(Bo("data-v-54e83f8b"),o=o(),Lo(),o),Gn={class:"card"},Zn={class:"top"},Jn={key:1,class:"input-div"},Kn={key:0},Qn={class:"left"},xn={class:"loading-token"},ot={class:"lp-bg"},et={key:0,alt:""},nt={class:"bottom"},tt=Yn(()=>e("div",null,null,-1)),st={class:"top"},it={class:"right"};function at(o,n,O,q,L,I){const g=fe,_=Qo,v=jo("image");return c(),w("div",Gn,[e("div",Zn,[o.inputDisabled?(c(),w("div",Jn,[o.inputValue?(c(),w("span",Kn,p(o.inputValue),1)):(c(),E(_,{key:1,indicator:o.indicator},null,8,["indicator"]))])):(c(),E(g,{key:0,value:o.inputValue=="InsufficientLiquidity"?"":o.inputValue,placeholder:"0.0",disabled:o.inputDisabled,onChange:o.inputChange,onInput:n[0]||(n[0]=$=>o.$emit("onInput",$.target.value)),onFocus:n[1]||(n[1]=$=>o.$emit("onFocus"))},null,8,["value","disabled","onChange"])),e("div",Qn,[e("div",xn,[e("div",ot,[o.positionInfo&&!("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)&&o.positionInfo.lpInfo?vo((c(),w("img",et,null,512)),[[v,o.getCoinIcon(o.positionInfo.lpInfo)]]):po("",!0)]),e("p",null,p(o.fromCoin.symbol)+" - "+p(o.toCoin.symbol),1)])])]),e("div",nt,[tt,e("div",st,[e("div",it,[To(p(o.$t("common.balance"))+" ",1),e("span",{class:"balance",onClick:n[2]||(n[2]=$=>o.$emit("onMax"))},p(o.wallet.connected?("addCommom"in o?o.addCommom:U(M))(o.balance,o.lpDecimals):"0"),1)])])])])}const lt=wo(Hn,[["render",at],["__scopeId","data-v-54e83f8b"]]),ut=Co({components:{AutoPoolRemoveModal:ee},setup(){const o=Ro(),n=r(()=>o),O=qo(),q=r(()=>O),L=r(()=>q.value.slippage),I=r(()=>q.value.chainName),g=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],_=S(25),v=So(),$=No(),a=r(()=>$),i=r(()=>a.value.positionInfoObj[v.params.id]),b=r(()=>{var d;return(d=i.value)==null?void 0:d.needReverse}),m=S(),s=S(),t=S(!1),l=S(),k=r(()=>{var d;return(d=i.value)==null?void 0:d.myLiquidity}),A=S(!0),y=r(()=>I.value?Go(I.value):{}),Y=Zo("Sui"),B=S("--"),C=S("--"),V=S("--"),F=()=>{if(A.value||!i.value)return;if(!l.value){B.value="--",C.value="--",_.value=0;return}if(Number(l.value)>Number(k.value))return;if(Number(l.value)*Math.pow(10,i.value.decimals)==Number(k.value)){_.value=100,P({value:1}),A.value=!0;return}const d=new f(l.value).mul(Math.pow(10,i.value.lpInfo.decimals)).toString(),D=new f(l.value).div(new f(k.value)).mul(100),mo=i.value.tick_lower_index,_o=i.value.tick_upper_index,go=i.value.token_a.decimals,u=i.value.token_b.decimals,h=bo.tickIndexToSqrtPriceX64(mo),N=bo.tickIndexToSqrtPriceX64(_o),T=Vo.get_share_liquidity_by_amount({liquidity:i.value.liquidity,total_supply:i.value.total_supply},d.toString()),W=Ho.getCoinAmountFromLiquidity(new Z(T),new Z(i.value.object.current_sqrt_price),h,N,!1),R=new f(W.coinA.toString()).div(Math.pow(10,go)).toString(),z=new f(W.coinB.toString()).div(Math.pow(10,u)).toString();B.value=Number(R)>0?R:"--",C.value=Number(z)>0?z:"--",_.value=D.toString(),V.value=to(d,0),X.value=to(T,0)},X=S(),P=d=>{if(!A.value)return;A.value=!0;const D=i.value.token_a.decimals,mo=i.value.token_b.decimals,_o=i.value.tick_lower_index,go=i.value.tick_upper_index,u=bo.tickIndexToSqrtPriceX64(_o),h=bo.tickIndexToSqrtPriceX64(go);let N="",T;d.value!==1?T=new f(i.value.myLiquidity).mul(Math.pow(10,i.value.lpInfo.decimals)).mul(d.value).toString():T=new f(i.value.myLiquidity).mul(Math.pow(10,i.value.lpInfo.decimals)).toString(),l.value=new f(T).div(Math.pow(10,i.value.lpInfo.decimals)),N=Vo.get_share_liquidity_by_amount({liquidity:i.value.liquidity,total_supply:i.value.total_supply},T),V.value=to(T,0),X.value=to(N,0);const W=Ho.getCoinAmountFromLiquidity(new Z(N),new Z(i.value.object.current_sqrt_price),u,h,!1),R=new f(W.coinA.toString()).div(Math.pow(10,D)).toString(),z=new f(W.coinB.toString()).div(Math.pow(10,mo)).toString();B.value=Number(R)>0?R:"--",C.value=Number(z)>0?z:"--"};Q(_,_e((d,D)=>{d!==D&&(Number(d)>100?_.value=100:d&&i.value?(_.value=d,P({value:_.value/100})):(B.value="--",C.value="--"))},300)),Q(()=>l.value,d=>{F()},{immediate:!0});const eo=xo(),{setIsShowSuccess:x,setIsShowRejected:J,setIsShowWaiting:G,setTransactionDesc:oo,setTransactionTxid:so,setPositiomNum:io,setTransactionDescText:Po}=O,uo=S(!1),{t:ao}=Eo(),ro=async()=>{var T,W;uo.value=!0,so("");const d=Number(B.value)>0?`${M(B.value,m.value.decimals)} ${m.value.symbol}`:"",D=Number(C.value)>0?`${M(C.value,s.value.decimals)} ${s.value.symbol}`:"";oo(ao("tips.removeLiquidiyText",{from:b.value?D:d,and:Number(B.value)>0&&Number(C.value)>0?"and":"",to:b.value?d:D})),G(!0);const mo=ao("modal.removeLiquidityText2");Po(mo);const _o=i.value.autoPoolPositionInfo.tick_lower_index,go=i.value.autoPoolPositionInfo.tick_upper_index,u=bo.tickIndexToSqrtPriceX64(_o),h=bo.tickIndexToSqrtPriceX64(go),N=i.value.rewarderInfo.map(R=>R.coinAddress);try{const R={lowerSqrtPrice:u,upperSqrtPrice:h,lpTokenAmount:new Z(V.value),liquidity:new Z(X.value),curSqrtPrice:new Z(i.value.object.current_sqrt_price),slippage:Number(L.value)/100,id:i.value.id,clmm_pool:i.value.autoPoolPositionInfo.pool,lp_token_type:i.value.lp_token_type,coinTypeA:i.value.autoPoolPositionInfo.coin_type_a,coinTypeB:i.value.autoPoolPositionInfo.coin_type_b,rewarder_coin_types:N},z=await Y.remove(R),no=await y.value.signAndExecuteTransactionBlock(n.value.currentWallet,z);let H=y.value.handleTx(no);if(console.log("0331###remove###tx####",H),H&&H.hash){so(H.hash),G(!1),x(!0);const j={title:ao("common.removeLiquidity"),desc:"",hash:H.hash,descTransactions:`Remove ${d} ${Number(B.value)>0&&Number(C.value)>0?"and":""} ${D} from the pool`,sender:n.value.address,chainName:"Sui",tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${B.value} ${(T=m.value)==null?void 0:T.symbol} and ${C.value} ${(W=s.value)==null?void 0:W.symbol}`};j.res=H.res,y.value.showTransitionPending(j),await y.value.watchTransaction(j)&&(B.value="",C.value="",l.value="",_.value=0,setTimeout(()=>{$.updatePositionItem(i.value.id),y.value.getAccount(n.value.address)},1e3),Number(_.value)==100&&v.name=="auto-pool-detail"&&eo.push("/vaults"))}else G(!1),J(!0);uo.value=!1}catch(R){console.log("Remove error",R),uo.value=!1,G(!1),J(!0)}};Q(()=>i.value,(d,D)=>{d&&!lo(d)&&(m.value=d==null?void 0:d.token_a,s.value=d==null?void 0:d.token_b,(!D||D&&D.address!==d.address)&&P({value:_.value/100}))},{immediate:!0});const ho=r(()=>{const d=Number(l.value)>Number(k.value);return!l.value||l.value<=0?ao("button.enterAmount"):d?"Invalid Amount":ao("button.remove")}),fo=r(()=>{const d=Number(l.value)>Number(k.value);return!!(!l.value||l.value<=0||d)});return{removeLiquidityBtnText:ho,removeLiquidityBtnDisabled:fo,wallet:n,ratioArr:g,positionInfo:i,isShowRemoveModal:t,needReverse:b,fromCoin:m,toCoin:s,lpAmount:l,lpBalance:k,sliderVal:_,sFixD:to,isSlider:A,fromCoinAmount:B,toCoinAmount:C,setPercent:P,toRemove:ro,addCommom:M,getCoinIcon:d=>(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||ko("/image/coins/sui-unknown.png")}}});const Uo=o=>(Bo("data-v-05bf1d58"),o=o(),Lo(),o),rt={class:"auto-pool-add"},dt={class:"auto-pool-add-content"},ct={class:"liquidity-action-tab"},mt=Uo(()=>e("div",{class:"remove tab-active"},"Remove",-1)),vt={class:"card-item"},pt={class:"remove-ratio"},ft=Uo(()=>e("div",{class:"remove-ratio-title"},"Amount",-1)),_t={class:"remove-ratio-select"},bt={key:0,class:"ratio"},yt={key:1,class:"ratio"},ht={class:"ratio-list"},gt=["onClick"],It={class:"est-receive"},$t=Uo(()=>e("div",{class:"est-receive-title"},"Estimated Receive",-1)),kt={class:"token-a"},Ct={alt:""},St={class:"token-a"},wt={alt:""},At=Uo(()=>e("span",null,"Pool Closed",-1));function Pt(o,n,O,q,L,I){var i,b,m,s,t,l,k,A,y,Y,B,C,V,F,X;const g=lt,_=he,v=Ko,$=ee,a=jo("image");return c(),w("div",rt,[e("div",dt,[e("div",ct,[e("div",{class:"increase",onClick:n[0]||(n[0]=Jo(P=>o.$emit("changeCurrentTab"),["stop"]))},"Add"),mt]),e("div",{class:Wo(o.needReverse?"card-container reverse":"card-container")},[e("div",vt,[K(g,{modelValue:o.lpAmount,"onUpdate:modelValue":n[1]||(n[1]=P=>o.lpAmount=P),"input-value":o.lpAmount,balance:o.lpBalance,"from-coin":o.needReverse?o.toCoin:o.fromCoin,"to-coin":o.needReverse?o.fromCoin:o.toCoin,"position-info":o.positionInfo,"lp-decimals":(b=(i=o.positionInfo)==null?void 0:i.lpInfo)==null?void 0:b.decimals,onOnMax:n[2]||(n[2]=()=>{o.sliderVal=100,o.setPercent({value:1})}),onOnInput:n[3]||(n[3]=P=>{o.isSlider=!1,o.lpAmount=P})},null,8,["modelValue","input-value","balance","from-coin","to-coin","position-info","lp-decimals"])])],2),e("div",pt,[ft,e("div",_t,[Number(o.lpBalance)>=Number(o.lpAmount)?(c(),w("div",bt,p(o.sliderVal>0&&Number(("sFixD"in o?o.sFixD:U(to))(o.sliderVal,2))<.01?"<0.01":("sFixD"in o?o.sFixD:U(to))(o.sliderVal,2))+"% ",1)):(c(),w("div",yt,"--")),e("div",ht,[(c(!0),w(be,null,ye(o.ratioArr,(P,eo)=>(c(),w("div",{key:eo,class:Wo(["ratio-item",o.sliderVal==P.value?"ratio-item-active":""]),onClick:()=>{o.isSlider=!0,o.sliderVal=P.value}},p(P.name),11,gt))),128))])]),K(_,{value:o.sliderVal,"onUpdate:value":n[4]||(n[4]=P=>o.sliderVal=P)},null,8,["value"])]),e("div",It,[$t,e("div",kt,[e("div",null,p(("addCommom"in o?o.addCommom:U(M))(o.fromCoinAmount)),1),e("div",null,[vo(e("img",Ct,null,512),[[a,o.needReverse?o.getCoinIcon((m=o.positionInfo)==null?void 0:m.token_b):o.getCoinIcon((s=o.positionInfo)==null?void 0:s.token_a)]]),e("span",null,p(o.needReverse?(l=(t=o.positionInfo)==null?void 0:t.token_b)==null?void 0:l.symbol:(A=(k=o.positionInfo)==null?void 0:k.token_a)==null?void 0:A.symbol),1)])]),e("div",St,[e("div",null,p(("addCommom"in o?o.addCommom:U(M))(o.toCoinAmount)),1),e("div",null,[vo(e("img",wt,null,512),[[a,o.needReverse?o.getCoinIcon((y=o.positionInfo)==null?void 0:y.token_a):o.getCoinIcon((Y=o.positionInfo)==null?void 0:Y.token_b)]]),e("span",null,p(o.needReverse?(C=(B=o.positionInfo)==null?void 0:B.token_a)==null?void 0:C.symbol:(F=(V=o.positionInfo)==null?void 0:V.token_b)==null?void 0:F.symbol),1)])])])]),(X=o.positionInfo)!=null&&X.is_pause?(c(),E(v,{key:0,class:"big-btn liquidity-btn",disabled:!0},{default:$o(()=>[At]),_:1})):o.wallet.connected?(c(),E(v,{key:1,class:"big-btn liquidity-btn",disabled:o.removeLiquidityBtnDisabled,onClick:o.toRemove},{default:$o(()=>[e("span",null,p(o.removeLiquidityBtnText),1)]),_:1},8,["disabled","onClick"])):(c(),E(v,{key:2,class:"big-btn",onClick:n[5]||(n[5]=P=>o.wallet.setIsShowWalletModal(!0))},{default:$o(()=>[e("span",null,p(o.$t("button.connectWallet")),1)]),_:1})),o.isShowRemoveModal?(c(),E($,{key:3,"pool-info":o.positionInfo,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b,onOnClose:n[6]||(n[6]=P=>o.isShowRemoveModal=!1)},null,8,["pool-info","from-coin","to-coin"])):po("",!0)])}const ie=wo(ut,[["render",Pt],["__scopeId","data-v-05bf1d58"]]),Tt=Co({components:{AutoPoolAdd:se,AutoPositionInfo:ne,AutoPositionLiquidity:te,AutoPoolRemove:ie},setup(){const o=S("add"),n=Ro(),O=r(()=>n),q=No(),L=r(()=>q),I=Do(),g=r(()=>I);Q(()=>g.value.poolConfigList,b=>{b&&b.length>0&&q.getAutoPoolList()},{immediate:!0}),Q(()=>[O.value.address,L.value.autoPoolList,g.value.poolConfigList],([b,m,s])=>{b&&m&&m.length>0&&s&&s.length>0&&q.getMyAutoPoolPosition()},{immediate:!0});const _=So(),v=r(()=>(console.log(L.value.positionInfoObj[_.params.id],"autoPool.value.positionInfoObj[route.params.id]###"),L.value.positionInfoObj[_.params.id]||{}));Q(()=>_.query.action,b=>{b&&(o.value=b)},{immediate:!0}),xo(),Q(()=>O.value.address,b=>{b||q.logout()},{immediate:!0});const $=qo(),a=r(()=>$);return{currentTab:o,positionInfo:v,clickRefresh:()=>{q.getAutoPoolAPY(),q.getAutoPoolList(),I.setPoolConfigList(a.value.chainName,a.value.filterCoinsObj)},checkNullObj:lo}}});const qt={class:"auto-increase-liquidity"},Rt={class:"auto-increase-liquidity-content pc-content"},Nt={class:"left"},Bt={class:"right"},Lt={class:"auto-increase-liquidity-content h5-content"},Mt={class:"left"},Ot={class:"right"};function Dt(o,n,O,q,L,I){const g=le,_=ne,v=te,$=se,a=ie,i=Qo;return c(),w("div",qt,[K(g,{onClickRefresh:o.clickRefresh},null,8,["onClickRefresh"]),e("div",Rt,[e("div",Nt,[K(_),K(v)]),e("div",Bt,[o.currentTab=="add"?(c(),E($,{key:0,onChangeCurrentTab:n[0]||(n[0]=b=>o.currentTab="remove")})):(c(),E(a,{key:1,onChangeCurrentTab:n[1]||(n[1]=b=>o.currentTab="add")}))]),("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)?(c(),E(i,{key:0})):po("",!0)]),e("div",Lt,[e("div",Mt,[K(_),o.currentTab=="add"?(c(),E($,{key:0,onChangeCurrentTab:n[2]||(n[2]=b=>o.currentTab="remove")})):(c(),E(a,{key:1,onChangeCurrentTab:n[3]||(n[3]=b=>o.currentTab="add")}))]),e("div",Ot,[K(v)]),("checkNullObj"in o?o.checkNullObj:U(lo))(o.positionInfo)?(c(),E(i,{key:0})):po("",!0)])])}const rs=wo(Tt,[["render",Dt],["__scopeId","data-v-c1d813f3"]]);export{rs as default};
