import{_ as ia,a as oa,b as aa,c as ra,d as ca}from"./new-liquidity-title.8449cc50.js";import{i as je}from"./import-icon.de3e6c66.js";import{a as Ye,R as va,m as R,e as Ze,T as xe,o as h,c as Se,w as Ee,h as t,f as q,v as fe,p as eo,k as oo,r as B,K as ta,l as da,D as ne,X as ma,J as De,i as re,x as L,B as pa,j as we,b as fa,C as ga,q as ka,G as ba,z as be,t as Ca,u as wa,P as ha}from"./entry.a800e351.js";/* empty css              */import{b as ao,a as ya,u as na,s as Yo,h as Zo,d as xo,w as Ve,c as la,p as ea,e as ua,x as Sa,l as _a}from"./pool.72e6880c.js";import{_ as Na,a as Pa,b as Ta}from"./icon-Add-Liquidity_2x.4a481db1.js";import{D as u}from"./decimal.0bdeb344.js";import{amountLock as Ce,fromCoinAmount as l,toCoinAmount as s,fromCoin as p,toCoin as m,showFromCoinLock as K,showToCoinLock as Q,fixedFromCoin as P,createPoolInfo as r,minPrice as k,maxPrice as d,currentPriceReverse as Qe,currentPrice as le,initPrice as pe,direction as b,createPoolFromCoin as ae,createPoolToCoin as te,isFullRange as oe,resetData as Aa,defaultMinPrice as Je,defaultMaxPrice as Ke}from"./create-pool-data.a8d4ffb9.js";import{_ as $a}from"./icon-selected_3x.09e9a6f0.js";import"./img-lock_2x.a28135f4.js";import"./index.b6cdaf66.js";import"./token-warning.34ad6e94.js";/* empty css              *//* empty css              */import"./swap-setting.c1f96208.js";/* empty css              */import"./icon-warning_2x.49e8800f.js";import"./icon-error_2x.7d5dfce8.js";import"./status-block.d41a8711.js";import"./notifi.53d01b54.js";import"./useWhale.5463ca16.js";const Ra=Ye({components:{Modal:va},setup(){const e=ao(),n=R(()=>e);return{importIcon:je,store:n}}}),qa=""+new URL("img-Creat-success_2x.b6f0a395.png",import.meta.url).href,Ia=""+new URL("img-Creat-success.9734ad6f.png",import.meta.url).href;const La=e=>(eo("data-v-d7a9ceb3"),e=e(),oo(),e),Ba=La(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Ma={class:"create-success-container"},Fa={key:0,src:qa,alt:""},Oa={key:1,src:Ia,alt:""},Ua={class:"waiting-title"};function Da(e,n,he,ge,U,z){const M=xe("Modal");return h(),Se(M,{visible:!0,class:"",centered:"",title:"",width:"400px",footer:null,onCancel:n[0]||(n[0]=g=>e.$emit("onClose"))},{closeIcon:Ee(()=>[Ba]),default:Ee(()=>[t("div",Ma,[e.store.theme=="default"?(h(),q("img",Fa)):(h(),q("img",Oa)),t("p",Ua,fe(e.$t("newAdd.createPoolSuccessText")),1)])]),_:1})}const Va=Ze(Ra,[["render",Da],["__scopeId","data-v-d7a9ceb3"]]),ja=Ye({components:{NewLiquidityTile:ia,NewLiquidityDepositRatio:oa},setup(e,n){const he=ya(),ge=ao(),U=R(()=>ge),z=R(()=>U.value.chainName),M=R(()=>he),g=B(!1);B(),B(),B(),B(!1);const C=ta(),{t:H,locale:ve}=da(),_=R(()=>z.value?la(z.value):{}),X=na(),i=R(()=>X),Z=R(()=>U.value.theme),F=R(()=>M.value.assets&&p.value&&M.value.assets[p.value.address]?ea(M.value.assets[p.value.address].balance,p.value.decimals):"0"),E=R(()=>M.value.assets&&m.value&&M.value.assets[m.value.address]?ea(M.value.assets[m.value.address].balance,m.value.decimals):"0"),We=o=>{o==="fromCoin"?(P.value=!0,z.value==="Aptos"?l.value=Number(F.value)>0?p.value.symbol=="APT"?new u(Number(F.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(F.value)).sub(new u(.1)).toString():String(F.value):"":l.value=Number(F.value)>0?p.value.symbol=="SUI"?new u(Number(F.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(F.value)).sub(new u(.05)).toString():String(F.value):""):(P.value=!1,z.value==="Aptos"?s.value=Number(E.value)>0?m.value.symbol=="APT"?new u(Number(E.value)).sub(new u(.1)).lt(new u(0))?"0":new u(Number(E.value)).sub(new u(.1)).toString():String(E.value):"":s.value=Number(E.value)>0?m.value.symbol=="SUI"?new u(Number(E.value)).sub(new u(.05)).lt(new u(0))?"0":new u(Number(E.value)).sub(new u(.05)).toString():String(E.value):"")},ze=o=>{o==="fromCoin"?(P.value=!0,l.value=Number(F.value)>0?Yo(new u(Number(F.value)).div(2).toString(),p.value.decimals).toString():""):(P.value=!1,s.value=Number(E.value)>0?Yo(new u(Number(E.value)).div(2).toString(),m.value.decimals).toString():"")};ne(()=>[i.value.tokensObj,C.query],async([o])=>{if(o){const v=o;if(C&&C.query&&C.query.fromCoin&&C.query.fromCoin){const c=v[C.query.fromCoin]||await _.value.getTokenBySymbol(v,C.query.fromCoin);p.value=c,ae.value=c}if(C&&C.query&&C.query.toCoin&&C.query.toCoin){const c=v[C.query.toCoin]||await _.value.getTokenBySymbol(v,C.query.toCoin);m.value=c,te.value=c}}},{immediate:!0,deep:!0});const G=B("--"),_e=R(()=>U.value.slippage),He=B(),de=async()=>{if(!k.value&&!d.value)return!1;if(!l.value&&!s.value&&!k.value&&!d.value)return;const o=r.value||{};if(xo(o))return;const{TickUtil:v,TickMath:c,getNearestTickByTick:f}=_.value,N=o==null?void 0:o.token_a.decimals,D=o==null?void 0:o.token_b.decimals;let y,$,T,S,I,V,j=o.current_tick_index,x;if(o.token_a.address.toLowerCase()===p.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===m.value.address.toLowerCase()?x=!0:x=!1,k.value==="0"&&d.value==="∞")T=v.getMinIndex(Number(o.tickSpacing)),S=v.getMaxIndex(Number(o.tickSpacing));else{x?(y=Number(k.value),$=Number(d.value)):(y=new u(1).div(d.value).toString(),$=new u(1).div(k.value).toString());try{I=y==0?-443636:c.priceToTickIndex(new u(y),N,D)}catch{I=-443636}try{V=c.priceToTickIndex(new u($),N,D)}catch{V=443636}T=f(I,Number(o.tickSpacing)),S=f(V,Number(o.tickSpacing))}if(d.value!=="∞"&&T>=S){K.value=!0,l.value="",Q.value=!0,s.value="";return}if(j==S||j==T){K.value=!0,Q.value=!0;return}if(d.value==="∞"||j>=T&&j<=S){K.value=!1,Q.value=!1;let ee;if(l.value||s.value){if(P.value){const ye=new u(l.value).mul(Math.pow(10,p.value.decimals)).toString();ee=new Ve(ye)}else{const ye=new u(s.value).mul(Math.pow(10,m.value.decimals)).toString();ee=new Ve(ye)}const{liquidityAmount:J,tokenMaxA:Y,tokenMaxB:se,tokenMaxAOrigin:Oe,tokenMaxBOrigin:Ue}=_.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:T,upperTick:S,coinAmount:ee,iscoinA:x?P.value:!P.value,roundUp:!0,slippage:Number(_e.value)/100,curSqrtPrice:new Ve(o.current_sqrt_price)});He.value={liquidityAmount:J,tokenMaxA:Y,tokenMaxB:se,tokenMaxAOrigin:Oe,tokenMaxBOrigin:Ue},x?P.value?s.value=Number(se)>0?se:"":l.value=Number(Y)>0?Y:"":P.value?s.value=Y:l.value=se}}else j>S?(K.value=!0,Q.value=!0):j<T?(K.value=!0,Q.value=!0):(K.value=!0,l.value="",Q.value=!0,s.value="")};ne(()=>pe.value,o=>{o&&de()},{immediate:!0}),ne(l,(o,v)=>{o==""&&P.value&&(s.value=""),o&&P.value&&!g.value&&de()}),ne(s,(o,v)=>{o==""&&!P.value&&(l.value=""),o&&!P.value&&!g.value&&de()}),ne(()=>oe.value,o=>{de()},{immediate:!0});const Xe=o=>{const v=o.replace(/[^\d.]/g,""),c="$"+Zo(v);g.value=!0,G.value=c,o>0?w():(l.value="",s.value="")};ne([k,d],([o,v])=>{Number(o)!==0&&Number(v)!==0&&!g.value?de():Number(o)!==0&&Number(v)!==0&&g.value?w():de()},{immediate:!0});const to=()=>{const o=a.value&&a.value[p.value.address]&&a.value[p.value.address].price,v=a.value&&a.value[m.value.address]&&a.value[m.value.address].price;if(o&&v){const c=new u(l.value>0?l.value:0).mul(o),f=new u(s.value>0?s.value:0).mul(v),N=c.add(f).toNumber();G.value=N>0&&N<.01?"$<0.01":"$"+Zo(N,2)}else G.value="--"};ne(()=>[l.value,s.value,g.value],([o,v,c])=>{(o||v)&&!c?to():(!o||!v)&&!c&&(G.value="--")},{immediate:!0});const a=R(()=>i.value.RATES),A=B(),w=async()=>{if(!k.value&&!d.value)return!1;if(!l.value&&!s.value&&!k.value&&!d.value)return;const o=r.value||{};if(xo(o))return;const{TickUtil:v,TickMath:c,getNearestTickByTick:f}=_.value,N=o==null?void 0:o.token_a.decimals,D=o==null?void 0:o.token_b.decimals;let y,$,T,S,I,V,j;if(o.token_a.address.toLowerCase()===p.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===m.value.address.toLowerCase()?j=!0:j=!1,k.value==="0"&&d.value==="∞")T=v.getMinIndex(Number(o.tickSpacing)),S=v.getMaxIndex(Number(o.tickSpacing));else{j?(y=Number(k.value),$=Number(d.value)):(y=new u(1).div(d.value).toString(),$=new u(1).div(k.value).toString());try{I=y==0?-443636:c.priceToTickIndex(new u(y),N,D)}catch{I=-443636}try{V=c.priceToTickIndex(new u($),N,D)}catch{V=443636}T=f(I,Number(o.tickSpacing)),S=f(V,Number(o.tickSpacing))}const x=a.value[o==null?void 0:o.token_a.address].price,ee=a.value[o==null?void 0:o.token_b.address].price;try{const{amountA:J,amountB:Y,tokenAmountsInfo:se}=await _.value.estCoinAmountsFromTotalAmount({lowerTick:T,upperTick:S,decimalsA:N,decimalsB:D,curSqrtPrice:new Ve(o.current_sqrt_price),totalAmount:G.value,tokenPriceA:x,tokenPriceB:ee});A.value=se,o.needReverse?b.value?(l.value=J,s.value=Y):(l.value=Y,s.value=J):(l.value=J,s.value=Y)}catch(J){console.log(J,"e===>")}},ue=R(()=>{var c,f,N,D,y,$;const o=(N=a.value[(f=(c=p)==null?void 0:c.value)==null?void 0:f.address])==null?void 0:N.price,v=($=a.value[(y=(D=m)==null?void 0:D.value)==null?void 0:y.address])==null?void 0:$.price;return!!(o&&v)}),O=()=>{n.emit("toggle")},W=B(!1),me=R(()=>{var o;return!p.value||!m.value?H("modal.selectTokenModalTitle"):!((o=C.query)!=null&&o.fee)&&ua[z.value].hasCreatePool?"Select fee tier":!Number(l.value)&&!Number(s.value)?H("button.enterAmount"):Number(l.value)>Number(F.value)?H("button.insufficientBalance",{name:p.value.symbol}):Number(s.value)>Number(E.value)?H("button.insufficientBalance",{name:m.value.symbol}):d.value!=="∞"&&Number(k.value)>=Number(d.value)?H("newAdd.invalidRange"):H("newAdd.preview")}),Re=o=>{const v=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,2})?).*$");o.target.value=o.target.value.replace(v,"$1")},qe=R(()=>{var o;return!!(!l.value&&!s.value||Number(l.value)>Number(F.value)||Number(s.value)>Number(E.value)||me.value!==H("newAdd.preview")||!r.value&&!((o=r.value)!=null&&o.currentPrice)||Number(l.value)<=0&&Number(s.value)<=0||K.value||Q.value)}),{setTransactionTxid:Ne,setTransactionDesc:Ie,setIsShowWaiting:ke,setIsShowSuccess:Pe,setIsShowRejected:Te,setPositiomNum:Le}=ge,Be=()=>{z.value=="Sui"&&Fe()},{$notify:Me}=ma(),Ae=B(!1),Fe=async()=>{var x,ee,J,Y,se,Oe,Ue,ye,no,lo,uo,so,io,ro,co,vo,mo,po,fo,go,ko,bo,Co,wo,ho,yo,So,_o,No,Po,To,Ao,$o,Ro,qo,Io,Lo,Bo,Mo,Fo,Oo,Uo,Do,Vo,jo,Eo,Wo,zo,Ho,Xo,Go,Jo,Ko,Qo;W.value=!1;let o=!1;_.value.getIsSortedSymbols(ae.value.address,te.value.address)&&(o=!0),Ne("");const v=K.value?"":`${l.value} ${(x=p.value)==null?void 0:x.symbol}`,c=Q.value?"":`${s.value} ${(ee=m.value)==null?void 0:ee.symbol}`;Ie(H("tips.increaseLiquiditySuccess",{from:!o&&!((Y=(J=r)==null?void 0:J.value)!=null&&Y.needReverse)||o&&((Oe=(se=r)==null?void 0:se.value)!=null&&Oe.needReverse)?v:c,and:!K.value&&!Q.value?"and":"",to:!o&&!((ye=(Ue=r)==null?void 0:Ue.value)!=null&&ye.needReverse)||o&&((lo=(no=r)==null?void 0:no.value)!=null&&lo.needReverse)?c:v})),ke(!0);let f="",N="",D="",y="",$="",T="",S=0,I=0,V=!1,j;if(o||(so=(uo=r)==null?void 0:uo.value)!=null&&so.needReverse){const ie=o&&!((ro=(io=r)==null?void 0:io.value)!=null&&ro.needReverse);f=ie?(go=(fo=(po=r)==null?void 0:po.value)==null?void 0:fo.token_b)==null?void 0:go.address:(mo=(vo=(co=r)==null?void 0:co.value)==null?void 0:vo.token_a)==null?void 0:mo.address,N=ie?(yo=(ho=(wo=r)==null?void 0:wo.value)==null?void 0:ho.token_a)==null?void 0:yo.address:(Co=(bo=(ko=r)==null?void 0:ko.value)==null?void 0:bo.token_b)==null?void 0:Co.address,D=ie?(Ao=(To=(Po=r)==null?void 0:Po.value)==null?void 0:To.token_b)==null?void 0:Ao.decimals:(No=(_o=(So=r)==null?void 0:So.value)==null?void 0:_o.token_a)==null?void 0:No.decimals,y=ie?(Bo=(Lo=(Io=r)==null?void 0:Io.value)==null?void 0:Lo.token_a)==null?void 0:Bo.decimals:(qo=(Ro=($o=r)==null?void 0:$o.value)==null?void 0:Ro.token_b)==null?void 0:qo.decimals,(Fo=(Mo=r)==null?void 0:Mo.value)!=null&&Fo.needReverse?($=b.value?l.value:s.value,T=b.value?s.value:l.value,S=b.value?Number(k.value):1/Number(d.value),I=b.value?Number(d.value):1/Number(k.value),V=b.value?P.value:!P.value,j=b.value?le.value:1/Number(le.value)):($=b.value?s.value:l.value,T=b.value?l.value:s.value,S=b.value?1/Number(d.value):Number(k.value),I=b.value?1/Number(k.value):Number(d.value),V=b.value?!P.value:P.value,j=b.value?1/Number(le.value):le.value)}else f=(Do=(Uo=(Oo=r)==null?void 0:Oo.value)==null?void 0:Uo.token_a)==null?void 0:Do.address,N=(Eo=(jo=(Vo=r)==null?void 0:Vo.value)==null?void 0:jo.token_b)==null?void 0:Eo.address,D=(Ho=(zo=(Wo=r)==null?void 0:Wo.value)==null?void 0:zo.token_a)==null?void 0:Ho.decimals,y=(Jo=(Go=(Xo=r)==null?void 0:Xo.value)==null?void 0:Go.token_b)==null?void 0:Jo.decimals,$=b.value?l.value:s.value,T=b.value?s.value:l.value,S=b.value?Number(k.value):1/Number(d.value),I=b.value?Number(d.value):1/Number(k.value),V=b.value?P.value:!P.value,j=b.value?le.value:1/Number(le.value);try{console.log("0501###toCreatePool###params###",{coinTypeA:f,coinTypeB:N,decimalsA:D,decimalsB:y,amountA:$,amountB:T,minPrice:S,maxPrice:I,fix_amount_a:V,tick_spacing:Number(r.value.tickSpacing),slippage:Number(_e.value)/100,price:j});const ie=await _.value.getCreatPoolTransactionPayload({coinTypeA:f,coinTypeB:N,decimalsA:D,decimalsB:y,amountA:$,amountB:T,minPrice:k.value=="0"&&d.value=="∞"?"0":S,maxPrice:k.value=="0"&&d.value=="∞"?"∞":I,fix_amount_a:V,tick_spacing:Number(r.value.tickSpacing),slippage:Number(_e.value)/100,price:j}),sa=await _.value.signAndExecuteTransactionBlock(M.value.currentWallet,ie),$e=_.value.handleTx(sa);if($e&&$e.hash){Ne($e.hash),ke(!1),Pe(!0);const Ge={title:"Created pool",desc:"Pool created successfully ",hash:$e.hash,tit:"Pool Created",icon:"icon-icon-Position-Created",tokenInfo:{tokena:`${(Ko=p.value)==null?void 0:Ko.address}`,numa:K.value?"":`- ${l.value}`,logoa:i.value.tokensObj&&p.value&&p.value.address&&i.value.tokensObj[p.value.address]&&i.value.tokensObj[p.value.address].logoURI,tokenb:`${(Qo=m.value)==null?void 0:Qo.address}`,numb:Q.value?"":`- ${s.value}`,logob:i.value.tokensObj&&m.value&&m.value.address&&i.value.tokensObj[m.value.address]&&i.value.tokensObj[m.value.address].logoURI},text:"Pool created successfully"};z.value!=="Aptos"&&(Ge.res=$e.res),_.value.showTransitionPending(Ge),(await _.value.watchTransaction(Ge,!0)).status&&(Pe(!1),Ae.value=!0,setTimeout(()=>{X.setPoolConfigList(z.value,U.value.filterCoinsObj),_.value.getAccount(M.value.address)},1e3)),Le()}else ke(!1),Te(!0);l.value="",s.value=""}catch(ie){console.log("0407###createPool###error##",String(ie)),String(ie).indexOf('Some("create_pool_internal") }, 1')>-1&&Me.error({icon:De("svg",{class:{icon:!0},"aria-hidden":!0},[De("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:De("div",{class:"notification-title"},[De("span",{innerHTML:"Pool already exists"},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),W.value=!1,X.setPoolConfigList(z.value,U.value.filterCoinsObj),l.value="",s.value="",ke(!1),Te(!0)}};return{amountLock:Ce,wallet:M,inputChange:Re,fromCoinAmount:l,toCoinAmount:s,fromCoin:p,toCoin:m,maxBtnSelect:We,halfBtnSelect:ze,showFromCoinLock:K,showToCoinLock:Q,fromCoinBlance:F,toCoinBlance:E,fixedFromCoin:P,isInputTotalAmount:g,toggle:O,theme:Z,liquidityTotalAmount:G,createPoolInfo:r,minPrice:k,maxPrice:d,currentPriceReverse:Qe,currentPrice:le,onInput:Xe,initPrice:pe,isShowtotalAmount:ue,direction:b,isShowLiquidityModal:W,createPoolBtnText:me,createPoolBtnDisabled:qe,toCreatePool:Be,isCreateSuccess:Ae}}});const Ea=e=>(eo("data-v-e6292c1d"),e=e(),oo(),e),Wa={class:"create-pool-right"},za={class:"card-container"},Ha={key:0,class:"lock"},Xa={class:"card-item"},Ga={class:"card-item"},Ja={key:0,class:"total-amount"},Ka=Ea(()=>t("span",null,"Total Amount",-1));function Qa(e,n,he,ge,U,z){const M=xe("NewLiquidityTile"),g=aa,C=ra,H=oa,ve=Ta,_=pa,X=Va;return h(),q("div",Wa,[re(M),t("div",za,[e.amountLock||e.showFromCoinLock||e.showToCoinLock?(h(),q("div",Ha,[re(g)])):L("",!0),t("div",Xa,[re(C,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[0]||(n[0]=i=>e.fromCoinAmount=i),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[1]||(n[1]=i=>e.maxBtnSelect("fromCoin")),onOnHalf:n[2]||(n[2]=i=>e.halfBtnSelect("fromCoin")),onOnInput:n[3]||(n[3]=i=>{e.fromCoinAmount=i,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),t("div",Ga,[re(C,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[4]||(n[4]=i=>e.toCoinAmount=i),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[5]||(n[5]=i=>e.maxBtnSelect("toCoin")),onOnHalf:n[6]||(n[6]=i=>e.halfBtnSelect("toCoin")),onOnInput:n[7]||(n[7]=i=>{e.toCoinAmount=i,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(h(),q("img",{key:1,class:"add",src:Na,alt:"",onClick:n[8]||(n[8]=(...i)=>e.toggle&&e.toggle(...i))})):L("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(h(),q("img",{key:2,class:"add",src:Pa,alt:"",onClick:n[9]||(n[9]=(...i)=>e.toggle&&e.toggle(...i))})):L("",!0)]),e.isShowtotalAmount?(h(),q("div",Ja,[Ka,t("span",null,fe(e.liquidityTotalAmount)+" ",1)])):L("",!0),e.initPrice?(h(),Se(H,{key:1,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"create-pool-info":e.createPoolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":"custom","current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","create-pool-info","min-price","max-price","current-price","current-price-reverse"])):L("",!0),e.isShowLiquidityModal?(h(),Se(ve,{key:2,"pool-info":e.createPoolInfo,title:e.$t("newAdd.preview"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":"custom","min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,"is-create":!0,onCreatePool:e.toCreatePool,onOnClose:n[10]||(n[10]=i=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onCreatePool"])):L("",!0),e.wallet.connected?(h(),Se(_,{key:4,class:"add-liquidity-btn",disabled:e.wallet.connected?e.createPoolBtnDisabled:!1,onClick:n[12]||(n[12]=i=>e.isShowLiquidityModal=!0)},{default:Ee(()=>[we(fe(e.createPoolBtnText),1)]),_:1},8,["disabled"])):(h(),Se(_,{key:3,class:"add-liquidity-btn",onClick:n[11]||(n[11]=i=>e.wallet.setIsShowWalletModal(!0))},{default:Ee(()=>[we(fe(e.$t("button.connectWallet")),1)]),_:1})),e.isCreateSuccess?(h(),Se(X,{key:5,onOnClose:n[13]||(n[13]=i=>e.isCreateSuccess=!1)})):L("",!0)])}const Ya=Ze(ja,[["render",Qa],["__scopeId","data-v-e6292c1d"]]),Za={1e-4:2,5e-4:10,.002:60,.006:200},xa={1e-4:2,5e-4:10,.0025:60,.01:200},et=Ye({components:{CreatePoolRight:Ya},setup(){const e=B(!0),n=B(!0),he=B(!0),ge=B(!1),U=B("1"),z=B(!0),M=B(""),g=ta(),C=fa(),H=ao(),ve=R(()=>H),_=na(),X=R(()=>_),i=R(()=>ve.value.chainName),Z=R(()=>i.value?la(i.value):{}),F=B("");ne(()=>[C,X.value.tokensObj],async([a,A])=>{var w,ue,O;((w=C==null?void 0:C.currentRoute)==null?void 0:w.value.name)=="liquidity-create"&&A&&(p.value=X.value.tokensObj[g.query.fromCoin]||await Z.value.getTokenBySymbol(A,g.query.fromCoin),m.value=X.value.tokensObj[g.query.toCoin]||await Z.value.getTokenBySymbol(A,g.query.toCoin),F.value=g.query.fee!=="null"&&g.query.fee?g.query.fee:""),((ue=C==null?void 0:C.currentRoute)==null?void 0:ue.value.name)=="liquidity-create"&&((O=g==null?void 0:g.query)!=null&&O.fee)&&(pe.value="",l.value="",s.value="",oe.value=!0)},{immediate:!0,deep:!0}),ne(()=>[p.value,m.value,pe.value,F.value,k.value,d.value,l.value,s.value],([a,A,w,ue,O,W,me])=>{!a||!A?(U.value="1",e.value=!0,n.value=!0,Ce.value=!0):ue?w?!O||!W?(U.value="4",e.value=!1,n.value=!1,Ce.value=!0):me||(U.value="5",e.value=!1,n.value=!1,Ce.value=!1):(U.value="3",e.value=!1,n.value=!0,Ce.value=!0):(U.value="2",e.value=!0,n.value=!0,Ce.value=!0)},{immediate:!0}),ne(()=>U.value,a=>{Number(a)<5&&(l.value="",s.value="")});const E=a=>{pe.value=a},We=a=>{var A;return(a==null?void 0:a.logoURI)||(a==null?void 0:a.logo_url)||((A=X.value.tokensObj[a==null?void 0:a.address])==null?void 0:A.logo_url)||(ve.value.theme==="default"?je("/image/coins/unknown.png"):je("/image/coins/sui-unknown.png"))},ze=a=>{switch(a){case"1":return{top:"10%"};case"2":return{top:"29%"};case"3":return{top:"48%"};case"4":return{top:"67%"};case"5":return{top:"87%"}}};R(()=>ua[i.value].hasCreatePool);const G=async a=>{var Re,qe,Ne,Ie,ke,Pe,Te,Le,Be,Me,Ae,Fe,o,v;console.log("#####emitCurrentPrice",a),a?(pe.value=a,le.value=a,Qe.value=new u(1).div(new u(a)).toString()):(pe.value="",le.value="",Qe.value="");let A,w;const ue=X.value.poolConfigList;for(let c=0;c<ue.length;c++){const f=ue[c];if(f.token_a.address.toUpperCase()===((Ne=(qe=(Re=ae)==null?void 0:Re.value)==null?void 0:qe.address)==null?void 0:Ne.toUpperCase())&&f.token_b.address.toUpperCase()===((Pe=(ke=(Ie=te)==null?void 0:Ie.value)==null?void 0:ke.address)==null?void 0:Pe.toUpperCase())){A=f.needReverse,w=f;break}else if(f.token_b.address.toUpperCase()===((Be=(Le=(Te=ae)==null?void 0:Te.value)==null?void 0:Le.address)==null?void 0:Be.toUpperCase())&&f.token_a.address.toUpperCase()===((Fe=(Ae=(Me=te)==null?void 0:Me.value)==null?void 0:Ae.address)==null?void 0:Fe.toUpperCase())){A=f.needReverse,w=f;break}}let O=!1;await Z.value.getIsSortedSymbols((o=ae.value)==null?void 0:o.address,(v=te.value)==null?void 0:v.address)&&(O=!0);let W;console.log(O,"###changeCurrentPrice createPoolNeedReverse 289"),console.log(b.value,"####changeCurrentPrice direction.value 290"),O&&!b.value?W=!0:O&&b.value||!O&&b.value?W=!1:W=!0,console.log(W,"###changeCurrentPrice newDirect 298");const me=i.value=="Aptos"?Za:xa;if(p.value&&m.value&&a){const c=w?w==null?void 0:w.token_a.decimals:O?te.value.decimals:ae.value.decimals,f=w?w==null?void 0:w.token_b.decimals:O?ae.value.decimals:te.value.decimals,N=a&&Z.value.TickMath.priceToSqrtPriceX64(W?new u(1/a):new u(a),c,f);console.log(N.toString(),"===>current_sqrt_price"),console.log(a&&a>0,"## emitCurrentPrice &&emitCurrentPrice>0");const D=a&&a>0&&Z.value.TickMath.priceToSqrtPriceX64(new u(1).div(a),p.value.decimals,m.value.decimals);console.log(!W,a,"===>!newDirect"),console.log(c,f,"decimalsA,decimalsB===>");const y=a&&a>0&&Z.value.TickMath.priceToTickIndex(W?new u(1).div(a):new u(a),c,f);console.log(y,"==>currentTickIndex");const $=y-me[g.query.fee]*5,T=y+me[g.query.fee]*5,S=Z.value.TickMath.tickIndexToPrice($,c,f).toString(),I=Z.value.TickMath.tickIndexToPrice(T,c,f).toString();oe.value?(k.value="0",d.value="∞"):W?(k.value=String(1/I),d.value=String(1/S),Je.value=String(1/I),Ke.value=String(1/S)):(k.value=S,d.value=I,Je.value=S,Ke.value=I),console.log("0518###c####createPoolFromCoin.value####",ae.value),console.log("0518###c####createPoolToCoin.value####",te.value),console.log("0518###c####createPoolNeedReverse####",O);const V={token_a:w?w.token_a:O?te.value:ae.value,token_b:w?w.token_b:O?ae.value:te.value,isCreate:!0,tickSpacing:me[g.query.fee],currentPrice:a,current_sqrt_price:N,tick_lower:$,tick_upper:T,current_tick_index:y,currentPriceReverse:Sa(String(1/a),6),reverse_current_sqrt_price:D,needReverse:A,fee:g.query.fee};r.value=V,console.log("0518###c####poolInfos####",V)}else r.value=null,k.value="",d.value=""},_e=()=>{oe.value=!oe.value,G(r.value.currentPrice)},He=a=>{console.log(a,"####0731 priceRangeChangeMin"),oe.value?(oe.value=!1,G(r.value.currentPrice)):k.value=a},de=a=>{oe.value?(oe.value=!1,G(r.value.currentPrice)):a=="0"?d.value="∞":d.value=a},Xe=()=>{var A,w;console.log(r.value,"==>createPoolInfo.value"),b.value=!b.value;const a=p.value;p.value=m.value,m.value=a,r.value&&(G(_a(new u(1).div(r.value.currentPrice).toString(),(w=(A=m)==null?void 0:A.value)==null?void 0:w.decimals)),P.value?l.value=s.value:s.value=l.value),console.log(b.value,"####toggle direction.value")};return ga(()=>{Aa()}),{amountLock:Ce,currentStep:U,sliderStyle:ze,coinAmount:ge,pricerange:M,fromCoin:p,toCoin:m,fee:F,direct:z,getCoinIcon:We,isSelectFullRange:he,onInput:E,store:ve,initPrice:pe,inputPriceLock:e,specifyPriceLock:n,changeCurrentPrice:G,minPrice:k,maxPrice:d,defaultMinPrice:Je,defaultMaxPrice:Ke,clickFullRange:_e,createPoolInfo:r,isFullRange:oe,priceRangeChangeMin:He,priceRangeChangeMax:de,fromCoinAmount:l,toggle:Xe,showFromCoinLock:K,showToCoinLock:Q,inputChange:a=>{const A=b.value?m.value.decimals:p.value.decimals,w=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${A}})?).*$`);a.target.value=a.target.value.replace(w,"$1")},currentPrice:le}}});const ce=e=>(eo("data-v-22d1195c"),e=e(),oo(),e),ot={class:"creat-pool-container"},at={class:"creat-pool-left"},tt={class:"progress"},nt=ce(()=>t("div",{class:"slider-ratio-content"},null,-1)),lt=[nt],ut={class:"progress-text"},st={key:0},it={key:0},rt={key:0},ct={key:0},vt={key:0},dt={class:"creat-pool-center"},mt={class:"title"},pt=ce(()=>t("div",{class:"left"},"Set Initial Price",-1)),ft={class:"right"},gt={key:0,class:"token-box"},kt=ce(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),bt=ce(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ct=[kt,bt],wt={class:"content top-content"},ht=ce(()=>t("div",{class:"top"},[t("span",null,"💡"),t("span",null,"Please set an initial price for this new pool to start.")],-1)),yt={class:"bottom"},St={class:"input-div"},_t={key:0,class:"lock"},Nt={class:"title"},Pt=ce(()=>t("div",{class:"left"},"Set Price Range",-1)),Tt={class:"right"},At={key:0,src:$a},$t=ce(()=>t("span",null,"Full Range",-1)),Rt={class:"content bottom-content"},qt=ce(()=>t("span",null,"💡",-1)),It=ce(()=>t("span",null,"Please specify a price range that you want to provide your liquidity within.",-1)),Lt=[qt,It],Bt={class:"bottom"},Mt={class:"set-price-box"},Ft={key:0,class:"lock"},Ot={key:1,class:"create-pool-warning"},Ut={key:2,class:"position-tips"},Dt=["src"],Vt={class:"error"},jt={class:"creat-pool-right-container"};function Et(e,n,he,ge,U,z){var _,X;const M=ha,g=aa,C=ca,H=xe("CreatePoolRight"),ve=ka("image");return h(),q("div",ot,[t("div",at,[t("div",tt,[t("div",{class:"slider-ratio",style:ba(e.sliderStyle(e.currentStep))},lt,4)]),t("div",ut,[t("div",{class:be(["row",Number(e.currentStep)>=1?"":"color-text"])},[e.currentStep>=1&&e.fromCoin&&e.toCoin?(h(),q("span",st,"✓")):L("",!0),we(" Select Tokens ")],2),t("div",{class:be(["row",Number(e.currentStep)>=2?"":"color-text"])},[e.currentStep>=2&&e.fee?(h(),q("span",it,"✓")):L("",!0),we(" Select Fee Tier ")],2),t("div",{class:be(["row",Number(e.currentStep)>=3?"":"color-text"])},[e.currentStep>=3&&e.initPrice?(h(),q("span",rt,"✓")):L("",!0),we(" Set Initial Price ")],2),t("div",{class:be(["row",Number(e.currentStep)>=4?"":"color-text"])},[e.currentStep>=4&&e.minPrice&&e.maxPrice?(h(),q("span",ct,"✓")):L("",!0),we(" Select Price Range ")],2),t("div",{class:be(["row",Number(e.currentStep)>=5?"":"color-text"])},[e.currentStep>=5&&e.fromCoinAmount?(h(),q("span",vt,"✓")):L("",!0),we(" Confirm Liquidity ")],2)])]),t("div",dt,[t("div",mt,[pt,t("div",ft,[e.fromCoin&&e.toCoin?(h(),q("div",gt,[Ca(t("img",null,null,512),[[ve,(_=e.fromCoin)==null?void 0:_.logo_url]]),t("span",null,fe((X=e.fromCoin)==null?void 0:X.symbol),1),t("div",{class:"icon-change",onClick:n[0]||(n[0]=(...i)=>e.toggle&&e.toggle(...i))},Ct)])):L("",!0)])]),t("div",wt,[ht,t("div",yt,[t("div",St,[re(M,{value:e.initPrice,type:"text",placeholder:"0.0",onChange:e.inputChange,onInput:n[1]||(n[1]=i=>e.changeCurrentPrice(i.target.value))},null,8,["value","onChange"]),t("span",null,fe(e.toCoin&&e.toCoin.symbol)+" per "+fe(e.fromCoin&&e.fromCoin.symbol),1)]),e.inputPriceLock?(h(),q("div",_t,[re(g)])):L("",!0)])]),t("div",Nt,[Pt,t("div",Tt,[t("div",{class:be(["radio",e.isFullRange?"active-radio":""]),onClick:n[2]||(n[2]=(...i)=>e.clickFullRange&&e.clickFullRange(...i))},[e.isFullRange?(h(),q("img",At)):L("",!0)],2),$t])]),t("div",Rt,[t("div",{class:be(["top",e.specifyPriceLock?"":"no-border"])},Lt,2),t("div",Bt,[t("div",Mt,[re(C,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.createPoolInfo,loading:!1,"current-price-tab":"custom",onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice"])]),e.specifyPriceLock?(h(),q("div",Ft,[re(g)])):L("",!0),e.currentStep>=4&&(e.showFromCoinLock||e.showToCoinLock)&&Number(e.maxPrice)>Number(e.minPrice)?(h(),q("div",Ot," To create a new pool, the initial price you set must be within your price range. ")):L("",!0),e.currentStep>=4&&Number(e.minPrice)>Number(e.maxPrice)?(h(),q("div",Ut,[t("img",{src:("importIcon"in e?e.importIcon:wa(je))("/image/icon-tips-error@2x.png"),alt:""},null,8,Dt),t("p",Vt,fe(e.$t("tips.positionError")),1)])):L("",!0)])])]),t("div",jt,[re(H,{"create-pool-info":e.createPoolInfo,onToggle:e.toggle},null,8,["create-pool-info","onToggle"])])])}const dn=Ze(et,[["render",Et],["__scopeId","data-v-22d1195c"]]);export{dn as default};
