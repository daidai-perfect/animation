import{b as rt,x as zt,y as _t,l as ie,c as It,u as St,h as Pe,d as K,s as wt,T as ut,z as di,e as mi,f as vi,a as fi,w as ze,p as Rt,A as gi}from"./pool.e2dd35c1.js";import{a as xe,r as B,m as h,y as Et,D as Ne,e as et,o as g,f as z,t as gt,V as pi,h as a,G as Ct,v as S,u as H,x as ne,c as Ue,p as pt,k as bt,S as Ht,i as $e,w as De,j as Ge,U as Tt,l as Dt,K as Nt,C as Xt,q as Wt,F as Pt,s as Bt,z as vt,Y as bi,R as hi,b as Zt,T as ki,B as Gt,Z as yi}from"./entry.b66a9ef5.js";/* empty css              */import{s as mt,m as _i,l as wi,b as Ci,a as Pi}from"./transform.c672907f.js";import{D as s}from"./decimal.0bdeb344.js";/* empty css              */import{d as Kt,_ as Jt,c as Yt,a as Qt,b as Ii}from"./new-liquidity-title.7de0f566.js";import{i as at}from"./import-icon.de3e6c66.js";/* empty css              */import{positionError as ot,fromCoin as C,toCoin as y,tickList as nt,currentPrice as ct,currentPriceReverse as ft,direction as he,currentPriceTab as x,defaultMinPrice as kt,defaultMaxPrice as yt,minPrice as R,maxPrice as P,toggle as Vt,isStableFarmingRange as Be,isInputTotalAmount as He,priceConfigObj as Ve,fromCoinAmount as T,toCoinAmount as N,fixedFromCoin as Te,resetTickList as Ut,resetData as Si}from"./data.d4964c3e.js";import{u as At}from"./farms.d0df7386.js";import{_ as xt}from"./icon_farms_2x.95c929e1.js";import{_ as Ti}from"./coin-lock.e003a7ee.js";import{_ as Ni}from"./coin-select.cb09c085.js";import{_ as Ai}from"./status-block.0de623f8.js";import{_ as ei}from"./icon-arrow_2x.948aedb2.js";import{_ as ti}from"./icon-arrow_2x.4ffddb8e.js";import{_ as Li}from"./token-warning-modal.29f6fb88.js";import{_ as $i,a as qi,b as Mi}from"./icon-Add-Liquidity_2x.acebc5cd.js";import{u as Fi}from"./notifi.35121870.js";import"./img-lock_2x.a28135f4.js";import"./index.8d1c7ae6.js";/* empty css              */import"./token-warning.fd222bfb.js";import"./swap-setting.616157d2.js";import"./icon-warning_2x.573d2f96.js";import"./icon-error_2x.0d4ff5aa.js";import"./token-warning_2x.959a8efb.js";import"./img-no-Positions_2x.dbb1628a.js";import"./img-no-Positions_2x.bb773a2a.js";import"./icon-selected_3x.09e9a6f0.js";import"./useWhale.ef902a84.js";function jt(e,r,ae){const ee=new s(10).pow(r-ae);return new s(1.0001).pow(e).mul(ee)}const Oi=xe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,r){const ae=B(""),ee=B(""),L=h(()=>{var n,w,m,G,U,te;return(n=e.poolInfo)!=null&&n.current_sqrt_price&&((w=e.poolInfo)!=null&&w.coinA)&&((m=e.poolInfo)!=null&&m.coinB)?o.sqrtPriceX64ToPrice((G=e.poolInfo)==null?void 0:G.current_sqrt_price,(U=e.poolInfo)==null?void 0:U.coinA.decimals,(te=e.poolInfo)==null?void 0:te.coinB.decimals).toString():"0"}),re=h(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(L.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(L.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),$=h(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(L.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(L.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),O=rt(),I=h(()=>O),J=h(()=>I.value.chainName?It(I.value.chainName):{}),{TickMath:o,getNearestTickByTick:v}=J.value,q=(n=[])=>{let w=6;const m=Math.abs(Number(n[0])-Number(n[n.length-1]));return m>=6?w=0:m>=1?w=1:m>=.1?w=2:m>=.01?w=3:m>=.001?w=4:m>=1e-4?w=5:m>=1e-5?w=6:m>=1e-6?w=7:m>=1e-7&&(w=8),w},Z=(n,w=1)=>{if(n&&n.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const m=Number(e.poolInfo.current_tick_index);let G=m+100*w,U=m-100*w,te,p;if(e.maxPrice==="âˆž")p=J.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?p=o.priceToTickIndex(new s(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):p=o.priceToTickIndex(new s(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{p=443636}if(e.minPrice==="0")te=J.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=o.priceToTickIndex(new s(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=o.priceToTickIndex(new s(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=-443636}let ve=0;if(e.currentPriceTab!=="full range"){if(m>=te&&m<=p){const F=m-te,fe=p-m;ve=Math.max(Math.abs(F),Math.abs(fe))}else m<te?ve=Math.abs(p-m):ve=Math.abs(m-te);G=m+ve+100*w,U=m-ve-100*w}else{const F=(Math.abs(m)>5e3,2e4);G=m+F*w,U=m-F*w}U<-443636&&(U=-443636),G>443636&&(G=443636);const f=new s(n.liquidity).div(Math.pow(10,8)).toString(),M=e.tickList,E=[],be=[];let k={};for(let F=0;F<M.length;F++){if(k=M[F],k.index<=m&&k.index>=U){if(E.length<1&&F!==0){const fe=M[F-1];E.unshift({...fe,index:U,source:"left"})}E.unshift(k)}else if(k.index>m&&k.index<=G&&(be.push(k),E.length<1&&F!==0)){const fe=M[F-1];E.push({...fe,index:U,source:"left"})}if(k.index>G){const fe=M[F];if(be.push({...fe,index:G,source:"right"}),E.length<1&&F!==0){const Je=M[F-1];E.push({...Je,index:U,source:"left"})}break}}let j="0";for(let F=E.length-1;F>=0;F--)j=new s(j).plus(new s(E[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),E[F].liquityAmount=j;let le=f;for(let F=0;F<be.length;F++)le=new s(le).plus(new s(be[F].liquidityNet.toString()).div(Math.pow(10,8))).toString(),be[F].liquityAmount=le;let me=[];const Y=M&&M.length>0?{index:m,liquityAmount:Number(f)}:{index:m,liquityAmount:0};(E.length>0||be.length>0)&&(me=[...E.reverse(),Y,...be],e.direction||(me=me.reverse()));const Ee=[];M.forEach(F=>{Ee.push({...F,liquidityGross:F.liquidityGross.toString(),liquidityNet:F.liquidityNet.toString()})}),D(me,U,G,te,p,m)}};let se=B(!1);const Q=B(!1);Et(()=>{const n=document.body.clientWidth;Q.value=!0,n<750?se.value=!1:se.value=!0,window.onresize=()=>{document.body.clientWidth<750?se.value=!1:se.value=!0,Z(e.poolInfo,e.zoom)}});const D=(n,w,m,G,U,te)=>{let p,ve;e.direction?(p=Number(e.before7dContractPriceLowest)!==0?o.priceToTickIndex(new s(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ve=Number(e.before7dContractPriceHighest)!==0?o.priceToTickIndex(new s(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(p=Number(e.before7dContractPriceLowest)!==0?o.priceToTickIndex(new s(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ve=Number(e.before7dContractPriceHighest)!==0?o.priceToTickIndex(new s(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const f={top:30,right:35,bottom:20,left:80};let M,E;se.value?(M=460-f.left-f.right,E=205-f.top-f.bottom):(M=340-f.left-f.right,E=205-f.top-f.bottom);const be=m-w,k=parseInt(String(be/4));let j=[w+k/4,w+k,w+2*k,m-k,m-k/4];const le=w,me=m,Y=M/(me-le);e.currentPriceTab==="full range"&&(j=[w,w+2*k,m]);const Ee=j.map(u=>e.direction?jt(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new s(1).div(jt(u,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),F=q(Ee);mt("#chart").selectAll("*").remove();const fe=mt("#chart").attr("width",M+f.left+f.right).attr("height",E+f.top+f.bottom).append("g").attr("transform",`translate(${f.left},${f.right})`),Je=_i(n,function(u){return Number(Math.abs(u.liquityAmount))})||0,qe=wi().range([0,E]).domain([Je,0]);Ci().rangeRound([0,M]).padding(.1);const tt=fe.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");I.value.theme=="default"?tt.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-le)*Y:Math.abs(me-u.index)*Y}).attr("y",function(u,c){return e.direction?c===n.length-1?0:qe(u.liquityAmount):c===n.length-1?0:qe(n[c+1].liquityAmount)}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?M:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*Y:0)}).attr("height",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?E:e.direction?c===n.length-1?0:E-qe(u.liquityAmount):c===n.length-1?0:E-qe(n[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):tt.attr("x",function(u,c){return c===0?0:e.direction?Math.abs(u.index-le)*Y:Math.abs(me-u.index)*Y}).attr("y",function(u,c){return e.direction?c===n.length-1?0:qe(Math.abs(u.liquityAmount)):c===n.length-1?0:qe(Math.abs(n[c+1].liquityAmount))}).attr("width",function(u,c){return c===0&&n.length===1&&u.liquityAmount>0?M:(e.direction,c!==n.length-1?Math.abs(n[c+1].index-u.index)*Y:0)}).attr("height",function(u,c){if(c===0&&n.length===1&&u.liquityAmount>0)return E;if(e.direction)return c===n.length-1?0:Number(u.liquityAmount)?E-qe(Math.abs(u.liquityAmount)):0;{if(c===n.length-1)return 0;const Le=E-qe(Math.abs(n[c+1].liquityAmount));return Number(n[c+1].liquityAmount)?Le:0}}).attr("fill",function(u,c){return"#417494"}).attr("class","bars").attr("stroke-width",1).attr("stroke",function(u,c){return"#417494"});const Ye=fe.append("g");Ye.append("line").attr("x1",0).attr("y1",155).attr("x2",M).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const Qe=Ye.append("g");let oe=0;if(e.direction){for(let u=0;u<j.length;u++){const c=ie(Ee[u],F)||"0";Ee.push(c);const Le=Math.abs(j[u]-le)*Y;let ce=0;for(let Ie=0;Ie<c.length;Ie++)c[Ie]==="1"?ce+=4.02:c[Ie]==="."?ce+=2.64:c[Ie]==="7"?ce+=5.48:ce+=6;Qe.append("text").text(c).attr("x",Le-ce/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}oe=Math.abs(te-le)*Y}else{for(let u=j.length-1;u>=0;u--){const c=ie(Ee[u],F)||0;Ee.push(c);const Le=Math.abs(j[u]-me)*Y;let ce=0;for(let Ie=0;Ie<c.length;Ie++)c[Ie]==="1"?ce+=4.02:c[Ie]==="."?ce+=2.64:c[Ie]==="7"?ce+=5.48:ce+=6;Qe.append("text").text(c).attr("x",Le-ce/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}oe=Math.abs(te-me)*Y}(I.value.theme=="default"?fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+oe+", 0)");let t,d,_,A;e.direction?(t=G<le?-100:parseInt(String(Math.abs(G-le)*Y)),d=U<le?-100:parseInt(String(Math.abs(U-le)*Y)),_=p<le?-100:Math.abs(p-le)*Y,A=ve<le?-100:Math.abs(ve-le)*Y):(d=G<le?-100:Math.abs(me-G)*Y,t=U<le?-100:Math.abs(me-U)*Y,A=p>me?-100:Math.abs(me-p)*Y,_=ve>me?-100:Math.abs(me-ve)*Y),e.minPrice==="0"&&(t=0),e.maxPrice==="âˆž"&&(d=M),se.value?ae.value=M-t+94+"px":ae.value=M-t+87+"px",ee.value=d+98+"px",p&&_<M&&fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+_+", 0)"),ve&&A<M&&fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+A+", 0)");const X=fe.append("g").attr("id","left-handle"),W=fe.append("g").attr("id","right-handle");I.value.theme=="default"?(X.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),X.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),X.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),X.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),W.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),W.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),W.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(X.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),X.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),X.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),X.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),W.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),W.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),W.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),X.attr("transform","translate("+t+", 0)"),W.attr("transform","translate("+d+", 0)");const Ae=Pi().extent([[0,0],[M,E]]).handleSize(30).on("end",it);fe.append("g").attr("class","brush").call(Ae).call(Ae.move,[t,d]);function it(u){if(!u.sourceEvent||!u.selection)return;X.attr("transform","translate("+u.selection[0]+", 0)"),W.attr("transform","translate("+u.selection[1]+", 0)"),se.value,ae.value=M-u.selection[0]+87+"px",ee.value=u.selection[1]+74+"px";let c,Le,ce=0,Ie=0;e.direction?(ce=v(parseInt(String(u.selection[0]/Y+le)),Number(e.poolInfo.tickSpacing)),c=o.tickIndexToPrice(ce,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),Ie=v(parseInt(String(u.selection[1]/Y+le)),Number(e.poolInfo.tickSpacing)),Le=o.tickIndexToPrice(Ie,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(Ie=v(me-u.selection[0]/Y,Number(e.poolInfo.tickSpacing)),c=1/o.tickIndexToPrice(Ie,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ce=v(me-u.selection[1]/Y,Number(e.poolInfo.tickSpacing)),Le=1/o.tickIndexToPrice(ce,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),r.emit("onChangeMinPrice",String(ie(String(c),6))),r.emit("onChangeMaxPrice",String(ie(String(Le),6)))}I.value.theme=="default"?mt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):mt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};return B(""),Ne(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom,e.tickList],([n,w,m,G,U,te])=>{n&&w&&m&&(n!=null&&n.liquidity)&&Z(n,U)},{immediate:!0}),{store:I,loading:Q,rangeSizeLower:re,rangeSizeUpper:$,rangeSizeLowerPosition:ae,rangeSizeUpperPosition:ee,decimalFormat:zt,numberformat:_t}}});const Ri=e=>(pt("data-v-662ad41d"),e=e(),bt(),e),Bi={class:"chart-box"},Ui={class:"chart"},ji=Ri(()=>a("svg",{id:"chart"},null,-1));function zi(e,r,ae,ee,L,re){const $=Ht;return g(),z("div",Bi,[gt(a("div",Ui,[e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(g(),z("div",{key:0,class:"range-size range-size-lower",style:Ct({right:e.rangeSizeLowerPosition})},S(("numberformat"in e?e.numberformat:H(_t))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):ne("",!0),e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(g(),z("div",{key:1,class:"range-size range-size-upper",style:Ct({left:e.rangeSizeUpperPosition})},S(("numberformat"in e?e.numberformat:H(_t))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):ne("",!0),ji],512),[[pi,!e.chartLoading]]),e.chartLoading?(g(),Ue($,{key:0})):ne("",!0)])}const ii=et(Oi,[["render",zi],["__scopeId","data-v-662ad41d"]]),Ei=xe({props:{lever:{type:String,default:""}},setup(){return{}}});const Hi=e=>(pt("data-v-47f26f4b"),e=e(),bt(),e),Di={class:"lever"},Xi=Hi(()=>a("div",{class:"lever-title"},[a("span",null,"Leverage"),a("svg",{"aria-hidden":"true",class:"icon"},[a("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),Wi={class:"lever-text"};function Zi(e,r,ae,ee,L,re){const $=Tt;return g(),z("div",Di,[$e($,{"overlay-class-name":"lever-tooltip"},{title:De(()=>[Ge("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:De(()=>[Xi]),_:1}),a("div",Wi,S(e.lever),1)])}const Gi=et(Ei,[["render",Zi],["__scopeId","data-v-47f26f4b"]]),Ki=xe({components:{NewLiquidityD3Chart:ii,NewLiquidityPrice:Kt},setup(){const{t:e,locale:r}=Dt(),ae=B("liquidity"),ee=rt(),L=h(()=>ee),re=h(()=>L.value.chainName),$=St(),O=h(()=>$),I=h(()=>L.value.chainName?It(L.value.chainName):{});Et(()=>{ot.value=!1});const J=Nt(),o=h(()=>{let t=null;for(let d=0;d<O.value.poolConfigList.length;d++){const _=O.value.poolConfigList[d];_.address==J.query.poolAddress&&(t=_)}return t}),v=h(()=>{let t=null;for(const d in O.value.poolsObj){const _=O.value.poolsObj[d];_.address==J.query.poolAddress&&(t=_)}return t}),q=B(),Z=B(!0),se=async(t,d)=>{if(Z.value=!0,d){nt.value=[],D.value=[],Be.value=!1;const _=t.token_a.decimals,A=t.token_b.decimals;ut.tickIndexToPrice(t.current_tick_index,_,A),ct.value=ut.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||(t==null?void 0:t.object.current_sqrt_price),_,A).toString(),ft.value=new s(1).div(ut.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||(t==null?void 0:t.object.current_sqrt_price),_,A)).toString(),C.value=t.needReverse?t.token_b:t.token_a,y.value=t.needReverse?t.token_a:t.token_b,q.value=t.needReverse,t.token_a.address.toLowerCase()===C.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===y.value.address.toLowerCase()?he.value=!0:he.value=!1;let X={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const{list:W,address:Ae}=await I.value.getTicks(X);nt.value=W&&Ae==t.address?I.value.getTickDataFromUrlData(W):[],Z.value=!1,w(t)}},Q=t=>{var A,X;const d=t.token_a.decimals,_=t.token_b.decimals;ct.value=ut.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((A=t==null?void 0:t.object)==null?void 0:A.current_sqrt_price),d,_).toString(),ft.value=new s(1).div(ut.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((X=t==null?void 0:t.object)==null?void 0:X.current_sqrt_price),d,_)).toString()},D=B([]),n=B(),w=async t=>{const d=t.token_a.decimals,_=t.token_b.decimals;let A=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[t.address]&&O.value.poolPriceConfigObj[t.address].recommend_ranges||{};const X=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[t.address]&&O.value.poolPriceConfigObj[t.address].type||"";let W,Ae;const it=di(t.current_tick_index,t.tickSpacing);n.value=t.current_tick_index,W=it-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),Ae=it+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const u=I.value.TickMath.tickIndexToPrice(W,d,_).toString(),c=I.value.TickMath.tickIndexToPrice(Ae,d,_).toString();A["full range"]={lower:I.value.TickUtil.getMinIndex(Number(v.value.tickSpacing)),upper:I.value.TickUtil.getMaxIndex(Number(v.value.tickSpacing))},A.custom={lower:W,upper:Ae,minPrice:u,maxPrice:c};const Le=[];for(let ce in A)A[ce]&&Le.push({...A[ce],key:ce});X&&Le&&Le.length>2?t.isSelfBuilt?x.value="custom":X=="stable"?x.value="suggested":x.value="passive":x.value="custom",D.value=Le||{},Ve.value=A,U({key:x.value,...A[x.value]})},m=B(""),G=B(""),U=t=>{x.value=t.key.toLowerCase();const d=v.value.token_a.decimals,_=v.value.token_b.decimals,{lower:A,upper:X}=t;He.value=!1;const W=I.value.TickMath.tickIndexToPrice(A,d,_).toString(),Ae=I.value.TickMath.tickIndexToPrice(X,d,_).toString();if(t.key=="full range"){m.value=A,G.value=X,te();return}he.value?(kt.value=String(W),R.value=String(W),yt.value=String(Ae),P.value=String(Ae),m.value=A,G.value=X):(kt.value=new s(1).div(new s(Ae)).toString(),R.value=new s(1).div(new s(Ae)).toString(),yt.value=new s(1).div(new s(W)).toString(),P.value=new s(1).div(new s(W)).toString(),m.value=I.value.TickMath.priceToTickIndex(new s(1/Number(Ae)),d,_),G.value=I.value.TickMath.priceToTickIndex(new s(1/Number(W)),d,_))},te=t=>{R.value="0",P.value="âˆž"};Ne(()=>v.value,(t,d)=>{(!d&&t&&!K(t)||d&&t&&d.address!==t.address)&&se(t,!d||t.address!==d.address),t&&!K(t)&&Q(t),t||(nt.value=[])},{immediate:!0}),Xt(()=>{C.value=B(),y.value=B(),nt.value=[]}),Ne(()=>[o.value,v.value,O.value.recommendRangesObj],(t,d)=>{var _,A;(!d||t[0]&&t[1]&&t[2]&&!K(t[0])&&!K(t[1]&&!K(t[2]))||((_=t[0])==null?void 0:_.address)!==((A=d[0])==null?void 0:A.address))&&t[0]&&t[2]&&!K(t[0])&&!K(t[2])&&$.setSinglePool(t[0],t[2],re.value)},{immediate:!0,deep:!0});const p=t=>{if(re.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},ve=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},f=t=>{var _,A;const d=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[(_=v.value)==null?void 0:_.address]&&O.value.poolPriceConfigObj[(A=v.value)==null?void 0:A.address].type||"";if(D.value.length>2)if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},M=B(1),E=()=>{const t=M.value/2;M.value=t},be=()=>{const t=M.value*2;M.value=t},k=h(()=>{var t,d,_;return!v.value||K(L.value.addressHistTokens)||!L.value.addressHistTokens[(t=v.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((_=L.value.addressHistTokens[(d=v.value)==null?void 0:d.poolAddress])==null?void 0:_.data.map(A=>[A.key,A.value]))}),j=B(30),le=B("30D"),me=h(()=>he.value?k.value&&ie(j.value==7?k.value.before_7_d_contract_price_lowest:j.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest,6)||0:k.value&&ie(new s(1).div(j.value==7?k.value.before_7_d_contract_price_highest:j.value==24?k.value.before_24_h_contract_price_highest:k.value.before_30_d_contract_price_highest).toString(),6)||0),Y=h(()=>he.value?k.value&&ie(j.value==7?k.value.before_7_d_contract_price_highest:j.value==24?k.value.before_24_h_contract_price_highest:k.value.before_30_d_contract_price_highest,6)||0:(k.value&&ie(1/Number(j.value==7?k.value.before_7_d_contract_price_lowest:j.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest),6))==1/0?0:k.value&&ie(1/Number(j.value==7?k.value.before_7_d_contract_price_lowest:j.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest),6)||0),Ee=h(()=>{const t=Number(R.value),d=Number(P.value);if(R.value=="0"&&P.value=="âˆž"||x.value=="full range")return"1x";if(R.value==P.value||x.value=="full range")return"--";if(R.value&&P.value&&R.value!=="0"&&P.value!=="âˆž"){const _=wt(1/(1-Number((t/d)**.25)),2);return Number(_)>0?_+"x":"--"}else return 1}),F=h(()=>{var t,d,_,A,X,W;return((t=C.value)==null?void 0:t.isSelfBuilt)||((d=y.value)==null?void 0:d.isSelfBuilt)||((A=O.value.tokensObj[(_=C.value)==null?void 0:_.address])==null?void 0:A.isSelfBuilt)||((W=O.value.tokensObj[(X=y.value)==null?void 0:X.address])==null?void 0:W.isSelfBuilt)}),fe=(t,d)=>{t!==R.value&&x.value=="full range"?U({key:"custom",...D.value.custom}):x.value!=="full range"&&x.value!=="custom"?(x.value="custom",R.value=t):R.value=t,oe.value&&(Be.value?(he.value&&R.value!==oe.value.minPrice&&(Be.value=!1),!he.value&&Number(R.value)!==1/Number(oe.value.maxPrice)&&(Be.value=!1)):(he.value&&R.value==oe.value.minPrice&&P.value==oe.value.maxPrice&&(Be.value=!0),!he.value&&Number(R.value)==1/Number(oe.value.maxPrice)&&Number(P.value)==1/Number(oe.value.minPrice)&&(Be.value=!0)))},Je=(t,d)=>{t!==P.value&&x.value=="full range"?U({key:"custom",...D.value.custom}):x.value!=="full range"&&x.value!=="custom"?(x.value="custom",t=="0"?P.value="âˆž":P.value=t):t=="0"?P.value="âˆž":P.value=t,oe.value&&(Be.value?(he.value&&P.value!==oe.value.maxPrice&&(Be.value=!1),!he.value&&Number(P.value)!==1/Number(oe.value.minPrice)&&(Be.value=!1)):(he.value&&R.value==oe.value.minPrice&&P.value==oe.value.maxPrice&&(Be.value=!0),!he.value&&Number(R.value)==1/Number(oe.value.maxPrice)&&Number(P.value)==1/Number(oe.value.minPrice)&&(Be.value=!0)))},qe=t=>{var d;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((d=O.value.tokensObj[t==null?void 0:t.address])==null?void 0:d.logo_url)||(L.value.theme==="default"?at("/image/coins/unknown.png"):at("/image/coins/sui-unknown.png"))},st=t=>{switch(t){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},tt=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],Ye=At(),Qe=h(()=>Ye),oe=h(()=>{var t;return Qe.value.farmsPoolObj[(t=v==null?void 0:v.value)==null?void 0:t.address]}),lt=h(()=>O.value.poolPriceConfigObj);return Ne(()=>[Be.value,v.value,D.value,lt.value,oe.value,he.value],(t,d)=>{var _,A;if(t[0]&&t[4]&&!K(t[4]))x.value="custom",R.value=t[5]?t[4].minPrice:String(1/t[4].maxPrice),P.value=t[5]?t[4].maxPrice:String(1/t[4].minPrice);else if(t[1]&&!K(t[1])&&t[2]&&!K(t[2])&&t[3]&&!K(t[3])&&t[4]&&!K(t[4])){t[3]&&t[3][(_=t[1])==null?void 0:_.address]&&t[3][(A=t[1])==null?void 0:A.address].type;const X=t[2].filter(W=>W.key===(t[2].length==4?"passive":"suggested"));X!=null&&X[0]&&(!d||d[0]!==t[0])&&U({...X[0]})}},{immediate:!0}),{positionError:ot,getCoinIcon:qe,chainName:re,store:L,currentTab:ae,currentPrice:ct,currentPriceReverse:ft,fromCoin:C,toCoin:y,direction:he,needReverse:q,addCommom:Pe,decimalUi:ie,priceTablList:D,currentPriceTab:x,sliderStyle:f,poolInfo:v,tickList:nt,getPriceTabImage:p,getPriceTabText:ve,defaultMinPrice:kt,defaultMaxPrice:yt,minPrice:R,maxPrice:P,currentTick:n,chartLoading:Z,zoomOut:E,zoomIn:be,zoom:M,priceTab:U,before7dContractPriceLowest:me,before7dContractPriceHighest:Y,aprRewardsTime:le,lever:Ee,aprRewardsParameter:j,isSelfBuilt:F,priceRangeChangeMin:fe,priceRangeChangeMax:Je,toggle:Vt,getPirceTabTips:st,timeList:tt,farmsPoolInfo:oe,checkNullObj:K,isStableFarmingRange:Be}}});const Ji={class:"new-liquidity-left"},Yi=a("span",{class:"selectRange"},"Select Range",-1),Qi={class:"price-info"},Vi={class:"left"},xi={class:"base-coin"},en={class:"base-coin-title"},tn=a("span",null,"Base coin",-1),nn=a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})],-1),on=a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})],-1),an=[nn,on],rn={class:"base-coin-bottom"},sn={alt:""},ln={class:"current-price"},un=a("div",{class:"current-price-title"},"Current Price",-1),cn={key:0,class:"from-pre-to"},dn={class:"right"},mn={class:"price-range"},vn={class:"left"},fn={class:"price-slider"},gn={class:"slider"},pn=a("div",{class:"slider-ratio-content"},null,-1),bn=[pn],hn={class:"price-tab-list"},kn=["onClick"],yn=["src"],_n={class:"right"},wn={class:"price-zoom"},Cn={class:"current-price"},Pn=a("div",{class:"current-price-title"},"Current Price",-1),In={key:0,class:"from-pre-to"},Sn={class:"price-zoom-right"},Tn={class:"leverage"},Nn=a("div",{class:"left"},null,-1),An={class:"right"},Ln={class:"right-time"},$n={key:0,class:"day-7-price-range"},qn=a("i",null,null,-1),Mn={class:"gray"},Fn={class:"time-list"},On=["onClick"],Rn={class:"right-price-h5"},Bn={class:"range pc-range"},Un={key:0,class:"stable-farming-range pc-stable-farming-range"},jn=a("img",{src:xt},null,-1),zn={class:"check-box-active"},En={key:1,class:"stable-farming-range h5-stable-farming-range"},Hn=a("span",null,[a("img",{src:xt}),Ge(" Farm rewards rangeï¼š ")],-1),Dn={class:"check-box-active"},Xn={key:2,class:"position-tips"},Wn=["src"],Zn={class:"error"};function Gn(e,r,ae,ee,L,re){var q,Z,se,Q,D,n,w,m,G,U,te;const $=Tt,O=ii,I=Gi,J=bi,o=Kt,v=Wt("image");return g(),z("div",Ji,[Yi,a("div",Qi,[a("div",Vi,[a("div",xi,[a("div",en,[tn,a("div",{class:"change-price",onClick:r[0]||(r[0]=(...p)=>e.toggle&&e.toggle(...p))},an)]),a("div",rn,[gt(a("img",sn,null,512),[[v,e.getCoinIcon(e.fromCoin)]]),a("span",null,S((q=e.fromCoin)==null?void 0:q.symbol),1)])]),a("div",ln,[un,a("div",null,[a("span",null,S(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.currentPrice,6)):("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(g(),z("span",cn,S((Z=e.toCoin)==null?void 0:Z.symbol)+" per "+S((se=e.fromCoin)==null?void 0:se.symbol),1)):ne("",!0)])])]),a("div",dn,[e.currentTab=="liquidity"?(g(),z("div",{key:0,class:"zoom-out",onClick:r[1]||(r[1]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):ne("",!0),e.currentTab=="liquidity"?(g(),z("div",{key:1,class:"zoom-in",onClick:r[2]||(r[2]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):ne("",!0)])]),a("div",mn,[a("div",vn,[a("div",fn,[a("div",gn,[a("div",{class:"slider-ratio",style:Ct(e.sliderStyle(e.currentPriceTab))},bn,4)])]),a("div",hn,[(g(!0),z(Pt,null,Bt(e.priceTablList,p=>(g(),z("div",{key:p.key,class:vt(["price-tab-item",e.currentPriceTab==p.key?"price-tab-item-active":""]),onClick:ve=>e.priceTab(p)},[$e($,{placement:"bottom","arrow-point-at-center":""},{title:De(()=>[Ge(S(e.getPirceTabTips(p.key)),1)]),default:De(()=>[a("img",{src:e.getPriceTabImage(p.key),alt:""},null,8,yn),a("span",null,S(e.getPriceTabText(p.key)),1)]),_:2},1024)],10,kn))),128))])]),a("div",_n,[a("div",wn,[a("div",Cn,[Pn,a("div",null,[a("span",null,S(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.currentPrice,6)):("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(g(),z("span",In,S(e.direction&&!e.needReverse?`${(Q=e.fromCoin)==null?void 0:Q.symbol} per ${(D=e.toCoin)==null?void 0:D.symbol}`:`${(n=e.toCoin)==null?void 0:n.symbol} per ${(w=e.fromCoin)==null?void 0:w.symbol}`),1)):ne("",!0)])]),a("div",Sn,[e.currentTab=="liquidity"?(g(),z("div",{key:0,class:"zoom-out",onClick:r[3]||(r[3]=(...p)=>e.zoomOut&&e.zoomOut(...p))}," + ")):ne("",!0),e.currentTab=="liquidity"?(g(),z("div",{key:1,class:"zoom-in",onClick:r[4]||(r[4]=(...p)=>e.zoomIn&&e.zoomIn(...p))}," - ")):ne("",!0)])]),e.poolInfo?(g(),Ue(O,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):ne("",!0)])]),a("div",Tn,[Nn,a("div",An,[a("div",Ln,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(g(),z("div",$n,[qn,a("span",Mn,S(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),a("span",null,S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.before7dContractPriceLowest,6)))+" - "+S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.before7dContractPriceHighest,6))),1)])):ne("",!0),a("div",Fn,[(g(!0),z(Pt,null,Bt(e.timeList,p=>(g(),z("div",{key:p.value,class:vt(["time-item",p.value==e.aprRewardsParameter?"time-item-active":""]),onClick:ve=>e.aprRewardsParameter=p.value},S(p.label),11,On))),128))])]),a("div",Rn,[a("span",null,S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.before7dContractPriceLowest,6)))+" - "+S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(e.before7dContractPriceHighest,6))),1)])])]),a("div",{class:vt(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[$e(I,{lever:e.lever},null,8,["lever"]),a("div",Bn,[e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:H(K))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(g(),z("div",Un,[a("span",null,[jn,Ge(" Farm rewards rangeï¼š"+S(("decimalUi"in e?e.decimalUi:H(ie))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+S(("decimalUi"in e?e.decimalUi:H(ie))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+S((m=e.toCoin)==null?void 0:m.symbol)+" per "+S((G=e.fromCoin)==null?void 0:G.symbol),1)]),a("div",zn,[$e(J,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:r[5]||(r[5]=p=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):ne("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:H(K))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(g(),z("div",En,[Hn,a("div",Dn,[Ge(S(("decimalUi"in e?e.decimalUi:H(ie))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+S(("decimalUi"in e?e.decimalUi:H(ie))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+S((U=e.toCoin)==null?void 0:U.symbol)+" per "+S((te=e.fromCoin)==null?void 0:te.symbol)+" ",1),$e(J,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:r[6]||(r[6]=p=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):ne("",!0),$e(o,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(g(),z("div",Xn,[a("img",{src:("importIcon"in e?e.importIcon:H(at))("/image/icon-tips-error@2x.png"),alt:""},null,8,Wn),a("p",Zn,S(e.$t("tips.positionError")),1)])):ne("",!0)])],2)])}const ni=et(Ki,[["render",Gn]]),Kn=xe({components:{Modal:hi},props:{positionInfo:{type:Object,default:()=>({})},poolInfo:{type:Object,required:!0},farmPoolInfo:{type:Object,default:()=>({})},isAutoStakeFarming:{type:Boolean,default:!0}},setup(e){console.log("ðŸš€ðŸš€ðŸš€ ~ file: viewDetail.vue:218 ~ setup ~ props:",e);const r=rt(),ae=h(()=>r),ee=h(()=>ae.value.chainName),L=h(()=>mi[ee.value]);let re=B(!0);const $=St(),O=h(()=>$),I=Zt(),J=h(()=>e.poolInfo.needResever),o=h(()=>e.farmPoolInfo&&e.isAutoStakeFarming?`/new-position-detail?position_nft_id=${e.positionInfo.id}&positionSource=farming`:`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`),v=Z=>{var se;return(Z==null?void 0:Z.logoURI)||(Z==null?void 0:Z.logo_url)||((se=O.value.tokensObj[Z==null?void 0:Z.address])==null?void 0:se.logo_url)||(ae.value.theme==="default"?at("/image/coins/unknown.png"):at("/image/coins/sui-unknown.png"))},q=h(()=>ae.value.currentExplorer);return{getExplorerUrl:vi,addCommom:Pe,router:I,pools:O,decimalFormat:zt,rateChange:re,config:L,importIcon:at,store:ae,chainName:ee,checkNullObj:K,needReverse:J,getCoinIcon:v,decimalUi:ie,currentExplorer:q,positionDetailUrl:o}}});const Lt=e=>(pt("data-v-9a9a42f6"),e=e(),bt(),e),Jn=Lt(()=>a("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Yn={class:"rejected-container"},Qn=Lt(()=>a("div",{class:"coin-pair"},null,-1)),Vn={class:"coin-pair"},xn={class:"fee"},eo={class:"status"},to={class:"min-and-max"},io={key:0},no={class:"text"},oo={key:0,src:ei,alt:""},ao={key:1,src:ti,alt:""},ro={class:"text"},so={key:1},lo={class:"text"},uo={key:0,src:ei,alt:""},co={key:1,src:ti,alt:""},mo={class:"text"},vo=Lt(()=>a("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),fo=[vo];function go(e,r,ae,ee,L,re){const $=Ai,O=Gt,I=ki("Modal"),J=Wt("image");return g(),Ue(I,{visible:!0,class:"transiaction-rejected",centered:"",title:e.$t("newAdd.openPositionSuccessful"),width:"340px",footer:null,onCancel:r[3]||(r[3]=o=>e.$emit("onClose"))},{closeIcon:De(()=>[Jn]),default:De(()=>{var o,v,q,Z,se,Q,D,n,w,m,G,U,te,p,ve,f,M,E,be,k;return[a("div",Yn,[Qn,a("div",{class:vt(["left",`position-status-${e.positionInfo&&e.positionInfo.currentStatus&&e.positionInfo.currentStatus.toLowerCase()}`])},[a("div",Vn,[a("div",null,[gt(a("img",null,null,512),[[J,e.getCoinIcon(e.needReverse?(v=e.positionInfo)==null?void 0:v.token_b:(o=e.positionInfo)==null?void 0:o.token_a)]]),gt(a("img",null,null,512),[[J,e.getCoinIcon(e.needReverse?(Z=e.positionInfo)==null?void 0:Z.token_a:(q=e.positionInfo)==null?void 0:q.token_b)]])]),a("span",null,S(e.needReverse?(n=(D=e.positionInfo)==null?void 0:D.token_b)==null?void 0:n.symbol:(Q=(se=e.positionInfo)==null?void 0:se.token_a)==null?void 0:Q.symbol)+" - "+S(e.needReverse?(U=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:U.symbol:(m=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:m.symbol),1)]),a("div",xn,S(e.$t("common.fee"))+" "+S(e.poolInfo.fee*100)+"%",1)],2),a("div",eo,[$e($,{"current-status":e.positionInfo.currentStatus||""},null,8,["current-status"])]),a("div",to,[(e.needReverse?!e.rateChange:e.rateChange)?(g(),z("div",io,[a("div",no,S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(String(e.positionInfo&&e.positionInfo.minPrice),6))),1),e.store.theme=="default"?(g(),z("img",oo)):(g(),z("img",ao)),a("div",ro,S(e.positionInfo&&e.positionInfo.maxPrice.indexOf("âˆž")>-1||e.positionInfo&&e.positionInfo.maxPrice.indexOf("+")>-1?"âˆž":("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(String(e.positionInfo&&e.positionInfo.maxPrice),6)))+" "+S((p=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:p.symbol)+" per "+S((f=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:f.symbol),1)])):(g(),z("div",so,[a("div",lo,S(("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(String(1/Number(e.positionInfo&&e.positionInfo.maxPrice)),6))),1),e.store.theme=="default"?(g(),z("img",uo)):(g(),z("img",co)),a("div",mo,S(e.positionInfo&&e.positionInfo.maxPrice.indexOf("âˆž")>-1||e.positionInfo&&e.positionInfo.maxPrice.indexOf("+")>-1?"âˆž":("addCommom"in e?e.addCommom:H(Pe))(("decimalUi"in e?e.decimalUi:H(ie))(String(1/Number(e.positionInfo&&e.positionInfo.minPrice)),6)))+" "+S((E=(M=e.positionInfo)==null?void 0:M.token_a)==null?void 0:E.symbol)+" per "+S((k=(be=e.positionInfo)==null?void 0:be.token_b)==null?void 0:k.symbol),1)])),(g(),z("svg",{class:"icon-change","aria-hidden":"true",onClick:r[0]||(r[0]=j=>e.rateChange=!e.rateChange)},fo))])]),e.chainName=="Sui"?(g(),Ue(O,{key:0,disabled:("checkNullObj"in e?e.checkNullObj:H(K))(e.positionInfo)||e.isAutoStakeFarming&&!e.positionInfo.clmm_pool_id,onClick:r[1]||(r[1]=j=>e.router.push(e.positionDetailUrl))},{default:De(()=>[Ge(S(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"])):(g(),Ue(O,{key:1,disabled:("checkNullObj"in e?e.checkNullObj:H(K))(e.positionInfo),onClick:r[2]||(r[2]=j=>e.router.push(`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`))},{default:De(()=>[Ge(S(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"]))]}),_:1},8,["title"])}const po=et(Kn,[["render",go],["__scopeId","data-v-9a9a42f6"]]),bo=xe({props:{poolInfo:{type:Object,default:()=>({})},isActive:{type:Boolean,default:!0}},setup(e,r){const ae=At(),ee=B(!1),L=B(),re=B(!0),$=rt(),O=h(()=>$),I=h(()=>O.value.newTopPoolsObj);Ne(()=>e.poolInfo,v=>{v&&!K(v)&&ae.getFarmsPoolList()},{immediate:!0});const J=v=>{var se,Q,D,n;const q=v[(se=e==null?void 0:e.poolInfo)==null?void 0:se.poolAddress]||{};let Z=0;q&&!K(q)&&((D=(Q=q==null?void 0:q.stable_farming)==null?void 0:Q.stable_rewarder)==null||D.forEach(w=>{w.amount_second>0&&(Z+=w.amount_second)}),Z>0?(ee.value=!0,L.value={id:q.stable_farming.stable_farming_pool,clmm_pool_id:(n=e==null?void 0:e.poolInfo)==null?void 0:n.poolAddress},r.emit("sendFarmsPoolInfo",re.value&&e.isActive?L.value:"")):ee.value=!1)};return Ne(()=>[I.value,e.poolInfo],([v,q])=>{v&&!K(v)&&q&&!K(q)&&J(v)},{immediate:!0}),Ne(()=>[e.isActive,re.value,L.value],([v,q,Z])=>{r.emit("sendFarmsPoolInfo",q&&e.isActive?Z:"")},{immediate:!0}),{isShowAutoStake:ee,changeIsOpen:()=>{re.value=!re.value,r.emit("sendFarmsPoolInfo",re.value&&e.isActive?L.value:"")},isOpen:re}}}),ho=""+globalThis.__publicAssetsURL("sui-image/farming_huo.png"),ko=""+globalThis.__publicAssetsURL("sui-image/icon_sel@2x.png");const $t=e=>(pt("data-v-9d2d8cb8"),e=e(),bt(),e),yo={key:0,class:"farms-auto-stake"},_o=$t(()=>a("img",{class:"farms-icon",src:ho,alt:""},null,-1)),wo=$t(()=>a("div",{class:"desc"},"Automatically stake your position into the farm to enjoy higher yield.",-1)),Co={key:0,src:ko,alt:""},Po=$t(()=>a("div",{class:"check-box"},null,-1));function Io(e,r,ae,ee,L,re){const $=Tt;return e.isShowAutoStake?(g(),z("div",yo,[_o,wo,e.isActive?(g(),z("div",{key:0,class:"check-box-active",onClick:r[0]||(r[0]=(...O)=>e.changeIsOpen&&e.changeIsOpen(...O))},[e.isOpen?(g(),z("img",Co)):ne("",!0)])):(g(),Ue($,{key:1,"overlay-style":{"min-width":"200px"}},yi({default:De(()=>[Po]),_:2},[e.isActive?void 0:{name:"title",fn:De(()=>[Ge("Farming rewards only available for active positions.")]),key:"0"}]),1024))])):ne("",!0)}const So=et(bo,[["render",Io],["__scopeId","data-v-9d2d8cb8"]]),To=xe({components:{NewLiquidityTitle:Jt,NewLiquidityAssetsCard:Yt,NewLiquidityDepositRatio:Qt},setup(){const{t:e,locale:r}=Dt(),ae=rt(),ee=h(()=>ae),L=h(()=>ee.value.chainName),re=St(),$=h(()=>re),O=fi(),I=h(()=>O),J=Nt(),o=h(()=>{let i=null;for(const l in $.value.poolsObj){const b=$.value.poolsObj[l];b.address==J.query.poolAddress&&(i=b)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",i),i}),v=B(!1),q=B(!1),Z=h(()=>ee.value.theme),se=async(i,l)=>{C.value=i.needReverse?i.token_b:i.token_a,y.value=i.needReverse?i.token_a:i.token_b,T.value="",N.value=""},Q=h(()=>I.value.assets&&C.value&&I.value.assets[C.value.address]?Rt(I.value.assets[C.value.address].balance,C.value.decimals):"0"),D=h(()=>I.value.assets&&y.value&&I.value.assets[y.value.address]?Rt(I.value.assets[y.value.address].balance,y.value.decimals):"0"),n=i=>{i==="fromCoin"?(Te.value=!0,L.value==="Aptos"?T.value=Number(Q.value)>0?C.value.symbol=="APT"?new s(Number(Q.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(Q.value)).sub(new s(.1)).toString():String(Q.value):"":T.value=Number(Q.value)>0?C.value.symbol=="SUI"?new s(Number(Q.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(Q.value)).sub(new s(.05)).toString():String(Q.value):""):(Te.value=!1,L.value==="Aptos"?N.value=Number(D.value)>0?y.value.symbol=="APT"?new s(Number(D.value)).sub(new s(.1)).lt(new s(0))?"0":new s(Number(D.value)).sub(new s(.1)).toString():String(D.value):"":N.value=Number(D.value)>0?y.value.symbol=="SUI"?new s(Number(D.value)).sub(new s(.05)).lt(new s(0))?"0":new s(Number(D.value)).sub(new s(.05)).toString():String(D.value):"")},w=i=>{i==="fromCoin"?(Te.value=!0,T.value=Number(Q.value)>0?wt(new s(Number(Q.value)).div(2).toString(),C.value.decimals).toString():""):(Te.value=!1,N.value=Number(D.value)>0?wt(new s(Number(D.value)).div(2).toString(),y.value.decimals).toString():"")},m=B(),G=B(),U=B(),te=B(!1),p=i=>{var l,b,ge,V;m.value=i,i==="fromCoin"?(G.value=((l=y.value)==null?void 0:l.address)||"",U.value=J.query.actions=="new-position"?(b=C.value)==null?void 0:b.address:o.value.needReverse?o.value.token_b.address:o.value.token_a.address):(G.value=((ge=C.value)==null?void 0:ge.address)||"",U.value=J.query.actions=="new-position"?(V=y.value)==null?void 0:V.address:o.value.needReverse?o.value.token_a.address:o.value.token_b.address),te.value=!0},ve=i=>{var ge,V,ke,ye,pe,_e,we,Se;const l=o.value.needReverse?o.value.token_b:o.value.token_a,b=o.value.needReverse?o.value.token_a:o.value.token_b;m.value==="fromCoin"?(((ge=C.value)==null?void 0:ge.address)===(l==null?void 0:l.address)||!((V=C.value)!=null&&V.address)?(y.value&&i.address.toLowerCase()===((ke=y)==null?void 0:ke.value.address.toLowerCase())&&(y.value=null),C.value=i):(C.value&&i.address.toLowerCase()===((ye=C)==null?void 0:ye.value.address.toLowerCase())&&(C.value=null),y.value=i),J.query.action||(J.query.fee="")):((pe=y.value)==null?void 0:pe.address)===(b==null?void 0:b.address)||!((_e=y.value)!=null&&_e.address)?(C.value&&i.address.toLowerCase()===((we=C)==null?void 0:we.value.address.toLowerCase())&&(C.value=null),y.value=i):(y.value&&i.address.toLowerCase()===((Se=y)==null?void 0:Se.value.address.toLowerCase())&&(y.value=null),C.value=i),te.value=!1},f=h(()=>ee.value.chainName?It(ee.value.chainName):{}),M=h(()=>ee.value.slippage),E=B(),be=async()=>{var je,Fe,Oe,We;if(He.value||!R.value&&!P.value)return!1;if(!T.value&&!N.value&&!R.value&&!P.value)return;const i=o.value||{};if(K(i))return;const{TickUtil:l,TickMath:b,getNearestTickByTick:ge}=f.value,V=i==null?void 0:i.token_a.decimals,ke=i==null?void 0:i.token_b.decimals;let ye,pe,_e,we,Se,Me,Xe,Ke,Ce=i==null?void 0:i.current_tick_index,ue;if(i.token_a.address.toLowerCase()===C.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===y.value.address.toLowerCase()?ue=!0:ue=!1,R.value==="0"&&P.value==="âˆž")_e=l.getMinIndex(Number(i.tickSpacing)),we=l.getMaxIndex(Number(i.tickSpacing)),Se=b.tickIndexToSqrtPriceX64(_e),Me=b.tickIndexToSqrtPriceX64(we);else if(x.value=="custom"){ue?(ye=R.value,pe=P.value):(ye=P.value!=="âˆž"?new s(1).div(P.value).toString():1/0,pe=new s(1).div(R.value).toString());try{Xe=new s(ye).equals(new s(0))?-443636:b.priceToTickIndex(new s(ye),V,ke)}catch{Xe=-443636}try{Ke=b.priceToTickIndex(new s(pe),V,ke)}catch{Ke=443636}_e=ge(Xe,Number(i.tickSpacing),!0),we=ge(Ke,Number(i.tickSpacing),!0);try{Se=b.priceToSqrtPriceX64(new s(ye),V,ke)}catch{(pe===1/0||pe==="âˆž")&&(Se=b.tickIndexToSqrtPriceX64(l.getMinIndex(Number(i.tickSpacing))))}try{Me=b.priceToSqrtPriceX64(new s(pe),V,ke)}catch{(pe===1/0||pe==="âˆž")&&(Me=b.tickIndexToSqrtPriceX64(l.getMaxIndex(Number(i.tickSpacing))))}}else _e=(je=Ve.value[x.value])==null?void 0:je.lower,we=(Fe=Ve.value[x.value])==null?void 0:Fe.upper,Se=b.tickIndexToSqrtPriceX64(_e),Me=b.tickIndexToSqrtPriceX64(we);if(P.value!=="âˆž"&&_e>=we){v.value=!0,T.value="",q.value=!0,N.value="";return}if(P.value==="âˆž"||Ce>=_e&&Ce<we){v.value=!1,q.value=!1;let de;if(T.value||N.value){if(Te.value){const ht=new s(T.value).mul(Math.pow(10,C.value.decimals)).toString();de=new ze(ht)}else{const ht=new s(N.value).mul(Math.pow(10,y.value.decimals)).toString();de=new ze(ht)}b.tickIndexToSqrtPriceX64(o.value.current_tick_index);const{liquidityAmount:Re,tokenMaxA:Ze,tokenMaxB:dt,tokenMaxAOrigin:ui,tokenMaxBOrigin:ci}=f.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.token_a,tokenB:i.token_b,lowerTick:_e,upperTick:we,coinAmount:de,iscoinA:ue?Te.value:!Te.value,roundUp:!0,slippage:Number(M.value)/100,curSqrtPrice:new ze(o.value.current_sqrt_price)});E.value={liquidityAmount:Re,tokenMaxA:Ze,tokenMaxB:dt,tokenMaxAOrigin:ui,tokenMaxBOrigin:ci},ue?Te.value?N.value=Number(dt)>0?dt:"":T.value=Number(Ze)>0?Ze:"":Te.value?N.value=Ze:T.value=dt}}else if(Ce>=we){if(ue?T.value="":N.value="",v.value=ue,q.value=!ue,T.value||N.value){let de;if(ue){const Re=new s(N.value).mul(Math.pow(10,(Oe=y.value)==null?void 0:Oe.decimals)).toString();de=new ze(Re),E.value={liquidityAmount:f.value.estimateLiquidityForCoinB(Se,Me,de),tokenMaxA:0,tokenMaxB:N.value}}else{const Re=new s(T.value).mul(Math.pow(10,(We=C.value)==null?void 0:We.decimals)).toString();de=new ze(Re),E.value={liquidityAmount:f.value.estimateLiquidityForCoinB(Se,Me,de),tokenMaxA:0,tokenMaxB:T.value}}}}else if(Ce<_e){if(v.value=!ue,q.value=ue,ue?N.value="":T.value="",T.value||N.value){let de;if(ue){const Re=new s(T.value).mul(Math.pow(10,C.value.decimals)).toString();de=new ze(Re),E.value={liquidityAmount:f.value.estimateLiquidityForCoinA(Se,Me,de),tokenMaxA:T.value,tokenMaxB:0}}else{const Re=new s(N.value).mul(Math.pow(10,y.value.decimals)).toString();de=new ze(Re),E.value={liquidityAmount:f.value.estimateLiquidityForCoinA(Se,Me,de),tokenMaxA:N.value,tokenMaxB:0}}}}else v.value=!0,T.value="",q.value=!0,N.value=""};Ne(()=>o.value,(i,l)=>{(!l&&i&&!K(i)||l&&i&&l.address!==i.address)&&se(i,!l||i.address!==l.address),i&&!K(i)&&be()},{immediate:!0}),Ne(T,(i,l)=>{i==""&&Te.value&&(N.value=""),i&&Te.value&&!He.value&&be()}),Ne(N,(i,l)=>{i==""&&!Te.value&&(T.value=""),i&&!Te.value&&!He.value&&be()}),Ne(()=>he.value,(i,l)=>{be()}),Ne(()=>[C.value,y.value],([i,l])=>{i&&l&&(v.value=!1,q.value=!1)});const k=B("--"),j=h(()=>$.value.RATES),le=()=>{const i=j.value&&j.value[C.value.address]&&j.value[C.value.address].price,l=j.value&&j.value[y.value.address]&&j.value[y.value.address].price;if(i&&l){const b=new s(T.value>0?T.value:0).mul(i),ge=new s(N.value>0?N.value:0).mul(l),V=b.add(ge).toNumber();k.value=V>0&&V<.01?"<$0.01":"$"+Pe(V,2)}else k.value="--"};Ne(()=>[T.value,N.value,He.value],([i,l,b])=>{(i||l)&&!b?le():(!i||!l)&&!b&&(k.value="--")},{immediate:!0});const me=B(),Y=async()=>{var ue,je;if(!R.value&&!P.value)return!1;if(!T.value&&!N.value&&!R.value&&!P.value)return;const i=o.value;if(K(i))return;const{TickUtil:l,TickMath:b,getNearestTickByTick:ge}=f.value,V=i==null?void 0:i.token_a.decimals,ke=i==null?void 0:i.token_b.decimals;let ye,pe,_e,we,Se,Me,Xe;if(i.token_a.address.toLowerCase()===C.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===y.value.address.toLowerCase()?Xe=!0:Xe=!1,R.value==="0"&&P.value==="âˆž")_e=l.getMinIndex(Number(i.tickSpacing)),we=l.getMaxIndex(Number(i.tickSpacing));else if(x.value=="custom"){Xe?(ye=Number(R.value),pe=Number(P.value)):(ye=new s(1).div(P.value).toString(),pe=new s(1).div(R.value).toString());try{Se=ye==0?-443636:b.priceToTickIndex(new s(ye),V,ke)}catch{Se=-443636}try{Me=b.priceToTickIndex(new s(pe),V,ke)}catch{Me=443636}_e=ge(Se,Number(i.tickSpacing),!0),we=ge(Me,Number(i.tickSpacing),!0)}else _e=(ue=Ve.value[x.value])==null?void 0:ue.lower,we=(je=Ve.value[x.value])==null?void 0:je.upper;const Ke=j.value[i==null?void 0:i.token_a.address].price,Ce=j.value[i==null?void 0:i.token_b.address].price;he.value?new ze(i.current_sqrt_price):new ze(1/i.current_sqrt_price);try{const{amountA:Fe,amountB:Oe,tokenAmountsInfo:We}=await f.value.estCoinAmountsFromTotalAmount({lowerTick:_e,upperTick:we,decimalsA:V,decimalsB:ke,curSqrtPrice:new ze(i.current_sqrt_price),totalAmount:k.value.replace(/[^\d.]/g,""),tokenPriceA:Ke,tokenPriceB:Ce});me.value=We,i.needReverse?he.value?(T.value=Fe,N.value=Oe):(T.value=Oe,N.value=Fe):(T.value=Fe,N.value=Oe)}catch(Fe){console.log(Fe,"e===>")}};Ne([R,P],([i,l])=>{He.value?He.value&&Y():be(),l!=="âˆž"&&Number(i)!==0&&Number(l)!==0&&Number(i)>=Number(l)?ot.value=!0:ot.value=!1,Number(i)==0&&Number(l)==0&&ct.value&&(ot.value=!0)},{deep:!0,immediate:!0});const Ee=i=>{const l=i.replace(/[^\d.]/g,""),b="$"+Pe(l);He.value=!0,k.value=b,l>0?Y():(T.value="",N.value="")},F=B(!1),{setTransactionTxid:fe,setTransactionDesc:Je,setIsShowWaiting:qe,setIsShowSuccess:st,setPositiomNum:tt,setIsShowRejected:Ye}=ae,Qe=Fi(),oe=h(()=>$.value.currentPositionInfo),lt=B(!1),t=B(!0),d=At(),_=h(()=>d),A=h(()=>_.value.farmsPoolObj);Ne(()=>[A.value,o.value],([i,l])=>{i&&!K(i)&&l&&!K(l)&&(i[l.address]||(t.value=!1))},{immediate:!0});const X=B(),W=B(),Ae=i=>{X.value=i,i?t.value=!0:t.value=!1},it=async(i,l,b,ge)=>{try{l=="farming"?await $.value.setCurrentPositionInfo("","","","Sui",b,"farming"):await $.value.setCurrentPositionInfo(i,"","",L.value,ge),await gi(3e3),t.value?await Qe.subscribePosition({pool_address:oe.value.clmm_pool_id,position_index:oe.value.name.split("-")[1]},oe.value.clmm_position_id):await Qe.subscribePosition({pool_address:oe.value.poolAddress,position_index:oe.value.index},oe.value.nftHash)}catch(V){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",V)}},u=async i=>{var Se,Me,Xe,Ke;F.value=!1,$.value.currentPositionInfo={},fe(""),Je(e("tips.increaseLiquiditySuccess",{from:v.value?"":`${Pe(T.value)} ${(Se=C.value)==null?void 0:Se.symbol}`,and:!v.value&&!q.value?"and":"",to:q.value?"":`${Pe(N.value)} ${(Me=y.value)==null?void 0:Me.symbol}`})),qe(!0);const l=he.value?Te.value:!Te.value;let b,ge,V,ke,ye,pe;const _e=o.value.token_a.decimals,we=o.value.token_b.decimals;if(R.value==="0"&&P.value==="âˆž")V=f.value.TickUtil.getMinIndex(Number(o.value.tickSpacing)),ke=f.value.TickUtil.getMaxIndex(Number(o.value.tickSpacing));else if(x.value=="custom"){he.value?(b=R.value,ge=P.value):(b=new s(1).div(P.value).toString(),ge=new s(1).div(R.value).toString());try{ye=b==0?f.value.TickUtil.getMinIndex(Number(o.value.tickSpacing)):f.value.TickMath.priceToTickIndex(new s(b),_e,we)}catch{ye=f.value.TickUtil.getMinIndex(Number(o.value.tickSpacing))}try{pe=f.value.TickMath.priceToTickIndex(new s(ge),_e,we)}catch{pe=f.value.TickUtil.getMaxIndex(Number(o.value.tickSpacing))}V=f.value.getNearestTickByTick(ye,Number(o.value.tickSpacing),!0),ke=f.value.getNearestTickByTick(pe,Number(o.value.tickSpacing),!0)}else V=Ve.value[x.value].lower,ke=Ve.value[x.value].upper;try{let Ce;He.value?Ce=await f.value.getCreateAddLiquidityPayload({pool:o.value,curSqrtPrice:new ze(o.value.current_sqrt_price),tickLower:V,tickUpper:ke,slippage:Number(M.value)/100,tokenAmounts:me.value}):Ce=await f.value.getAddLiquidityTransactionPayload({pool:{poolAddress:o.value.poolAddress,token_a:o.value.token_a,token_b:o.value.token_b},amount:Te.value?T.value:N.value,fix_amount_a:l,tick_lower:V,tick_upper:ke,index:0,slippage:Number(M.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new ze(o.value.current_sqrt_price),farmPoolInfo:X.value});let ue;if(L.value==="Aptos")ue=await I.value.currentWallet.signAndSubmitTransaction(Ce);else{const je=await f.value.signAndExecuteTransactionBlock(I.value.currentWallet,Ce==null?void 0:Ce.txb,Ce==null?void 0:Ce.payloadParams);ue=f.value.handleTx(je)}if(console.log("0410###tx###",ue),ue&&ue.hash){fe(ue.hash),qe(!1),st(!0);let je;o.value.needReverse?o.value.token_a.address.toLowerCase()===C.value.address.toLowerCase()&&o.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?je=!1:je=!0:o.value.token_a.address.toLowerCase()===C.value.address.toLowerCase()&&o.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?je=!0:je=!1;const Fe={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:v.value?"":`${Pe(T.value)} ${(Xe=C.value)==null?void 0:Xe.symbol}`,and:!v.value&&!q.value?"and":"",to:q.value?"":`${Pe(N.value)} ${(Ke=y.value)==null?void 0:Ke.symbol}`}),hash:ue.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};L.value!=="Aptos"&&(Fe.res=ue.res),f.value.showTransitionPending(Fe),console.log(Fe,"toAdd params###");const Oe=await f.value.watchTransaction(Fe,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",Oe),Oe.status){st(!1),$.value.setCurrentPositionLoading(!0);let We,de;L.value==="Aptos"?W.value={token_a:o.value.token_a,token_b:o.value.token_b,minPrice:R.value,maxPrice:P.value,pool:o.value.address,collection:Oe.nftInfo[0].data.id.collection,tokenName:Oe.nftInfo[0].data.name}:(de=Oe.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",de),t.value?(Oe.res.events.forEach(Ze=>{Ze.type.indexOf("::pool::DepositEvent")>-1&&(We=Ze.parsedJson.wrapped_position_id)}),W.value={token_a:o.value.needReverse?o.value.token_b:o.value.token_a,token_b:o.value.needReverse?o.value.token_a:o.value.token_b,minPrice:R.value,maxPrice:P.value,id:We,clmm_pool_id:o.value.address,pool:o.value.address}):W.value={token_a:o.value.needReverse?o.value.token_b:o.value.token_a,token_b:o.value.needReverse?o.value.token_a:o.value.token_b,minPrice:R.value,maxPrice:P.value,pos_object_id:de.position,pool:o.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",W.value)),lt.value=!0;const Re=o.value.poolAddress;setTimeout(()=>{if(i){const Ze=We?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",Re),it(Re,Ze,We,de==null?void 0:de.position)}},3e3),setTimeout(()=>{re.updateCurrentPools(Re,L.value),f.value.getAccount(I.value.address)},3e3),setTimeout(async()=>{Ut(f,o)},7e3)}tt()}else qe(!1),Ye(!0);T.value="",N.value=""}catch(Ce){T.value="",N.value="",console.log("0330###Add liquidity Error###",Ce),qe(!1),Ye(!0)}},c=h(()=>!!(!T.value&&!N.value||Number(T.value)>Number(Q.value)||Number(N.value)>Number(D.value)||ce.value!==e("button.addLiquidity")&&ce.value!==e("newAdd.preview")||o.value&&o.value&&o.value.is_pause||Number(T.value)<=0&&Number(N.value)<=0||!v.value&&Number(T.value)==0||!q.value&&Number(N.value)==0)),Le=h(()=>!C.value||!y.value),ce=h(()=>o.value&&o.value.is_pause?"Pool Closed":!C.value||!y.value||Le.value?e("modal.selectTokenModalTitle"):Number(T.value)>Number(Q.value)?e("button.insufficientBalance",{name:C.value.symbol}):Number(N.value)>Number(D.value)?e("button.insufficientBalance",{name:y.value.symbol}):!Number(T.value)&&!Number(N.value)?e("button.enterAmount"):P.value!=="âˆž"&&Number(R.value)>=Number(P.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Ie=B({}),qt=B({}),Mt=B(!1),Ft=(i,l)=>{const b=localStorage.getItem(i.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1523 ~ getTokenSource ~ pools.value.tokensObj:",$.value.tokensObj&&$.value.tokensObj[i.address]&&$.value.tokensObj[i.address].isSelfBuilt&&!b),$.value.tokensObj&&$.value.tokensObj[i.address]&&$.value.tokensObj[i.address].isSelfBuilt&&!b&&(l=="fromCoin"&&(Ie.value=i),l=="toCoin"&&(qt.value=i),Mt.value=!0)};Ne(()=>[C.value,y.value],([i,l])=>{i&&!K(i)&&Ft(i,"fromCoin"),l&&!K(l)&&Ft(l,"toCoin")},{immediate:!0});const Ot=Zt(),ai=()=>{L.value!=="Aptos"?Ot.push("/pool/list"):Ot.push("/pools")},ri=i=>{He.value,u(i)},si=()=>{J.query.action!=="create-pool"&&J.query.actions!=="new-position"&&(Ut(f,o),be(),re.updateCurrentPools(o.value.poolAddress,L.value)),re.setPoolConfigList(L.value,ee.value.filterCoinsObj)},li=h(()=>{var b,ge,V,ke,ye,pe;const i=(V=j.value[(ge=(b=C)==null?void 0:b.value)==null?void 0:ge.address])==null?void 0:V.price,l=(pe=j.value[(ye=(ke=y)==null?void 0:ke.value)==null?void 0:ye.address])==null?void 0:pe.price;return!!(i&&l)});return Ne(()=>[J,$.value.tokensObj],([i,l])=>{var b;l&&!K(l)&&(y.value||(y.value=$.value.tokensObj[(b=i==null?void 0:i.query)==null?void 0:b.toCoin]))},{immediate:!0,deep:!0}),{positionError:ot,decimalUi:ie,poolInfo:o,fromCoinAmount:T,toCoinAmount:N,fromCoin:C,toCoin:y,theme:Z,showFromCoinLock:v,showToCoinLock:q,fromCoinBlance:Q,toCoinBlance:D,maxBtnSelect:n,halfBtnSelect:w,fixedFromCoin:Te,openCoinSelect:p,currentCoinKey:m,existingCoins:G,lastSelectCoin:U,showCoinSelect:te,onCoinSelect:ve,liquidityTotalAmount:k,toggle:Vt,onInput:Ee,isInputTotalAmount:He,isViewDetail:lt,addLiquidityBtnDisabled:c,addLiquidityBtnText:ce,isShowTokenWarning:Mt,chainName:L,closeTokenWarning:ai,warningFromCoin:Ie,warningToCoin:qt,isShowLiquidityModal:F,currentPrice:ct,currentPriceReverse:ft,currentPriceTab:x,minPrice:R,maxPrice:P,toAdd:u,direction:he,wallet:I,getAddLiquidityType:ri,clickRefresh:si,isShowtotalAmount:li,isAutoStakeFarming:t,farmPoolInfo:X,getFarmsPoolInfo:Ae,positionInfoDetail:W}}});const No={class:"new-liquidity-right"},Ao={class:"deposit-title"},Lo={class:"card-container"},$o={key:0,class:"lock"},qo={class:"card-item"},Mo={class:"card-item"},Fo={key:0,class:"total-amount"},Oo=a("span",null,"Total Amount",-1);function Ro(e,r,ae,ee,L,re){const $=Jt,O=Ii,I=Yt,J=Ti,o=Qt,v=Gt,q=Ni,Z=po,se=Li,Q=Mi,D=So;return g(),z("div",No,[a("div",Ao,[$e($,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),a("div",Lo,[e.positionError?(g(),z("div",$o,[$e(O)])):ne("",!0),a("div",qo,[$e(I,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":r[0]||(r[0]=n=>e.fromCoinAmount=n),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:r[1]||(r[1]=n=>e.maxBtnSelect("fromCoin")),onOnHalf:r[2]||(r[2]=n=>e.halfBtnSelect("fromCoin")),onOnInput:r[3]||(r[3]=n=>{e.fromCoinAmount=n,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.positionError?(g(),Ue(J,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ne("",!0)]),a("div",Mo,[$e(I,{modelValue:e.toCoinAmount,"onUpdate:modelValue":r[4]||(r[4]=n=>e.toCoinAmount=n),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:r[5]||(r[5]=n=>e.maxBtnSelect("toCoin")),onOnHalf:r[6]||(r[6]=n=>e.halfBtnSelect("toCoin")),onOnInput:r[7]||(r[7]=n=>{e.toCoinAmount=n,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.positionError?(g(),Ue(J,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):ne("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(g(),z("img",{key:1,class:"add",src:$i,alt:"",onClick:r[8]||(r[8]=(...n)=>e.toggle&&e.toggle(...n))})):ne("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(g(),z("img",{key:2,class:"add",src:qi,alt:"",onClick:r[9]||(r[9]=(...n)=>e.toggle&&e.toggle(...n))})):ne("",!0)]),e.isShowtotalAmount?(g(),z("div",Fo,[Oo,a("span",null,S(e.liquidityTotalAmount)+" ",1)])):ne("",!0),$e(o,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),$e(v,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:r[10]||(r[10]=n=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:De(()=>[Ge(S(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(g(),Ue(q,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:r[11]||(r[11]=n=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):ne("",!0),e.isViewDetail?(g(),Ue(Z,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:r[12]||(r[12]=n=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):ne("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(g(),Ue(se,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,"is-import-modal":!0,onClose:e.closeTokenWarning,onClickContinue:r[13]||(r[13]=n=>e.isShowTokenWarning=!1)},null,8,["from-coin","to-coin","onClose"])):ne("",!0),e.isShowLiquidityModal?(g(),Ue(Q,{key:4,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:r[14]||(r[14]=n=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):ne("",!0),e.chainName=="Sui"?(g(),Ue(D,{key:5,"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])):ne("",!0)])}const oi=et(To,[["render",Ro]]),Bo=xe({components:{NewLiquidityLeft:ni,NewLiquidityRight:oi},setup(){Xt(()=>{Si()});const e=Nt(),r=rt();return h(()=>r),{tickList:nt,route:e}}});const Uo={key:0,class:"loading-spin-liquidity loading-global"},jo={class:"privide-liquidity"};function zo(e,r,ae,ee,L,re){var J,o;const $=Ht,O=ni,I=oi;return g(),z(Pt,null,[!e.tickList&&((o=(J=e.route)==null?void 0:J.query)!=null&&o.poolAddress)?(g(),z("div",Uo,[$e($)])):ne("",!0),a("div",jo,[$e(O),$e(I)])],64)}const ka=et(Bo,[["render",zo],["__scopeId","data-v-1b76f12f"]]);export{ka as default};
