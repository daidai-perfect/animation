var yw=Object.defineProperty;var ww=(e,t,n)=>t in e?yw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ze=(e,t,n)=>(ww(e,typeof t!="symbol"?t+"":t,n),n);import{ae as Fd,ad as bw,l as Ls,a4 as Gs,C as St,a7 as hi,a6 as ep,R as tp}from"./entry.ad32dc49.js";import{w as vw,r as np,x as cd,h as De,y as xw,b as jd,u as ip,j as yn,e as No,z as vn,A as ni,T as ye,B as Tw,S as Aw,I as kw,C as ta,D as Sw,E as Pw,g as Fo,c as Ew,d as So}from"./sha256.de7acfa8.js";import{D as ie}from"./decimal.0bdeb344.js";var is={},Cw={get exports(){return is},set exports(e){is=e}};(function(e){(function(t){var n=function(w){var S,C=new Float64Array(16);if(w)for(S=0;S<w.length;S++)C[S]=w[S];return C},i=function(){throw new Error("no PRNG")},s=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var r=n(),a=n([1]),c=n([56129,1]),u=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(w,S,C,p){w[S]=C>>24&255,w[S+1]=C>>16&255,w[S+2]=C>>8&255,w[S+3]=C&255,w[S+4]=p>>24&255,w[S+5]=p>>16&255,w[S+6]=p>>8&255,w[S+7]=p&255}function v(w,S,C,p,I){var Z,Y=0;for(Z=0;Z<I;Z++)Y|=w[S+Z]^C[p+Z];return(1&Y-1>>>8)-1}function k(w,S,C,p){return v(w,S,C,p,16)}function E(w,S,C,p){return v(w,S,C,p,32)}function N(w,S,C,p){for(var I=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Z=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,Y=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,le=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,Pe=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,Ue=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,Ee=S[0]&255|(S[1]&255)<<8|(S[2]&255)<<16|(S[3]&255)<<24,Jt=S[4]&255|(S[5]&255)<<8|(S[6]&255)<<16|(S[7]&255)<<24,He=S[8]&255|(S[9]&255)<<8|(S[10]&255)<<16|(S[11]&255)<<24,ht=S[12]&255|(S[13]&255)<<8|(S[14]&255)<<16|(S[15]&255)<<24,pt=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,kt=C[16]&255|(C[17]&255)<<8|(C[18]&255)<<16|(C[19]&255)<<24,xt=C[20]&255|(C[21]&255)<<8|(C[22]&255)<<16|(C[23]&255)<<24,gt=C[24]&255|(C[25]&255)<<8|(C[26]&255)<<16|(C[27]&255)<<24,bt=C[28]&255|(C[29]&255)<<8|(C[30]&255)<<16|(C[31]&255)<<24,_t=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ge=I,Ze=Z,je=Y,Ve=le,Xe=Pe,Fe=Ue,re=Ee,ae=Jt,be=He,ge=ht,me=pt,Se=kt,dt=xt,Dt=gt,Ft=bt,Mt=_t,H,Gt=0;Gt<20;Gt+=2)H=Ge+dt|0,Xe^=H<<7|H>>>32-7,H=Xe+Ge|0,be^=H<<9|H>>>32-9,H=be+Xe|0,dt^=H<<13|H>>>32-13,H=dt+be|0,Ge^=H<<18|H>>>32-18,H=Fe+Ze|0,ge^=H<<7|H>>>32-7,H=ge+Fe|0,Dt^=H<<9|H>>>32-9,H=Dt+ge|0,Ze^=H<<13|H>>>32-13,H=Ze+Dt|0,Fe^=H<<18|H>>>32-18,H=me+re|0,Ft^=H<<7|H>>>32-7,H=Ft+me|0,je^=H<<9|H>>>32-9,H=je+Ft|0,re^=H<<13|H>>>32-13,H=re+je|0,me^=H<<18|H>>>32-18,H=Mt+Se|0,Ve^=H<<7|H>>>32-7,H=Ve+Mt|0,ae^=H<<9|H>>>32-9,H=ae+Ve|0,Se^=H<<13|H>>>32-13,H=Se+ae|0,Mt^=H<<18|H>>>32-18,H=Ge+Ve|0,Ze^=H<<7|H>>>32-7,H=Ze+Ge|0,je^=H<<9|H>>>32-9,H=je+Ze|0,Ve^=H<<13|H>>>32-13,H=Ve+je|0,Ge^=H<<18|H>>>32-18,H=Fe+Xe|0,re^=H<<7|H>>>32-7,H=re+Fe|0,ae^=H<<9|H>>>32-9,H=ae+re|0,Xe^=H<<13|H>>>32-13,H=Xe+ae|0,Fe^=H<<18|H>>>32-18,H=me+ge|0,Se^=H<<7|H>>>32-7,H=Se+me|0,be^=H<<9|H>>>32-9,H=be+Se|0,ge^=H<<13|H>>>32-13,H=ge+be|0,me^=H<<18|H>>>32-18,H=Mt+Ft|0,dt^=H<<7|H>>>32-7,H=dt+Mt|0,Dt^=H<<9|H>>>32-9,H=Dt+dt|0,Ft^=H<<13|H>>>32-13,H=Ft+Dt|0,Mt^=H<<18|H>>>32-18;Ge=Ge+I|0,Ze=Ze+Z|0,je=je+Y|0,Ve=Ve+le|0,Xe=Xe+Pe|0,Fe=Fe+Ue|0,re=re+Ee|0,ae=ae+Jt|0,be=be+He|0,ge=ge+ht|0,me=me+pt|0,Se=Se+kt|0,dt=dt+xt|0,Dt=Dt+gt|0,Ft=Ft+bt|0,Mt=Mt+_t|0,w[0]=Ge>>>0&255,w[1]=Ge>>>8&255,w[2]=Ge>>>16&255,w[3]=Ge>>>24&255,w[4]=Ze>>>0&255,w[5]=Ze>>>8&255,w[6]=Ze>>>16&255,w[7]=Ze>>>24&255,w[8]=je>>>0&255,w[9]=je>>>8&255,w[10]=je>>>16&255,w[11]=je>>>24&255,w[12]=Ve>>>0&255,w[13]=Ve>>>8&255,w[14]=Ve>>>16&255,w[15]=Ve>>>24&255,w[16]=Xe>>>0&255,w[17]=Xe>>>8&255,w[18]=Xe>>>16&255,w[19]=Xe>>>24&255,w[20]=Fe>>>0&255,w[21]=Fe>>>8&255,w[22]=Fe>>>16&255,w[23]=Fe>>>24&255,w[24]=re>>>0&255,w[25]=re>>>8&255,w[26]=re>>>16&255,w[27]=re>>>24&255,w[28]=ae>>>0&255,w[29]=ae>>>8&255,w[30]=ae>>>16&255,w[31]=ae>>>24&255,w[32]=be>>>0&255,w[33]=be>>>8&255,w[34]=be>>>16&255,w[35]=be>>>24&255,w[36]=ge>>>0&255,w[37]=ge>>>8&255,w[38]=ge>>>16&255,w[39]=ge>>>24&255,w[40]=me>>>0&255,w[41]=me>>>8&255,w[42]=me>>>16&255,w[43]=me>>>24&255,w[44]=Se>>>0&255,w[45]=Se>>>8&255,w[46]=Se>>>16&255,w[47]=Se>>>24&255,w[48]=dt>>>0&255,w[49]=dt>>>8&255,w[50]=dt>>>16&255,w[51]=dt>>>24&255,w[52]=Dt>>>0&255,w[53]=Dt>>>8&255,w[54]=Dt>>>16&255,w[55]=Dt>>>24&255,w[56]=Ft>>>0&255,w[57]=Ft>>>8&255,w[58]=Ft>>>16&255,w[59]=Ft>>>24&255,w[60]=Mt>>>0&255,w[61]=Mt>>>8&255,w[62]=Mt>>>16&255,w[63]=Mt>>>24&255}function A(w,S,C,p){for(var I=p[0]&255|(p[1]&255)<<8|(p[2]&255)<<16|(p[3]&255)<<24,Z=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,Y=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,le=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,Pe=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,Ue=p[4]&255|(p[5]&255)<<8|(p[6]&255)<<16|(p[7]&255)<<24,Ee=S[0]&255|(S[1]&255)<<8|(S[2]&255)<<16|(S[3]&255)<<24,Jt=S[4]&255|(S[5]&255)<<8|(S[6]&255)<<16|(S[7]&255)<<24,He=S[8]&255|(S[9]&255)<<8|(S[10]&255)<<16|(S[11]&255)<<24,ht=S[12]&255|(S[13]&255)<<8|(S[14]&255)<<16|(S[15]&255)<<24,pt=p[8]&255|(p[9]&255)<<8|(p[10]&255)<<16|(p[11]&255)<<24,kt=C[16]&255|(C[17]&255)<<8|(C[18]&255)<<16|(C[19]&255)<<24,xt=C[20]&255|(C[21]&255)<<8|(C[22]&255)<<16|(C[23]&255)<<24,gt=C[24]&255|(C[25]&255)<<8|(C[26]&255)<<16|(C[27]&255)<<24,bt=C[28]&255|(C[29]&255)<<8|(C[30]&255)<<16|(C[31]&255)<<24,_t=p[12]&255|(p[13]&255)<<8|(p[14]&255)<<16|(p[15]&255)<<24,Ge=I,Ze=Z,je=Y,Ve=le,Xe=Pe,Fe=Ue,re=Ee,ae=Jt,be=He,ge=ht,me=pt,Se=kt,dt=xt,Dt=gt,Ft=bt,Mt=_t,H,Gt=0;Gt<20;Gt+=2)H=Ge+dt|0,Xe^=H<<7|H>>>32-7,H=Xe+Ge|0,be^=H<<9|H>>>32-9,H=be+Xe|0,dt^=H<<13|H>>>32-13,H=dt+be|0,Ge^=H<<18|H>>>32-18,H=Fe+Ze|0,ge^=H<<7|H>>>32-7,H=ge+Fe|0,Dt^=H<<9|H>>>32-9,H=Dt+ge|0,Ze^=H<<13|H>>>32-13,H=Ze+Dt|0,Fe^=H<<18|H>>>32-18,H=me+re|0,Ft^=H<<7|H>>>32-7,H=Ft+me|0,je^=H<<9|H>>>32-9,H=je+Ft|0,re^=H<<13|H>>>32-13,H=re+je|0,me^=H<<18|H>>>32-18,H=Mt+Se|0,Ve^=H<<7|H>>>32-7,H=Ve+Mt|0,ae^=H<<9|H>>>32-9,H=ae+Ve|0,Se^=H<<13|H>>>32-13,H=Se+ae|0,Mt^=H<<18|H>>>32-18,H=Ge+Ve|0,Ze^=H<<7|H>>>32-7,H=Ze+Ge|0,je^=H<<9|H>>>32-9,H=je+Ze|0,Ve^=H<<13|H>>>32-13,H=Ve+je|0,Ge^=H<<18|H>>>32-18,H=Fe+Xe|0,re^=H<<7|H>>>32-7,H=re+Fe|0,ae^=H<<9|H>>>32-9,H=ae+re|0,Xe^=H<<13|H>>>32-13,H=Xe+ae|0,Fe^=H<<18|H>>>32-18,H=me+ge|0,Se^=H<<7|H>>>32-7,H=Se+me|0,be^=H<<9|H>>>32-9,H=be+Se|0,ge^=H<<13|H>>>32-13,H=ge+be|0,me^=H<<18|H>>>32-18,H=Mt+Ft|0,dt^=H<<7|H>>>32-7,H=dt+Mt|0,Dt^=H<<9|H>>>32-9,H=Dt+dt|0,Ft^=H<<13|H>>>32-13,H=Ft+Dt|0,Mt^=H<<18|H>>>32-18;w[0]=Ge>>>0&255,w[1]=Ge>>>8&255,w[2]=Ge>>>16&255,w[3]=Ge>>>24&255,w[4]=Fe>>>0&255,w[5]=Fe>>>8&255,w[6]=Fe>>>16&255,w[7]=Fe>>>24&255,w[8]=me>>>0&255,w[9]=me>>>8&255,w[10]=me>>>16&255,w[11]=me>>>24&255,w[12]=Mt>>>0&255,w[13]=Mt>>>8&255,w[14]=Mt>>>16&255,w[15]=Mt>>>24&255,w[16]=re>>>0&255,w[17]=re>>>8&255,w[18]=re>>>16&255,w[19]=re>>>24&255,w[20]=ae>>>0&255,w[21]=ae>>>8&255,w[22]=ae>>>16&255,w[23]=ae>>>24&255,w[24]=be>>>0&255,w[25]=be>>>8&255,w[26]=be>>>16&255,w[27]=be>>>24&255,w[28]=ge>>>0&255,w[29]=ge>>>8&255,w[30]=ge>>>16&255,w[31]=ge>>>24&255}function P(w,S,C,p){N(w,S,C,p)}function B(w,S,C,p){A(w,S,C,p)}var W=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Q(w,S,C,p,I,Z,Y){var le=new Uint8Array(16),Pe=new Uint8Array(64),Ue,Ee;for(Ee=0;Ee<16;Ee++)le[Ee]=0;for(Ee=0;Ee<8;Ee++)le[Ee]=Z[Ee];for(;I>=64;){for(P(Pe,le,Y,W),Ee=0;Ee<64;Ee++)w[S+Ee]=C[p+Ee]^Pe[Ee];for(Ue=1,Ee=8;Ee<16;Ee++)Ue=Ue+(le[Ee]&255)|0,le[Ee]=Ue&255,Ue>>>=8;I-=64,S+=64,p+=64}if(I>0)for(P(Pe,le,Y,W),Ee=0;Ee<I;Ee++)w[S+Ee]=C[p+Ee]^Pe[Ee];return 0}function V(w,S,C,p,I){var Z=new Uint8Array(16),Y=new Uint8Array(64),le,Pe;for(Pe=0;Pe<16;Pe++)Z[Pe]=0;for(Pe=0;Pe<8;Pe++)Z[Pe]=p[Pe];for(;C>=64;){for(P(Y,Z,I,W),Pe=0;Pe<64;Pe++)w[S+Pe]=Y[Pe];for(le=1,Pe=8;Pe<16;Pe++)le=le+(Z[Pe]&255)|0,Z[Pe]=le&255,le>>>=8;C-=64,S+=64}if(C>0)for(P(Y,Z,I,W),Pe=0;Pe<C;Pe++)w[S+Pe]=Y[Pe];return 0}function ee(w,S,C,p,I){var Z=new Uint8Array(32);B(Z,p,I,W);for(var Y=new Uint8Array(8),le=0;le<8;le++)Y[le]=p[le+16];return V(w,S,C,Y,Z)}function j(w,S,C,p,I,Z,Y){var le=new Uint8Array(32);B(le,Z,Y,W);for(var Pe=new Uint8Array(8),Ue=0;Ue<8;Ue++)Pe[Ue]=Z[Ue+16];return Q(w,S,C,p,I,Pe,le)}var R=function(w){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var S,C,p,I,Z,Y,le,Pe;S=w[0]&255|(w[1]&255)<<8,this.r[0]=S&8191,C=w[2]&255|(w[3]&255)<<8,this.r[1]=(S>>>13|C<<3)&8191,p=w[4]&255|(w[5]&255)<<8,this.r[2]=(C>>>10|p<<6)&7939,I=w[6]&255|(w[7]&255)<<8,this.r[3]=(p>>>7|I<<9)&8191,Z=w[8]&255|(w[9]&255)<<8,this.r[4]=(I>>>4|Z<<12)&255,this.r[5]=Z>>>1&8190,Y=w[10]&255|(w[11]&255)<<8,this.r[6]=(Z>>>14|Y<<2)&8191,le=w[12]&255|(w[13]&255)<<8,this.r[7]=(Y>>>11|le<<5)&8065,Pe=w[14]&255|(w[15]&255)<<8,this.r[8]=(le>>>8|Pe<<8)&8191,this.r[9]=Pe>>>5&127,this.pad[0]=w[16]&255|(w[17]&255)<<8,this.pad[1]=w[18]&255|(w[19]&255)<<8,this.pad[2]=w[20]&255|(w[21]&255)<<8,this.pad[3]=w[22]&255|(w[23]&255)<<8,this.pad[4]=w[24]&255|(w[25]&255)<<8,this.pad[5]=w[26]&255|(w[27]&255)<<8,this.pad[6]=w[28]&255|(w[29]&255)<<8,this.pad[7]=w[30]&255|(w[31]&255)<<8};R.prototype.blocks=function(w,S,C){for(var p=this.fin?0:2048,I,Z,Y,le,Pe,Ue,Ee,Jt,He,ht,pt,kt,xt,gt,bt,_t,Ge,Ze,je,Ve=this.h[0],Xe=this.h[1],Fe=this.h[2],re=this.h[3],ae=this.h[4],be=this.h[5],ge=this.h[6],me=this.h[7],Se=this.h[8],dt=this.h[9],Dt=this.r[0],Ft=this.r[1],Mt=this.r[2],H=this.r[3],Gt=this.r[4],on=this.r[5],rn=this.r[6],jt=this.r[7],Qt=this.r[8],en=this.r[9];C>=16;)I=w[S+0]&255|(w[S+1]&255)<<8,Ve+=I&8191,Z=w[S+2]&255|(w[S+3]&255)<<8,Xe+=(I>>>13|Z<<3)&8191,Y=w[S+4]&255|(w[S+5]&255)<<8,Fe+=(Z>>>10|Y<<6)&8191,le=w[S+6]&255|(w[S+7]&255)<<8,re+=(Y>>>7|le<<9)&8191,Pe=w[S+8]&255|(w[S+9]&255)<<8,ae+=(le>>>4|Pe<<12)&8191,be+=Pe>>>1&8191,Ue=w[S+10]&255|(w[S+11]&255)<<8,ge+=(Pe>>>14|Ue<<2)&8191,Ee=w[S+12]&255|(w[S+13]&255)<<8,me+=(Ue>>>11|Ee<<5)&8191,Jt=w[S+14]&255|(w[S+15]&255)<<8,Se+=(Ee>>>8|Jt<<8)&8191,dt+=Jt>>>5|p,He=0,ht=He,ht+=Ve*Dt,ht+=Xe*(5*en),ht+=Fe*(5*Qt),ht+=re*(5*jt),ht+=ae*(5*rn),He=ht>>>13,ht&=8191,ht+=be*(5*on),ht+=ge*(5*Gt),ht+=me*(5*H),ht+=Se*(5*Mt),ht+=dt*(5*Ft),He+=ht>>>13,ht&=8191,pt=He,pt+=Ve*Ft,pt+=Xe*Dt,pt+=Fe*(5*en),pt+=re*(5*Qt),pt+=ae*(5*jt),He=pt>>>13,pt&=8191,pt+=be*(5*rn),pt+=ge*(5*on),pt+=me*(5*Gt),pt+=Se*(5*H),pt+=dt*(5*Mt),He+=pt>>>13,pt&=8191,kt=He,kt+=Ve*Mt,kt+=Xe*Ft,kt+=Fe*Dt,kt+=re*(5*en),kt+=ae*(5*Qt),He=kt>>>13,kt&=8191,kt+=be*(5*jt),kt+=ge*(5*rn),kt+=me*(5*on),kt+=Se*(5*Gt),kt+=dt*(5*H),He+=kt>>>13,kt&=8191,xt=He,xt+=Ve*H,xt+=Xe*Mt,xt+=Fe*Ft,xt+=re*Dt,xt+=ae*(5*en),He=xt>>>13,xt&=8191,xt+=be*(5*Qt),xt+=ge*(5*jt),xt+=me*(5*rn),xt+=Se*(5*on),xt+=dt*(5*Gt),He+=xt>>>13,xt&=8191,gt=He,gt+=Ve*Gt,gt+=Xe*H,gt+=Fe*Mt,gt+=re*Ft,gt+=ae*Dt,He=gt>>>13,gt&=8191,gt+=be*(5*en),gt+=ge*(5*Qt),gt+=me*(5*jt),gt+=Se*(5*rn),gt+=dt*(5*on),He+=gt>>>13,gt&=8191,bt=He,bt+=Ve*on,bt+=Xe*Gt,bt+=Fe*H,bt+=re*Mt,bt+=ae*Ft,He=bt>>>13,bt&=8191,bt+=be*Dt,bt+=ge*(5*en),bt+=me*(5*Qt),bt+=Se*(5*jt),bt+=dt*(5*rn),He+=bt>>>13,bt&=8191,_t=He,_t+=Ve*rn,_t+=Xe*on,_t+=Fe*Gt,_t+=re*H,_t+=ae*Mt,He=_t>>>13,_t&=8191,_t+=be*Ft,_t+=ge*Dt,_t+=me*(5*en),_t+=Se*(5*Qt),_t+=dt*(5*jt),He+=_t>>>13,_t&=8191,Ge=He,Ge+=Ve*jt,Ge+=Xe*rn,Ge+=Fe*on,Ge+=re*Gt,Ge+=ae*H,He=Ge>>>13,Ge&=8191,Ge+=be*Mt,Ge+=ge*Ft,Ge+=me*Dt,Ge+=Se*(5*en),Ge+=dt*(5*Qt),He+=Ge>>>13,Ge&=8191,Ze=He,Ze+=Ve*Qt,Ze+=Xe*jt,Ze+=Fe*rn,Ze+=re*on,Ze+=ae*Gt,He=Ze>>>13,Ze&=8191,Ze+=be*H,Ze+=ge*Mt,Ze+=me*Ft,Ze+=Se*Dt,Ze+=dt*(5*en),He+=Ze>>>13,Ze&=8191,je=He,je+=Ve*en,je+=Xe*Qt,je+=Fe*jt,je+=re*rn,je+=ae*on,He=je>>>13,je&=8191,je+=be*Gt,je+=ge*H,je+=me*Mt,je+=Se*Ft,je+=dt*Dt,He+=je>>>13,je&=8191,He=(He<<2)+He|0,He=He+ht|0,ht=He&8191,He=He>>>13,pt+=He,Ve=ht,Xe=pt,Fe=kt,re=xt,ae=gt,be=bt,ge=_t,me=Ge,Se=Ze,dt=je,S+=16,C-=16;this.h[0]=Ve,this.h[1]=Xe,this.h[2]=Fe,this.h[3]=re,this.h[4]=ae,this.h[5]=be,this.h[6]=ge,this.h[7]=me,this.h[8]=Se,this.h[9]=dt},R.prototype.finish=function(w,S){var C=new Uint16Array(10),p,I,Z,Y;if(this.leftover){for(Y=this.leftover,this.buffer[Y++]=1;Y<16;Y++)this.buffer[Y]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(p=this.h[1]>>>13,this.h[1]&=8191,Y=2;Y<10;Y++)this.h[Y]+=p,p=this.h[Y]>>>13,this.h[Y]&=8191;for(this.h[0]+=p*5,p=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=p,p=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=p,C[0]=this.h[0]+5,p=C[0]>>>13,C[0]&=8191,Y=1;Y<10;Y++)C[Y]=this.h[Y]+p,p=C[Y]>>>13,C[Y]&=8191;for(C[9]-=8192,I=(p^1)-1,Y=0;Y<10;Y++)C[Y]&=I;for(I=~I,Y=0;Y<10;Y++)this.h[Y]=this.h[Y]&I|C[Y];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Z=this.h[0]+this.pad[0],this.h[0]=Z&65535,Y=1;Y<8;Y++)Z=(this.h[Y]+this.pad[Y]|0)+(Z>>>16)|0,this.h[Y]=Z&65535;w[S+0]=this.h[0]>>>0&255,w[S+1]=this.h[0]>>>8&255,w[S+2]=this.h[1]>>>0&255,w[S+3]=this.h[1]>>>8&255,w[S+4]=this.h[2]>>>0&255,w[S+5]=this.h[2]>>>8&255,w[S+6]=this.h[3]>>>0&255,w[S+7]=this.h[3]>>>8&255,w[S+8]=this.h[4]>>>0&255,w[S+9]=this.h[4]>>>8&255,w[S+10]=this.h[5]>>>0&255,w[S+11]=this.h[5]>>>8&255,w[S+12]=this.h[6]>>>0&255,w[S+13]=this.h[6]>>>8&255,w[S+14]=this.h[7]>>>0&255,w[S+15]=this.h[7]>>>8&255},R.prototype.update=function(w,S,C){var p,I;if(this.leftover){for(I=16-this.leftover,I>C&&(I=C),p=0;p<I;p++)this.buffer[this.leftover+p]=w[S+p];if(C-=I,S+=I,this.leftover+=I,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(C>=16&&(I=C-C%16,this.blocks(w,S,I),S+=I,C-=I),C){for(p=0;p<C;p++)this.buffer[this.leftover+p]=w[S+p];this.leftover+=C}};function U(w,S,C,p,I,Z){var Y=new R(Z);return Y.update(C,p,I),Y.finish(w,S),0}function x(w,S,C,p,I,Z){var Y=new Uint8Array(16);return U(Y,0,C,p,I,Z),k(w,S,Y,0)}function f(w,S,C,p,I){var Z;if(C<32)return-1;for(j(w,0,S,0,C,p,I),U(w,16,w,32,C-32,w),Z=0;Z<16;Z++)w[Z]=0;return 0}function m(w,S,C,p,I){var Z,Y=new Uint8Array(32);if(C<32||(ee(Y,0,32,p,I),x(S,16,S,32,C-32,Y)!==0))return-1;for(j(w,0,S,0,C,p,I),Z=0;Z<32;Z++)w[Z]=0;return 0}function T(w,S){var C;for(C=0;C<16;C++)w[C]=S[C]|0}function $(w){var S,C,p=1;for(S=0;S<16;S++)C=w[S]+p+65535,p=Math.floor(C/65536),w[S]=C-p*65536;w[0]+=p-1+37*(p-1)}function M(w,S,C){for(var p,I=~(C-1),Z=0;Z<16;Z++)p=I&(w[Z]^S[Z]),w[Z]^=p,S[Z]^=p}function z(w,S){var C,p,I,Z=n(),Y=n();for(C=0;C<16;C++)Y[C]=S[C];for($(Y),$(Y),$(Y),p=0;p<2;p++){for(Z[0]=Y[0]-65517,C=1;C<15;C++)Z[C]=Y[C]-65535-(Z[C-1]>>16&1),Z[C-1]&=65535;Z[15]=Y[15]-32767-(Z[14]>>16&1),I=Z[15]>>16&1,Z[14]&=65535,M(Y,Z,1-I)}for(C=0;C<16;C++)w[2*C]=Y[C]&255,w[2*C+1]=Y[C]>>8}function J(w,S){var C=new Uint8Array(32),p=new Uint8Array(32);return z(C,w),z(p,S),E(C,0,p,0)}function O(w){var S=new Uint8Array(32);return z(S,w),S[0]&1}function _(w,S){var C;for(C=0;C<16;C++)w[C]=S[2*C]+(S[2*C+1]<<8);w[15]&=32767}function q(w,S,C){for(var p=0;p<16;p++)w[p]=S[p]+C[p]}function ve(w,S,C){for(var p=0;p<16;p++)w[p]=S[p]-C[p]}function ue(w,S,C){var p,I,Z=0,Y=0,le=0,Pe=0,Ue=0,Ee=0,Jt=0,He=0,ht=0,pt=0,kt=0,xt=0,gt=0,bt=0,_t=0,Ge=0,Ze=0,je=0,Ve=0,Xe=0,Fe=0,re=0,ae=0,be=0,ge=0,me=0,Se=0,dt=0,Dt=0,Ft=0,Mt=0,H=C[0],Gt=C[1],on=C[2],rn=C[3],jt=C[4],Qt=C[5],en=C[6],En=C[7],dn=C[8],Tn=C[9],An=C[10],kn=C[11],$n=C[12],Qn=C[13],ei=C[14],ti=C[15];p=S[0],Z+=p*H,Y+=p*Gt,le+=p*on,Pe+=p*rn,Ue+=p*jt,Ee+=p*Qt,Jt+=p*en,He+=p*En,ht+=p*dn,pt+=p*Tn,kt+=p*An,xt+=p*kn,gt+=p*$n,bt+=p*Qn,_t+=p*ei,Ge+=p*ti,p=S[1],Y+=p*H,le+=p*Gt,Pe+=p*on,Ue+=p*rn,Ee+=p*jt,Jt+=p*Qt,He+=p*en,ht+=p*En,pt+=p*dn,kt+=p*Tn,xt+=p*An,gt+=p*kn,bt+=p*$n,_t+=p*Qn,Ge+=p*ei,Ze+=p*ti,p=S[2],le+=p*H,Pe+=p*Gt,Ue+=p*on,Ee+=p*rn,Jt+=p*jt,He+=p*Qt,ht+=p*en,pt+=p*En,kt+=p*dn,xt+=p*Tn,gt+=p*An,bt+=p*kn,_t+=p*$n,Ge+=p*Qn,Ze+=p*ei,je+=p*ti,p=S[3],Pe+=p*H,Ue+=p*Gt,Ee+=p*on,Jt+=p*rn,He+=p*jt,ht+=p*Qt,pt+=p*en,kt+=p*En,xt+=p*dn,gt+=p*Tn,bt+=p*An,_t+=p*kn,Ge+=p*$n,Ze+=p*Qn,je+=p*ei,Ve+=p*ti,p=S[4],Ue+=p*H,Ee+=p*Gt,Jt+=p*on,He+=p*rn,ht+=p*jt,pt+=p*Qt,kt+=p*en,xt+=p*En,gt+=p*dn,bt+=p*Tn,_t+=p*An,Ge+=p*kn,Ze+=p*$n,je+=p*Qn,Ve+=p*ei,Xe+=p*ti,p=S[5],Ee+=p*H,Jt+=p*Gt,He+=p*on,ht+=p*rn,pt+=p*jt,kt+=p*Qt,xt+=p*en,gt+=p*En,bt+=p*dn,_t+=p*Tn,Ge+=p*An,Ze+=p*kn,je+=p*$n,Ve+=p*Qn,Xe+=p*ei,Fe+=p*ti,p=S[6],Jt+=p*H,He+=p*Gt,ht+=p*on,pt+=p*rn,kt+=p*jt,xt+=p*Qt,gt+=p*en,bt+=p*En,_t+=p*dn,Ge+=p*Tn,Ze+=p*An,je+=p*kn,Ve+=p*$n,Xe+=p*Qn,Fe+=p*ei,re+=p*ti,p=S[7],He+=p*H,ht+=p*Gt,pt+=p*on,kt+=p*rn,xt+=p*jt,gt+=p*Qt,bt+=p*en,_t+=p*En,Ge+=p*dn,Ze+=p*Tn,je+=p*An,Ve+=p*kn,Xe+=p*$n,Fe+=p*Qn,re+=p*ei,ae+=p*ti,p=S[8],ht+=p*H,pt+=p*Gt,kt+=p*on,xt+=p*rn,gt+=p*jt,bt+=p*Qt,_t+=p*en,Ge+=p*En,Ze+=p*dn,je+=p*Tn,Ve+=p*An,Xe+=p*kn,Fe+=p*$n,re+=p*Qn,ae+=p*ei,be+=p*ti,p=S[9],pt+=p*H,kt+=p*Gt,xt+=p*on,gt+=p*rn,bt+=p*jt,_t+=p*Qt,Ge+=p*en,Ze+=p*En,je+=p*dn,Ve+=p*Tn,Xe+=p*An,Fe+=p*kn,re+=p*$n,ae+=p*Qn,be+=p*ei,ge+=p*ti,p=S[10],kt+=p*H,xt+=p*Gt,gt+=p*on,bt+=p*rn,_t+=p*jt,Ge+=p*Qt,Ze+=p*en,je+=p*En,Ve+=p*dn,Xe+=p*Tn,Fe+=p*An,re+=p*kn,ae+=p*$n,be+=p*Qn,ge+=p*ei,me+=p*ti,p=S[11],xt+=p*H,gt+=p*Gt,bt+=p*on,_t+=p*rn,Ge+=p*jt,Ze+=p*Qt,je+=p*en,Ve+=p*En,Xe+=p*dn,Fe+=p*Tn,re+=p*An,ae+=p*kn,be+=p*$n,ge+=p*Qn,me+=p*ei,Se+=p*ti,p=S[12],gt+=p*H,bt+=p*Gt,_t+=p*on,Ge+=p*rn,Ze+=p*jt,je+=p*Qt,Ve+=p*en,Xe+=p*En,Fe+=p*dn,re+=p*Tn,ae+=p*An,be+=p*kn,ge+=p*$n,me+=p*Qn,Se+=p*ei,dt+=p*ti,p=S[13],bt+=p*H,_t+=p*Gt,Ge+=p*on,Ze+=p*rn,je+=p*jt,Ve+=p*Qt,Xe+=p*en,Fe+=p*En,re+=p*dn,ae+=p*Tn,be+=p*An,ge+=p*kn,me+=p*$n,Se+=p*Qn,dt+=p*ei,Dt+=p*ti,p=S[14],_t+=p*H,Ge+=p*Gt,Ze+=p*on,je+=p*rn,Ve+=p*jt,Xe+=p*Qt,Fe+=p*en,re+=p*En,ae+=p*dn,be+=p*Tn,ge+=p*An,me+=p*kn,Se+=p*$n,dt+=p*Qn,Dt+=p*ei,Ft+=p*ti,p=S[15],Ge+=p*H,Ze+=p*Gt,je+=p*on,Ve+=p*rn,Xe+=p*jt,Fe+=p*Qt,re+=p*en,ae+=p*En,be+=p*dn,ge+=p*Tn,me+=p*An,Se+=p*kn,dt+=p*$n,Dt+=p*Qn,Ft+=p*ei,Mt+=p*ti,Z+=38*Ze,Y+=38*je,le+=38*Ve,Pe+=38*Xe,Ue+=38*Fe,Ee+=38*re,Jt+=38*ae,He+=38*be,ht+=38*ge,pt+=38*me,kt+=38*Se,xt+=38*dt,gt+=38*Dt,bt+=38*Ft,_t+=38*Mt,I=1,p=Z+I+65535,I=Math.floor(p/65536),Z=p-I*65536,p=Y+I+65535,I=Math.floor(p/65536),Y=p-I*65536,p=le+I+65535,I=Math.floor(p/65536),le=p-I*65536,p=Pe+I+65535,I=Math.floor(p/65536),Pe=p-I*65536,p=Ue+I+65535,I=Math.floor(p/65536),Ue=p-I*65536,p=Ee+I+65535,I=Math.floor(p/65536),Ee=p-I*65536,p=Jt+I+65535,I=Math.floor(p/65536),Jt=p-I*65536,p=He+I+65535,I=Math.floor(p/65536),He=p-I*65536,p=ht+I+65535,I=Math.floor(p/65536),ht=p-I*65536,p=pt+I+65535,I=Math.floor(p/65536),pt=p-I*65536,p=kt+I+65535,I=Math.floor(p/65536),kt=p-I*65536,p=xt+I+65535,I=Math.floor(p/65536),xt=p-I*65536,p=gt+I+65535,I=Math.floor(p/65536),gt=p-I*65536,p=bt+I+65535,I=Math.floor(p/65536),bt=p-I*65536,p=_t+I+65535,I=Math.floor(p/65536),_t=p-I*65536,p=Ge+I+65535,I=Math.floor(p/65536),Ge=p-I*65536,Z+=I-1+37*(I-1),I=1,p=Z+I+65535,I=Math.floor(p/65536),Z=p-I*65536,p=Y+I+65535,I=Math.floor(p/65536),Y=p-I*65536,p=le+I+65535,I=Math.floor(p/65536),le=p-I*65536,p=Pe+I+65535,I=Math.floor(p/65536),Pe=p-I*65536,p=Ue+I+65535,I=Math.floor(p/65536),Ue=p-I*65536,p=Ee+I+65535,I=Math.floor(p/65536),Ee=p-I*65536,p=Jt+I+65535,I=Math.floor(p/65536),Jt=p-I*65536,p=He+I+65535,I=Math.floor(p/65536),He=p-I*65536,p=ht+I+65535,I=Math.floor(p/65536),ht=p-I*65536,p=pt+I+65535,I=Math.floor(p/65536),pt=p-I*65536,p=kt+I+65535,I=Math.floor(p/65536),kt=p-I*65536,p=xt+I+65535,I=Math.floor(p/65536),xt=p-I*65536,p=gt+I+65535,I=Math.floor(p/65536),gt=p-I*65536,p=bt+I+65535,I=Math.floor(p/65536),bt=p-I*65536,p=_t+I+65535,I=Math.floor(p/65536),_t=p-I*65536,p=Ge+I+65535,I=Math.floor(p/65536),Ge=p-I*65536,Z+=I-1+37*(I-1),w[0]=Z,w[1]=Y,w[2]=le,w[3]=Pe,w[4]=Ue,w[5]=Ee,w[6]=Jt,w[7]=He,w[8]=ht,w[9]=pt,w[10]=kt,w[11]=xt,w[12]=gt,w[13]=bt,w[14]=_t,w[15]=Ge}function xe(w,S){ue(w,S,S)}function lt(w,S){var C=n(),p;for(p=0;p<16;p++)C[p]=S[p];for(p=253;p>=0;p--)xe(C,C),p!==2&&p!==4&&ue(C,C,S);for(p=0;p<16;p++)w[p]=C[p]}function Qe(w,S){var C=n(),p;for(p=0;p<16;p++)C[p]=S[p];for(p=250;p>=0;p--)xe(C,C),p!==1&&ue(C,C,S);for(p=0;p<16;p++)w[p]=C[p]}function yt(w,S,C){var p=new Uint8Array(32),I=new Float64Array(80),Z,Y,le=n(),Pe=n(),Ue=n(),Ee=n(),Jt=n(),He=n();for(Y=0;Y<31;Y++)p[Y]=S[Y];for(p[31]=S[31]&127|64,p[0]&=248,_(I,C),Y=0;Y<16;Y++)Pe[Y]=I[Y],Ee[Y]=le[Y]=Ue[Y]=0;for(le[0]=Ee[0]=1,Y=254;Y>=0;--Y)Z=p[Y>>>3]>>>(Y&7)&1,M(le,Pe,Z),M(Ue,Ee,Z),q(Jt,le,Ue),ve(le,le,Ue),q(Ue,Pe,Ee),ve(Pe,Pe,Ee),xe(Ee,Jt),xe(He,le),ue(le,Ue,le),ue(Ue,Pe,Jt),q(Jt,le,Ue),ve(le,le,Ue),xe(Pe,le),ve(Ue,Ee,He),ue(le,Ue,c),q(le,le,Ee),ue(Ue,Ue,le),ue(le,Ee,He),ue(Ee,Pe,I),xe(Pe,Jt),M(le,Pe,Z),M(Ue,Ee,Z);for(Y=0;Y<16;Y++)I[Y+16]=le[Y],I[Y+32]=Ue[Y],I[Y+48]=Pe[Y],I[Y+64]=Ee[Y];var ht=I.subarray(32),pt=I.subarray(16);return lt(ht,ht),ue(pt,pt,ht),z(w,pt),0}function ot(w,S){return yt(w,S,o)}function rt(w,S){return i(S,32),ot(w,S)}function vt(w,S,C){var p=new Uint8Array(32);return yt(p,C,S),B(w,s,p,W)}var Pn=f,ne=m;function de(w,S,C,p,I,Z){var Y=new Uint8Array(32);return vt(Y,I,Z),Pn(w,S,C,p,Y)}function Oe(w,S,C,p,I,Z){var Y=new Uint8Array(32);return vt(Y,I,Z),ne(w,S,C,p,Y)}var ke=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Le(w,S,C,p){for(var I=new Int32Array(16),Z=new Int32Array(16),Y,le,Pe,Ue,Ee,Jt,He,ht,pt,kt,xt,gt,bt,_t,Ge,Ze,je,Ve,Xe,Fe,re,ae,be,ge,me,Se,dt=w[0],Dt=w[1],Ft=w[2],Mt=w[3],H=w[4],Gt=w[5],on=w[6],rn=w[7],jt=S[0],Qt=S[1],en=S[2],En=S[3],dn=S[4],Tn=S[5],An=S[6],kn=S[7],$n=0;p>=128;){for(Xe=0;Xe<16;Xe++)Fe=8*Xe+$n,I[Xe]=C[Fe+0]<<24|C[Fe+1]<<16|C[Fe+2]<<8|C[Fe+3],Z[Xe]=C[Fe+4]<<24|C[Fe+5]<<16|C[Fe+6]<<8|C[Fe+7];for(Xe=0;Xe<80;Xe++)if(Y=dt,le=Dt,Pe=Ft,Ue=Mt,Ee=H,Jt=Gt,He=on,ht=rn,pt=jt,kt=Qt,xt=en,gt=En,bt=dn,_t=Tn,Ge=An,Ze=kn,re=rn,ae=kn,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=(H>>>14|dn<<32-14)^(H>>>18|dn<<32-18)^(dn>>>41-32|H<<32-(41-32)),ae=(dn>>>14|H<<32-14)^(dn>>>18|H<<32-18)^(H>>>41-32|dn<<32-(41-32)),be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,re=H&Gt^~H&on,ae=dn&Tn^~dn&An,be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,re=ke[Xe*2],ae=ke[Xe*2+1],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,re=I[Xe%16],ae=Z[Xe%16],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,je=me&65535|Se<<16,Ve=be&65535|ge<<16,re=je,ae=Ve,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=(dt>>>28|jt<<32-28)^(jt>>>34-32|dt<<32-(34-32))^(jt>>>39-32|dt<<32-(39-32)),ae=(jt>>>28|dt<<32-28)^(dt>>>34-32|jt<<32-(34-32))^(dt>>>39-32|jt<<32-(39-32)),be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,re=dt&Dt^dt&Ft^Dt&Ft,ae=jt&Qt^jt&en^Qt&en,be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,ht=me&65535|Se<<16,Ze=be&65535|ge<<16,re=Ue,ae=gt,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=je,ae=Ve,be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,Ue=me&65535|Se<<16,gt=be&65535|ge<<16,Dt=Y,Ft=le,Mt=Pe,H=Ue,Gt=Ee,on=Jt,rn=He,dt=ht,Qt=pt,en=kt,En=xt,dn=gt,Tn=bt,An=_t,kn=Ge,jt=Ze,Xe%16===15)for(Fe=0;Fe<16;Fe++)re=I[Fe],ae=Z[Fe],be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=I[(Fe+9)%16],ae=Z[(Fe+9)%16],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,je=I[(Fe+1)%16],Ve=Z[(Fe+1)%16],re=(je>>>1|Ve<<32-1)^(je>>>8|Ve<<32-8)^je>>>7,ae=(Ve>>>1|je<<32-1)^(Ve>>>8|je<<32-8)^(Ve>>>7|je<<32-7),be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,je=I[(Fe+14)%16],Ve=Z[(Fe+14)%16],re=(je>>>19|Ve<<32-19)^(Ve>>>61-32|je<<32-(61-32))^je>>>6,ae=(Ve>>>19|je<<32-19)^(je>>>61-32|Ve<<32-(61-32))^(Ve>>>6|je<<32-6),be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,I[Fe]=me&65535|Se<<16,Z[Fe]=be&65535|ge<<16;re=dt,ae=jt,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[0],ae=S[0],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[0]=dt=me&65535|Se<<16,S[0]=jt=be&65535|ge<<16,re=Dt,ae=Qt,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[1],ae=S[1],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[1]=Dt=me&65535|Se<<16,S[1]=Qt=be&65535|ge<<16,re=Ft,ae=en,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[2],ae=S[2],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[2]=Ft=me&65535|Se<<16,S[2]=en=be&65535|ge<<16,re=Mt,ae=En,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[3],ae=S[3],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[3]=Mt=me&65535|Se<<16,S[3]=En=be&65535|ge<<16,re=H,ae=dn,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[4],ae=S[4],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[4]=H=me&65535|Se<<16,S[4]=dn=be&65535|ge<<16,re=Gt,ae=Tn,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[5],ae=S[5],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[5]=Gt=me&65535|Se<<16,S[5]=Tn=be&65535|ge<<16,re=on,ae=An,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[6],ae=S[6],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[6]=on=me&65535|Se<<16,S[6]=An=be&65535|ge<<16,re=rn,ae=kn,be=ae&65535,ge=ae>>>16,me=re&65535,Se=re>>>16,re=w[7],ae=S[7],be+=ae&65535,ge+=ae>>>16,me+=re&65535,Se+=re>>>16,ge+=be>>>16,me+=ge>>>16,Se+=me>>>16,w[7]=rn=me&65535|Se<<16,S[7]=kn=be&65535|ge<<16,$n+=128,p-=128}return p}function tt(w,S,C){var p=new Int32Array(8),I=new Int32Array(8),Z=new Uint8Array(256),Y,le=C;for(p[0]=1779033703,p[1]=3144134277,p[2]=1013904242,p[3]=2773480762,p[4]=1359893119,p[5]=2600822924,p[6]=528734635,p[7]=1541459225,I[0]=4089235720,I[1]=2227873595,I[2]=4271175723,I[3]=1595750129,I[4]=2917565137,I[5]=725511199,I[6]=4215389547,I[7]=327033209,Le(p,I,S,C),C%=128,Y=0;Y<C;Y++)Z[Y]=S[le-C+Y];for(Z[C]=128,C=256-128*(C<112?1:0),Z[C-9]=0,b(Z,C-8,le/536870912|0,le<<3),Le(p,I,Z,C),Y=0;Y<8;Y++)b(w,8*Y,p[Y],I[Y]);return 0}function Ke(w,S){var C=n(),p=n(),I=n(),Z=n(),Y=n(),le=n(),Pe=n(),Ue=n(),Ee=n();ve(C,w[1],w[0]),ve(Ee,S[1],S[0]),ue(C,C,Ee),q(p,w[0],w[1]),q(Ee,S[0],S[1]),ue(p,p,Ee),ue(I,w[3],S[3]),ue(I,I,l),ue(Z,w[2],S[2]),q(Z,Z,Z),ve(Y,p,C),ve(le,Z,I),q(Pe,Z,I),q(Ue,p,C),ue(w[0],Y,le),ue(w[1],Ue,Pe),ue(w[2],Pe,le),ue(w[3],Y,Ue)}function et(w,S,C){var p;for(p=0;p<4;p++)M(w[p],S[p],C)}function Xt(w,S){var C=n(),p=n(),I=n();lt(I,S[2]),ue(C,S[0],I),ue(p,S[1],I),z(w,p),w[31]^=O(C)<<7}function ut(w,S,C){var p,I;for(T(w[0],r),T(w[1],a),T(w[2],a),T(w[3],r),I=255;I>=0;--I)p=C[I/8|0]>>(I&7)&1,et(w,S,p),Ke(S,w),Ke(w,w),et(w,S,p)}function nt(w,S){var C=[n(),n(),n(),n()];T(C[0],d),T(C[1],h),T(C[2],a),ue(C[3],d,h),ut(w,C,S)}function Kt(w,S,C){var p=new Uint8Array(64),I=[n(),n(),n(),n()],Z;for(C||i(S,32),tt(p,S,32),p[0]&=248,p[31]&=127,p[31]|=64,nt(I,p),Xt(w,I),Z=0;Z<32;Z++)S[Z+32]=w[Z];return 0}var At=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Pt(w,S){var C,p,I,Z;for(p=63;p>=32;--p){for(C=0,I=p-32,Z=p-12;I<Z;++I)S[I]+=C-16*S[p]*At[I-(p-32)],C=Math.floor((S[I]+128)/256),S[I]-=C*256;S[I]+=C,S[p]=0}for(C=0,I=0;I<32;I++)S[I]+=C-(S[31]>>4)*At[I],C=S[I]>>8,S[I]&=255;for(I=0;I<32;I++)S[I]-=C*At[I];for(p=0;p<32;p++)S[p+1]+=S[p]>>8,w[p]=S[p]&255}function hn(w){var S=new Float64Array(64),C;for(C=0;C<64;C++)S[C]=w[C];for(C=0;C<64;C++)w[C]=0;Pt(w,S)}function Ut(w,S,C,p){var I=new Uint8Array(64),Z=new Uint8Array(64),Y=new Uint8Array(64),le,Pe,Ue=new Float64Array(64),Ee=[n(),n(),n(),n()];tt(I,p,32),I[0]&=248,I[31]&=127,I[31]|=64;var Jt=C+64;for(le=0;le<C;le++)w[64+le]=S[le];for(le=0;le<32;le++)w[32+le]=I[32+le];for(tt(Y,w.subarray(32),C+32),hn(Y),nt(Ee,Y),Xt(w,Ee),le=32;le<64;le++)w[le]=p[le];for(tt(Z,w,C+64),hn(Z),le=0;le<64;le++)Ue[le]=0;for(le=0;le<32;le++)Ue[le]=Y[le];for(le=0;le<32;le++)for(Pe=0;Pe<32;Pe++)Ue[le+Pe]+=Z[le]*I[Pe];return Pt(w.subarray(32),Ue),Jt}function sn(w,S){var C=n(),p=n(),I=n(),Z=n(),Y=n(),le=n(),Pe=n();return T(w[2],a),_(w[1],S),xe(I,w[1]),ue(Z,I,u),ve(I,I,w[2]),q(Z,w[2],Z),xe(Y,Z),xe(le,Y),ue(Pe,le,Y),ue(C,Pe,I),ue(C,C,Z),Qe(C,C),ue(C,C,I),ue(C,C,Z),ue(C,C,Z),ue(w[0],C,Z),xe(p,w[0]),ue(p,p,Z),J(p,I)&&ue(w[0],w[0],g),xe(p,w[0]),ue(p,p,Z),J(p,I)?-1:(O(w[0])===S[31]>>7&&ve(w[0],r,w[0]),ue(w[3],w[0],w[1]),0)}function D(w,S,C,p){var I,Z=new Uint8Array(32),Y=new Uint8Array(64),le=[n(),n(),n(),n()],Pe=[n(),n(),n(),n()];if(C<64||sn(Pe,p))return-1;for(I=0;I<C;I++)w[I]=S[I];for(I=0;I<32;I++)w[I+32]=p[I];if(tt(Y,w,C),hn(Y),ut(le,Pe,Y),nt(Pe,S.subarray(32)),Ke(le,Pe),Xt(Z,le),C-=64,E(S,0,Z,0)){for(I=0;I<C;I++)w[I]=0;return-1}for(I=0;I<C;I++)w[I]=S[I+64];return C}var K=32,X=24,te=32,oe=16,se=32,we=32,Be=32,Ae=32,fe=32,pe=X,Te=te,it=oe,Re=64,Ne=32,qt=64,Ye=32,Et=64;t.lowlevel={crypto_core_hsalsa20:B,crypto_stream_xor:j,crypto_stream:ee,crypto_stream_salsa20_xor:Q,crypto_stream_salsa20:V,crypto_onetimeauth:U,crypto_onetimeauth_verify:x,crypto_verify_16:k,crypto_verify_32:E,crypto_secretbox:f,crypto_secretbox_open:m,crypto_scalarmult:yt,crypto_scalarmult_base:ot,crypto_box_beforenm:vt,crypto_box_afternm:Pn,crypto_box:de,crypto_box_open:Oe,crypto_box_keypair:rt,crypto_hash:tt,crypto_sign:Ut,crypto_sign_keypair:Kt,crypto_sign_open:D,crypto_secretbox_KEYBYTES:K,crypto_secretbox_NONCEBYTES:X,crypto_secretbox_ZEROBYTES:te,crypto_secretbox_BOXZEROBYTES:oe,crypto_scalarmult_BYTES:se,crypto_scalarmult_SCALARBYTES:we,crypto_box_PUBLICKEYBYTES:Be,crypto_box_SECRETKEYBYTES:Ae,crypto_box_BEFORENMBYTES:fe,crypto_box_NONCEBYTES:pe,crypto_box_ZEROBYTES:Te,crypto_box_BOXZEROBYTES:it,crypto_sign_BYTES:Re,crypto_sign_PUBLICKEYBYTES:Ne,crypto_sign_SECRETKEYBYTES:qt,crypto_sign_SEEDBYTES:Ye,crypto_hash_BYTES:Et,gf:n,D:u,L:At,pack25519:z,unpack25519:_,M:ue,A:q,S:xe,Z:ve,pow2523:Qe,add:Ke,set25519:T,modL:Pt,scalarmult:ut,scalarbase:nt};function Lt(w,S){if(w.length!==K)throw new Error("bad key size");if(S.length!==X)throw new Error("bad nonce size")}function Ct(w,S){if(w.length!==Be)throw new Error("bad public key size");if(S.length!==Ae)throw new Error("bad secret key size")}function wt(){for(var w=0;w<arguments.length;w++)if(!(arguments[w]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Cn(w){for(var S=0;S<w.length;S++)w[S]=0}t.randomBytes=function(w){var S=new Uint8Array(w);return i(S,w),S},t.secretbox=function(w,S,C){wt(w,S,C),Lt(C,S);for(var p=new Uint8Array(te+w.length),I=new Uint8Array(p.length),Z=0;Z<w.length;Z++)p[Z+te]=w[Z];return f(I,p,p.length,S,C),I.subarray(oe)},t.secretbox.open=function(w,S,C){wt(w,S,C),Lt(C,S);for(var p=new Uint8Array(oe+w.length),I=new Uint8Array(p.length),Z=0;Z<w.length;Z++)p[Z+oe]=w[Z];return p.length<32||m(I,p,p.length,S,C)!==0?null:I.subarray(te)},t.secretbox.keyLength=K,t.secretbox.nonceLength=X,t.secretbox.overheadLength=oe,t.scalarMult=function(w,S){if(wt(w,S),w.length!==we)throw new Error("bad n size");if(S.length!==se)throw new Error("bad p size");var C=new Uint8Array(se);return yt(C,w,S),C},t.scalarMult.base=function(w){if(wt(w),w.length!==we)throw new Error("bad n size");var S=new Uint8Array(se);return ot(S,w),S},t.scalarMult.scalarLength=we,t.scalarMult.groupElementLength=se,t.box=function(w,S,C,p){var I=t.box.before(C,p);return t.secretbox(w,S,I)},t.box.before=function(w,S){wt(w,S),Ct(w,S);var C=new Uint8Array(fe);return vt(C,w,S),C},t.box.after=t.secretbox,t.box.open=function(w,S,C,p){var I=t.box.before(C,p);return t.secretbox.open(w,S,I)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var w=new Uint8Array(Be),S=new Uint8Array(Ae);return rt(w,S),{publicKey:w,secretKey:S}},t.box.keyPair.fromSecretKey=function(w){if(wt(w),w.length!==Ae)throw new Error("bad secret key size");var S=new Uint8Array(Be);return ot(S,w),{publicKey:S,secretKey:new Uint8Array(w)}},t.box.publicKeyLength=Be,t.box.secretKeyLength=Ae,t.box.sharedKeyLength=fe,t.box.nonceLength=pe,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(w,S){if(wt(w,S),S.length!==qt)throw new Error("bad secret key size");var C=new Uint8Array(Re+w.length);return Ut(C,w,w.length,S),C},t.sign.open=function(w,S){if(wt(w,S),S.length!==Ne)throw new Error("bad public key size");var C=new Uint8Array(w.length),p=D(C,w,w.length,S);if(p<0)return null;for(var I=new Uint8Array(p),Z=0;Z<I.length;Z++)I[Z]=C[Z];return I},t.sign.detached=function(w,S){for(var C=t.sign(w,S),p=new Uint8Array(Re),I=0;I<p.length;I++)p[I]=C[I];return p},t.sign.detached.verify=function(w,S,C){if(wt(w,S,C),S.length!==Re)throw new Error("bad signature size");if(C.length!==Ne)throw new Error("bad public key size");var p=new Uint8Array(Re+w.length),I=new Uint8Array(Re+w.length),Z;for(Z=0;Z<Re;Z++)p[Z]=S[Z];for(Z=0;Z<w.length;Z++)p[Z+Re]=w[Z];return D(I,p,p.length,C)>=0},t.sign.keyPair=function(){var w=new Uint8Array(Ne),S=new Uint8Array(qt);return Kt(w,S),{publicKey:w,secretKey:S}},t.sign.keyPair.fromSecretKey=function(w){if(wt(w),w.length!==qt)throw new Error("bad secret key size");for(var S=new Uint8Array(Ne),C=0;C<S.length;C++)S[C]=w[32+C];return{publicKey:S,secretKey:new Uint8Array(w)}},t.sign.keyPair.fromSeed=function(w){if(wt(w),w.length!==Ye)throw new Error("bad seed size");for(var S=new Uint8Array(Ne),C=new Uint8Array(qt),p=0;p<32;p++)C[p]=w[p];return Kt(S,C,!0),{publicKey:S,secretKey:C}},t.sign.publicKeyLength=Ne,t.sign.secretKeyLength=qt,t.sign.seedLength=Ye,t.sign.signatureLength=Re,t.hash=function(w){wt(w);var S=new Uint8Array(Et);return tt(S,w,w.length),S},t.hash.hashLength=Et,t.verify=function(w,S){return wt(w,S),w.length===0||S.length===0||w.length!==S.length?!1:v(w,0,S,0,w.length)===0},t.setPRNG=function(w){i=w},function(){var w=typeof self<"u"?self.crypto||self.msCrypto:null;if(w&&w.getRandomValues){var S=65536;t.setPRNG(function(C,p){var I,Z=new Uint8Array(p);for(I=0;I<p;I+=S)w.getRandomValues(Z.subarray(I,I+Math.min(p-I,S)));for(I=0;I<p;I++)C[I]=Z[I];Cn(Z)})}else typeof vw<"u"&&(w=np,w&&w.randomBytes&&t.setPRNG(function(C,p){var I,Z=w.randomBytes(p);for(I=0;I<p;I++)C[I]=Z[I];Cn(Z)}))}()})(e.exports?e.exports:self.nacl=self.nacl||{})})(Cw);var yi={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.output=Nn.exists=Nn.hash=Nn.bytes=Nn.bool=Nn.number=void 0;function yc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}Nn.number=yc;function sp(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}Nn.bool=sp;function zd(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}Nn.bytes=zd;function op(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yc(e.outputLen),yc(e.blockLen)}Nn.hash=op;function rp(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}Nn.exists=rp;function ap(e,t){zd(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Nn.output=ap;const Bw={number:yc,bool:sp,bytes:zd,hash:op,exists:rp,output:ap};Nn.default=Bw;var tr={},cp={},uo={},Hc={};Object.defineProperty(Hc,"__esModule",{value:!0});Hc.crypto=void 0;Hc.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=Hc,n=P=>new Uint8Array(P.buffer,P.byteOffset,P.byteLength);e.u8=n;const i=P=>new Uint32Array(P.buffer,P.byteOffset,Math.floor(P.byteLength/4));e.u32=i;const s=P=>new DataView(P.buffer,P.byteOffset,P.byteLength);e.createView=s;const o=(P,B)=>P<<32-B|P>>>B;if(e.rotr=o,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(P,B)=>B.toString(16).padStart(2,"0"));function a(P){if(!(P instanceof Uint8Array))throw new Error("Uint8Array expected");let B="";for(let W=0;W<P.length;W++)B+=r[P[W]];return B}e.bytesToHex=a;function c(P){if(typeof P!="string")throw new TypeError("hexToBytes: expected string, got "+typeof P);if(P.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const B=new Uint8Array(P.length/2);for(let W=0;W<B.length;W++){const Q=W*2,V=P.slice(Q,Q+2),ee=Number.parseInt(V,16);if(Number.isNaN(ee)||ee<0)throw new Error("Invalid byte sequence");B[W]=ee}return B}e.hexToBytes=c;const u=async()=>{};e.nextTick=u;async function l(P,B,W){let Q=Date.now();for(let V=0;V<P;V++){W(V);const ee=Date.now()-Q;ee>=0&&ee<B||(await(0,e.nextTick)(),Q+=ee)}}e.asyncLoop=l;function d(P){if(typeof P!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof P}`);return new TextEncoder().encode(P)}e.utf8ToBytes=d;function h(P){if(typeof P=="string"&&(P=d(P)),!(P instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof P})`);return P}e.toBytes=h;function g(...P){if(!P.every(Q=>Q instanceof Uint8Array))throw new Error("Uint8Array list expected");if(P.length===1)return P[0];const B=P.reduce((Q,V)=>Q+V.length,0),W=new Uint8Array(B);for(let Q=0,V=0;Q<P.length;Q++){const ee=P[Q];W.set(ee,V),V+=ee.length}return W}e.concatBytes=g;class b{clone(){return this._cloneInto()}}e.Hash=b;const v=P=>Object.prototype.toString.call(P)==="[object Object]"&&P.constructor===Object;function k(P,B){if(B!==void 0&&(typeof B!="object"||!v(B)))throw new TypeError("Options should be object or undefined");return Object.assign(P,B)}e.checkOpts=k;function E(P){const B=Q=>P().update(h(Q)).digest(),W=P();return B.outputLen=W.outputLen,B.blockLen=W.blockLen,B.create=()=>P(),B}e.wrapConstructor=E;function N(P){const B=(Q,V)=>P(V).update(h(Q)).digest(),W=P({});return B.outputLen=W.outputLen,B.blockLen=W.blockLen,B.create=Q=>P(Q),B}e.wrapConstructorWithOpts=N;function A(P=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(P));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(P).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=A})(uo);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;const t=Nn,n=uo;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,t.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return t.default.exists(this),this.iHash.update(r),this}digestInto(r){t.default.exists(this),t.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:h}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=h,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();e.hmac=s,e.hmac.create=(o,r)=>new i(o,r)})(cp);Object.defineProperty(tr,"__esModule",{value:!0});tr.pbkdf2Async=tr.pbkdf2=void 0;const La=Nn,Iw=cp,Vo=uo;function up(e,t,n,i){La.default.hash(e);const s=(0,Vo.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(La.default.number(o),La.default.number(r),La.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Vo.toBytes)(t),u=(0,Vo.toBytes)(n),l=new Uint8Array(r),d=Iw.hmac.create(e,c),h=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:h}}function lp(e,t,n,i,s){return e.destroy(),t.destroy(),i&&i.destroy(),s.fill(0),n}function Ow(e,t,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=up(e,t,n,i);let u;const l=new Uint8Array(4),d=(0,Vo.createView)(l),h=new Uint8Array(a.outputLen);for(let g=1,b=0;b<o;g++,b+=a.outputLen){const v=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(h),v.set(h.subarray(0,v.length));for(let k=1;k<s;k++){a._cloneInto(u).update(h).digestInto(h);for(let E=0;E<v.length;E++)v[E]^=h[E]}}return lp(a,c,r,u,h)}tr.pbkdf2=Ow;async function Rw(e,t,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=up(e,t,n,i);let l;const d=new Uint8Array(4),h=(0,Vo.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,v=0;v<o;b++,v+=c.outputLen){const k=a.subarray(v,v+c.outputLen);h.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),k.set(g.subarray(0,k.length)),await(0,Vo.asyncLoop)(s-1,r,E=>{c._cloneInto(l).update(g).digestInto(g);for(let N=0;N<k.length;N++)k[N]^=g[N]})}return lp(c,u,a,l,g)}tr.pbkdf2Async=Rw;var nr={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.SHA2=void 0;const cl=Nn,Lr=uo;function $w(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let Uw=class extends Lr.Hash{constructor(t,n,i,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Lr.createView)(this.buffer)}update(t){cl.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;t=(0,Lr.toBytes)(t);const o=t.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,Lr.createView)(t);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){cl.default.exists(this),cl.default.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;$w(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,Lr.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=r,s%n&&t.buffer.set(i),t}};ha.SHA2=Uw;Object.defineProperty(nr,"__esModule",{value:!0});nr.sha224=nr.sha256=void 0;const qw=ha,ki=uo,Lw=(e,t,n)=>e&t^~e&n,Dw=(e,t,n)=>e&t^e&n^t&n,Mw=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ps=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gs=new Uint32Array(64);let dp=class extends qw.SHA2{constructor(){super(64,32,8,!1),this.A=ps[0]|0,this.B=ps[1]|0,this.C=ps[2]|0,this.D=ps[3]|0,this.E=ps[4]|0,this.F=ps[5]|0,this.G=ps[6]|0,this.H=ps[7]|0}get(){const{A:t,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[t,n,i,s,o,r,a,c]}set(t,n,i,s,o,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)gs[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=gs[d-15],g=gs[d-2],b=(0,ki.rotr)(h,7)^(0,ki.rotr)(h,18)^h>>>3,v=(0,ki.rotr)(g,17)^(0,ki.rotr)(g,19)^g>>>10;gs[d]=v+gs[d-7]+b+gs[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=(0,ki.rotr)(a,6)^(0,ki.rotr)(a,11)^(0,ki.rotr)(a,25),g=l+h+Lw(a,c,u)+Mw[d]+gs[d]|0,v=((0,ki.rotr)(i,2)^(0,ki.rotr)(i,13)^(0,ki.rotr)(i,22))+Dw(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){gs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Nw=class extends dp{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};nr.sha256=(0,ki.wrapConstructor)(()=>new dp);nr.sha224=(0,ki.wrapConstructor)(()=>new Nw);var Ri={},hp={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),n=BigInt(32);function i(j,R=!1){return R?{h:Number(j&t),l:Number(j>>n&t)}:{h:Number(j>>n&t)|0,l:Number(j&t)|0}}e.fromBig=i;function s(j,R=!1){let U=new Uint32Array(j.length),x=new Uint32Array(j.length);for(let f=0;f<j.length;f++){const{h:m,l:T}=i(j[f],R);[U[f],x[f]]=[m,T]}return[U,x]}e.split=s;const o=(j,R)=>BigInt(j>>>0)<<n|BigInt(R>>>0);e.toBig=o;const r=(j,R,U)=>j>>>U,a=(j,R,U)=>j<<32-U|R>>>U,c=(j,R,U)=>j>>>U|R<<32-U,u=(j,R,U)=>j<<32-U|R>>>U,l=(j,R,U)=>j<<64-U|R>>>U-32,d=(j,R,U)=>j>>>U-32|R<<64-U,h=(j,R)=>R,g=(j,R)=>j,b=(j,R,U)=>j<<U|R>>>32-U,v=(j,R,U)=>R<<U|j>>>32-U,k=(j,R,U)=>R<<U-32|j>>>64-U,E=(j,R,U)=>j<<U-32|R>>>64-U;function N(j,R,U,x){const f=(R>>>0)+(x>>>0);return{h:j+U+(f/2**32|0)|0,l:f|0}}e.add=N;const A=(j,R,U)=>(j>>>0)+(R>>>0)+(U>>>0),P=(j,R,U,x)=>R+U+x+(j/2**32|0)|0,B=(j,R,U,x)=>(j>>>0)+(R>>>0)+(U>>>0)+(x>>>0),W=(j,R,U,x,f)=>R+U+x+f+(j/2**32|0)|0,Q=(j,R,U,x,f)=>(j>>>0)+(R>>>0)+(U>>>0)+(x>>>0)+(f>>>0),V=(j,R,U,x,f,m)=>R+U+x+f+m+(j/2**32|0)|0,ee={fromBig:i,split:s,toBig:e.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:h,rotr32L:g,rotlSH:b,rotlSL:v,rotlBH:k,rotlBL:E,add:N,add3L:A,add3H:P,add4L:B,add4H:W,add5H:V,add5L:Q};e.default=ee})(hp);Object.defineProperty(Ri,"__esModule",{value:!0});Ri.sha384=Ri.sha512_256=Ri.sha512_224=Ri.sha512=Ri.SHA512=void 0;const Fw=ha,zt=hp,Kc=uo,[jw,zw]=zt.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),_s=new Uint32Array(80),ms=new Uint32Array(80);let fa=class extends Fw.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:k}=this;return[t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k]}set(t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=k|0}process(t,n){for(let A=0;A<16;A++,n+=4)_s[A]=t.getUint32(n),ms[A]=t.getUint32(n+=4);for(let A=16;A<80;A++){const P=_s[A-15]|0,B=ms[A-15]|0,W=zt.default.rotrSH(P,B,1)^zt.default.rotrSH(P,B,8)^zt.default.shrSH(P,B,7),Q=zt.default.rotrSL(P,B,1)^zt.default.rotrSL(P,B,8)^zt.default.shrSL(P,B,7),V=_s[A-2]|0,ee=ms[A-2]|0,j=zt.default.rotrSH(V,ee,19)^zt.default.rotrBH(V,ee,61)^zt.default.shrSH(V,ee,6),R=zt.default.rotrSL(V,ee,19)^zt.default.rotrBL(V,ee,61)^zt.default.shrSL(V,ee,6),U=zt.default.add4L(Q,R,ms[A-7],ms[A-16]),x=zt.default.add4H(U,W,j,_s[A-7],_s[A-16]);_s[A]=x|0,ms[A]=U|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:k,Hh:E,Hl:N}=this;for(let A=0;A<80;A++){const P=zt.default.rotrSH(d,h,14)^zt.default.rotrSH(d,h,18)^zt.default.rotrBH(d,h,41),B=zt.default.rotrSL(d,h,14)^zt.default.rotrSL(d,h,18)^zt.default.rotrBL(d,h,41),W=d&g^~d&v,Q=h&b^~h&k,V=zt.default.add5L(N,B,Q,zw[A],ms[A]),ee=zt.default.add5H(V,E,P,W,jw[A],_s[A]),j=V|0,R=zt.default.rotrSH(i,s,28)^zt.default.rotrBH(i,s,34)^zt.default.rotrBH(i,s,39),U=zt.default.rotrSL(i,s,28)^zt.default.rotrBL(i,s,34)^zt.default.rotrBL(i,s,39),x=i&o^i&a^o&a,f=s&r^s&c^r&c;E=v|0,N=k|0,v=g|0,k=b|0,g=d|0,b=h|0,{h:d,l:h}=zt.default.add(u|0,l|0,ee|0,j|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=zt.default.add3L(j,U,f);i=zt.default.add3H(m,ee,R,x),s=m|0}({h:i,l:s}=zt.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=zt.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=zt.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=zt.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=zt.default.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=zt.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:k}=zt.default.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:E,l:N}=zt.default.add(this.Hh|0,this.Hl|0,E|0,N|0),this.set(i,s,o,r,a,c,u,l,d,h,g,b,v,k,E,N)}roundClean(){_s.fill(0),ms.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Ri.SHA512=fa;let Hw=class extends fa{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},Kw=class extends fa{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Gw=class extends fa{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};Ri.sha512=(0,Kc.wrapConstructor)(()=>new fa);Ri.sha512_224=(0,Kc.wrapConstructor)(()=>new Hw);Ri.sha512_256=(0,Kc.wrapConstructor)(()=>new Kw);Ri.sha384=(0,Kc.wrapConstructor)(()=>new Gw);var Hd={};(function(e){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64urlnopad=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t(R){if(!Number.isSafeInteger(R))throw new Error(`Wrong integer: ${R}`)}e.assertNumber=t;function n(...R){const U=(m,T)=>$=>m(T($)),x=Array.from(R).reverse().reduce((m,T)=>m?U(m,T.encode):T.encode,void 0),f=R.reduce((m,T)=>m?U(m,T.decode):T.decode,void 0);return{encode:x,decode:f}}function i(R){return{encode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return U.map(x=>{if(x<0||x>=R.length)throw new Error(`Digit index outside alphabet: ${x} (alphabet: ${R.length})`);return R[x]})},decode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="string")throw new Error("alphabet.decode input should be array of strings");return U.map(x=>{if(typeof x!="string")throw new Error(`alphabet.decode: not string element=${x}`);const f=R.indexOf(x);if(f===-1)throw new Error(`Unknown letter: "${x}". Allowed: ${R}`);return f})}}}function s(R=""){if(typeof R!="string")throw new Error("join separator should be string");return{encode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="string")throw new Error("join.encode input should be array of strings");for(let x of U)if(typeof x!="string")throw new Error(`join.encode: non-string input=${x}`);return U.join(R)},decode:U=>{if(typeof U!="string")throw new Error("join.decode input should be string");return U.split(R)}}}function o(R,U="="){if(typeof U!="string")throw new Error("padding chr should be string");return{encode(x){if(!Array.isArray(x)||x.length&&typeof x[0]!="string")throw new Error("padding.encode input should be array of strings");for(let f of x)if(typeof f!="string")throw new Error(`padding.encode: non-string input=${f}`);for(;x.length*R%8;)x.push(U);return x},decode(x){if(!Array.isArray(x)||x.length&&typeof x[0]!="string")throw new Error("padding.encode input should be array of strings");for(let m of x)if(typeof m!="string")throw new Error(`padding.decode: non-string input=${m}`);let f=x.length;if(f*R%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;f>0&&x[f-1]===U;f--)if(!((f-1)*R%8))throw new Error("Invalid padding: string has too much padding");return x.slice(0,f)}}}function r(R){if(typeof R!="function")throw new Error("normalize fn should be function");return{encode:U=>U,decode:U=>R(U)}}function a(R,U,x){if(U<2)throw new Error(`convertRadix: wrong from=${U}, base cannot be less than 2`);if(x<2)throw new Error(`convertRadix: wrong to=${x}, base cannot be less than 2`);if(!Array.isArray(R))throw new Error("convertRadix: data should be array");if(!R.length)return[];let f=0;const m=[],T=Array.from(R);for(T.forEach($=>{if($<0||$>=U)throw new Error(`Wrong integer: ${$}`)});;){let $=0,M=!0;for(let z=f;z<T.length;z++){const J=T[z],O=U*$+J;if(!Number.isSafeInteger(O)||U*$/U!==$||O-J!==U*$)throw new Error("convertRadix: carry overflow");$=O%x;const _=Math.floor(O/x);if(T[z]=_,!Number.isSafeInteger(_)||_*x+$!==O)throw new Error("convertRadix: carry overflow");if(M)_?M=!1:f=z;else continue}if(m.push($),M)break}for(let $=0;$<R.length-1&&R[$]===0;$++)m.push(0);return m.reverse()}const c=(R,U)=>U?c(U,R%U):R,u=(R,U)=>R+(U-c(R,U));function l(R,U,x,f){if(!Array.isArray(R))throw new Error("convertRadix2: data should be array");if(U<=0||U>32)throw new Error(`convertRadix2: wrong from=${U}`);if(x<=0||x>32)throw new Error(`convertRadix2: wrong to=${x}`);if(u(U,x)>32)throw new Error(`convertRadix2: carry overflow from=${U} to=${x} carryBits=${u(U,x)}`);let m=0,T=0;const $=2**x-1,M=[];for(const z of R){if(z>=2**U)throw new Error(`convertRadix2: invalid data word=${z} from=${U}`);if(m=m<<U|z,T+U>32)throw new Error(`convertRadix2: carry overflow pos=${T} from=${U}`);for(T+=U;T>=x;T-=x)M.push((m>>T-x&$)>>>0);m&=2**T-1}if(m=m<<x-T&$,!f&&T>=U)throw new Error("Excess padding");if(!f&&m)throw new Error(`Non-zero padding: ${m}`);return f&&T>0&&M.push(m>>>0),M}function d(R){return{encode:U=>{if(!(U instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(U),2**8,R)},decode:U=>{if(!Array.isArray(U)||U.length&&typeof U[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(U,R,2**8))}}}function h(R,U=!1){if(R<=0||R>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,R)>32||u(R,8)>32)throw new Error("radix2: carry overflow");return{encode:x=>{if(!(x instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(x),8,R,!U)},decode:x=>{if(!Array.isArray(x)||x.length&&typeof x[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(x,R,8,U))}}}function g(R){if(typeof R!="function")throw new Error("unsafeWrapper fn should be function");return function(...U){try{return R.apply(null,U)}catch{}}}function b(R,U){if(typeof U!="function")throw new Error("checksum fn should be function");return{encode(x){if(!(x instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const f=U(x).slice(0,R),m=new Uint8Array(x.length+R);return m.set(x),m.set(f,x.length),m},decode(x){if(!(x instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const f=x.slice(0,-R),m=U(f).slice(0,R),T=x.slice(-R);for(let $=0;$<R;$++)if(m[$]!==T[$])throw new Error("Invalid checksum");return f}}}e.utils={alphabet:i,chain:n,checksum:b,radix:d,radix2:h,join:s,padding:o},e.base16=n(h(4),i("0123456789ABCDEF"),s("")),e.base32=n(h(5),i("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o(5),s("")),e.base32hex=n(h(5),i("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o(5),s("")),e.base32crockford=n(h(5),i("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),s(""),r(R=>R.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o(6),s("")),e.base64url=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(6),s("")),e.base64urlnopad=n(h(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),s(""));const v=R=>n(d(58),i(R),s(""));e.base58=v("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=v("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=v("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const k=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(R){let U="";for(let x=0;x<R.length;x+=8){const f=R.subarray(x,x+8);U+=e.base58.encode(f).padStart(k[f.length],"1")}return U},decode(R){let U=[];for(let x=0;x<R.length;x+=11){const f=R.slice(x,x+11),m=k.indexOf(f.length),T=e.base58.decode(f);for(let $=0;$<T.length-m;$++)if(T[$]!==0)throw new Error("base58xmr: wrong padding");U=U.concat(Array.from(T.slice(T.length-m)))}return Uint8Array.from(U)}};const E=R=>n(b(4,U=>R(R(U))),e.base58);e.base58check=E;const N=n(i("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),s("")),A=[996825010,642813549,513874426,1027748829,705979059];function P(R){const U=R>>25;let x=(R&33554431)<<5;for(let f=0;f<A.length;f++)(U>>f&1)===1&&(x^=A[f]);return x}function B(R,U,x=1){const f=R.length;let m=1;for(let T=0;T<f;T++){const $=R.charCodeAt(T);if($<33||$>126)throw new Error(`Invalid prefix (${R})`);m=P(m)^$>>5}m=P(m);for(let T=0;T<f;T++)m=P(m)^R.charCodeAt(T)&31;for(let T of U)m=P(m)^T;for(let T=0;T<6;T++)m=P(m);return m^=x,N.encode(l([m%2**30],30,5,!1))}function W(R){const U=R==="bech32"?1:734539939,x=h(5),f=x.decode,m=x.encode,T=g(f);function $(O,_,q=90){if(typeof O!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof O}`);if(!Array.isArray(_)||_.length&&typeof _[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof _}`);const ve=O.length+7+_.length;if(q!==!1&&ve>q)throw new TypeError(`Length ${ve} exceeds limit ${q}`);const ue=O.toLowerCase(),xe=B(ue,_,U);return`${ue}1${N.encode(_)}${xe}`}function M(O,_=90){if(typeof O!="string")throw new Error(`bech32.decode input should be string, not ${typeof O}`);if(O.length<8||_!==!1&&O.length>_)throw new TypeError(`Wrong string length: ${O.length} (${O}). Expected (8..${_})`);const q=O.toLowerCase();if(O!==q&&O!==O.toUpperCase())throw new Error("String must be lowercase or uppercase");O=q;const ve=O.lastIndexOf("1");if(ve===0||ve===-1)throw new Error('Letter "1" must be present between prefix and data only');const ue=O.slice(0,ve),xe=O.slice(ve+1);if(xe.length<6)throw new Error("Data must be at least 6 characters long");const lt=N.decode(xe).slice(0,-6),Qe=B(ue,lt,U);if(!xe.endsWith(Qe))throw new Error(`Invalid checksum in ${O}: expected "${Qe}"`);return{prefix:ue,words:lt}}const z=g(M);function J(O){const{prefix:_,words:q}=M(O,!1);return{prefix:_,words:q,bytes:f(q)}}return{encode:$,decode:M,decodeToBytes:J,decodeUnsafe:z,fromWords:f,fromWordsUnsafe:T,toWords:m}}e.bech32=W("bech32"),e.bech32m=W("bech32m"),e.utf8={encode:R=>new TextDecoder().decode(R),decode:R=>new TextEncoder().encode(R)},e.hex=n(h(4),i("0123456789abcdef"),s(""),r(R=>{if(typeof R!="string"||R.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof R} with length ${R.length}`);return R.toLowerCase()}));const Q={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},V="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",ee=(R,U)=>{if(typeof R!="string"||!Q.hasOwnProperty(R))throw new TypeError(V);if(!(U instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Q[R].encode(U)};e.bytesToString=ee,e.str=e.bytesToString;const j=(R,U)=>{if(!Q.hasOwnProperty(R))throw new TypeError(V);if(typeof U!="string")throw new TypeError("stringToBytes() expects string");return Q[R].decode(U)};e.stringToBytes=j,e.bytes=e.stringToBytes})(Hd);Object.defineProperty(yi,"__esModule",{value:!0});var fp=yi.mnemonicToSeedSync=yi.mnemonicToSeed=yi.validateMnemonic=yi.entropyToMnemonic=yi.mnemonicToEntropy=yi.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const pp=Nn,gp=tr,Ww=nr,_p=Ri,Vw=uo,Da=Hd,Xw=e=>e[0]==="";function mp(e){if(typeof e!="string")throw new TypeError(`Invalid mnemonic type: ${typeof e}`);return e.normalize("NFKD")}function Kd(e){const t=mp(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function yp(e){pp.default.bytes(e,16,20,24,28,32)}function Jw(e,t=128){if(pp.default.number(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return vp((0,Vw.randomBytes)(t/8),e)}yi.generateMnemonic=Jw;const Zw=e=>{const t=8-e.length/4;return new Uint8Array([(0,Ww.sha256)(e)[0]>>t<<t])};function wp(e){if(!Array.isArray(e)||e.length!==2**11||typeof e[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error(`Wordlist: non-string element: ${t}`)}),Da.utils.chain(Da.utils.checksum(1,Zw),Da.utils.radix2(11,!0),Da.utils.alphabet(e))}function bp(e,t){const{words:n}=Kd(e),i=wp(t).decode(n);return yp(i),i}yi.mnemonicToEntropy=bp;function vp(e,t){return yp(e),wp(t).encode(e).join(Xw(t)?"":" ")}yi.entropyToMnemonic=vp;function Yw(e,t){try{bp(e,t)}catch{return!1}return!0}yi.validateMnemonic=Yw;const xp=e=>mp(`mnemonic${e}`);function Qw(e,t=""){return(0,gp.pbkdf2Async)(_p.sha512,Kd(e).nfkd,xp(t),{c:2048,dkLen:64})}yi.mnemonicToSeed=Qw;function eb(e,t=""){return(0,gp.pbkdf2)(_p.sha512,Kd(e).nfkd,xp(t),{c:2048,dkLen:64})}fp=yi.mnemonicToSeedSync=eb;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tb=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ul=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ji=(e,t)=>e<<32-t|e>>>t,nb=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!nb)throw new Error("Non little-endian hardware is not supported");const ib=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Tp(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=ib[e[n]];return t}function Ap(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const i=n*2,s=e.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function sb(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function pa(e){if(typeof e=="string"&&(e=sb(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}let Gd=class{clone(){return this._cloneInto()}};function ga(e){const t=i=>e().update(pa(i)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ob(e){const t=(i,s)=>e(s).update(pa(i)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=i=>e(i),t}function ud(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function rb(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function kp(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function ab(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ud(e.outputLen),ud(e.blockLen)}function cb(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ub(e,t){kp(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const wi={number:ud,bool:rb,bytes:kp,hash:ab,exists:cb,output:ub};function lb(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let Sp=class extends Gd{constructor(t,n,i,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ul(this.buffer)}update(t){wi.exists(this);const{view:n,buffer:i,blockLen:s}=this;t=pa(t);const o=t.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=ul(t);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){wi.exists(this),wi.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;lb(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=ul(t);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=r,s%n&&t.buffer.set(i),t}};const db=(e,t,n)=>e&t^~e&n,hb=(e,t,n)=>e&t^e&n^t&n,fb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ys=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ws=new Uint32Array(64);let pb=class extends Sp{constructor(){super(64,32,8,!1),this.A=ys[0]|0,this.B=ys[1]|0,this.C=ys[2]|0,this.D=ys[3]|0,this.E=ys[4]|0,this.F=ys[5]|0,this.G=ys[6]|0,this.H=ys[7]|0}get(){const{A:t,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[t,n,i,s,o,r,a,c]}set(t,n,i,s,o,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)ws[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=ws[d-15],g=ws[d-2],b=Ji(h,7)^Ji(h,18)^h>>>3,v=Ji(g,17)^Ji(g,19)^g>>>10;ws[d]=v+ws[d-7]+b+ws[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=Ji(a,6)^Ji(a,11)^Ji(a,25),g=l+h+db(a,c,u)+fb[d]+ws[d]|0,v=(Ji(i,2)^Ji(i,13)^Ji(i,22))+hb(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){ws.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const gb=ga(()=>new pb),Ma=BigInt(2**32-1),ld=BigInt(32);function Pp(e,t=!1){return t?{h:Number(e&Ma),l:Number(e>>ld&Ma)}:{h:Number(e>>ld&Ma)|0,l:Number(e&Ma)|0}}function _b(e,t=!1){let n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:r}=Pp(e[s],t);[n[s],i[s]]=[o,r]}return[n,i]}const mb=(e,t)=>BigInt(e>>>0)<<ld|BigInt(t>>>0),yb=(e,t,n)=>e>>>n,wb=(e,t,n)=>e<<32-n|t>>>n,bb=(e,t,n)=>e>>>n|t<<32-n,vb=(e,t,n)=>e<<32-n|t>>>n,xb=(e,t,n)=>e<<64-n|t>>>n-32,Tb=(e,t,n)=>e>>>n-32|t<<64-n,Ab=(e,t)=>t,kb=(e,t)=>e,Sb=(e,t,n)=>e<<n|t>>>32-n,Pb=(e,t,n)=>t<<n|e>>>32-n,Eb=(e,t,n)=>t<<n-32|e>>>64-n,Cb=(e,t,n)=>e<<n-32|t>>>64-n;function Bb(e,t,n,i){const s=(t>>>0)+(i>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const Ib=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ob=(e,t,n,i)=>t+n+i+(e/2**32|0)|0,Rb=(e,t,n,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),$b=(e,t,n,i,s)=>t+n+i+s+(e/2**32|0)|0,Ub=(e,t,n,i,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0)+(s>>>0),qb=(e,t,n,i,s,o)=>t+n+i+s+o+(e/2**32|0)|0,Bt={fromBig:Pp,split:_b,toBig:mb,shrSH:yb,shrSL:wb,rotrSH:bb,rotrSL:vb,rotrBH:xb,rotrBL:Tb,rotr32H:Ab,rotr32L:kb,rotlSH:Sb,rotlSL:Pb,rotlBH:Eb,rotlBL:Cb,add:Bb,add3L:Ib,add3H:Ob,add4L:Rb,add4H:$b,add5H:qb,add5L:Ub},[Ep,Cp,Bp]=[[],[],[]],Lb=BigInt(0),Dr=BigInt(1),Db=BigInt(2),Mb=BigInt(7),Nb=BigInt(256),Fb=BigInt(113);for(let e=0,t=Dr,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],Ep.push(2*(5*i+n)),Cp.push((e+1)*(e+2)/2%64);let s=Lb;for(let o=0;o<7;o++)t=(t<<Dr^(t>>Mb)*Fb)%Nb,t&Db&&(s^=Dr<<(Dr<<BigInt(o))-Dr);Bp.push(s)}const[jb,zb]=Bt.split(Bp,!0),tf=(e,t,n)=>n>32?Bt.rotlBH(e,t,n):Bt.rotlSH(e,t,n),nf=(e,t,n)=>n>32?Bt.rotlBL(e,t,n):Bt.rotlSL(e,t,n);function Hb(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=tf(u,l,1)^n[a],h=nf(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)e[r+g]^=d,e[r+g+1]^=h}let s=e[2],o=e[3];for(let r=0;r<24;r++){const a=Cp[r],c=tf(s,o,a),u=nf(s,o,a),l=Ep[r];s=e[l],o=e[l+1],e[l]=c,e[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=e[r+a];for(let a=0;a<10;a++)e[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=jb[i],e[1]^=zb[i]}n.fill(0)}let Ip=class Op extends Gd{constructor(t,n,i,s=!1,o=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,wi.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=tb(this.state)}keccak(){Hb(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){wi.exists(this);const{blockLen:n,state:i}=this;t=pa(t);const s=t.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:s}=this;t[i]^=n,n&128&&i===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){wi.exists(this,!1),wi.bytes(t),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=t.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return wi.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(wi.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return t||(t=new Op(n,i,s,r,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=i,t.outputLen=s,t.enableXOF=r,t.destroyed=this.destroyed,t}};const zs=(e,t,n)=>ga(()=>new Ip(t,e,n));zs(6,144,224/8);const ir=zs(6,136,256/8);zs(6,104,384/8);zs(6,72,512/8);zs(1,144,224/8);zs(1,136,256/8);zs(1,104,384/8);zs(1,72,512/8);const Rp=(e,t,n)=>ob((i={})=>new Ip(t,e,i.dkLen===void 0?n:i.dkLen,!0));Rp(31,168,128/8);Rp(31,136,256/8);let $p=class extends Gd{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,wi.hash(t);const i=pa(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?t.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=t.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(t){return wi.exists(this),this.iHash.update(t),this}digestInto(t){wi.exists(this),wi.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=r,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Wd=(e,t,n)=>new $p(e,t).update(n).digest();Wd.create=(e,t)=>new $p(e,t);const[Kb,Gb]=Bt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),bs=new Uint32Array(80),vs=new Uint32Array(80);let Vd=class extends Sp{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:k}=this;return[t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k]}set(t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=k|0}process(t,n){for(let A=0;A<16;A++,n+=4)bs[A]=t.getUint32(n),vs[A]=t.getUint32(n+=4);for(let A=16;A<80;A++){const P=bs[A-15]|0,B=vs[A-15]|0,W=Bt.rotrSH(P,B,1)^Bt.rotrSH(P,B,8)^Bt.shrSH(P,B,7),Q=Bt.rotrSL(P,B,1)^Bt.rotrSL(P,B,8)^Bt.shrSL(P,B,7),V=bs[A-2]|0,ee=vs[A-2]|0,j=Bt.rotrSH(V,ee,19)^Bt.rotrBH(V,ee,61)^Bt.shrSH(V,ee,6),R=Bt.rotrSL(V,ee,19)^Bt.rotrBL(V,ee,61)^Bt.shrSL(V,ee,6),U=Bt.add4L(Q,R,vs[A-7],vs[A-16]),x=Bt.add4H(U,W,j,bs[A-7],bs[A-16]);bs[A]=x|0,vs[A]=U|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:k,Hh:E,Hl:N}=this;for(let A=0;A<80;A++){const P=Bt.rotrSH(d,h,14)^Bt.rotrSH(d,h,18)^Bt.rotrBH(d,h,41),B=Bt.rotrSL(d,h,14)^Bt.rotrSL(d,h,18)^Bt.rotrBL(d,h,41),W=d&g^~d&v,Q=h&b^~h&k,V=Bt.add5L(N,B,Q,Gb[A],vs[A]),ee=Bt.add5H(V,E,P,W,Kb[A],bs[A]),j=V|0,R=Bt.rotrSH(i,s,28)^Bt.rotrBH(i,s,34)^Bt.rotrBH(i,s,39),U=Bt.rotrSL(i,s,28)^Bt.rotrBL(i,s,34)^Bt.rotrBL(i,s,39),x=i&o^i&a^o&a,f=s&r^s&c^r&c;E=v|0,N=k|0,v=g|0,k=b|0,g=d|0,b=h|0,{h:d,l:h}=Bt.add(u|0,l|0,ee|0,j|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Bt.add3L(j,U,f);i=Bt.add3H(m,ee,R,x),s=m|0}({h:i,l:s}=Bt.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Bt.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Bt.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Bt.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Bt.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=Bt.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:k}=Bt.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:E,l:N}=Bt.add(this.Hh|0,this.Hl|0,E|0,N|0),this.set(i,s,o,r,a,c,u,l,d,h,g,b,v,k,E,N)}roundClean(){bs.fill(0),vs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Wb=class extends Vd{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Vb=class extends Vd{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const Up=ga(()=>new Vd);ga(()=>new Wb);ga(()=>new Vb);var dd={},Xb={get exports(){return dd},set exports(e){dd=e}},wc={},Jb={get exports(){return wc},set exports(e){wc=e}},qp=function(t,n){return function(){for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];return t.apply(n,s)}},Zb=qp,Xd=Object.prototype.toString,Jd=function(e){return function(t){var n=Xd.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function lo(e){return e=e.toLowerCase(),function(n){return Jd(n)===e}}function Zd(e){return Array.isArray(e)}function bc(e){return typeof e>"u"}function Yb(e){return e!==null&&!bc(e)&&e.constructor!==null&&!bc(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var Lp=lo("ArrayBuffer");function Qb(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Lp(e.buffer),t}function ev(e){return typeof e=="string"}function tv(e){return typeof e=="number"}function Dp(e){return e!==null&&typeof e=="object"}function Ya(e){if(Jd(e)!=="object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}var nv=lo("Date"),iv=lo("File"),sv=lo("Blob"),ov=lo("FileList");function Yd(e){return Xd.call(e)==="[object Function]"}function rv(e){return Dp(e)&&Yd(e.pipe)}function av(e){var t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||Xd.call(e)===t||Yd(e.toString)&&e.toString()===t)}var cv=lo("URLSearchParams");function uv(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function lv(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Qd(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),Zd(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function hd(){var e={};function t(s,o){Ya(e[o])&&Ya(s)?e[o]=hd(e[o],s):Ya(s)?e[o]=hd({},s):Zd(s)?e[o]=s.slice():e[o]=s}for(var n=0,i=arguments.length;n<i;n++)Qd(arguments[n],t);return e}function dv(e,t,n){return Qd(t,function(s,o){n&&typeof s=="function"?e[o]=Zb(s,n):e[o]=s}),e}function hv(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function fv(e,t,n,i){e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)}function pv(e,t,n){var i,s,o,r={};t=t||{};do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],r[o]||(t[o]=e[o],r[o]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t}function gv(e,t,n){e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;var i=e.indexOf(t,n);return i!==-1&&i===n}function _v(e){if(!e)return null;var t=e.length;if(bc(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n}var mv=function(e){return function(t){return e&&t instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),Zn={isArray:Zd,isArrayBuffer:Lp,isBuffer:Yb,isFormData:av,isArrayBufferView:Qb,isString:ev,isNumber:tv,isObject:Dp,isPlainObject:Ya,isUndefined:bc,isDate:nv,isFile:iv,isBlob:sv,isFunction:Yd,isStream:rv,isURLSearchParams:cv,isStandardBrowserEnv:lv,forEach:Qd,merge:hd,extend:dv,trim:uv,stripBOM:hv,inherits:fv,toFlatObject:pv,kindOf:Jd,kindOfTest:lo,endsWith:gv,toArray:_v,isTypedArray:mv,isFileList:ov},Po=Zn;function sf(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Mp=function(t,n,i){if(!n)return t;var s;if(i)s=i(n);else if(Po.isURLSearchParams(n))s=n.toString();else{var o=[];Po.forEach(n,function(c,u){c===null||typeof c>"u"||(Po.isArray(c)?u=u+"[]":c=[c],Po.forEach(c,function(d){Po.isDate(d)?d=d.toISOString():Po.isObject(d)&&(d=JSON.stringify(d)),o.push(sf(u)+"="+sf(d))}))}),s=o.join("&")}if(s){var r=t.indexOf("#");r!==-1&&(t=t.slice(0,r)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t},yv=Zn;function Gc(){this.handlers=[]}Gc.prototype.use=function(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};Gc.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Gc.prototype.forEach=function(t){yv.forEach(this.handlers,function(i){i!==null&&t(i)})};var wv=Gc,bv=Zn,vv=function(t,n){bv.forEach(t,function(s,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(t[n]=s,delete t[o])})},Np=Zn;function sr(e,t,n,i,s){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}Np.inherits(sr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Fp=sr.prototype,jp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){jp[e]={value:e}});Object.defineProperties(sr,jp);Object.defineProperty(Fp,"isAxiosError",{value:!0});sr.from=function(e,t,n,i,s,o){var r=Object.create(Fp);return Np.toFlatObject(e,r,function(c){return c!==Error.prototype}),sr.call(r,e.message,t,n,i,s),r.name=e.name,o&&Object.assign(r,o),r};var xr=sr,zp={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Di=Zn;function xv(e,t){t=t||new FormData;var n=[];function i(o){return o===null?"":Di.isDate(o)?o.toISOString():Di.isArrayBuffer(o)||Di.isTypedArray(o)?typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function s(o,r){if(Di.isPlainObject(o)||Di.isArray(o)){if(n.indexOf(o)!==-1)throw Error("Circular reference detected in "+r);n.push(o),Di.forEach(o,function(c,u){if(!Di.isUndefined(c)){var l=r?r+"."+u:u,d;if(c&&!r&&typeof c=="object"){if(Di.endsWith(u,"{}"))c=JSON.stringify(c);else if(Di.endsWith(u,"[]")&&(d=Di.toArray(c))){d.forEach(function(h){!Di.isUndefined(h)&&t.append(l,i(h))});return}}s(c,l)}}),n.pop()}else t.append(r,i(o))}return s(e),t}var Hp=xv,ll,of;function Tv(){if(of)return ll;of=1;var e=xr;return ll=function(n,i,s){var o=s.config.validateStatus;!s.status||!o||o(s.status)?n(s):i(new e("Request failed with status code "+s.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))},ll}var dl,rf;function Av(){if(rf)return dl;rf=1;var e=Zn;return dl=e.isStandardBrowserEnv()?function(){return{write:function(i,s,o,r,a,c){var u=[];u.push(i+"="+encodeURIComponent(s)),e.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),e.isString(r)&&u.push("path="+r),e.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(i){var s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),dl}var kv=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},Sv=function(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t},Pv=kv,Ev=Sv,Kp=function(t,n){return t&&!Pv(n)?Ev(t,n):n},hl,af;function Cv(){if(af)return hl;af=1;var e=Zn,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return hl=function(i){var s={},o,r,a;return i&&e.forEach(i.split(`
`),function(u){if(a=u.indexOf(":"),o=e.trim(u.substr(0,a)).toLowerCase(),r=e.trim(u.substr(a+1)),o){if(s[o]&&t.indexOf(o)>=0)return;o==="set-cookie"?s[o]=(s[o]?s[o]:[]).concat([r]):s[o]=s[o]?s[o]+", "+r:r}}),s},hl}var fl,cf;function Bv(){if(cf)return fl;cf=1;var e=Zn;return fl=e.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),s;function o(r){var a=r;return n&&(i.setAttribute("href",a),a=i.href),i.setAttribute("href",a),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return s=o(window.location.href),function(a){var c=e.isString(a)?o(a):a;return c.protocol===s.protocol&&c.host===s.host}}():function(){return function(){return!0}}(),fl}var pl,uf;function Wc(){if(uf)return pl;uf=1;var e=xr,t=Zn;function n(i){e.call(this,i??"canceled",e.ERR_CANCELED),this.name="CanceledError"}return t.inherits(n,e,{__CANCEL__:!0}),pl=n,pl}var gl,lf;function Iv(){return lf||(lf=1,gl=function(t){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}),gl}var _l,df;function hf(){if(df)return _l;df=1;var e=Zn,t=Tv(),n=Av(),i=Mp,s=Kp,o=Cv(),r=Bv(),a=zp,c=xr,u=Wc(),l=Iv();return _l=function(h){return new Promise(function(b,v){var k=h.data,E=h.headers,N=h.responseType,A;function P(){h.cancelToken&&h.cancelToken.unsubscribe(A),h.signal&&h.signal.removeEventListener("abort",A)}e.isFormData(k)&&e.isStandardBrowserEnv()&&delete E["Content-Type"];var B=new XMLHttpRequest;if(h.auth){var W=h.auth.username||"",Q=h.auth.password?unescape(encodeURIComponent(h.auth.password)):"";E.Authorization="Basic "+btoa(W+":"+Q)}var V=s(h.baseURL,h.url);B.open(h.method.toUpperCase(),i(V,h.params,h.paramsSerializer),!0),B.timeout=h.timeout;function ee(){if(B){var U="getAllResponseHeaders"in B?o(B.getAllResponseHeaders()):null,x=!N||N==="text"||N==="json"?B.responseText:B.response,f={data:x,status:B.status,statusText:B.statusText,headers:U,config:h,request:B};t(function(T){b(T),P()},function(T){v(T),P()},f),B=null}}if("onloadend"in B?B.onloadend=ee:B.onreadystatechange=function(){!B||B.readyState!==4||B.status===0&&!(B.responseURL&&B.responseURL.indexOf("file:")===0)||setTimeout(ee)},B.onabort=function(){B&&(v(new c("Request aborted",c.ECONNABORTED,h,B)),B=null)},B.onerror=function(){v(new c("Network Error",c.ERR_NETWORK,h,B,B)),B=null},B.ontimeout=function(){var x=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded",f=h.transitional||a;h.timeoutErrorMessage&&(x=h.timeoutErrorMessage),v(new c(x,f.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,h,B)),B=null},e.isStandardBrowserEnv()){var j=(h.withCredentials||r(V))&&h.xsrfCookieName?n.read(h.xsrfCookieName):void 0;j&&(E[h.xsrfHeaderName]=j)}"setRequestHeader"in B&&e.forEach(E,function(x,f){typeof k>"u"&&f.toLowerCase()==="content-type"?delete E[f]:B.setRequestHeader(f,x)}),e.isUndefined(h.withCredentials)||(B.withCredentials=!!h.withCredentials),N&&N!=="json"&&(B.responseType=h.responseType),typeof h.onDownloadProgress=="function"&&B.addEventListener("progress",h.onDownloadProgress),typeof h.onUploadProgress=="function"&&B.upload&&B.upload.addEventListener("progress",h.onUploadProgress),(h.cancelToken||h.signal)&&(A=function(U){B&&(v(!U||U&&U.type?new u:U),B.abort(),B=null)},h.cancelToken&&h.cancelToken.subscribe(A),h.signal&&(h.signal.aborted?A():h.signal.addEventListener("abort",A))),k||(k=null);var R=l(V);if(R&&["http","https","file"].indexOf(R)===-1){v(new c("Unsupported protocol "+R+":",c.ERR_BAD_REQUEST,h));return}B.send(k)})},_l}var ml,ff;function Ov(){return ff||(ff=1,ml=null),ml}var Un=Zn,pf=vv,gf=xr,Rv=zp,$v=Hp,Uv={"Content-Type":"application/x-www-form-urlencoded"};function _f(e,t){!Un.isUndefined(e)&&Un.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function qv(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=hf()),e}function Lv(e,t,n){if(Un.isString(e))try{return(t||JSON.parse)(e),Un.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}var Vc={transitional:Rv,adapter:qv(),transformRequest:[function(t,n){if(pf(n,"Accept"),pf(n,"Content-Type"),Un.isFormData(t)||Un.isArrayBuffer(t)||Un.isBuffer(t)||Un.isStream(t)||Un.isFile(t)||Un.isBlob(t))return t;if(Un.isArrayBufferView(t))return t.buffer;if(Un.isURLSearchParams(t))return _f(n,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var i=Un.isObject(t),s=n&&n["Content-Type"],o;if((o=Un.isFileList(t))||i&&s==="multipart/form-data"){var r=this.env&&this.env.FormData;return $v(o?{"files[]":t}:t,r&&new r)}else if(i||s==="application/json")return _f(n,"application/json"),Lv(t);return t}],transformResponse:[function(t){var n=this.transitional||Vc.transitional,i=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,o=!i&&this.responseType==="json";if(o||s&&Un.isString(t)&&t.length)try{return JSON.parse(t)}catch(r){if(o)throw r.name==="SyntaxError"?gf.from(r,gf.ERR_BAD_RESPONSE,this,null,this.response):r}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ov()},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Un.forEach(["delete","get","head"],function(t){Vc.headers[t]={}});Un.forEach(["post","put","patch"],function(t){Vc.headers[t]=Un.merge(Uv)});var eh=Vc,Dv=Zn,Mv=eh,Nv=function(t,n,i){var s=this||Mv;return Dv.forEach(i,function(r){t=r.call(s,t,n)}),t},yl,mf;function Gp(){return mf||(mf=1,yl=function(t){return!!(t&&t.__CANCEL__)}),yl}var yf=Zn,wl=Nv,Fv=Gp(),jv=eh,zv=Wc();function bl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new zv}var Hv=function(t){bl(t),t.headers=t.headers||{},t.data=wl.call(t,t.data,t.headers,t.transformRequest),t.headers=yf.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),yf.forEach(["delete","get","head","post","put","patch","common"],function(s){delete t.headers[s]});var n=t.adapter||jv.adapter;return n(t).then(function(s){return bl(t),s.data=wl.call(t,s.data,s.headers,t.transformResponse),s},function(s){return Fv(s)||(bl(t),s&&s.response&&(s.response.data=wl.call(t,s.response.data,s.response.headers,t.transformResponse))),Promise.reject(s)})},gi=Zn,Wp=function(t,n){n=n||{};var i={};function s(l,d){return gi.isPlainObject(l)&&gi.isPlainObject(d)?gi.merge(l,d):gi.isPlainObject(d)?gi.merge({},d):gi.isArray(d)?d.slice():d}function o(l){if(gi.isUndefined(n[l])){if(!gi.isUndefined(t[l]))return s(void 0,t[l])}else return s(t[l],n[l])}function r(l){if(!gi.isUndefined(n[l]))return s(void 0,n[l])}function a(l){if(gi.isUndefined(n[l])){if(!gi.isUndefined(t[l]))return s(void 0,t[l])}else return s(void 0,n[l])}function c(l){if(l in n)return s(t[l],n[l]);if(l in t)return s(void 0,t[l])}var u={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return gi.forEach(Object.keys(t).concat(Object.keys(n)),function(d){var h=u[d]||o,g=h(d);gi.isUndefined(g)&&h!==c||(i[d]=g)}),i},vl,wf;function Vp(){return wf||(wf=1,vl={version:"0.27.2"}),vl}var Kv=Vp().version,$s=xr,th={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){th[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});var bf={};th.transitional=function(t,n,i){function s(o,r){return"[Axios v"+Kv+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return function(o,r,a){if(t===!1)throw new $s(s(r," has been removed"+(n?" in "+n:"")),$s.ERR_DEPRECATED);return n&&!bf[r]&&(bf[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,r,a):!0}};function Gv(e,t,n){if(typeof e!="object")throw new $s("options must be an object",$s.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(e),s=i.length;s-- >0;){var o=i[s],r=t[o];if(r){var a=e[o],c=a===void 0||r(a,o,e);if(c!==!0)throw new $s("option "+o+" must be "+c,$s.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new $s("Unknown option "+o,$s.ERR_BAD_OPTION)}}var Wv={assertOptions:Gv,validators:th},Xp=Zn,Vv=Mp,vf=wv,xf=Hv,Xc=Wp,Xv=Kp,Jp=Wv,Eo=Jp.validators;function or(e){this.defaults=e,this.interceptors={request:new vf,response:new vf}}or.prototype.request=function(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Xc(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&Jp.assertOptions(i,{silentJSONParsing:Eo.transitional(Eo.boolean),forcedJSONParsing:Eo.transitional(Eo.boolean),clarifyTimeoutError:Eo.transitional(Eo.boolean)},!1);var s=[],o=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(o=o&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var r=[];this.interceptors.response.forEach(function(g){r.push(g.fulfilled,g.rejected)});var a;if(!o){var c=[xf,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(r),a=Promise.resolve(n);c.length;)a=a.then(c.shift(),c.shift());return a}for(var u=n;s.length;){var l=s.shift(),d=s.shift();try{u=l(u)}catch(h){d(h);break}}try{a=xf(u)}catch(h){return Promise.reject(h)}for(;r.length;)a=a.then(r.shift(),r.shift());return a};or.prototype.getUri=function(t){t=Xc(this.defaults,t);var n=Xv(t.baseURL,t.url);return Vv(n,t.params,t.paramsSerializer)};Xp.forEach(["delete","get","head","options"],function(t){or.prototype[t]=function(n,i){return this.request(Xc(i||{},{method:t,url:n,data:(i||{}).data}))}});Xp.forEach(["post","put","patch"],function(t){function n(i){return function(o,r,a){return this.request(Xc(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}or.prototype[t]=n(),or.prototype[t+"Form"]=n(!0)});var Jv=or,xl,Tf;function Zv(){if(Tf)return xl;Tf=1;var e=Wc();function t(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(r){i=r});var s=this;this.promise.then(function(o){if(s._listeners){var r,a=s._listeners.length;for(r=0;r<a;r++)s._listeners[r](o);s._listeners=null}}),this.promise.then=function(o){var r,a=new Promise(function(c){s.subscribe(c),r=c}).then(o);return a.cancel=function(){s.unsubscribe(r)},a},n(function(r){s.reason||(s.reason=new e(r),i(s.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},t.prototype.unsubscribe=function(i){if(this._listeners){var s=this._listeners.indexOf(i);s!==-1&&this._listeners.splice(s,1)}},t.source=function(){var i,s=new t(function(r){i=r});return{token:s,cancel:i}},xl=t,xl}var Tl,Af;function Yv(){return Af||(Af=1,Tl=function(t){return function(i){return t.apply(null,i)}}),Tl}var Al,kf;function Qv(){if(kf)return Al;kf=1;var e=Zn;return Al=function(n){return e.isObject(n)&&n.isAxiosError===!0},Al}var Sf=Zn,e1=qp,Qa=Jv,t1=Wp,n1=eh;function Zp(e){var t=new Qa(e),n=e1(Qa.prototype.request,t);return Sf.extend(n,Qa.prototype,t),Sf.extend(n,t),n.create=function(s){return Zp(t1(e,s))},n}var fi=Zp(n1);fi.Axios=Qa;fi.CanceledError=Wc();fi.CancelToken=Zv();fi.isCancel=Gp();fi.VERSION=Vp().version;fi.toFormData=Hp;fi.AxiosError=xr;fi.Cancel=fi.CanceledError;fi.all=function(t){return Promise.all(t)};fi.spread=Yv();fi.isAxiosError=Qv();Jb.exports=fi;wc.default=fi;(function(e){e.exports=wc})(Xb);const i1=Fd(dd);async function s1(e){var t;const{params:n,method:i,url:s,headers:o,body:r,overrides:a}=e,c={headers:o,method:i,url:s,params:n,data:r,withCredentials:(t=a==null?void 0:a.WITH_CREDENTIALS)!=null?t:!0};try{const u=await i1(c);return{status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config}}catch(u){const l=u;if(l.response)return l.response;throw u}}var fd={},o1={get exports(){return fd},set exports(e){fd=e}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function o(c,u,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var g=new s(l,d||c,h),b=n?n+u:u;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],g]:c._events[b].push(g):(c._events[b]=g,c._eventsCount++),c}function r(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)t.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,g=d.length,b=new Array(g);h<g;h++)b[h]=d[h].fn;return b},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,h,g,b){var v=n?n+u:u;if(!this._events[v])return!1;var k=this._events[v],E=arguments.length,N,A;if(k.fn){switch(k.once&&this.removeListener(u,k.fn,void 0,!0),E){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,l),!0;case 3:return k.fn.call(k.context,l,d),!0;case 4:return k.fn.call(k.context,l,d,h),!0;case 5:return k.fn.call(k.context,l,d,h,g),!0;case 6:return k.fn.call(k.context,l,d,h,g,b),!0}for(A=1,N=new Array(E-1);A<E;A++)N[A-1]=arguments[A];k.fn.apply(k.context,N)}else{var P=k.length,B;for(A=0;A<P;A++)switch(k[A].once&&this.removeListener(u,k[A].fn,void 0,!0),E){case 1:k[A].fn.call(k[A].context);break;case 2:k[A].fn.call(k[A].context,l);break;case 3:k[A].fn.call(k[A].context,l,d);break;case 4:k[A].fn.call(k[A].context,l,d,h);break;default:if(!N)for(B=1,N=new Array(E-1);B<E;B++)N[B-1]=arguments[B];k[A].fn.apply(k[A].context,N)}}return!0},a.prototype.on=function(u,l,d){return o(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return o(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,h){var g=n?n+u:u;if(!this._events[g])return this;if(!l)return r(this,g),this;var b=this._events[g];if(b.fn)b.fn===l&&(!h||b.once)&&(!d||b.context===d)&&r(this,g);else{for(var v=0,k=[],E=b.length;v<E;v++)(b[v].fn!==l||h&&!b[v].once||d&&b[v].context!==d)&&k.push(b[v]);k.length?this._events[g]=k.length===1?k[0]:k:r(this,g)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&r(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(o1);var Yp=Object.defineProperty,r1=Object.getOwnPropertyDescriptor,Jc=(e,t)=>{for(var n in t)Yp(e,n,{get:t[n],enumerable:!0})},un=(e,t,n,i)=>{for(var s=i>1?void 0:i?r1(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Yp(t,n,s),s},a1=/^m(\/[0-9]+')+$/,Qp=e=>e.replace("'",""),c1="ed25519 seed",u1=2147483648,eg=e=>{const n=Wd.create(Up,c1).update(Ap(e)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},tg=({key:e,chainCode:t},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...e,...s]),a=Wd.create(Up,t).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},l1=(e,t=!0)=>{const i=is.sign.keyPair.fromSeed(e).secretKey.subarray(32),s=new Uint8Array([0]);return t?new Uint8Array([...s,...i]):i},ng=e=>a1.test(e)?!e.split("/").slice(1).map(Qp).some(Number.isNaN):!1,ig=(e,t,n=u1)=>{if(!ng(e))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=eg(t);return e.split("/").slice(1).map(Qp).map(r=>parseInt(r,10)).reduce((r,a)=>tg(r,a+n),{key:i,chainCode:s})},d1="1.20.0";async function Hr(e){return new Promise(t=>{setTimeout(t,e)})}var Pf="/v1";function h1(e){let t=`${e}`;return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.endsWith(Pf)||(t=`${t}${Pf}`),t}var sg=2e5,og=20,rg=20,vc="0x1::aptos_coin::AptosCoin";function Zc(e){let t,n,i;return typeof e=="object"?(t=e.hashFunction,n=e.ttlMs,i=e.tags):t=e,(s,o,r)=>{if(r.value!=null)r.value=Ef(r.value,t,n,i);else if(r.get!=null)r.get=Ef(r.get,t,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function ag(e,t){return Zc({ttlMs:e,hashFunction:t})}var ec=new Map;function f1(e){const t=new Set;for(const n of e){const i=ec.get(n);if(i)for(const s of i)t.has(s)||(s.clear(),t.add(s))}return t.size}function Ef(e,t,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)ec.has(u)?ec.get(u).push(c):ec.set(u,[c]);if(t||o.length>0||n>0){let u;t===!0?u=o.map(h=>h.toString()).join("!"):t?u=t.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const h=c.get(l);d=Date.now()-h>n}c.has(u)&&!d?r=c.get(u):(r=e.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=e.apply(a,o),c.set(u,r))}return r}}var nh=class extends Error{constructor(e,t,n){super(n),this.name="AptosApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.data=t.data,this.request=e}},p1={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable"};async function g1(e,t,n,i,s,o){const r={...o==null?void 0:o.HEADERS,"x-aptos-client":`aptos-ts-sdk/${d1}`,"content-type":i??"application/json"};return o!=null&&o.TOKEN&&(r.Authorization=`Bearer ${o==null?void 0:o.TOKEN}`),await s1({url:e,method:t,body:n,params:s,headers:r,overrides:o})}async function ih(e){const{url:t,endpoint:n,method:i,body:s,contentType:o,params:r,overrides:a}=e,c=`${t}/${n??""}`,u=await g1(c,i,s,o,r,a),l={status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config,url:c};if(l.status>=200&&l.status<300)return l;const d=p1[l.status];throw new nh(e,l,d??"Generic Error")}async function oi(e){return await ih({...e,method:"GET"})}async function Xs(e){return await ih({...e,method:"POST"})}async function Cf(e){const t=[];let n;const i=e.params;for(;;){i.start=n;const s=await oi({url:e.url,endpoint:e.endpoint,params:i,originMethod:e.originMethod,overrides:e.overrides});if(n=s.headers["x-aptos-cursor"],delete s.headers,t.push(...s.data),n==null)break}return t}var xc={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},cg={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1",local:"http://localhost:8080/v1"},pd={"https://fullnode.mainnet.aptoslabs.com/v1":"mainnet","https://fullnode.testnet.aptoslabs.com/v1":"testnet","https://fullnode.devnet.aptoslabs.com/v1":"devnet","http://localhost:8080/v1":"local"},ug=(e=>(e.MAINNET="mainnet",e.TESTNET="testnet",e.DEVNET="devnet",e.LOCAL="local",e))(ug||{}),$e=class{static fromBuffer(t){return $e.fromUint8Array(t)}static fromUint8Array(t){return new $e(Tp(t))}static ensure(t){return typeof t=="string"?new $e(t):t}constructor(t){t.startsWith("0x")?this.hexString=t:this.hexString=`0x${t}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(Ap(this.noPrefix()))}},ct={};Jc(ct,{AccountAddress:()=>nn,AccountAuthenticator:()=>Ds,AccountAuthenticatorEd25519:()=>ah,AccountAuthenticatorMultiEd25519:()=>ch,ArgumentABI:()=>ba,AuthenticationKey:()=>oo,ChainId:()=>ru,ChangeSet:()=>R1,Ed25519PublicKey:()=>Bi,Ed25519Signature:()=>Qi,EntryFunction:()=>Ys,EntryFunctionABI:()=>rr,FeePayerRawTransaction:()=>iu,Identifier:()=>Vn,Module:()=>fg,ModuleId:()=>so,MultiAgentRawTransaction:()=>nu,MultiEd25519PublicKey:()=>_a,MultiEd25519Signature:()=>Yc,MultiSig:()=>hh,MultiSigTransactionPayload:()=>dh,RawTransaction:()=>mo,RawTransactionWithData:()=>fh,RotationProofChallenge:()=>U1,Script:()=>tu,ScriptABI:()=>_u,SignedTransaction:()=>ma,StructTag:()=>js,Transaction:()=>pg,TransactionArgument:()=>Vi,TransactionArgumentAddress:()=>fu,TransactionArgumentBool:()=>gu,TransactionArgumentU128:()=>du,TransactionArgumentU16:()=>cu,TransactionArgumentU256:()=>hu,TransactionArgumentU32:()=>uu,TransactionArgumentU64:()=>lu,TransactionArgumentU8:()=>au,TransactionArgumentU8Vector:()=>pu,TransactionAuthenticator:()=>Tr,TransactionAuthenticatorEd25519:()=>Qc,TransactionAuthenticatorFeePayer:()=>rh,TransactionAuthenticatorMultiAgent:()=>oh,TransactionAuthenticatorMultiEd25519:()=>eu,TransactionPayload:()=>ya,TransactionPayloadEntryFunction:()=>ou,TransactionPayloadMultisig:()=>ph,TransactionPayloadScript:()=>su,TransactionScriptABI:()=>mu,TypeArgumentABI:()=>wa,TypeTag:()=>Xn,TypeTagAddress:()=>Ns,TypeTagBool:()=>fo,TypeTagParser:()=>_o,TypeTagParserError:()=>hg,TypeTagSigner:()=>uh,TypeTagStruct:()=>Fs,TypeTagU128:()=>go,TypeTagU16:()=>Ar,TypeTagU256:()=>Sr,TypeTagU32:()=>kr,TypeTagU64:()=>po,TypeTagU8:()=>ds,TypeTagVector:()=>Pr,UserTransaction:()=>gh,WriteSet:()=>$1,objectStructTag:()=>C1,optionStructTag:()=>E1,stringStructTag:()=>lh});var lg={};Jc(lg,{Deserializer:()=>sh,Serializer:()=>_n,bcsSerializeBool:()=>k1,bcsSerializeBytes:()=>Os,bcsSerializeFixedBytes:()=>P1,bcsSerializeStr:()=>S1,bcsSerializeU128:()=>T1,bcsSerializeU16:()=>v1,bcsSerializeU256:()=>A1,bcsSerializeU32:()=>x1,bcsSerializeU8:()=>gd,bcsSerializeUint64:()=>b1,bcsToBytes:()=>Ki,deserializeVector:()=>ci,serializeVector:()=>Wn,serializeVectorWithFunc:()=>w1});var _1=2**8-1,m1=2**16-1,na=2**32-1,Xo=BigInt(2**64)-BigInt(1),dg=BigInt(2**128)-BigInt(1),y1=BigInt(2**256)-BigInt(1),_n=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(t){for(;this.buffer.byteLength<this.offset+t;){const n=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n}}serialize(t){this.ensureBufferWillHandleSize(t.length),new Uint8Array(this.buffer,this.offset).set(t),this.offset+=t.length}serializeWithFunction(t,n,i){this.ensureBufferWillHandleSize(n);const s=new DataView(this.buffer,this.offset);t.apply(s,[0,i,!0]),this.offset+=n}serializeStr(t){const n=new TextEncoder;this.serializeBytes(n.encode(t))}serializeBytes(t){this.serializeU32AsUleb128(t.length),this.serialize(t)}serializeFixedBytes(t){this.serialize(t)}serializeBool(t){if(typeof t!="boolean")throw new Error("Value needs to be a boolean");const n=t?1:0;this.serialize(new Uint8Array([n]))}serializeU8(t){this.serialize(new Uint8Array([t]))}serializeU16(t){this.serializeWithFunction(DataView.prototype.setUint16,2,t)}serializeU32(t){this.serializeWithFunction(DataView.prototype.setUint32,4,t)}serializeU64(t){const n=BigInt(t.toString())&BigInt(na),i=BigInt(t.toString())>>BigInt(32);this.serializeU32(Number(n)),this.serializeU32(Number(i))}serializeU128(t){const n=BigInt(t.toString())&Xo,i=BigInt(t.toString())>>BigInt(64);this.serializeU64(n),this.serializeU64(i)}serializeU256(t){const n=BigInt(t.toString())&dg,i=BigInt(t.toString())>>BigInt(128);this.serializeU128(n),this.serializeU128(i)}serializeU32AsUleb128(t){let n=t;const i=[];for(;n>>>7;)i.push(n&127|128),n>>>=7;i.push(n),this.serialize(new Uint8Array(i))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};un([ho(0,_1)],_n.prototype,"serializeU8",1);un([ho(0,m1)],_n.prototype,"serializeU16",1);un([ho(0,na)],_n.prototype,"serializeU32",1);un([ho(BigInt(0),Xo)],_n.prototype,"serializeU64",1);un([ho(BigInt(0),dg)],_n.prototype,"serializeU128",1);un([ho(BigInt(0),y1)],_n.prototype,"serializeU256",1);un([ho(0,na)],_n.prototype,"serializeU32AsUleb128",1);function ho(e,t,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(t.toString())||u<BigInt(e.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var sh=class{constructor(t){this.buffer=new ArrayBuffer(t.length),new Uint8Array(this.buffer).set(t,0),this.offset=0}read(t){if(this.offset+t>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const n=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,n}deserializeStr(){const t=this.deserializeBytes();return new TextDecoder().decode(t)}deserializeBytes(){const t=this.deserializeUleb128AsU32();return new Uint8Array(this.read(t))}deserializeFixedBytes(t){return new Uint8Array(this.read(t))}deserializeBool(){const t=new Uint8Array(this.read(1))[0];if(t!==1&&t!==0)throw new Error("Invalid boolean value");return t===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const t=this.deserializeU32(),n=this.deserializeU32();return BigInt(BigInt(n)<<BigInt(32)|BigInt(t))}deserializeU128(){const t=this.deserializeU64(),n=this.deserializeU64();return BigInt(n<<BigInt(64)|t)}deserializeU256(){const t=this.deserializeU128(),n=this.deserializeU128();return BigInt(n<<BigInt(128)|t)}deserializeUleb128AsU32(){let t=BigInt(0),n=0;for(;t<na;){const i=this.deserializeU8();if(t|=BigInt(i&127)<<BigInt(n),!(i&128))break;n+=7}if(t>na)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(t)}};function Wn(e,t){t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)})}function w1(e,t){const n=new _n;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(s=>{i.call(n,s)}),n.getBytes()}function ci(e,t){const n=e.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(t.deserialize(e));return i}function Ki(e){const t=new _n;return e.serialize(t),t.getBytes()}function b1(e){const t=new _n;return t.serializeU64(e),t.getBytes()}function gd(e){const t=new _n;return t.serializeU8(e),t.getBytes()}function v1(e){const t=new _n;return t.serializeU16(e),t.getBytes()}function x1(e){const t=new _n;return t.serializeU32(e),t.getBytes()}function T1(e){const t=new _n;return t.serializeU128(e),t.getBytes()}function A1(e){const t=new _n;return t.serializeU256(e),t.getBytes()}function k1(e){const t=new _n;return t.serializeBool(e),t.getBytes()}function S1(e){const t=new _n;return t.serializeStr(e),t.getBytes()}function Os(e){const t=new _n;return t.serializeBytes(e),t.getBytes()}function P1(e){const t=new _n;return t.serializeFixedBytes(e),t.getBytes()}var Si=class{constructor(t){if(t.length!==Si.LENGTH)throw new Error("Expected address of length 32");this.address=t}static fromHex(t){let n=$e.ensure(t);n.noPrefix().length%2!==0&&(n=new $e(`0${n.noPrefix()}`));const i=n.toUint8Array();if(i.length>Si.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(i.length===Si.LENGTH)return new Si(i);const s=new Uint8Array(Si.LENGTH);return s.set(i,Si.LENGTH-i.length),new Si(s)}static isValid(t){if(t==="")return!1;let n=$e.ensure(t);return n.noPrefix().length%2!==0&&(n=new $e(`0${n.noPrefix()}`)),n.toUint8Array().length<=Si.LENGTH}toHexString(){return $e.fromUint8Array(this.address).hex()}serialize(t){t.serializeFixedBytes(this.address)}static deserialize(t){return new Si(t.deserializeFixedBytes(Si.LENGTH))}static standardizeAddress(t){const n=t.toLowerCase();return`0x${(n.startsWith("0x")?n.slice(2):n).padStart(64,"0")}`}},nn=Si;nn.LENGTH=32;nn.CORE_CODE_ADDRESS=Si.fromHex("0x1");var tc=class{constructor(t){if(t.length!==tc.LENGTH)throw new Error(`Ed25519PublicKey length should be ${tc.LENGTH}`);this.value=t}toBytes(){return this.value}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const n=t.deserializeBytes();return new tc(n)}},Bi=tc;Bi.LENGTH=32;var nc=class{constructor(t){if(this.value=t,t.length!==nc.LENGTH)throw new Error(`Ed25519Signature length should be ${nc.LENGTH}`)}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const n=t.deserializeBytes();return new nc(n)}},Qi=nc;Qi.LENGTH=64;var _d=32,_a=class{constructor(t,n){if(this.public_keys=t,this.threshold=n,n>_d)throw new Error(`"threshold" cannot be larger than ${_d}`)}toBytes(){const t=new Uint8Array(this.public_keys.length*Bi.LENGTH+1);return this.public_keys.forEach((n,i)=>{t.set(n.value,i*Bi.LENGTH)}),t[this.public_keys.length*Bi.LENGTH]=this.threshold,t}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const n=t.deserializeBytes(),i=n[n.length-1],s=[];for(let o=0;o<n.length-1;o+=Bi.LENGTH){const r=o;s.push(new Bi(n.subarray(r,r+Bi.LENGTH)))}return new _a(s,i)}},Kr=class{constructor(t,n){if(this.signatures=t,this.bitmap=n,n.length!==Kr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Kr.BITMAP_LEN}`)}toBytes(){const t=new Uint8Array(this.signatures.length*Qi.LENGTH+Kr.BITMAP_LEN);return this.signatures.forEach((n,i)=>{t.set(n.value,i*Qi.LENGTH)}),t.set(this.bitmap,this.signatures.length*Qi.LENGTH),t}static createBitmap(t){const i=new Uint8Array([0,0,0,0]),s=new Set;return t.forEach(o=>{if(o>=_d)throw new Error(`Invalid bit value ${o}.`);if(s.has(o))throw new Error("Duplicated bits detected.");s.add(o);const r=Math.floor(o/8);let a=i[r];a|=128>>o%8,i[r]=a}),i}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const n=t.deserializeBytes(),i=n.subarray(n.length-4),s=[];for(let o=0;o<n.length-i.length;o+=Qi.LENGTH){const r=o;s.push(new Qi(n.subarray(r,r+Qi.LENGTH)))}return new Kr(s,i)}},Yc=Kr;Yc.BITMAP_LEN=4;var Tr=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return Qc.load(t);case 1:return eu.load(t);case 2:return oh.load(t);case 3:return rh.load(t);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${n}`)}}},Qc=class extends Tr{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=Bi.deserialize(t),i=Qi.deserialize(t);return new Qc(n,i)}},eu=class extends Tr{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=_a.deserialize(t),i=Yc.deserialize(t);return new eu(n,i)}},oh=class extends Tr{constructor(t,n,i){super(),this.sender=t,this.secondary_signer_addresses=n,this.secondary_signers=i}serialize(t){t.serializeU32AsUleb128(2),this.sender.serialize(t),Wn(this.secondary_signer_addresses,t),Wn(this.secondary_signers,t)}static load(t){const n=Ds.deserialize(t),i=ci(t,nn),s=ci(t,Ds);return new oh(n,i,s)}},rh=class extends Tr{constructor(e,t,n,i){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=n,this.fee_payer=i}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),Wn(this.secondary_signer_addresses,e),Wn(this.secondary_signers,e),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(e){const t=Ds.deserialize(e),n=ci(e,nn),i=ci(e,Ds),s=nn.deserialize(e),o=Ds.deserialize(e),r={address:s,authenticator:o};return new rh(t,n,i,r)}},Ds=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return ah.load(t);case 1:return ch.load(t);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${n}`)}}},ah=class extends Ds{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=Bi.deserialize(t),i=Qi.deserialize(t);return new ah(n,i)}},ch=class extends Ds{constructor(t,n){super(),this.public_key=t,this.signature=n}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const n=_a.deserialize(t),i=Yc.deserialize(t);return new ch(n,i)}},Vn=class{constructor(t){this.value=t}serialize(t){t.serializeStr(this.value)}static deserialize(t){const n=t.deserializeStr();return new Vn(n)}},Xn=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return fo.load(t);case 1:return ds.load(t);case 2:return po.load(t);case 3:return go.load(t);case 4:return Ns.load(t);case 5:return uh.load(t);case 6:return Pr.load(t);case 7:return Fs.load(t);case 8:return Ar.load(t);case 9:return kr.load(t);case 10:return Sr.load(t);default:throw new Error(`Unknown variant index for TypeTag: ${n}`)}}},fo=class extends Xn{serialize(t){t.serializeU32AsUleb128(0)}static load(t){return new fo}},ds=class extends Xn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new ds}},Ar=class extends Xn{serialize(t){t.serializeU32AsUleb128(8)}static load(t){return new Ar}},kr=class extends Xn{serialize(t){t.serializeU32AsUleb128(9)}static load(t){return new kr}},po=class extends Xn{serialize(t){t.serializeU32AsUleb128(2)}static load(t){return new po}},go=class extends Xn{serialize(t){t.serializeU32AsUleb128(3)}static load(t){return new go}},Sr=class extends Xn{serialize(t){t.serializeU32AsUleb128(10)}static load(t){return new Sr}},Ns=class extends Xn{serialize(t){t.serializeU32AsUleb128(4)}static load(t){return new Ns}},uh=class extends Xn{serialize(t){t.serializeU32AsUleb128(5)}static load(t){return new uh}},Pr=class extends Xn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),this.value.serialize(t)}static load(t){const n=Xn.deserialize(t);return new Pr(n)}},Fs=class extends Xn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),this.value.serialize(t)}static load(t){const n=js.deserialize(t);return new Fs(n)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===nn.CORE_CODE_ADDRESS.toHexString()}},js=class{constructor(t,n,i,s){this.address=t,this.module_name=n,this.name=i,this.type_args=s}static fromString(t){const n=new _o(t).parseTypeTag();return new js(n.value.address,n.value.module_name,n.value.name,n.value.type_args)}serialize(t){this.address.serialize(t),this.module_name.serialize(t),this.name.serialize(t),Wn(this.type_args,t)}static deserialize(t){const n=nn.deserialize(t),i=Vn.deserialize(t),s=Vn.deserialize(t),o=ci(t,Xn);return new js(n,i,s,o)}},lh=new js(nn.fromHex("0x1"),new Vn("string"),new Vn("String"),[]);function E1(e){return new js(nn.fromHex("0x1"),new Vn("option"),new Vn("Option"),[e])}function C1(e){return new js(nn.fromHex("0x1"),new Vn("object"),new Vn("Object"),[e])}function Rs(e){throw new hg(e)}function Bf(e){return!!e.match(/\s/)}function If(e){return!!e.match(/[_A-Za-z0-9]/g)}function B1(e){return!!e.match(/T\d+/g)}function I1(e,t){const n=e[t];if(n===":"){if(e.slice(t,t+2)==="::")return[["COLON","::"],2];Rs("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(Bf(n)){let i="";for(let s=t;s<e.length;s+=1){const o=e[s];if(Bf(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(If(n)){let i="";for(let s=t;s<e.length;s+=1){const o=e[s];if(If(o))i=`${i}${o}`;else break}return B1(i)?[["GENERIC",i],i.length]:[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function O1(e){let t=0;const n=[];for(;t<e.length;){const[i,s]=I1(e,t);i[0]!=="SPACE"&&n.push(i),t+=s}return n}var _o=class{constructor(t,n){this.typeTags=[],this.tokens=O1(t),this.typeTags=n||[]}consume(t){const n=this.tokens.shift();(!n||n[1]!==t)&&Rs("Invalid type tag.")}consumeWholeGeneric(){for(this.consume("<");this.tokens[0][1]!==">";)this.tokens[0][1]==="<"&&this.consumeWholeGeneric(),this.tokens.shift();this.consume(">")}parseCommaList(t,n){const i=[];for(this.tokens.length<=0&&Rs("Invalid type tag.");this.tokens[0][1]!==t&&(i.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===t||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===t&&n)));)this.tokens.length<=0&&Rs("Invalid type tag.");return i}parseTypeTag(){this.tokens.length===0&&Rs("Invalid type tag.");const[t,n]=this.tokens.shift();if(n==="u8")return new ds;if(n==="u16")return new Ar;if(n==="u32")return new kr;if(n==="u64")return new po;if(n==="u128")return new go;if(n==="u256")return new Sr;if(n==="bool")return new fo;if(n==="address")return new Ns;if(n==="vector"){this.consume("<");const i=this.parseTypeTag();return this.consume(">"),new Pr(i)}if(n==="string")return new Fs(lh);if(t==="IDENT"&&(n.startsWith("0x")||n.startsWith("0X"))){const i=nn.fromHex(n);this.consume("::");const[s,o]=this.tokens.shift();s!=="IDENT"&&Rs("Invalid type tag."),this.consume("::");const[r,a]=this.tokens.shift();if(r!=="IDENT"&&Rs("Invalid type tag."),nn.CORE_CODE_ADDRESS.toHexString()===i.toHexString()&&o==="object"&&a==="Object")return this.consumeWholeGeneric(),new Ns;let c=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),c=this.parseCommaList(">",!0),this.consume(">"));const u=new js(i,new Vn(o),new Vn(a),c);return new Fs(u)}if(t==="GENERIC"){this.typeTags.length===0&&Rs("Can't convert generic type since no typeTags were specified.");const i=parseInt(n.substring(1),10);return new _o(this.typeTags[i]).parseTypeTag()}throw new Error("Invalid type tag.")}},hg=class extends Error{constructor(e){super(e),this.name="TypeTagParserError"}},mo=class{constructor(t,n,i,s,o,r,a){this.sender=t,this.sequence_number=n,this.payload=i,this.max_gas_amount=s,this.gas_unit_price=o,this.expiration_timestamp_secs=r,this.chain_id=a}serialize(t){this.sender.serialize(t),t.serializeU64(this.sequence_number),this.payload.serialize(t),t.serializeU64(this.max_gas_amount),t.serializeU64(this.gas_unit_price),t.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(t)}static deserialize(t){const n=nn.deserialize(t),i=t.deserializeU64(),s=ya.deserialize(t),o=t.deserializeU64(),r=t.deserializeU64(),a=t.deserializeU64(),c=ru.deserialize(t);return new mo(n,i,s,o,r,a,c)}},tu=class{constructor(t,n,i){this.code=t,this.ty_args=n,this.args=i}serialize(t){t.serializeBytes(this.code),Wn(this.ty_args,t),Wn(this.args,t)}static deserialize(t){const n=t.deserializeBytes(),i=ci(t,Xn),s=ci(t,Vi);return new tu(n,i,s)}},Ys=class{constructor(t,n,i,s){this.module_name=t,this.function_name=n,this.ty_args=i,this.args=s}static natural(t,n,i,s){return new Ys(so.fromStr(t),new Vn(n),i,s)}static natual(t,n,i,s){return Ys.natural(t,n,i,s)}serialize(t){this.module_name.serialize(t),this.function_name.serialize(t),Wn(this.ty_args,t),t.serializeU32AsUleb128(this.args.length),this.args.forEach(n=>{t.serializeBytes(n)})}static deserialize(t){const n=so.deserialize(t),i=Vn.deserialize(t),s=ci(t,Xn),o=t.deserializeUleb128AsU32(),r=[];for(let c=0;c<o;c+=1)r.push(t.deserializeBytes());const a=r;return new Ys(n,i,s,a)}},dh=class{constructor(t){this.transaction_payload=t}serialize(t){t.serializeU32AsUleb128(0),this.transaction_payload.serialize(t)}static deserialize(t){return t.deserializeUleb128AsU32(),new dh(Ys.deserialize(t))}},hh=class{constructor(t,n){this.multisig_address=t,this.transaction_payload=n}serialize(t){this.multisig_address.serialize(t),this.transaction_payload===void 0?t.serializeBool(!1):(t.serializeBool(!0),this.transaction_payload.serialize(t))}static deserialize(t){const n=nn.deserialize(t),i=t.deserializeBool();let s;return i&&(s=dh.deserialize(t)),new hh(n,s)}},fg=class{constructor(t){this.code=t}serialize(t){t.serializeBytes(this.code)}static deserialize(t){const n=t.deserializeBytes();return new fg(n)}},so=class{constructor(t,n){this.address=t,this.name=n}static fromStr(t){const n=t.split("::");if(n.length!==2)throw new Error("Invalid module id.");return new so(nn.fromHex(new $e(n[0])),new Vn(n[1]))}serialize(t){this.address.serialize(t),this.name.serialize(t)}static deserialize(t){const n=nn.deserialize(t),i=Vn.deserialize(t);return new so(n,i)}},R1=class{serialize(t){throw new Error("Not implemented.")}static deserialize(t){throw new Error("Not implemented.")}},$1=class{serialize(t){throw new Error("Not implmented.")}static deserialize(t){throw new Error("Not implmented.")}},ma=class{constructor(t,n){this.raw_txn=t,this.authenticator=n}serialize(t){this.raw_txn.serialize(t),this.authenticator.serialize(t)}static deserialize(t){const n=mo.deserialize(t),i=Tr.deserialize(t);return new ma(n,i)}},fh=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return nu.load(t);case 1:return iu.load(t);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${n}`)}}},nu=class extends fh{constructor(t,n){super(),this.raw_txn=t,this.secondary_signer_addresses=n}serialize(t){t.serializeU32AsUleb128(0),this.raw_txn.serialize(t),Wn(this.secondary_signer_addresses,t)}static load(t){const n=mo.deserialize(t),i=ci(t,nn);return new nu(n,i)}},iu=class extends fh{constructor(e,t,n){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=n}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),Wn(this.secondary_signer_addresses,e),this.fee_payer_address.serialize(e)}static load(e){const t=mo.deserialize(e),n=ci(e,nn),i=nn.deserialize(e);return new iu(t,n,i)}},ya=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return su.load(t);case 2:return ou.load(t);case 3:return ph.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},su=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){const n=tu.deserialize(t);return new su(n)}},ou=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),this.value.serialize(t)}static load(t){const n=Ys.deserialize(t);return new ou(n)}},ph=class extends ya{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const n=hh.deserialize(t);return new ph(n)}},ru=class{constructor(t){this.value=t}serialize(t){t.serializeU8(this.value)}static deserialize(t){const n=t.deserializeU8();return new ru(n)}},Vi=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return au.load(t);case 1:return lu.load(t);case 2:return du.load(t);case 3:return fu.load(t);case 4:return pu.load(t);case 5:return gu.load(t);case 6:return cu.load(t);case 7:return uu.load(t);case 8:return hu.load(t);default:throw new Error(`Unknown variant index for TransactionArgument: ${n}`)}}},au=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),t.serializeU8(this.value)}static load(t){const n=t.deserializeU8();return new au(n)}},cu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),t.serializeU16(this.value)}static load(t){const n=t.deserializeU16();return new cu(n)}},uu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),t.serializeU32(this.value)}static load(t){const n=t.deserializeU32();return new uu(n)}},lu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(1),t.serializeU64(this.value)}static load(t){const n=t.deserializeU64();return new lu(n)}},du=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),t.serializeU128(this.value)}static load(t){const n=t.deserializeU128();return new du(n)}},hu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(8),t.serializeU256(this.value)}static load(t){const n=t.deserializeU256();return new hu(n)}},fu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const n=nn.deserialize(t);return new fu(n)}},pu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(4),t.serializeBytes(this.value)}static load(t){const n=t.deserializeBytes();return new pu(n)}},gu=class extends Vi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(5),t.serializeBool(this.value)}static load(t){const n=t.deserializeBool();return new gu(n)}},pg=class{getHashSalt(){const t=ir.create();return t.update("APTOS::Transaction"),t.digest()}static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return gh.load(t);default:throw new Error(`Unknown variant index for Transaction: ${n}`)}}},gh=class extends pg{constructor(t){super(),this.value=t}hash(){const t=ir.create();return t.update(this.getHashSalt()),t.update(Ki(this)),t.digest()}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){return new gh(ma.deserialize(t))}},wa=class{constructor(t){this.name=t}serialize(t){t.serializeStr(this.name)}static deserialize(t){const n=t.deserializeStr();return new wa(n)}},ba=class{constructor(t,n){this.name=t,this.type_tag=n}serialize(t){t.serializeStr(this.name),this.type_tag.serialize(t)}static deserialize(t){const n=t.deserializeStr(),i=Xn.deserialize(t);return new ba(n,i)}},_u=class{static deserialize(t){const n=t.deserializeUleb128AsU32();switch(n){case 0:return mu.load(t);case 1:return rr.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},mu=class extends _u{constructor(t,n,i,s,o){super(),this.name=t,this.doc=n,this.code=i,this.ty_args=s,this.args=o}serialize(t){t.serializeU32AsUleb128(0),t.serializeStr(this.name),t.serializeStr(this.doc),t.serializeBytes(this.code),Wn(this.ty_args,t),Wn(this.args,t)}static load(t){const n=t.deserializeStr(),i=t.deserializeStr(),s=t.deserializeBytes(),o=ci(t,wa),r=ci(t,ba);return new mu(n,i,s,o,r)}},rr=class extends _u{constructor(t,n,i,s,o){super(),this.name=t,this.module_name=n,this.doc=i,this.ty_args=s,this.args=o}serialize(t){t.serializeU32AsUleb128(1),t.serializeStr(this.name),this.module_name.serialize(t),t.serializeStr(this.doc),Wn(this.ty_args,t),Wn(this.args,t)}static load(t){const n=t.deserializeStr(),i=so.deserialize(t),s=t.deserializeStr(),o=ci(t,wa),r=ci(t,ba);return new rr(n,i,s,o,r)}},Uo=class{constructor(t){if(t.length!==Uo.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=t}static fromMultiEd25519PublicKey(t){const n=t.toBytes(),i=new Uint8Array(n.length+1);i.set(n),i.set([Uo.MULTI_ED25519_SCHEME],n.length);const s=ir.create();return s.update(i),new Uo(s.digest())}static fromEd25519PublicKey(t){const n=t.value,i=new Uint8Array(n.length+1);i.set(n),i.set([Uo.ED25519_SCHEME],n.length);const s=ir.create();return s.update(i),new Uo(s.digest())}derivedAddress(){return $e.fromUint8Array(this.bytes)}},oo=Uo;oo.LENGTH=32;oo.MULTI_ED25519_SCHEME=1;oo.ED25519_SCHEME=0;oo.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var U1=class{constructor(t,n,i,s,o,r,a){this.accountAddress=t,this.moduleName=n,this.structName=i,this.sequenceNumber=s,this.originator=o,this.currentAuthKey=r,this.newPublicKey=a}serialize(t){this.accountAddress.serialize(t),t.serializeStr(this.moduleName),t.serializeStr(this.structName),t.serializeU64(this.sequenceNumber),this.originator.serialize(t),this.currentAuthKey.serialize(t),t.serializeBytes(this.newPublicKey)}},ic=class{static fromAptosAccountObject(t){return new ic($e.ensure(t.privateKeyHex).toUint8Array(),t.address)}static isValidPath(t){return/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(t)}static fromDerivePath(t,n){if(!ic.isValidPath(t))throw new Error("Invalid derivation path");const i=n.trim().split(/\s+/).map(o=>o.toLowerCase()).join(" "),{key:s}=ig(t,Tp(fp(i)));return new ic(s)}constructor(t,n){t?this.signingKey=is.sign.keyPair.fromSeed(t.slice(0,32)):this.signingKey=is.sign.keyPair(),this.accountAddress=$e.ensure(n||this.authKey().hex())}address(){return this.accountAddress}authKey(){const t=new Bi(this.signingKey.publicKey);return oo.fromEd25519PublicKey(t).derivedAddress()}static getResourceAccountAddress(t,n){const i=Ki(nn.fromHex(t)),s=new Uint8Array([...i,...n,oo.DERIVE_RESOURCE_ACCOUNT_SCHEME]),o=ir.create();return o.update(s),$e.fromUint8Array(o.digest())}static getCollectionID(t,n){const i=new TextEncoder().encode(`${t}::${n}`),s=gb.create();return s.update(i),$e.fromUint8Array(s.digest())}pubKey(){return $e.fromUint8Array(this.signingKey.publicKey)}signBuffer(t){const n=is.sign.detached(t,this.signingKey.secretKey);return $e.fromUint8Array(n)}signHexString(t){const n=$e.ensure(t).toUint8Array();return this.signBuffer(n)}verifySignature(t,n){const i=$e.ensure(t).toUint8Array(),s=$e.ensure(n).toUint8Array();return is.sign.detached.verify(i,s,this.signingKey.publicKey)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:$e.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},ia=ic;un([Zc()],ia.prototype,"authKey",1);function ji(e){return e instanceof ia?e.address():$e.ensure(e)}var va=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,q1=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,L1=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,gg=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,D1=`
    query getAccountCoinsDataCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,M1=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,N1=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${q1}
${L1}`,F1=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,j1=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,z1=`
    query getAccountTransactionsData($where_condition: account_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [account_transactions_order_by!]) {
  account_transactions(
    where: $where_condition
    order_by: $order_by
    limit: $limit
    offset: $offset
  ) {
    token_activities_v2 {
      ...TokenActivitiesFields
    }
    transaction_version
    account_address
  }
}
    ${gg}`,H1=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collections_v2_order_by!]) {
  current_collections_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    max_supply
    mutable_description
    mutable_uri
    table_handle_v1
    token_standard
    total_minted_v2
    uri
  }
}
    `,K1=`
    query getCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,G1=`
    query getCurrentObjects($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,W1=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,V1=`
    query getIndexerLedgerInfo {
  ledger_infos {
    chain_id
  }
}
    `,X1=`
    query getNumberOfDelegators($poolAddress: String) {
  num_active_delegator_per_pool(
    where: {pool_address: {_eq: $poolAddress}, num_active_delegator: {_gt: "0"}}
    distinct_on: pool_address
  ) {
    num_active_delegator
    pool_address
  }
}
    `,J1=`
    query getOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,Z1=`
    query getOwnedTokensByTokenData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,Y1=`
    query getTokenActivities($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${gg}`,Q1=`
    query getTokenActivitiesCount($token_id: String) {
  token_activities_v2_aggregate(where: {token_data_id: {_eq: $token_id}}) {
    aggregate {
      count
    }
  }
}
    `,ex=`
    query getTokenCurrentOwnerData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,tx=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,nx=`
    query getTokenOwnedFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,ix=`
    query getTokenOwnersData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${va}`,sx=`
    query getTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,ox=`
    query getUserTransactions($where_condition: user_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [user_transactions_order_by!]) {
  user_transactions(
    order_by: $order_by
    where: $where_condition
    limit: $limit
    offset: $offset
  ) {
    version
  }
}
    `;function yu(e,t,n){if(!(t!=null&&t.includes(typeof e)))throw new Error(n||`Invalid arg: ${e} type should be ${t instanceof Array?t.join(" or "):t}`)}function _h(e){if(yu(e,["boolean","string"]),typeof e=="boolean")return e;if(e==="true")return!0;if(e==="false")return!1;throw new Error("Invalid boolean string.")}function Qs(e){if(yu(e,["number","string"]),typeof e=="number")return e;const t=Number.parseInt(e,10);if(Number.isNaN(t))throw new Error("Invalid number string.");return t}function eo(e){return yu(e,["number","bigint","string"]),BigInt(e)}function wu(e,t,n){mh(e,t,n)}function mh(e,t,n,i){if(t instanceof fo)n.serializeBool(_h(e));else if(t instanceof ds)n.serializeU8(Qs(e));else if(t instanceof Ar)n.serializeU16(Qs(e));else if(t instanceof kr)n.serializeU32(Qs(e));else if(t instanceof po)n.serializeU64(eo(e));else if(t instanceof go)n.serializeU128(eo(e));else if(t instanceof Sr)n.serializeU256(eo(e));else if(t instanceof Ns)_g(e,n);else if(t instanceof Pr)rx(e,t,n);else if(t instanceof Fs)ax(e,t,n);else throw new Error("Unsupported arg type.")}function _g(e,t){let n;if(typeof e=="string"||e instanceof $e)n=nn.fromHex(e);else if(e instanceof nn)n=e;else throw new Error("Invalid account address.");n.serialize(t)}function rx(e,t,n,i){if(t.value instanceof ds){if(e instanceof Uint8Array){n.serializeBytes(e);return}if(e instanceof $e){n.serializeBytes(e.toUint8Array());return}if(typeof e=="string"){n.serializeStr(e);return}}if(!Array.isArray(e))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(e.length),e.forEach(s=>mh(s,t.value,n))}function ax(e,t,n,i){const{address:s,module_name:o,name:r,type_args:a}=t.value,c=`${$e.fromUint8Array(s.address).toShortString()}::${o.value}::${r.value}`;if(c==="0x1::string::String")yu(e,["string"]),n.serializeStr(e);else if(c==="0x1::object::Object")_g(e,n);else if(c==="0x1::option::Option"){if(a.length!==1)throw new Error(`Option has the wrong number of type arguments ${a.length}`);cx(e,a[0],n)}else throw new Error("Unsupported struct type in function argument")}function cx(e,t,n,i){e==null?n.serializeU32AsUleb128(0):(n.serializeU32AsUleb128(1),mh(e,t,n))}function mg(e,t){if(t instanceof fo)return new gu(_h(e));if(t instanceof ds)return new au(Qs(e));if(t instanceof Ar)return new cu(Qs(e));if(t instanceof kr)return new uu(Qs(e));if(t instanceof po)return new lu(eo(e));if(t instanceof go)return new du(eo(e));if(t instanceof Sr)return new hu(eo(e));if(t instanceof Ns){let n;if(typeof e=="string"||e instanceof $e)n=nn.fromHex(e);else if(e instanceof nn)n=e;else throw new Error("Invalid account address.");return new fu(n)}if(t instanceof Pr&&t.value instanceof ds){if(!(e instanceof Uint8Array))throw new Error(`${e} should be an instance of Uint8Array`);return new pu(e)}throw new Error("Unknown type for TransactionArgument.")}var ux="APTOS::RawTransaction",Of="APTOS::RawTransactionWithData",zi=class{constructor(t,n){this.rawTxnBuilder=n,this.signingFunction=t}build(t,n,i){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(t,n,i)}static getSigningMessage(t){const n=ir.create();if(t instanceof mo)n.update(ux);else if(t instanceof nu)n.update(Of);else if(t instanceof iu)n.update(Of);else throw new Error("Unknown transaction type.");const i=n.digest(),s=Ki(t),o=new Uint8Array(i.length+s.length);return o.set(i),o.set(s,i.length),o}},sc=class extends zi{constructor(t,n,i){super(t,i),this.publicKey=n}rawToSigned(t){const n=zi.getSigningMessage(t),i=this.signingFunction(n),s=new Qc(new Bi(this.publicKey),i);return new ma(t,s)}sign(t){return Ki(this.rawToSigned(t))}},yg=class extends zi{constructor(t,n){super(t),this.publicKey=n}rawToSigned(t){const n=zi.getSigningMessage(t),i=this.signingFunction(n),s=new eu(this.publicKey,i);return new ma(t,s)}sign(t){return Ki(this.rawToSigned(t))}},Tc=class{constructor(t,n){this.abiMap=new Map,t.forEach(i=>{const s=new sh(i),o=_u.deserialize(s);let r;if(o instanceof rr){const a=o,{address:c,name:u}=a.module_name;r=`${$e.fromUint8Array(c.address).toShortString()}::${u.value}::${a.name}`}else r=o.name;if(this.abiMap.has(r))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(r,o)}),this.builderConfig={maxGasAmount:BigInt(sg),expSecFromNow:og,...n}}static toBCSArgs(t,n){if(t.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>{const o=new _n;return wu(i,t[s].type_tag,o),o.getBytes()})}static toTransactionArguments(t,n){if(t.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>mg(i,t[s].type_tag))}setSequenceNumber(t){this.builderConfig.sequenceNumber=BigInt(t)}buildTransactionPayload(t,n,i){const s=n.map(a=>new _o(a).parseTypeTag());let o;if(!this.abiMap.has(t))throw new Error(`Cannot find function: ${t}`);const r=this.abiMap.get(t);if(r instanceof rr){const a=r,c=Tc.toBCSArgs(a.args,i);o=new ou(new Ys(a.module_name,new Vn(a.name),s,c))}else if(r instanceof mu){const a=r,c=Tc.toTransactionArguments(a.args,i);o=new su(new tu(a.code,s,c))}else throw new Error("Unknown ABI format.");return o}build(t,n,i){const{sender:s,sequenceNumber:o,gasUnitPrice:r,maxGasAmount:a,expSecFromNow:c,chainId:u}=this.builderConfig;if(!r)throw new Error("No gasUnitPrice provided.");const l=s instanceof nn?s:nn.fromHex(s),d=BigInt(Math.floor(Date.now()/1e3)+Number(c)),h=this.buildTransactionPayload(t,n,i);if(h)return new mo(l,BigInt(o),h,BigInt(a),BigInt(r),d,new ru(Number(u)));throw new Error("Invalid ABI.")}},gn=class{constructor(t,n){this.aptosClient=t,this.builderConfig=n}async fetchABI(t){const i=(await this.aptosClient.getAccountModules(t)).map(o=>o.abi).flatMap(o=>o.exposed_functions.filter(r=>r.is_entry).map(r=>({fullName:`${o.address}::${o.name}::${r.name}`,...r}))),s=new Map;return i.forEach(o=>{s.set(o.fullName,o)}),s}async build(t,n,i){if(t=(P=>P.replace(/^0[xX]0*/g,"0x"))(t),t.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coin::transfer");const[r,a]=t.split("::"),c=await this.fetchABI(r);if(!c.has(t))throw new Error(`${t} doesn't exist.`);const u=c.get(t),d=u.params.filter(P=>P!=="signer"&&P!=="&signer").map((P,B)=>new ba(`var${B}`,new _o(P,n).parseTypeTag())),h=new rr(u.name,so.fromStr(`${r}::${a}`),"",u.generic_type_params.map((P,B)=>new wa(`${B}`)),d),{sender:g,...b}=this.builderConfig,v=g instanceof nn?$e.fromUint8Array(g.address):g,[{sequence_number:k},E,{gas_estimate:N}]=await Promise.all([b!=null&&b.sequenceNumber?Promise.resolve({sequence_number:b==null?void 0:b.sequenceNumber}):this.aptosClient.getAccount(v),b!=null&&b.chainId?Promise.resolve(b==null?void 0:b.chainId):this.aptosClient.getChainId(),b!=null&&b.gasUnitPrice?Promise.resolve({gas_estimate:b==null?void 0:b.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Tc([Ki(h)],{sender:g,sequenceNumber:k,chainId:E,gasUnitPrice:BigInt(N),...b}).build(t,n,i)}};un([ag(10*60*1e3)],gn.prototype,"fetchABI",1);var qo=class{constructor(t,n,i=!1){if(!t)throw new Error("Node URL cannot be empty.");i?this.nodeUrl=t:this.nodeUrl=h1(t),this.config=n==null?{}:{...n}}async getAccount(t){const{data:n}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}`,originMethod:"getAccount",overrides:{...this.config}});return n}async getAccountTransactions(t,n){const{data:i}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}/transactions`,originMethod:"getAccountTransactions",params:{start:n==null?void 0:n.start,limit:n==null?void 0:n.limit},overrides:{...this.config}});return i}async getAccountModules(t,n){return await Cf({url:this.nodeUrl,endpoint:`accounts/${t}/modules`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:1e3},originMethod:"getAccountModules",overrides:{...this.config}})}async getAccountModule(t,n,i){const{data:s}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}/module/${n}`,originMethod:"getAccountModule",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}async getAccountResources(t,n){return await Cf({url:this.nodeUrl,endpoint:`accounts/${t}/resources`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:9999},originMethod:"getAccountResources",overrides:{...this.config}})}async getAccountResource(t,n,i){const{data:s}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}/resource/${n}`,originMethod:"getAccountResource",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}static generateBCSTransaction(t,n){return new sc(s=>{const o=t.signBuffer(s);return new ct.Ed25519Signature(o.toUint8Array())},t.pubKey().toUint8Array()).sign(n)}static generateBCSSimulation(t,n){return new sc(s=>{const o=new Uint8Array(64);return new ct.Ed25519Signature(o)},t.pubKey().toUint8Array()).sign(n)}async generateTransaction(t,n,i){const s={sender:t};if(i!=null&&i.sequence_number&&(s.sequenceNumber=i.sequence_number),i!=null&&i.gas_unit_price&&(s.gasUnitPrice=i.gas_unit_price),i!=null&&i.max_gas_amount&&(s.maxGasAmount=i.max_gas_amount),i!=null&&i.expiration_timestamp_secs){const r=Number.parseInt(i.expiration_timestamp_secs,10);s.expSecFromNow=r-Math.floor(Date.now()/1e3)}return new gn(this,s).build(n.function,n.type_arguments,n.arguments)}async generateFeePayerTransaction(t,n,i,s=[],o){const r=await this.generateTransaction(t,n,o),a=s.map(u=>nn.fromHex(u));return new ct.FeePayerRawTransaction(r,a,nn.fromHex(i))}async submitFeePayerTransaction(t,n,i,s=[]){const o=new ct.TransactionAuthenticatorFeePayer(n,t.secondary_signer_addresses,s,{address:t.fee_payer_address,authenticator:i}),r=Ki(new ct.SignedTransaction(t.raw_txn,o));return await this.submitSignedBCSTransaction(r)}async signMultiTransaction(t,n){const i=new ct.Ed25519Signature(t.signBuffer(zi.getSigningMessage(n)).toUint8Array()),s=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(t.signingKey.publicKey),i);return Promise.resolve(s)}async signTransaction(t,n){return Promise.resolve(qo.generateBCSTransaction(t,n))}async getEventsByCreationNumber(t,n,i){const{data:s}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}/events/${n}`,originMethod:"getEventsByCreationNumber",params:{start:i==null?void 0:i.start,limit:i==null?void 0:i.limit},overrides:{...this.config}});return s}async getEventsByEventHandle(t,n,i,s){const{data:o}=await oi({url:this.nodeUrl,endpoint:`accounts/${$e.ensure(t).hex()}/events/${n}/${i}`,originMethod:"getEventsByEventHandle",params:{start:s==null?void 0:s.start,limit:s==null?void 0:s.limit},overrides:{...this.config}});return o}async submitTransaction(t){return this.submitSignedBCSTransaction(t)}async simulateTransaction(t,n,i){let s;return t instanceof ia?s=qo.generateBCSSimulation(t,n):t instanceof _a?s=new yg(()=>{const{threshold:r}=t,a=[],c=[];for(let l=0;l<r;l+=1)a.push(l),c.push(new ct.Ed25519Signature(new Uint8Array(64)));const u=ct.MultiEd25519Signature.createBitmap(a);return new ct.MultiEd25519Signature(c,u)},t).sign(n):s=new sc(()=>{const r=new Uint8Array(64);return new ct.Ed25519Signature(r)},t.toBytes()).sign(n),this.submitBCSSimulation(s,i)}async submitSignedBCSTransaction(t){const{data:n}=await Xs({url:this.nodeUrl,body:t,endpoint:"transactions",originMethod:"submitSignedBCSTransaction",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return n}async submitBCSSimulation(t,n){var i,s,o;const r={estimate_gas_unit_price:(i=n==null?void 0:n.estimateGasUnitPrice)!=null?i:!1,estimate_max_gas_amount:(s=n==null?void 0:n.estimateMaxGasAmount)!=null?s:!1,estimate_prioritized_gas_unit_price:(o=n==null?void 0:n.estimatePrioritizedGasUnitPrice)!=null?o:!1},{data:a}=await Xs({url:this.nodeUrl,body:t,endpoint:"transactions/simulate",params:r,originMethod:"submitBCSSimulation",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return a}async getTransactions(t){var n;const{data:i}=await oi({url:this.nodeUrl,endpoint:"transactions",originMethod:"getTransactions",params:{start:(n=t==null?void 0:t.start)==null?void 0:n.toString(),limit:t==null?void 0:t.limit},overrides:{...this.config}});return i}async getTransactionByHash(t){const{data:n}=await oi({url:this.nodeUrl,endpoint:`transactions/by_hash/${t}`,originMethod:"getTransactionByHash",overrides:{...this.config}});return n}async getTransactionByVersion(t){const{data:n}=await oi({url:this.nodeUrl,endpoint:`transactions/by_version/${t}`,originMethod:"getTransactionByVersion",overrides:{...this.config}});return n}async transactionPending(t){try{return(await this.getTransactionByHash(t)).type==="pending_transaction"}catch(n){if((n==null?void 0:n.status)===404)return!0;throw n}}async waitForTransactionWithResult(t,n){var i,s;const o=(i=n==null?void 0:n.timeoutSecs)!=null?i:rg,r=(s=n==null?void 0:n.checkSuccess)!=null?s:!1;let a=!0,c=0,u;for(;a&&!(c>=o);){try{if(u=await this.getTransactionByHash(t),a=u.type==="pending_transaction",!a)break}catch(l){const d=l instanceof di,h=d&&l.status!==404&&l.status>=400&&l.status<500;if(!d||h)throw l}await Hr(1e3),c+=1}if(u===void 0)throw new Error(`Waiting for transaction ${t} failed`);if(a)throw new wg(`Waiting for transaction ${t} timed out after ${o} seconds`,u);if(!r)return u;if(!(u!=null&&u.success))throw new bg(`Transaction ${t} failed with an error: ${u.vm_status}`,u);return u}async waitForTransaction(t,n){await this.waitForTransactionWithResult(t,n)}async getLedgerInfo(){const{data:t}=await oi({url:this.nodeUrl,originMethod:"getLedgerInfo",overrides:{...this.config}});return t}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(t,n,i){var s;return(await Xs({url:this.nodeUrl,body:n,endpoint:`tables/${t}/item`,originMethod:"getTableItem",params:{ledger_version:(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString()},overrides:{...this.config}})).data}async generateRawTransaction(t,n,i){const[{sequence_number:s},o,{gas_estimate:r}]=await Promise.all([i!=null&&i.providedSequenceNumber?Promise.resolve({sequence_number:i.providedSequenceNumber}):this.getAccount(t),this.getChainId(),i!=null&&i.gasUnitPrice?Promise.resolve({gas_estimate:i.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:a,gasUnitPrice:c,expireTimestamp:u}={maxGasAmount:BigInt(sg),gasUnitPrice:BigInt(r),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+og),...i};return new ct.RawTransaction(ct.AccountAddress.fromHex(t),BigInt(s),n,a,c,u,new ct.ChainId(o))}async generateSignSubmitTransaction(t,n,i){const s=await this.generateRawTransaction(t.address(),n,i),o=qo.generateBCSTransaction(t,s);return(await this.submitSignedBCSTransaction(o)).hash}async signAndSubmitTransaction(t,n){const i=qo.generateBCSTransaction(t,n);return(await this.submitSignedBCSTransaction(i)).hash}async publishPackage(t,n,i,s){const o=new _n;Wn(i,o);const r=new ct.TransactionPayloadEntryFunction(ct.EntryFunction.natural("0x1::code","publish_package_txn",[],[Os(n),o.getBytes()]));return this.generateSignSubmitTransaction(t,r,s)}async createResourceAccountAndPublishPackage(t,n,i,s,o){const r=new _n;Wn(s,r);const a=new ct.TransactionPayloadEntryFunction(ct.EntryFunction.natural("0x1::resource_account","create_resource_account_and_publish_package",[],[Os(n),Os(i),r.getBytes()]));return this.generateSignSubmitTransaction(t,a,o)}async generateSignSubmitWaitForTransaction(t,n,i){const s=await this.generateSignSubmitTransaction(t,n,i);return this.waitForTransactionWithResult(s,i)}async estimateGasPrice(){const{data:t}=await oi({url:this.nodeUrl,endpoint:"estimate_gas_price",originMethod:"estimateGasPrice",overrides:{...this.config}});return t}async estimateMaxGasAmount(t){const n=`0x1::coin::CoinStore<${vc}>`,[{gas_estimate:i},s]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(t)]),o=s.find(a=>a.type===n);return BigInt(o.data.coin.value)/BigInt(i)}async rotateAuthKeyEd25519(t,n,i){const{sequence_number:s,authentication_key:o}=await this.getAccount(t.address()),r=new ia(n),a=new ct.RotationProofChallenge(ct.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(s),ct.AccountAddress.fromHex(t.address()),new ct.AccountAddress(new $e(o).toUint8Array()),r.pubKey().toUint8Array()),c=$e.fromUint8Array(Ki(a)),u=t.signHexString(c),l=r.signHexString(c),d=new ct.TransactionPayloadEntryFunction(ct.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[gd(0),Os(t.pubKey().toUint8Array()),gd(0),Os(r.pubKey().toUint8Array()),Os(u.toUint8Array()),Os(l.toUint8Array())])),h=await this.generateRawTransaction(t.address(),d,i),g=qo.generateBCSTransaction(t,h);return this.submitSignedBCSTransaction(g)}async lookupOriginalAddress(t){const n=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:i}}=n.data,s=await this.getTableItem(i,{key_type:"address",value_type:"address",key:$e.ensure(t).hex()});return new $e(s)}async getBlockByHeight(t,n){const{data:i}=await oi({url:this.nodeUrl,endpoint:`blocks/by_height/${t}`,originMethod:"getBlockByHeight",params:{with_transactions:n},overrides:{...this.config}});return i}async getBlockByVersion(t,n){const{data:i}=await oi({url:this.nodeUrl,endpoint:`blocks/by_version/${t}`,originMethod:"getBlockByVersion",params:{with_transactions:n},overrides:{...this.config}});return i}async view(t,n){const{data:i}=await Xs({url:this.nodeUrl,body:t,endpoint:"view",originMethod:"getTableItem",params:{ledger_version:n},overrides:{...this.config}});return i}clearCache(t){f1(t)}},Rt=qo;un([On],Rt.prototype,"getAccount",1);un([On],Rt.prototype,"getAccountTransactions",1);un([On,ag(10*60*1e3)],Rt.prototype,"getAccountModules",1);un([On],Rt.prototype,"getAccountModule",1);un([On],Rt.prototype,"getAccountResources",1);un([On],Rt.prototype,"getAccountResource",1);un([On],Rt.prototype,"getEventsByCreationNumber",1);un([On],Rt.prototype,"getEventsByEventHandle",1);un([On],Rt.prototype,"submitSignedBCSTransaction",1);un([On],Rt.prototype,"submitBCSSimulation",1);un([On],Rt.prototype,"getTransactions",1);un([On],Rt.prototype,"getTransactionByHash",1);un([On],Rt.prototype,"getTransactionByVersion",1);un([On],Rt.prototype,"getLedgerInfo",1);un([Zc()],Rt.prototype,"getChainId",1);un([On],Rt.prototype,"getTableItem",1);un([On,Zc({ttlMs:5*60*1e3,tags:["gas_estimates"]})],Rt.prototype,"estimateGasPrice",1);un([On],Rt.prototype,"estimateMaxGasAmount",1);un([On],Rt.prototype,"getBlockByHeight",1);un([On],Rt.prototype,"getBlockByVersion",1);un([On],Rt.prototype,"view",1);var wg=class extends Error{constructor(t,n){super(t),this.lastSubmittedTransaction=n}},bg=class extends Error{constructor(t,n){super(t),this.transaction=n}},di=class extends Error{constructor(t,n,i,s){super(n),this.status=t,this.message=n,this.errorCode=i,this.vmErrorCode=s}};function On(e,t,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof nh?new di(c.status,JSON.stringify({message:c.message,...c.data}),(r=c.data)==null?void 0:r.error_code,(a=c.data)==null?void 0:a.vm_error_code):c}},n}var wn=class{constructor(t,n){this.endpoint=t,this.config=n}static validateAddress(t){if(t.length<66)throw new Error(`${t} is less than 66 chars long.`)}async queryIndexer(t){const n=await Xs({url:this.endpoint,body:t,overrides:{WITH_CREDENTIALS:!1,...this.config}});if(n.data.errors)throw new di(n.data.errors[0].extensions.code,JSON.stringify({message:n.data.errors[0].message,error_code:n.data.errors[0].extensions.code}));return n.data.data}async getIndexerLedgerInfo(){const t={query:V1};return this.queryIndexer(t)}async getAccountNFTs(t,n){const i=$e.ensure(t).hex();wn.validateAddress(i);const s={query:N1,variables:{address:i,offset:n==null?void 0:n.offset,limit:n==null?void 0:n.limit}};return this.queryIndexer(s)}async getTokenActivities(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:Y1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenActivitiesCount(t){const n={query:Q1,variables:{token_id:t}};return this.queryIndexer(n)}async getAccountTokensCount(t,n){var i,s;const o={owner_address:{_eq:t},amount:{_gt:"0"}};n!=null&&n.tokenStandard&&(o.token_standard={_eq:n==null?void 0:n.tokenStandard});const r=$e.ensure(t).hex();wn.validateAddress(r);const a={query:F1,variables:{where_condition:o,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit}};return this.queryIndexer(a)}async getTokenData(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:tx,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnersData(t,n,i){var s,o;const r=$e.ensure(t).hex();wn.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:ix,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getTokenCurrentOwnerData(t,n,i){var s,o;const r=$e.ensure(t).hex();wn.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:ex,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getOwnedTokens(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const r={owner_address:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:J1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getOwnedTokensByTokenData(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const r={token_data_id:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:Z1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnedFromCollectionAddress(t,n,i){var s,o;const r=$e.ensure(t).hex();wn.validateAddress(r);const a=$e.ensure(n).hex();wn.validateAddress(a);const c={owner_address:{_eq:r},current_token_data:{collection_id:{_eq:a}},amount:{_gt:0}};i!=null&&i.tokenStandard&&(c.token_standard={_eq:i==null?void 0:i.tokenStandard});const u={query:nx,variables:{where_condition:c,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(u)}async getTokenOwnedFromCollectionNameAndCreatorAddress(t,n,i,s){const o=await this.getCollectionAddress(i,n,s);return await this.getTokenOwnedFromCollectionAddress(t,o,s)}async getCollectionData(t,n,i){var s,o;const r=$e.ensure(t).hex();wn.validateAddress(r);const a={collection_name:{_eq:n},creator_address:{_eq:r}};i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:H1,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getCollectionAddress(t,n,i){return(await this.getCollectionData(t,n,i)).current_collections_v2[0].collection_id}async getCollectionsWithOwnedTokens(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const r={owner_address:{_eq:o}};n!=null&&n.tokenStandard&&(r.current_collection={token_standard:{_eq:n==null?void 0:n.tokenStandard}});const a={query:K1,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountTransactionsCount(t){const n=$e.ensure(t).hex();wn.validateAddress(n);const i={query:j1,variables:{address:n}};return this.queryIndexer(i)}async getAccountTransactionsData(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const a={query:z1,variables:{where_condition:{account_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTopUserTransactions(t){const n={query:sx,variables:{limit:t}};return this.queryIndexer(n)}async getUserTransactions(t){var n,i;const s={version:{_lte:t==null?void 0:t.startVersion}},o={query:ox,variables:{where_condition:s,offset:(n=t==null?void 0:t.options)==null?void 0:n.offset,limit:(i=t==null?void 0:t.options)==null?void 0:i.limit,order_by:t==null?void 0:t.orderBy}};return this.queryIndexer(o)}async getDelegatedStakingActivities(t,n){const i=$e.ensure(t).hex(),s=$e.ensure(n).hex();wn.validateAddress(i),wn.validateAddress(s);const o={query:W1,variables:{delegatorAddress:i,poolAddress:s}};return this.queryIndexer(o)}async getNumberOfDelegators(t){const n=$e.ensure(t).hex();wn.validateAddress(n);const i={query:X1,variables:{poolAddress:n}};return this.queryIndexer(i)}async getAccountCoinsData(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const a={query:M1,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountCoinsDataCount(t){const n=$e.ensure(t).hex();wn.validateAddress(n);const i={query:D1,variables:{address:n}};return this.queryIndexer(i)}async getAccountOwnedObjects(t,n){var i,s;const o=$e.ensure(t).hex();wn.validateAddress(o);const a={query:G1,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}},sa=class{constructor(t,n,i=!1){let s=null,o=null;if(typeof t=="object"&&lx(t)?(s=t.fullnodeUrl,o=t.indexerUrl,this.network="CUSTOM"):(s=cg[t],o=xc[t],this.network=t),this.network==="CUSTOM"&&!s)throw new Error("fullnode url is not provided");o&&(this.indexerClient=new wn(o,n)),this.aptosClient=new Rt(s,n,i)}};function vg(e,t,n){Object.getOwnPropertyNames(t.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(t.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(e.prototype,i,s))}),Object.getOwnPropertyNames(t).forEach(i=>{const s=Object.getOwnPropertyDescriptor(t,i);s&&(s.value=function(...o){return this[n][i](...o)},!e.hasOwnProperty.call(e,i)&&Object.defineProperty(e,i,s))})}vg(sa,Rt,"aptosClient");vg(sa,wn,"indexerClient");function lx(e){return e.fullnodeUrl!==void 0&&typeof e.fullnodeUrl=="string"}var yh=class{constructor(t,n){this.type=t,this.value=n}},bu=class{constructor(){this.data={}}setProperty(t,n){this.data[t]=n}};function vu(e){let t;return e==="string"||e==="String"?t=new Fs(lh):t=new _o(e).parseTypeTag(),t}function Ac(e,t){if(e.length!==t.length)throw new Error("Length of property values and types not match");const n=new Array;return t.forEach((i,s)=>{try{const o=vu(i),r=new _n;wu(e[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(e[s]))}}),n}function md(e,t){if(!e||!t)throw new Error("value or type can not be empty");try{const n=vu(t),i=new _n;return wu(e,n,i),i.getBytes()}catch{return new TextEncoder().encode(e)}}function wh(e){const t=e.map.data,n=new bu;return t.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=vu(r),c=xg(a,o),u=new yh(r,c);n.setProperty(s,u)}),n}function xg(e,t){const n=new sh(new $e(t).toUint8Array());let i="";return e instanceof ds?i=n.deserializeU8().toString():e instanceof po?i=n.deserializeU64().toString():e instanceof go?i=n.deserializeU128().toString():e instanceof fo?i=n.deserializeBool()?"true":"false":e instanceof Ns?i=$e.fromUint8Array(n.deserializeFixedBytes(32)).hex():e instanceof Fs&&e.isStringTypeTag()?i=n.deserializeStr():i=t,i}var Tg={};Jc(Tg,{PropertyMap:()=>bu,PropertyValue:()=>yh,Token:()=>kg,TokenData:()=>Ag});var Ag=class{constructor(t,n,i,s,o,r,a,c){this.collection=t,this.description=n,this.name=i,this.maximum=s,this.supply=o,this.uri=r,this.default_properties=wh(a),this.mutability_config=c}},kg=class{constructor(t,n,i){this.id=t,this.amount=n,this.token_properties=wh(i)}},dx=class{constructor(t){this.aptosClient=t}async createCollection(t,n,i,s,o=Xo,r){const c=await new gn(this.aptosClient,{sender:t.address(),...r}).build("0x3::token::create_collection_script",[],[n,i,s,o,[!1,!1,!1]]),u=Rt.generateBCSTransaction(t,c);return(await this.aptosClient.submitSignedBCSTransaction(u)).hash}async createToken(t,n,i,s,o,r,a=Xo,c=t.address(),u=0,l=0,d=[],h=[],g=[],b){const k=await new gn(this.aptosClient,{sender:t.address(),...b}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,[!1,!1,!1,!1,!1],d,Ac(h,g),g]),E=Rt.generateBCSTransaction(t,k);return(await this.aptosClient.submitSignedBCSTransaction(E)).hash}async createTokenWithMutabilityConfig(t,n,i,s,o,r,a=Xo,c=t.address(),u=0,l=0,d=[],h=[],g=[],b=[!1,!1,!1,!1,!1],v){const E=await new gn(this.aptosClient,{sender:t.address(),...v}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,b,d,h,g]),N=Rt.generateBCSTransaction(t,E);return(await this.aptosClient.submitSignedBCSTransaction(N)).hash}async offerToken(t,n,i,s,o,r,a=0,c){const l=await new gn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token_transfers::offer_script",[],[n,i,s,o,a,r]),d=Rt.generateBCSTransaction(t,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async claimToken(t,n,i,s,o,r=0,a){const u=await new gn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token_transfers::claim_script",[],[n,i,s,o,r]),l=Rt.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async cancelTokenOffer(t,n,i,s,o,r=0,a){const u=await new gn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token_transfers::cancel_offer_script",[],[n,i,s,o,r]),l=Rt.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async directTransferToken(t,n,i,s,o,r,a=0,c){const l=await new gn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token::direct_transfer_script",[],[i,s,o,a,r]),d=new ct.MultiAgentRawTransaction(l,[ct.AccountAddress.fromHex(n.address())]),h=new ct.Ed25519Signature(t.signBuffer(zi.getSigningMessage(d)).toUint8Array()),g=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(t.signingKey.publicKey),h),b=new ct.Ed25519Signature(n.signBuffer(zi.getSigningMessage(d)).toUint8Array()),v=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(n.signingKey.publicKey),b),k=new ct.TransactionAuthenticatorMultiAgent(g,[ct.AccountAddress.fromHex(n.address())],[v]),E=Ki(new ct.SignedTransaction(l,k));return(await this.aptosClient.submitSignedBCSTransaction(E)).hash}async directTransferTokenWithFeePayer(t,n,i,s,o,r,a,c=0,u){const d=await new gn(this.aptosClient,{sender:t.address(),...u}).build("0x3::token::direct_transfer_script",[],[i,s,o,c,r]),h=new ct.FeePayerRawTransaction(d,[ct.AccountAddress.fromHex(n.address())],ct.AccountAddress.fromHex(a.address())),g=new ct.Ed25519Signature(t.signBuffer(zi.getSigningMessage(h)).toUint8Array()),b=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(t.signingKey.publicKey),g),v=new ct.Ed25519Signature(n.signBuffer(zi.getSigningMessage(h)).toUint8Array()),k=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(n.signingKey.publicKey),v),E=new ct.Ed25519Signature(a.signBuffer(zi.getSigningMessage(h)).toUint8Array()),N=new ct.AccountAuthenticatorEd25519(new ct.Ed25519PublicKey(a.signingKey.publicKey),E),A=new ct.TransactionAuthenticatorFeePayer(b,[ct.AccountAddress.fromHex(n.address())],[k],{address:ct.AccountAddress.fromHex(a.address()),authenticator:N}),P=Ki(new ct.SignedTransaction(d,A));return(await this.aptosClient.submitSignedBCSTransaction(P)).hash}async optInTokenTransfer(t,n,i){const o=await new gn(this.aptosClient,{sender:t.address(),...i}).build("0x3::token::opt_in_direct_transfer",[],[n]),r=Rt.generateBCSTransaction(t,o);return(await this.aptosClient.submitSignedBCSTransaction(r)).hash}async transferWithOptIn(t,n,i,s,o,r,a,c){const l=await new gn(this.aptosClient,{sender:t.address(),...c}).build("0x3::token::transfer_with_opt_in",[],[n,i,s,o,r,a]),d=Rt.generateBCSTransaction(t,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async burnByCreator(t,n,i,s,o,r,a){const u=await new gn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token::burn_by_creator",[],[n,i,s,o,r]),l=Rt.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async burnByOwner(t,n,i,s,o,r,a){const u=await new gn(this.aptosClient,{sender:t.address(),...a}).build("0x3::token::burn",[],[n,i,s,o,r]),l=Rt.generateBCSTransaction(t,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async mutateTokenProperties(t,n,i,s,o,r,a,c,u,l,d){const g=await new gn(this.aptosClient,{sender:t.address(),...d}).build("0x3::token::mutate_token_properties",[],[n,i,s,o,r,a,c,u,l]),b=Rt.generateBCSTransaction(t,g);return(await this.aptosClient.submitSignedBCSTransaction(b)).hash}async getCollectionData(t,n){const s=(await this.aptosClient.getAccountResources(t)).find(c=>c.type==="0x3::token::Collections"),{handle:o}=s.data.collection_data,r={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:n};return await this.aptosClient.getTableItem(o,r)}async getTokenData(t,n,i){const s=t instanceof $e?t.hex():t,o=await this.aptosClient.getAccountResource(s,"0x3::token::Collections"),{handle:r}=o.data.token_data,c={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:s,collection:n,name:i}},u=await this.aptosClient.getTableItem(r,c);return new Ag(u.collection,u.description,u.name,u.maximum,u.supply,u.uri,u.default_properties,u.mutability_config)}async getToken(t,n,i,s="0"){const o={creator:t instanceof $e?t.hex():t,collection:n,name:i};return this.getTokenForAccount(t,{token_data_id:o,property_version:s})}async getTokenForAccount(t,n){const i=await this.aptosClient.getAccountResource(t instanceof $e?t.hex():t,"0x3::token::TokenStore"),{handle:s}=i.data.tokens,o={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:n};try{const r=await this.aptosClient.getTableItem(s,o);return new kg(r.id,r.amount,r.token_properties)}catch(r){return(r==null?void 0:r.status)===404?{id:n,amount:"0",token_properties:new bu}:r}}},kc=class{constructor(e){this.assetType="0x1::fungible_asset::Metadata",this.provider=e}async transfer(e,t,n,i,s){const o=await this.generateTransfer(e,t,n,i,s);return await this.provider.signAndSubmitTransaction(e,o)}async getPrimaryBalance(e,t){const n={function:"0x1::primary_fungible_store::balance",type_arguments:[this.assetType],arguments:[$e.ensure(e).hex(),$e.ensure(t).hex()]},i=await this.provider.view(n);return BigInt(i[0])}async generateTransfer(e,t,n,i,s){return await new gn(this.provider,{sender:e.address(),...s}).build("0x1::primary_fungible_store::transfer",[this.assetType],[$e.ensure(t).hex(),$e.ensure(n).hex(),i])}},Co={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",VECTOR:"vector<u8>",STRING:"string"},hx=class{constructor(e){this.tokenType="0x4::token::Token",this.provider=e}async submitTransaction(e,t,n,i,s){const r=await new gn(this.provider,{sender:e.address(),...s}).build(`0x4::aptos_token::${t}`,n,i),a=Rt.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async createCollection(e,t,n,i,s=Xo,o,r){var a,c,u,l,d,h,g,b,v,k,E;return this.submitTransaction(e,"create_collection",[],[t,s,n,i,(a=o==null?void 0:o.mutableDescription)!=null?a:!0,(c=o==null?void 0:o.mutableRoyalty)!=null?c:!0,(u=o==null?void 0:o.mutableURI)!=null?u:!0,(l=o==null?void 0:o.mutableTokenDescription)!=null?l:!0,(d=o==null?void 0:o.mutableTokenName)!=null?d:!0,(h=o==null?void 0:o.mutableTokenProperties)!=null?h:!0,(g=o==null?void 0:o.mutableTokenURI)!=null?g:!0,(b=o==null?void 0:o.tokensBurnableByCreator)!=null?b:!0,(v=o==null?void 0:o.tokensFreezableByCreator)!=null?v:!0,(k=o==null?void 0:o.royaltyNumerator)!=null?k:0,(E=o==null?void 0:o.royaltyDenominator)!=null?E:1],r)}async mint(e,t,n,i,s,o=[],r=[],a=[],c){return this.submitTransaction(e,"mint",[],[t,n,i,s,o,r,Ac(a,r)],c)}async mintSoulBound(e,t,n,i,s,o,r=[],a=[],c=[],u){return this.submitTransaction(e,"mint_soul_bound",[],[t,n,i,s,r,a,Ac(c,a),o.address().hex()],u)}async burnToken(e,t,n,i){return this.submitTransaction(e,"burn",[n||this.tokenType],[$e.ensure(t).hex()],i)}async freezeTokenTransafer(e,t,n,i){return this.submitTransaction(e,"freeze_transfer",[n||this.tokenType],[$e.ensure(t).hex()],i)}async unfreezeTokenTransafer(e,t,n,i){return this.submitTransaction(e,"unfreeze_transfer",[n||this.tokenType],[$e.ensure(t).hex()],i)}async setTokenDescription(e,t,n,i,s){return this.submitTransaction(e,"set_description",[i||this.tokenType],[$e.ensure(t).hex(),n],s)}async setTokenName(e,t,n,i,s){return this.submitTransaction(e,"set_name",[i||this.tokenType],[$e.ensure(t).hex(),n],s)}async setTokenURI(e,t,n,i,s){return this.submitTransaction(e,"set_uri",[i||this.tokenType],[$e.ensure(t).hex(),n],s)}async addTokenProperty(e,t,n,i,s,o,r){return this.submitTransaction(e,"add_property",[o||this.tokenType],[$e.ensure(t).hex(),n,Co[i],md(s,Co[i])],r)}async removeTokenProperty(e,t,n,i,s){return this.submitTransaction(e,"remove_property",[i||this.tokenType],[$e.ensure(t).hex(),n],s)}async updateTokenProperty(e,t,n,i,s,o,r){return this.submitTransaction(e,"update_property",[o||this.tokenType],[$e.ensure(t).hex(),n,Co[i],md(s,Co[i])],r)}async addTypedProperty(e,t,n,i,s,o,r){return this.submitTransaction(e,"add_typed_property",[o||this.tokenType,Co[i]],[$e.ensure(t).hex(),n,s],r)}async updateTypedProperty(e,t,n,i,s,o,r){return this.submitTransaction(e,"update_typed_property",[o||this.tokenType,Co[i]],[$e.ensure(t).hex(),n,s],r)}async transferTokenOwnership(e,t,n,i,s){const r=await new gn(this.provider,{sender:e.address(),...s}).build("0x1::object::transfer",[i||this.tokenType],[$e.ensure(t).hex(),$e.ensure(n).hex()]),a=Rt.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async transfer(e,t){let n=t;if(n==null&&(n=(await this.provider.getTokenData($e.ensure(e.tokenAddress).hex())).current_token_datas_v2[0].is_fungible_v2),n){const o=e;return await new kc(this.provider).transfer(o.owner,o.tokenAddress,o.recipient,o.amount,o.extraArgs)}const i=e;return await this.transferTokenOwnership(i.owner,i.tokenAddress,i.recipient,i.tokenType,i.extraArgs)}async burnObject(e,t,n,i){const o=await new gn(this.provider,{sender:e.address(),...i}).build("0x1::object::burn",[n||"0x1::object::ObjectCore"],[$e.ensure(t).hex()]),r=Rt.generateBCSTransaction(e,o);return(await this.provider.submitSignedBCSTransaction(r)).hash}},yd="0x1::aptos_account::transfer_coins",Sg="0x1::coin::transfer",fx=class{constructor(e){this.aptosClient=e}async transfer(e,t,n,i){var s,o,r;const a=((s=i==null?void 0:i.coinType)!=null?s:"").toString().includes("::");if(i!=null&&i.coinType&&!a&&nn.isValid(i.coinType)){console.warn("to transfer a fungible asset, use `FungibleAssetClient()` class for better support");const v=new sa({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(o=xc[pd[this.aptosClient.nodeUrl]])!=null?o:this.aptosClient.nodeUrl});return await new kc(v).transfer(e,i==null?void 0:i.coinType,ji(t),n)}const c=(r=i==null?void 0:i.coinType)!=null?r:vc;let u;(i==null?void 0:i.createReceiverIfMissing)===void 0?u=yd:u=i!=null&&i.createReceiverIfMissing?yd:Sg;const l=ji(t),h=await new gn(this.aptosClient,{sender:e.address(),...i}).build(u,[c],[l,n]),g=Rt.generateBCSTransaction(e,h);return(await this.aptosClient.submitSignedBCSTransaction(g)).hash}async checkBalance(e,t){var n,i,s;const o=((n=t==null?void 0:t.coinType)!=null?n:"").toString().includes("::");if(t!=null&&t.coinType&&!o&&nn.isValid(t.coinType)){console.warn("to check balance of a fungible asset, use `FungibleAssetClient()` class for better support");const l=new sa({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(i=xc[pd[this.aptosClient.nodeUrl]])!=null?i:this.aptosClient.nodeUrl});return await new kc(l).getPrimaryBalance(ji(e),t==null?void 0:t.coinType)}const a=`0x1::coin::CoinStore<${(s=t==null?void 0:t.coinType)!=null?s:vc}>`,c=ji(e),u=await this.aptosClient.getAccountResource(c,a);return BigInt(u.data.coin.value)}},px=class extends Rt{constructor(e,t,n){if(super(e,n),!t)throw new Error("Faucet URL cannot be empty.");this.faucetUrl=t,this.config=n}async fundAccount(e,t,n=rg){const{data:i}=await Xs({url:this.faucetUrl,endpoint:"mint",body:null,params:{address:$e.ensure(e).noPrefix(),amount:t},overrides:{...this.config},originMethod:"fundAccount"}),s=[];for(let o=0;o<i.length;o+=1){const r=i[o];s.push(this.waitForTransaction(r,{timeoutSecs:n}))}return await Promise.all(s),i}},wd={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c"},as=/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/,Pg=new RegExp("^(?:(?<subdomain>[^.]+)\\.(?!apt$))?(?<domain>[^.]+)(?:\\.apt)?$"),gx=class{constructor(e,t){var n;if(this.provider=e,!wd[this.provider.network]&&!t)throw new Error("Error: For custom providers, you must pass in a contract address");this.contractAddress=(n=wd[this.provider.network])!=null?n:t}async getPrimaryNameByAddress(e){const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::ReverseLookupRegistryV1`)).data,{handle:i}=n.registry,s={key_type:"address",value_type:`${this.contractAddress}::domains::NameRecordKeyV1`,key:e};try{const o=await this.provider.getTableItem(i,s);return o.subdomain_name.vec[0]?`${o.subdomain_name.vec[0]}.${o.domain_name}`:o.domain_name}catch(o){if(o.status===404)return null;throw new Error(o)}}async getAddressByName(e){var t,n;const{domain:i,subdomain:s}=(n=(t=e.match(Pg))==null?void 0:t.groups)!=null?n:{};if(!i)return null;const o=s?await this.getRegistrationForSubdomainName(i,s):await this.getRegistrationForDomainName(i);return o===null?null:o.target}async mintAptosName(e,t,n=1,i){if(t.match(as)===null)throw new di(400,`Name ${t} is not valid`);const s=await this.getRegistrationForDomainName(t);if(s&&Math.ceil(Date.now()/1e3)<s.expirationTimestampSeconds)throw new di(400,`Name ${t} is not available`);const r=await new gn(this.provider.aptosClient,{sender:e.address(),...i}).build(`${this.contractAddress}::domains::register_domain`,[],[t,n]),a=Rt.generateBCSTransaction(e,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async mintAptosSubdomain(e,t,n,i,s){if(n.match(as)===null)throw new di(400,`Domain name ${n} is not valid`);if(t.match(as)===null)throw new di(400,`Subdomain name ${t} is not valid`);const o=await this.getRegistrationForSubdomainName(n,t);if(o&&Math.ceil(Date.now()/1e3)<o.expirationTimestampSeconds)throw new di(400,`Name ${t}.${n} is not available`);const r=await this.getRegistrationForDomainName(n);if(r===null)throw new di(400,`Domain name ${n} does not exist`);const a=Math.ceil(Date.now()/1e3);if(r.expirationTimestampSeconds<a)throw new di(400,`Domain name ${n} expired`);const c=i||r.expirationTimestampSeconds;if(c<a)throw new di(400,`Expiration for ${t}.${n} is before now`);const l=await new gn(this.provider.aptosClient,{sender:e.address(),...s}).build(`${this.contractAddress}::domains::register_subdomain`,[],[t,n,c]),d=Rt.generateBCSTransaction(e,l);return(await this.provider.submitSignedBCSTransaction(d)).hash}async setSubdomainAddress(e,t,n,i,s){const o=nn.standardizeAddress(i);if(n.match(as)===null)throw new di(400,`Name ${n} is not valid`);if(t.match(as)===null)throw new di(400,`Name ${t} is not valid`);const a=await new gn(this.provider.aptosClient,{sender:e.address(),...s}).build(`${this.contractAddress}::domains::set_subdomain_address`,[],[t,n,o]),c=Rt.generateBCSTransaction(e,a);return(await this.provider.submitSignedBCSTransaction(c)).hash}async initReverseLookupRegistry(e,t){const i=await new gn(this.provider.aptosClient,{sender:e.address(),...t}).build(`${this.contractAddress}::domains::init_reverse_lookup_registry_v1`,[],[]),s=Rt.generateBCSTransaction(e,i);return(await this.provider.submitSignedBCSTransaction(s)).hash}async getRegistrationForDomainName(e){if(e.match(as)===null)return null;const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:i}=n.registry,s={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[]},domain_name:e}};try{const o=await this.provider.getTableItem(i,s);return{target:o.target_address.vec.length===1?o.target_address.vec[0]:null,expirationTimestampSeconds:o.expiration_time_sec}}catch(o){if(o.status===404)return null;throw new Error(o)}}async getRegistrationForSubdomainName(e,t){if(e.match(as)===null||t.match(as)===null)return null;const i=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:s}=i.registry,o={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[t]},domain_name:e}};try{const r=await this.provider.getTableItem(s,o);return{target:r.target_address.vec.length===1?r.target_address.vec[0]:null,expirationTimestampSeconds:r.expiration_time_sec}}catch(r){if(r.status===404)return null;throw new Error(r)}}},Na=()=>Math.floor(Date.now()/1e3),Eg=class{constructor(e,t,n,i,s){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.provider=e,this.account=t,this.maxWaitTime=n,this.maximumInFlight=i,this.sleepTime=s}async nextSequenceNumber(){for(;this.lock;)await Hr(this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((this.lastUncommintedNumber===null||this.currentNumber===null)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();const t=Na();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await Hr(this.sleepTime),Na()-t>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(t){console.error("error in getting next sequence number for this account",t)}finally{this.lock=!1}return e}async initialize(){const{sequence_number:e}=await this.provider.getAccount(this.account.address());this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){const{sequence_number:e}=await this.provider.getAccount(this.account.address());return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await Hr(this.sleepTime);this.lock=!0;try{await this.update();const e=Na();for(;this.lastUncommintedNumber!==this.currentNumber;)Na()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):(await Hr(this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}},kl=class{constructor(){this.queue=[],this.resolveMap=new Map,this.counter=0,this.cancelled=!1}enqueue(e){if(this.resolveMap.size>0){const t=this.resolveMap.get(0);if(t){this.resolveMap.delete(0),t(e);return}}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise(t=>{this.counter+=1,this.resolveMap.set(this.counter,t)})}isEmpty(){return this.queue.length===0}cancel(){this.cancelled=!0,this.resolveMap.forEach(async e=>{e(await Promise.reject(new bd("Task cancelled")))}),this.resolveMap.clear(),this.queue.length=0}isCancelled(){return this.cancelled}},bd=class extends Error{constructor(e){super(e)}},Rf="fulfilled",Cg=(e=>(e.TransactionSent="transactionSent",e.TransactionSendFailed="transactionsendFailed",e.TransactionExecuted="transactionExecuted",e.TransactionExecutionFailed="transactionexecutionFailed",e))(Cg||{}),_x=class extends fd{constructor(e,t,n=30,i=100,s=10){super(),this.taskQueue=new kl,this.transactionsQueue=new kl,this.outstandingTransactions=new kl,this.sentTransactions=[],this.executedTransactions=[],this.provider=e,this.account=t,this.started=!1,this.accountSequnceNumber=new Eg(e,t,n,i,s)}async submitNextTransaction(){try{for(;;){if(this.transactionsQueue.isEmpty())return;const e=await this.accountSequnceNumber.nextSequenceNumber();if(e===null)return;const t=await this.generateNextTransaction(this.account,e);if(!t)return;const n=this.provider.submitSignedBCSTransaction(t);await this.outstandingTransactions.enqueue([n,e])}}catch(e){if(e instanceof bd)return;console.log(e)}}async processTransactions(){try{for(;;){const e=[],t=[];let[n,i]=await this.outstandingTransactions.dequeue();for(e.push(n),t.push(i);!this.outstandingTransactions.isEmpty();)[n,i]=await this.outstandingTransactions.dequeue(),e.push(n),t.push(i);const s=await Promise.allSettled(e);for(let o=0;o<s.length&&o<t.length;o+=1){const r=s[o];i=t[o],r.status===Rf?(this.sentTransactions.push([r.value.hash,i,null]),this.emit("transactionSent",[this.sentTransactions.length,r.value.hash]),await this.checkTransaction(r,i)):(this.sentTransactions.push([r.status,i,r.reason]),this.emit("transactionsendFailed",[this.sentTransactions.length,r.reason]))}}}catch(e){if(e instanceof bd)return;console.log(e)}}async checkTransaction(e,t){const n=[];n.push(this.provider.waitForTransactionWithResult(e.value.hash,{checkSuccess:!0}));const i=await Promise.allSettled(n);for(let s=0;s<i.length;s+=1){const o=i[s];o.status===Rf?(this.executedTransactions.push([o.value.hash,t,null]),this.emit("transactionExecuted",[this.executedTransactions.length,o.value.hash])):(this.executedTransactions.push([o.status,t,o.reason]),this.emit("transactionexecutionFailed",[this.executedTransactions.length,o.reason]))}}async push(e){await this.transactionsQueue.enqueue(e)}async generateNextTransaction(e,t){if(this.transactionsQueue.isEmpty())return;const n=await this.transactionsQueue.dequeue(),i=await this.provider.generateRawTransaction(e.address(),n,{providedSequenceNumber:t});return Rt.generateBCSTransaction(e,i)}async run(){try{for(;!this.taskQueue.isCancelled();)await(await this.taskQueue.dequeue())()}catch(e){throw new Error(e)}}start(){if(this.started)throw new Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw new Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},Bg={};Jc(Bg,{AptosErrorCode:()=>Ig,MoveFunctionVisibility:()=>Og,RoleType:()=>Rg});var Ig=(e=>(e.ACCOUNT_NOT_FOUND="account_not_found",e.RESOURCE_NOT_FOUND="resource_not_found",e.MODULE_NOT_FOUND="module_not_found",e.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",e.VERSION_NOT_FOUND="version_not_found",e.TRANSACTION_NOT_FOUND="transaction_not_found",e.TABLE_ITEM_NOT_FOUND="table_item_not_found",e.BLOCK_NOT_FOUND="block_not_found",e.STATE_VALUE_NOT_FOUND="state_value_not_found",e.VERSION_PRUNED="version_pruned",e.BLOCK_PRUNED="block_pruned",e.INVALID_INPUT="invalid_input",e.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",e.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",e.VM_ERROR="vm_error",e.HEALTH_CHECK_FAILED="health_check_failed",e.MEMPOOL_IS_FULL="mempool_is_full",e.INTERNAL_ERROR="internal_error",e.WEB_FRAMEWORK_ERROR="web_framework_error",e.BCS_NOT_SUPPORTED="bcs_not_supported",e.API_DISABLED="api_disabled",e))(Ig||{}),Og=(e=>(e.PRIVATE="private",e.PUBLIC="public",e.FRIEND="friend",e))(Og||{}),Rg=(e=>(e.VALIDATOR="validator",e.FULL_NODE="full_node",e))(Rg||{}),$g=(e=>(e.AccountAddress="account_address",e.TransactionVersion="transaction_version",e))($g||{}),Ug=(e=>(e.AccountAddress="account_address",e.MinBlockHeight="min_block_height",e.NumDistinctVersions="num_distinct_versions",e))(Ug||{}),qg=(e=>(e.AccountAddress="account_address",e.TransactionVersion="transaction_version",e))(qg||{}),Lg=(e=>(e.Address="address",e.TransactionVersion="transaction_version",e))(Lg||{}),Dg=(e=>(e.BlockHeight="block_height",e.Epoch="epoch",e.FailedProposerIndices="failed_proposer_indices",e.Id="id",e.PreviousBlockVotesBitvec="previous_block_votes_bitvec",e.Proposer="proposer",e.Round="round",e.Timestamp="timestamp",e.Version="version",e))(Dg||{}),Mg=(e=>(e.ActivityType="activity_type",e.Amount="amount",e.BlockHeight="block_height",e.CoinType="coin_type",e.EntryFunctionIdStr="entry_function_id_str",e.EventAccountAddress="event_account_address",e.EventCreationNumber="event_creation_number",e.EventIndex="event_index",e.EventSequenceNumber="event_sequence_number",e.IsGasFee="is_gas_fee",e.IsTransactionSuccess="is_transaction_success",e.OwnerAddress="owner_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(Mg||{}),Ng=(e=>(e.Amount="amount",e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.OwnerAddress="owner_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(Ng||{}),Fg=(e=>(e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.CreatorAddress="creator_address",e.Decimals="decimals",e.Name="name",e.SupplyAggregatorTableHandle="supply_aggregator_table_handle",e.SupplyAggregatorTableKey="supply_aggregator_table_key",e.Symbol="symbol",e.TransactionCreatedTimestamp="transaction_created_timestamp",e.TransactionVersionCreated="transaction_version_created",e))(Fg||{}),jg=(e=>(e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.Supply="supply",e.TransactionEpoch="transaction_epoch",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(jg||{}),zg=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Description="description",e.DescriptionMutable="description_mutable",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Supply="supply",e.TableHandle="table_handle",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.UriMutable="uri_mutable",e))(zg||{}),Hg=(e=>(e.Domain="domain",e.ExpirationTimestamp="expiration_timestamp",e.IsDeleted="is_deleted",e.LastTransactionVersion="last_transaction_version",e.RegisteredAddress="registered_address",e.Subdomain="subdomain",e.TokenName="token_name",e))(Hg||{}),Kg=(e=>(e.Domain="domain",e.ExpirationTimestamp="expiration_timestamp",e.IsPrimary="is_primary",e.LastTransactionVersion="last_transaction_version",e.RegisteredAddress="registered_address",e.Subdomain="subdomain",e.TokenName="token_name",e))(Kg||{}),Gg=(e=>(e.Amount="amount",e.CoinType="coin_type",e.CoinTypeHash="coin_type_hash",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e))(Gg||{}),Wg=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Description="description",e.DescriptionMutable="description_mutable",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Supply="supply",e.TableHandle="table_handle",e.UriMutable="uri_mutable",e))(Wg||{}),Vg=(e=>(e.CollectionId="collection_id",e.CollectionName="collection_name",e.CollectionUri="collection_uri",e.CreatorAddress="creator_address",e.DistinctTokens="distinct_tokens",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.SingleTokenUri="single_token_uri",e))(Vg||{}),Xg=(e=>(e.CollectionId="collection_id",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.CurrentSupply="current_supply",e.Description="description",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.MaxSupply="max_supply",e.MutableDescription="mutable_description",e.MutableUri="mutable_uri",e.TableHandleV1="table_handle_v1",e.TokenStandard="token_standard",e.TotalMintedV2="total_minted_v2",e.Uri="uri",e))(Xg||{}),Jg=(e=>(e.ActiveTableHandle="active_table_handle",e.InactiveTableHandle="inactive_table_handle",e.LastTransactionVersion="last_transaction_version",e.OperatorCommissionPercentage="operator_commission_percentage",e.StakingPoolAddress="staking_pool_address",e.TotalCoins="total_coins",e.TotalShares="total_shares",e))(Jg||{}),Zg=(e=>(e.DelegationPoolAddress="delegation_pool_address",e.DelegatorAddress="delegator_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.PendingVoter="pending_voter",e.TableHandle="table_handle",e.Voter="voter",e))(Zg||{}),Yg=(e=>(e.DelegatorAddress="delegator_address",e.LastTransactionVersion="last_transaction_version",e.ParentTableHandle="parent_table_handle",e.PoolAddress="pool_address",e.PoolType="pool_type",e.Shares="shares",e.TableHandle="table_handle",e))(Yg||{}),Qg=(e=>(e.Amount="amount",e.AssetType="asset_type",e.IsFrozen="is_frozen",e.IsPrimary="is_primary",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.StorageId="storage_id",e.TokenStandard="token_standard",e))(Qg||{}),e_=(e=>(e.AllowUngatedTransfer="allow_ungated_transfer",e.IsDeleted="is_deleted",e.LastGuidCreationNum="last_guid_creation_num",e.LastTransactionVersion="last_transaction_version",e.ObjectAddress="object_address",e.OwnerAddress="owner_address",e.StateKeyHash="state_key_hash",e))(e_||{}),t_=(e=>(e.LastTransactionVersion="last_transaction_version",e.OperatorAddress="operator_address",e.StakingPoolAddress="staking_pool_address",e.VoterAddress="voter_address",e))(t_||{}),n_=(e=>(e.DecodedKey="decoded_key",e.DecodedValue="decoded_value",e.IsDeleted="is_deleted",e.Key="key",e.KeyHash="key_hash",e.LastTransactionVersion="last_transaction_version",e.TableHandle="table_handle",e))(n_||{}),i_=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.DefaultProperties="default_properties",e.Description="description",e.DescriptionMutable="description_mutable",e.LargestPropertyVersion="largest_property_version",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Name="name",e.PayeeAddress="payee_address",e.PropertiesMutable="properties_mutable",e.RoyaltyMutable="royalty_mutable",e.RoyaltyPointsDenominator="royalty_points_denominator",e.RoyaltyPointsNumerator="royalty_points_numerator",e.Supply="supply",e.TokenDataIdHash="token_data_id_hash",e.UriMutable="uri_mutable",e))(i_||{}),s_=(e=>(e.CollectionId="collection_id",e.Description="description",e.IsFungibleV2="is_fungible_v2",e.LargestPropertyVersionV1="largest_property_version_v1",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Maximum="maximum",e.Supply="supply",e.TokenDataId="token_data_id",e.TokenName="token_name",e.TokenProperties="token_properties",e.TokenStandard="token_standard",e.TokenUri="token_uri",e))(s_||{}),o_=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.OwnerAddress="owner_address",e.PropertyVersion="property_version",e.TableType="table_type",e.TokenDataIdHash="token_data_id_hash",e.TokenProperties="token_properties",e))(o_||{}),r_=(e=>(e.Amount="amount",e.IsFungibleV2="is_fungible_v2",e.IsSoulboundV2="is_soulbound_v2",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.OwnerAddress="owner_address",e.PropertyVersionV1="property_version_v1",e.StorageId="storage_id",e.TableTypeV1="table_type_v1",e.TokenDataId="token_data_id",e.TokenPropertiesMutatedV1="token_properties_mutated_v1",e.TokenStandard="token_standard",e))(r_||{}),a_=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionId="collection_id",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.FromAddress="from_address",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.PropertyVersion="property_version",e.TableHandle="table_handle",e.ToAddress="to_address",e.TokenDataId="token_data_id",e.TokenDataIdHash="token_data_id_hash",e))(a_||{}),c_=(e=>(e.Asc="ASC",e.Desc="DESC",e))(c_||{}),u_=(e=>(e.Amount="amount",e.DelegatorAddress="delegator_address",e.EventIndex="event_index",e.EventType="event_type",e.PoolAddress="pool_address",e.TransactionVersion="transaction_version",e))(u_||{}),l_=(e=>(e.FirstTransactionVersion="first_transaction_version",e.StakingPoolAddress="staking_pool_address",e))(l_||{}),d_=(e=>(e.DelegatorAddress="delegator_address",e.PoolAddress="pool_address",e))(d_||{}),h_=(e=>(e.AccountAddress="account_address",e.CreationNumber="creation_number",e.Data="data",e.EventIndex="event_index",e.SequenceNumber="sequence_number",e.TransactionBlockHeight="transaction_block_height",e.TransactionVersion="transaction_version",e.Type="type",e))(h_||{}),f_=(e=>(e.Amount="amount",e.AssetType="asset_type",e.BlockHeight="block_height",e.EntryFunctionIdStr="entry_function_id_str",e.EventIndex="event_index",e.GasFeePayerAddress="gas_fee_payer_address",e.IsFrozen="is_frozen",e.IsGasFee="is_gas_fee",e.IsTransactionSuccess="is_transaction_success",e.OwnerAddress="owner_address",e.StorageId="storage_id",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.Type="type",e))(f_||{}),p_=(e=>(e.AssetType="asset_type",e.CreatorAddress="creator_address",e.Decimals="decimals",e.IconUri="icon_uri",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Name="name",e.ProjectUri="project_uri",e.SupplyAggregatorTableHandleV1="supply_aggregator_table_handle_v1",e.SupplyAggregatorTableKeyV1="supply_aggregator_table_key_v1",e.Symbol="symbol",e.TokenStandard="token_standard",e))(p_||{}),g_=(e=>(e.Db="db",e.IsIndexerUp="is_indexer_up",e))(g_||{}),__=(e=>(e.ChainId="chain_id",e))(__||{}),m_=(e=>(e.Address="address",e.TransactionVersion="transaction_version",e))(m_||{}),y_=(e=>(e.BuyItNowPrice="buy_it_now_price",e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.CurrentBidPrice="current_bid_price",e.CurrentBidder="current_bidder",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.ListingId="listing_id",e.Marketplace="marketplace",e.Seller="seller",e.StartingBidPrice="starting_bid_price",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(y_||{}),w_=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.CollectionOfferId="collection_offer_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.ItemPrice="item_price",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Marketplace="marketplace",e.RemainingTokenAmount="remaining_token_amount",e.TokenStandard="token_standard",e))(w_||{}),b_=(e=>(e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.ListingId="listing_id",e.Marketplace="marketplace",e.Price="price",e.Seller="seller",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(b_||{}),v_=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.ContractAddress="contract_address",e.EntryFunctionIdStr="entry_function_id_str",e.ExpirationTime="expiration_time",e.FeeScheduleId="fee_schedule_id",e.IsDeleted="is_deleted",e.LastTransactionTimestamp="last_transaction_timestamp",e.LastTransactionVersion="last_transaction_version",e.Marketplace="marketplace",e.OfferId="offer_id",e.Price="price",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e))(v_||{}),x_=(e=>(e.Buyer="buyer",e.CoinType="coin_type",e.CollectionId="collection_id",e.CollectionName="collection_name",e.ContractAddress="contract_address",e.CreatorAddress="creator_address",e.EntryFunctionIdStr="entry_function_id_str",e.EventIndex="event_index",e.EventType="event_type",e.FeeScheduleId="fee_schedule_id",e.Marketplace="marketplace",e.OfferOrListingId="offer_or_listing_id",e.Price="price",e.PropertyVersion="property_version",e.Seller="seller",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenName="token_name",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(x_||{}),T_=(e=>(e.AssetUri="asset_uri",e.CdnAnimationUri="cdn_animation_uri",e.CdnImageUri="cdn_image_uri",e.CdnJsonUri="cdn_json_uri",e.RawAnimationUri="raw_animation_uri",e.RawImageUri="raw_image_uri",e))(T_||{}),A_=(e=>(e.NumActiveDelegator="num_active_delegator",e.PoolAddress="pool_address",e))(A_||{}),k_=(e=>(e.Asc="asc",e.AscNullsFirst="asc_nulls_first",e.AscNullsLast="asc_nulls_last",e.Desc="desc",e.DescNullsFirst="desc_nulls_first",e.DescNullsLast="desc_nulls_last",e))(k_||{}),S_=(e=>(e.LastSuccessVersion="last_success_version",e.LastUpdated="last_updated",e.Processor="processor",e))(S_||{}),P_=(e=>(e.NumVotes="num_votes",e.ProposalId="proposal_id",e.ShouldPass="should_pass",e.StakingPoolAddress="staking_pool_address",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.VoterAddress="voter_address",e))(P_||{}),E_=(e=>(e.DecodedKey="decoded_key",e.DecodedValue="decoded_value",e.Key="key",e.TableHandle="table_handle",e.TransactionVersion="transaction_version",e.WriteSetChangeIndex="write_set_change_index",e))(E_||{}),C_=(e=>(e.Handle="handle",e.KeyType="key_type",e.ValueType="value_type",e))(C_||{}),B_=(e=>(e.CoinAmount="coin_amount",e.CoinType="coin_type",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.EventAccountAddress="event_account_address",e.EventCreationNumber="event_creation_number",e.EventIndex="event_index",e.EventSequenceNumber="event_sequence_number",e.FromAddress="from_address",e.Name="name",e.PropertyVersion="property_version",e.ToAddress="to_address",e.TokenAmount="token_amount",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.TransferType="transfer_type",e))(B_||{}),I_=(e=>(e.AfterValue="after_value",e.BeforeValue="before_value",e.EntryFunctionIdStr="entry_function_id_str",e.EventAccountAddress="event_account_address",e.EventIndex="event_index",e.FromAddress="from_address",e.IsFungibleV2="is_fungible_v2",e.PropertyVersionV1="property_version_v1",e.ToAddress="to_address",e.TokenAmount="token_amount",e.TokenDataId="token_data_id",e.TokenStandard="token_standard",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.Type="type",e))(I_||{}),O_=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.DefaultProperties="default_properties",e.Description="description",e.DescriptionMutable="description_mutable",e.LargestPropertyVersion="largest_property_version",e.Maximum="maximum",e.MaximumMutable="maximum_mutable",e.MetadataUri="metadata_uri",e.Name="name",e.PayeeAddress="payee_address",e.PropertiesMutable="properties_mutable",e.RoyaltyMutable="royalty_mutable",e.RoyaltyPointsDenominator="royalty_points_denominator",e.RoyaltyPointsNumerator="royalty_points_numerator",e.Supply="supply",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e.UriMutable="uri_mutable",e))(O_||{}),R_=(e=>(e.Amount="amount",e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Name="name",e.OwnerAddress="owner_address",e.PropertyVersion="property_version",e.TableHandle="table_handle",e.TableType="table_type",e.TokenDataIdHash="token_data_id_hash",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))(R_||{}),$_=(e=>(e.CollectionDataIdHash="collection_data_id_hash",e.CollectionName="collection_name",e.CreatorAddress="creator_address",e.Name="name",e.PropertyVersion="property_version",e.TokenDataIdHash="token_data_id_hash",e.TokenProperties="token_properties",e.TransactionTimestamp="transaction_timestamp",e.TransactionVersion="transaction_version",e))($_||{}),U_=(e=>(e.BlockHeight="block_height",e.EntryFunctionIdStr="entry_function_id_str",e.Epoch="epoch",e.ExpirationTimestampSecs="expiration_timestamp_secs",e.GasUnitPrice="gas_unit_price",e.MaxGasAmount="max_gas_amount",e.ParentSignatureType="parent_signature_type",e.Sender="sender",e.SequenceNumber="sequence_number",e.Timestamp="timestamp",e.Version="version",e))(U_||{});const d5=Object.freeze(Object.defineProperty({__proto__:null,APTOS_COIN:vc,AccountSequenceNumber:Eg,Account_Transactions_Select_Column:$g,Address_Events_Summary_Select_Column:Ug,Address_Version_From_Events_Select_Column:qg,Address_Version_From_Move_Resources_Select_Column:Lg,AnsClient:gx,ApiError:di,AptosAccount:ia,AptosApiError:nh,AptosClient:Rt,AptosToken:hx,BCS:lg,Block_Metadata_Transactions_Select_Column:Dg,CKDPriv:tg,COIN_TRANSFER:Sg,CoinClient:fx,Coin_Activities_Select_Column:Mg,Coin_Balances_Select_Column:Ng,Coin_Infos_Select_Column:Fg,Coin_Supply_Select_Column:jg,Collection_Datas_Select_Column:zg,Current_Ans_Lookup_Select_Column:Hg,Current_Aptos_Names_Select_Column:Kg,Current_Coin_Balances_Select_Column:Gg,Current_Collection_Datas_Select_Column:Wg,Current_Collection_Ownership_V2_View_Select_Column:Vg,Current_Collections_V2_Select_Column:Xg,Current_Delegated_Staking_Pool_Balances_Select_Column:Jg,Current_Delegated_Voter_Select_Column:Zg,Current_Delegator_Balances_Select_Column:Yg,Current_Fungible_Asset_Balances_Select_Column:Qg,Current_Objects_Select_Column:e_,Current_Staking_Pool_Voter_Select_Column:t_,Current_Table_Items_Select_Column:n_,Current_Token_Datas_Select_Column:i_,Current_Token_Datas_V2_Select_Column:s_,Current_Token_Ownerships_Select_Column:o_,Current_Token_Ownerships_V2_Select_Column:r_,Current_Token_Pending_Claims_Select_Column:a_,Cursor_Ordering:c_,Delegated_Staking_Activities_Select_Column:u_,Delegated_Staking_Pools_Select_Column:l_,Delegator_Distinct_Pool_Select_Column:d_,Events_Select_Column:h_,FailedTransactionError:bg,FaucetClient:px,FungibleAssetClient:kc,Fungible_Asset_Activities_Select_Column:f_,Fungible_Asset_Metadata_Select_Column:p_,HexString:$e,IndexerClient:wn,Indexer_Status_Select_Column:g_,Ledger_Infos_Select_Column:__,Move_Resources_Select_Column:m_,Network:ug,NetworkToIndexerAPI:xc,NetworkToNodeAPI:cg,Nft_Marketplace_V2_Current_Nft_Marketplace_Auctions_Select_Column:y_,Nft_Marketplace_V2_Current_Nft_Marketplace_Collection_Offers_Select_Column:w_,Nft_Marketplace_V2_Current_Nft_Marketplace_Listings_Select_Column:b_,Nft_Marketplace_V2_Current_Nft_Marketplace_Token_Offers_Select_Column:v_,Nft_Marketplace_V2_Nft_Marketplace_Activities_Select_Column:x_,Nft_Metadata_Crawler_Parsed_Asset_Uris_Select_Column:T_,NodeAPIToNetwork:pd,Num_Active_Delegator_Per_Pool_Select_Column:A_,Order_By:k_,Processor_Status_Select_Column:S_,PropertyMap:bu,PropertyValue:yh,Proposal_Votes_Select_Column:P_,Provider:sa,TRANSFER_COINS:yd,Table_Items_Select_Column:E_,Table_Metadatas_Select_Column:C_,TokenClient:dx,TokenTypes:Tg,Token_Activities_Select_Column:B_,Token_Activities_V2_Select_Column:I_,Token_Datas_Select_Column:O_,Token_Ownerships_Select_Column:R_,Tokens_Select_Column:$_,TransactionBuilder:zi,TransactionBuilderABI:Tc,TransactionBuilderEd25519:sc,TransactionBuilderMultiEd25519:yg,TransactionBuilderRemoteABI:gn,TransactionWorker:_x,TransactionWorkerEvents:Cg,TxnBuilderTypes:ct,TypeTagParser:_o,Types:Bg,User_Transactions_Select_Column:U_,WaitForTransactionError:wg,ansContractsMap:wd,aptosRequest:ih,argToTransactionArgument:mg,derivePath:ig,deserializePropertyMap:wh,deserializeValueBasedOnTypeTag:xg,ensureBigInt:eo,ensureBoolean:_h,ensureNumber:Qs,get:oi,getAddressFromAccountOrAddress:ji,getMasterKeyFromSeed:eg,getPropertyType:vu,getPropertyValueRaw:Ac,getPublicKey:l1,getSinglePropertyValueRaw:md,isValidPath:ng,nameComponentPattern:as,namePattern:Pg,post:Xs,serializeArg:wu},Symbol.toStringTag,{value:"Module"}));var bi={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.output=Fn.exists=Fn.hash=Fn.bytes=Fn.bool=Fn.number=void 0;function Sc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}Fn.number=Sc;function q_(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}Fn.bool=q_;function bh(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}Fn.bytes=bh;function L_(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Sc(e.outputLen),Sc(e.blockLen)}Fn.hash=L_;function D_(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}Fn.exists=D_;function M_(e,t){bh(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Fn.output=M_;const mx={number:Sc,bool:q_,bytes:bh,hash:L_,exists:D_,output:M_};Fn.default=mx;var ar={},N_={},yo={},xu={};Object.defineProperty(xu,"__esModule",{value:!0});xu.crypto=void 0;xu.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(e){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=xu,n=P=>new Uint8Array(P.buffer,P.byteOffset,P.byteLength);e.u8=n;const i=P=>new Uint32Array(P.buffer,P.byteOffset,Math.floor(P.byteLength/4));e.u32=i;const s=P=>new DataView(P.buffer,P.byteOffset,P.byteLength);e.createView=s;const o=(P,B)=>P<<32-B|P>>>B;if(e.rotr=o,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(P,B)=>B.toString(16).padStart(2,"0"));function a(P){if(!(P instanceof Uint8Array))throw new Error("Uint8Array expected");let B="";for(let W=0;W<P.length;W++)B+=r[P[W]];return B}e.bytesToHex=a;function c(P){if(typeof P!="string")throw new TypeError("hexToBytes: expected string, got "+typeof P);if(P.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const B=new Uint8Array(P.length/2);for(let W=0;W<B.length;W++){const Q=W*2,V=P.slice(Q,Q+2),ee=Number.parseInt(V,16);if(Number.isNaN(ee)||ee<0)throw new Error("Invalid byte sequence");B[W]=ee}return B}e.hexToBytes=c;const u=async()=>{};e.nextTick=u;async function l(P,B,W){let Q=Date.now();for(let V=0;V<P;V++){W(V);const ee=Date.now()-Q;ee>=0&&ee<B||(await(0,e.nextTick)(),Q+=ee)}}e.asyncLoop=l;function d(P){if(typeof P!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof P}`);return new TextEncoder().encode(P)}e.utf8ToBytes=d;function h(P){if(typeof P=="string"&&(P=d(P)),!(P instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof P})`);return P}e.toBytes=h;function g(...P){if(!P.every(Q=>Q instanceof Uint8Array))throw new Error("Uint8Array list expected");if(P.length===1)return P[0];const B=P.reduce((Q,V)=>Q+V.length,0),W=new Uint8Array(B);for(let Q=0,V=0;Q<P.length;Q++){const ee=P[Q];W.set(ee,V),V+=ee.length}return W}e.concatBytes=g;class b{clone(){return this._cloneInto()}}e.Hash=b;const v=P=>Object.prototype.toString.call(P)==="[object Object]"&&P.constructor===Object;function k(P,B){if(B!==void 0&&(typeof B!="object"||!v(B)))throw new TypeError("Options should be object or undefined");return Object.assign(P,B)}e.checkOpts=k;function E(P){const B=Q=>P().update(h(Q)).digest(),W=P();return B.outputLen=W.outputLen,B.blockLen=W.blockLen,B.create=()=>P(),B}e.wrapConstructor=E;function N(P){const B=(Q,V)=>P(V).update(h(Q)).digest(),W=P({});return B.outputLen=W.outputLen,B.blockLen=W.blockLen,B.create=Q=>P(Q),B}e.wrapConstructorWithOpts=N;function A(P=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(P));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(P).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=A})(yo);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;const t=Fn,n=yo;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,t.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return t.default.exists(this),this.iHash.update(r),this}digestInto(r){t.default.exists(this),t.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:h}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=h,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();e.hmac=s,e.hmac.create=(o,r)=>new i(o,r)})(N_);Object.defineProperty(ar,"__esModule",{value:!0});ar.pbkdf2Async=ar.pbkdf2=void 0;const Fa=Fn,yx=N_,Jo=yo;function F_(e,t,n,i){Fa.default.hash(e);const s=(0,Jo.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(Fa.default.number(o),Fa.default.number(r),Fa.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Jo.toBytes)(t),u=(0,Jo.toBytes)(n),l=new Uint8Array(r),d=yx.hmac.create(e,c),h=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:h}}function j_(e,t,n,i,s){return e.destroy(),t.destroy(),i&&i.destroy(),s.fill(0),n}function wx(e,t,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=F_(e,t,n,i);let u;const l=new Uint8Array(4),d=(0,Jo.createView)(l),h=new Uint8Array(a.outputLen);for(let g=1,b=0;b<o;g++,b+=a.outputLen){const v=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(h),v.set(h.subarray(0,v.length));for(let k=1;k<s;k++){a._cloneInto(u).update(h).digestInto(h);for(let E=0;E<v.length;E++)v[E]^=h[E]}}return j_(a,c,r,u,h)}ar.pbkdf2=wx;async function bx(e,t,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=F_(e,t,n,i);let l;const d=new Uint8Array(4),h=(0,Jo.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,v=0;v<o;b++,v+=c.outputLen){const k=a.subarray(v,v+c.outputLen);h.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),k.set(g.subarray(0,k.length)),await(0,Jo.asyncLoop)(s-1,r,E=>{c._cloneInto(l).update(g).digestInto(g);for(let N=0;N<k.length;N++)k[N]^=g[N]})}return j_(c,u,a,l,g)}ar.pbkdf2Async=bx;var cr={},xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.SHA2=void 0;const Sl=Fn,Mr=yo;function vx(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}let xx=class extends Mr.Hash{constructor(t,n,i,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Mr.createView)(this.buffer)}update(t){Sl.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;t=(0,Mr.toBytes)(t);const o=t.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,Mr.createView)(t);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Sl.default.exists(this),Sl.default.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;vx(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,Mr.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=r,s%n&&t.buffer.set(i),t}};xa.SHA2=xx;Object.defineProperty(cr,"__esModule",{value:!0});cr.sha224=cr.sha256=void 0;const Tx=xa,Pi=yo,Ax=(e,t,n)=>e&t^~e&n,kx=(e,t,n)=>e&t^e&n^t&n,Sx=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xs=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ts=new Uint32Array(64);class z_ extends Tx.SHA2{constructor(){super(64,32,8,!1),this.A=xs[0]|0,this.B=xs[1]|0,this.C=xs[2]|0,this.D=xs[3]|0,this.E=xs[4]|0,this.F=xs[5]|0,this.G=xs[6]|0,this.H=xs[7]|0}get(){const{A:t,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[t,n,i,s,o,r,a,c]}set(t,n,i,s,o,r,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)Ts[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=Ts[d-15],g=Ts[d-2],b=(0,Pi.rotr)(h,7)^(0,Pi.rotr)(h,18)^h>>>3,v=(0,Pi.rotr)(g,17)^(0,Pi.rotr)(g,19)^g>>>10;Ts[d]=v+Ts[d-7]+b+Ts[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=(0,Pi.rotr)(a,6)^(0,Pi.rotr)(a,11)^(0,Pi.rotr)(a,25),g=l+h+Ax(a,c,u)+Sx[d]+Ts[d]|0,v=((0,Pi.rotr)(i,2)^(0,Pi.rotr)(i,13)^(0,Pi.rotr)(i,22))+kx(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+v|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){Ts.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Px extends z_{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}cr.sha256=(0,Pi.wrapConstructor)(()=>new z_);cr.sha224=(0,Pi.wrapConstructor)(()=>new Px);var $i={},H_={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.add=e.toBig=e.split=e.fromBig=void 0;const t=BigInt(2**32-1),n=BigInt(32);function i(j,R=!1){return R?{h:Number(j&t),l:Number(j>>n&t)}:{h:Number(j>>n&t)|0,l:Number(j&t)|0}}e.fromBig=i;function s(j,R=!1){let U=new Uint32Array(j.length),x=new Uint32Array(j.length);for(let f=0;f<j.length;f++){const{h:m,l:T}=i(j[f],R);[U[f],x[f]]=[m,T]}return[U,x]}e.split=s;const o=(j,R)=>BigInt(j>>>0)<<n|BigInt(R>>>0);e.toBig=o;const r=(j,R,U)=>j>>>U,a=(j,R,U)=>j<<32-U|R>>>U,c=(j,R,U)=>j>>>U|R<<32-U,u=(j,R,U)=>j<<32-U|R>>>U,l=(j,R,U)=>j<<64-U|R>>>U-32,d=(j,R,U)=>j>>>U-32|R<<64-U,h=(j,R)=>R,g=(j,R)=>j,b=(j,R,U)=>j<<U|R>>>32-U,v=(j,R,U)=>R<<U|j>>>32-U,k=(j,R,U)=>R<<U-32|j>>>64-U,E=(j,R,U)=>j<<U-32|R>>>64-U;function N(j,R,U,x){const f=(R>>>0)+(x>>>0);return{h:j+U+(f/2**32|0)|0,l:f|0}}e.add=N;const A=(j,R,U)=>(j>>>0)+(R>>>0)+(U>>>0),P=(j,R,U,x)=>R+U+x+(j/2**32|0)|0,B=(j,R,U,x)=>(j>>>0)+(R>>>0)+(U>>>0)+(x>>>0),W=(j,R,U,x,f)=>R+U+x+f+(j/2**32|0)|0,Q=(j,R,U,x,f)=>(j>>>0)+(R>>>0)+(U>>>0)+(x>>>0)+(f>>>0),V=(j,R,U,x,f,m)=>R+U+x+f+m+(j/2**32|0)|0,ee={fromBig:i,split:s,toBig:e.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:h,rotr32L:g,rotlSH:b,rotlSL:v,rotlBH:k,rotlBL:E,add:N,add3L:A,add3H:P,add4L:B,add4H:W,add5H:V,add5L:Q};e.default=ee})(H_);Object.defineProperty($i,"__esModule",{value:!0});$i.sha384=$i.sha512_256=$i.sha512_224=$i.sha512=$i.SHA512=void 0;const Ex=xa,Ht=H_,Tu=yo,[Cx,Bx]=Ht.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),As=new Uint32Array(80),ks=new Uint32Array(80);let Ta=class extends Ex.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:k}=this;return[t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k]}set(t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=k|0}process(t,n){for(let A=0;A<16;A++,n+=4)As[A]=t.getUint32(n),ks[A]=t.getUint32(n+=4);for(let A=16;A<80;A++){const P=As[A-15]|0,B=ks[A-15]|0,W=Ht.default.rotrSH(P,B,1)^Ht.default.rotrSH(P,B,8)^Ht.default.shrSH(P,B,7),Q=Ht.default.rotrSL(P,B,1)^Ht.default.rotrSL(P,B,8)^Ht.default.shrSL(P,B,7),V=As[A-2]|0,ee=ks[A-2]|0,j=Ht.default.rotrSH(V,ee,19)^Ht.default.rotrBH(V,ee,61)^Ht.default.shrSH(V,ee,6),R=Ht.default.rotrSL(V,ee,19)^Ht.default.rotrBL(V,ee,61)^Ht.default.shrSL(V,ee,6),U=Ht.default.add4L(Q,R,ks[A-7],ks[A-16]),x=Ht.default.add4H(U,W,j,As[A-7],As[A-16]);As[A]=x|0,ks[A]=U|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:k,Hh:E,Hl:N}=this;for(let A=0;A<80;A++){const P=Ht.default.rotrSH(d,h,14)^Ht.default.rotrSH(d,h,18)^Ht.default.rotrBH(d,h,41),B=Ht.default.rotrSL(d,h,14)^Ht.default.rotrSL(d,h,18)^Ht.default.rotrBL(d,h,41),W=d&g^~d&v,Q=h&b^~h&k,V=Ht.default.add5L(N,B,Q,Bx[A],ks[A]),ee=Ht.default.add5H(V,E,P,W,Cx[A],As[A]),j=V|0,R=Ht.default.rotrSH(i,s,28)^Ht.default.rotrBH(i,s,34)^Ht.default.rotrBH(i,s,39),U=Ht.default.rotrSL(i,s,28)^Ht.default.rotrBL(i,s,34)^Ht.default.rotrBL(i,s,39),x=i&o^i&a^o&a,f=s&r^s&c^r&c;E=v|0,N=k|0,v=g|0,k=b|0,g=d|0,b=h|0,{h:d,l:h}=Ht.default.add(u|0,l|0,ee|0,j|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=Ht.default.add3L(j,U,f);i=Ht.default.add3H(m,ee,R,x),s=m|0}({h:i,l:s}=Ht.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Ht.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Ht.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ht.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Ht.default.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=Ht.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:k}=Ht.default.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:E,l:N}=Ht.default.add(this.Hh|0,this.Hl|0,E|0,N|0),this.set(i,s,o,r,a,c,u,l,d,h,g,b,v,k,E,N)}roundClean(){As.fill(0),ks.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};$i.SHA512=Ta;class Ix extends Ta{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}let Ox=class extends Ta{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Rx=class extends Ta{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};$i.sha512=(0,Tu.wrapConstructor)(()=>new Ta);$i.sha512_224=(0,Tu.wrapConstructor)(()=>new Ix);$i.sha512_256=(0,Tu.wrapConstructor)(()=>new Ox);$i.sha384=(0,Tu.wrapConstructor)(()=>new Rx);Object.defineProperty(bi,"__esModule",{value:!0});var K_=bi.mnemonicToSeedSync=bi.mnemonicToSeed=bi.validateMnemonic=bi.entropyToMnemonic=bi.mnemonicToEntropy=bi.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const G_=Fn,W_=ar,$x=cr,V_=$i,Ux=yo,ja=Hd,qx=e=>e[0]==="";function X_(e){if(typeof e!="string")throw new TypeError(`Invalid mnemonic type: ${typeof e}`);return e.normalize("NFKD")}function vh(e){const t=X_(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function J_(e){G_.default.bytes(e,16,20,24,28,32)}function Lx(e,t=128){if(G_.default.number(t),t%32!==0||t>256)throw new TypeError("Invalid entropy");return Q_((0,Ux.randomBytes)(t/8),e)}bi.generateMnemonic=Lx;const Dx=e=>{const t=8-e.length/4;return new Uint8Array([(0,$x.sha256)(e)[0]>>t<<t])};function Z_(e){if(!Array.isArray(e)||e.length!==2**11||typeof e[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return e.forEach(t=>{if(typeof t!="string")throw new Error(`Wordlist: non-string element: ${t}`)}),ja.utils.chain(ja.utils.checksum(1,Dx),ja.utils.radix2(11,!0),ja.utils.alphabet(e))}function Y_(e,t){const{words:n}=vh(e),i=Z_(t).decode(n);return J_(i),i}bi.mnemonicToEntropy=Y_;function Q_(e,t){return J_(e),Z_(t).encode(e).join(qx(t)?"":" ")}bi.entropyToMnemonic=Q_;function Mx(e,t){try{Y_(e,t)}catch{return!1}return!0}bi.validateMnemonic=Mx;const em=e=>X_(`mnemonic${e}`);function Nx(e,t=""){return(0,W_.pbkdf2Async)(V_.sha512,vh(e).nfkd,em(t),{c:2048,dkLen:64})}bi.mnemonicToSeed=Nx;function Fx(e,t=""){return(0,W_.pbkdf2)(V_.sha512,vh(e).nfkd,em(t),{c:2048,dkLen:64})}K_=bi.mnemonicToSeedSync=Fx;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jx=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Pl=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),zx=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!zx)throw new Error("Non little-endian hardware is not supported");const Hx=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tm(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Hx[e[n]];return t}function nm(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const i=n*2,s=e.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Kx(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function Aa(e){if(typeof e=="string"&&(e=Kx(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}class xh{clone(){return this._cloneInto()}}function Au(e){const t=i=>e().update(Aa(i)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Gx(e){const t=(i,s)=>e(s).update(Aa(i)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=i=>e(i),t}function vd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Wx(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function im(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Vx(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");vd(e.outputLen),vd(e.blockLen)}function Xx(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Jx(e,t){im(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const vi={number:vd,bool:Wx,bytes:im,hash:Vx,exists:Xx,output:Jx},za=BigInt(2**32-1),xd=BigInt(32);function sm(e,t=!1){return t?{h:Number(e&za),l:Number(e>>xd&za)}:{h:Number(e>>xd&za)|0,l:Number(e&za)|0}}function Zx(e,t=!1){let n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:r}=sm(e[s],t);[n[s],i[s]]=[o,r]}return[n,i]}const Yx=(e,t)=>BigInt(e>>>0)<<xd|BigInt(t>>>0),Qx=(e,t,n)=>e>>>n,eT=(e,t,n)=>e<<32-n|t>>>n,tT=(e,t,n)=>e>>>n|t<<32-n,nT=(e,t,n)=>e<<32-n|t>>>n,iT=(e,t,n)=>e<<64-n|t>>>n-32,sT=(e,t,n)=>e>>>n-32|t<<64-n,oT=(e,t)=>t,rT=(e,t)=>e,aT=(e,t,n)=>e<<n|t>>>32-n,cT=(e,t,n)=>t<<n|e>>>32-n,uT=(e,t,n)=>t<<n-32|e>>>64-n,lT=(e,t,n)=>e<<n-32|t>>>64-n;function dT(e,t,n,i){const s=(t>>>0)+(i>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const hT=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),fT=(e,t,n,i)=>t+n+i+(e/2**32|0)|0,pT=(e,t,n,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),gT=(e,t,n,i,s)=>t+n+i+s+(e/2**32|0)|0,_T=(e,t,n,i,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0)+(s>>>0),mT=(e,t,n,i,s,o)=>t+n+i+s+o+(e/2**32|0)|0,It={fromBig:sm,split:Zx,toBig:Yx,shrSH:Qx,shrSL:eT,rotrSH:tT,rotrSL:nT,rotrBH:iT,rotrBL:sT,rotr32H:oT,rotr32L:rT,rotlSH:aT,rotlSL:cT,rotlBH:uT,rotlBL:lT,add:dT,add3L:hT,add3H:fT,add4L:pT,add4H:gT,add5H:mT,add5L:_T},[om,rm,am]=[[],[],[]],yT=BigInt(0),Nr=BigInt(1),wT=BigInt(2),bT=BigInt(7),vT=BigInt(256),xT=BigInt(113);for(let e=0,t=Nr,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],om.push(2*(5*i+n)),rm.push((e+1)*(e+2)/2%64);let s=yT;for(let o=0;o<7;o++)t=(t<<Nr^(t>>bT)*xT)%vT,t&wT&&(s^=Nr<<(Nr<<BigInt(o))-Nr);am.push(s)}const[TT,AT]=It.split(am,!0),$f=(e,t,n)=>n>32?It.rotlBH(e,t,n):It.rotlSH(e,t,n),Uf=(e,t,n)=>n>32?It.rotlBL(e,t,n):It.rotlSL(e,t,n);function kT(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=$f(u,l,1)^n[a],h=Uf(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)e[r+g]^=d,e[r+g+1]^=h}let s=e[2],o=e[3];for(let r=0;r<24;r++){const a=rm[r],c=$f(s,o,a),u=Uf(s,o,a),l=om[r];s=e[l],o=e[l+1],e[l]=c,e[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=e[r+a];for(let a=0;a<10;a++)e[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=TT[i],e[1]^=AT[i]}n.fill(0)}class ku extends xh{constructor(t,n,i,s=!1,o=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,vi.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=jx(this.state)}keccak(){kT(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){vi.exists(this);const{blockLen:n,state:i}=this;t=Aa(t);const s=t.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:s}=this;t[i]^=n,n&128&&i===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){vi.exists(this,!1),vi.bytes(t),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=t.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return vi.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(vi.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return t||(t=new ku(n,i,s,r,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=i,t.outputLen=s,t.enableXOF=r,t.destroyed=this.destroyed,t}}const Hs=(e,t,n)=>Au(()=>new ku(t,e,n));Hs(6,144,224/8);const ur=Hs(6,136,256/8);Hs(6,104,384/8);Hs(6,72,512/8);Hs(1,144,224/8);Hs(1,136,256/8);Hs(1,104,384/8);Hs(1,72,512/8);const cm=(e,t,n)=>Gx((i={})=>new ku(t,e,i.dkLen===void 0?n:i.dkLen,!0));cm(31,168,128/8);cm(31,136,256/8);class um extends xh{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,vi.hash(t);const i=Aa(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?t.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=t.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(t){return vi.exists(this),this.iHash.update(t),this}digestInto(t){vi.exists(this),vi.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=r,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Th=(e,t,n)=>new um(e,t).update(n).digest();Th.create=(e,t)=>new um(e,t);function ST(e,t,n,i){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;e.setUint32(t+c,r,i),e.setUint32(t+u,a,i)}class PT extends xh{constructor(t,n,i,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Pl(this.buffer)}update(t){vi.exists(this);const{view:n,buffer:i,blockLen:s}=this;t=Aa(t);const o=t.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=Pl(t);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){vi.exists(this),vi.output(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;ST(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=Pl(t);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=r,s%n&&t.buffer.set(i),t}}const[ET,CT]=It.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Ss=new Uint32Array(80),Ps=new Uint32Array(80);class Ah extends PT{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:g,Gl:b,Hh:v,Hl:k}=this;return[t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k]}set(t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k){this.Ah=t|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=g|0,this.Gl=b|0,this.Hh=v|0,this.Hl=k|0}process(t,n){for(let A=0;A<16;A++,n+=4)Ss[A]=t.getUint32(n),Ps[A]=t.getUint32(n+=4);for(let A=16;A<80;A++){const P=Ss[A-15]|0,B=Ps[A-15]|0,W=It.rotrSH(P,B,1)^It.rotrSH(P,B,8)^It.shrSH(P,B,7),Q=It.rotrSL(P,B,1)^It.rotrSL(P,B,8)^It.shrSL(P,B,7),V=Ss[A-2]|0,ee=Ps[A-2]|0,j=It.rotrSH(V,ee,19)^It.rotrBH(V,ee,61)^It.shrSH(V,ee,6),R=It.rotrSL(V,ee,19)^It.rotrBL(V,ee,61)^It.shrSL(V,ee,6),U=It.add4L(Q,R,Ps[A-7],Ps[A-16]),x=It.add4H(U,W,j,Ss[A-7],Ss[A-16]);Ss[A]=x|0,Ps[A]=U|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:g,Fl:b,Gh:v,Gl:k,Hh:E,Hl:N}=this;for(let A=0;A<80;A++){const P=It.rotrSH(d,h,14)^It.rotrSH(d,h,18)^It.rotrBH(d,h,41),B=It.rotrSL(d,h,14)^It.rotrSL(d,h,18)^It.rotrBL(d,h,41),W=d&g^~d&v,Q=h&b^~h&k,V=It.add5L(N,B,Q,CT[A],Ps[A]),ee=It.add5H(V,E,P,W,ET[A],Ss[A]),j=V|0,R=It.rotrSH(i,s,28)^It.rotrBH(i,s,34)^It.rotrBH(i,s,39),U=It.rotrSL(i,s,28)^It.rotrBL(i,s,34)^It.rotrBL(i,s,39),x=i&o^i&a^o&a,f=s&r^s&c^r&c;E=v|0,N=k|0,v=g|0,k=b|0,g=d|0,b=h|0,{h:d,l:h}=It.add(u|0,l|0,ee|0,j|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const m=It.add3L(j,U,f);i=It.add3H(m,ee,R,x),s=m|0}({h:i,l:s}=It.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=It.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=It.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=It.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=It.add(this.Eh|0,this.El|0,d|0,h|0),{h:g,l:b}=It.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:v,l:k}=It.add(this.Gh|0,this.Gl|0,v|0,k|0),{h:E,l:N}=It.add(this.Hh|0,this.Hl|0,E|0,N|0),this.set(i,s,o,r,a,c,u,l,d,h,g,b,v,k,E,N)}roundClean(){Ss.fill(0),Ps.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class BT extends Ah{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class IT extends Ah{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const lm=Au(()=>new Ah);Au(()=>new BT);Au(()=>new IT);var Td={},OT={get exports(){return Td},set exports(e){Td=e}},Pc={},RT={get exports(){return Pc},set exports(e){Pc=e}},dm=function(t,n){return function(){for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];return t.apply(n,s)}},$T=dm,kh=Object.prototype.toString,Sh=function(e){return function(t){var n=kh.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function wo(e){return e=e.toLowerCase(),function(n){return Sh(n)===e}}function Ph(e){return Array.isArray(e)}function Ec(e){return typeof e>"u"}function UT(e){return e!==null&&!Ec(e)&&e.constructor!==null&&!Ec(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var hm=wo("ArrayBuffer");function qT(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&hm(e.buffer),t}function LT(e){return typeof e=="string"}function DT(e){return typeof e=="number"}function fm(e){return e!==null&&typeof e=="object"}function oc(e){if(Sh(e)!=="object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}var MT=wo("Date"),NT=wo("File"),FT=wo("Blob"),jT=wo("FileList");function Eh(e){return kh.call(e)==="[object Function]"}function zT(e){return fm(e)&&Eh(e.pipe)}function HT(e){var t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||kh.call(e)===t||Eh(e.toString)&&e.toString()===t)}var KT=wo("URLSearchParams");function GT(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function WT(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Ch(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),Ph(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function Ad(){var e={};function t(s,o){oc(e[o])&&oc(s)?e[o]=Ad(e[o],s):oc(s)?e[o]=Ad({},s):Ph(s)?e[o]=s.slice():e[o]=s}for(var n=0,i=arguments.length;n<i;n++)Ch(arguments[n],t);return e}function VT(e,t,n){return Ch(t,function(s,o){n&&typeof s=="function"?e[o]=$T(s,n):e[o]=s}),e}function XT(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function JT(e,t,n,i){e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)}function ZT(e,t,n){var i,s,o,r={};t=t||{};do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],r[o]||(t[o]=e[o],r[o]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t}function YT(e,t,n){e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;var i=e.indexOf(t,n);return i!==-1&&i===n}function QT(e){if(!e)return null;var t=e.length;if(Ec(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n}var eA=function(e){return function(t){return e&&t instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),Yn={isArray:Ph,isArrayBuffer:hm,isBuffer:UT,isFormData:HT,isArrayBufferView:qT,isString:LT,isNumber:DT,isObject:fm,isPlainObject:oc,isUndefined:Ec,isDate:MT,isFile:NT,isBlob:FT,isFunction:Eh,isStream:zT,isURLSearchParams:KT,isStandardBrowserEnv:WT,forEach:Ch,merge:Ad,extend:VT,trim:GT,stripBOM:XT,inherits:JT,toFlatObject:ZT,kindOf:Sh,kindOfTest:wo,endsWith:YT,toArray:QT,isTypedArray:eA,isFileList:jT},Bo=Yn;function qf(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var pm=function(t,n,i){if(!n)return t;var s;if(i)s=i(n);else if(Bo.isURLSearchParams(n))s=n.toString();else{var o=[];Bo.forEach(n,function(c,u){c===null||typeof c>"u"||(Bo.isArray(c)?u=u+"[]":c=[c],Bo.forEach(c,function(d){Bo.isDate(d)?d=d.toISOString():Bo.isObject(d)&&(d=JSON.stringify(d)),o.push(qf(u)+"="+qf(d))}))}),s=o.join("&")}if(s){var r=t.indexOf("#");r!==-1&&(t=t.slice(0,r)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t},tA=Yn;function Su(){this.handlers=[]}Su.prototype.use=function(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};Su.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Su.prototype.forEach=function(t){tA.forEach(this.handlers,function(i){i!==null&&t(i)})};var nA=Su,iA=Yn,sA=function(t,n){iA.forEach(t,function(s,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(t[n]=s,delete t[o])})},gm=Yn;function lr(e,t,n,i,s){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}gm.inherits(lr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var _m=lr.prototype,mm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){mm[e]={value:e}});Object.defineProperties(lr,mm);Object.defineProperty(_m,"isAxiosError",{value:!0});lr.from=function(e,t,n,i,s,o){var r=Object.create(_m);return gm.toFlatObject(e,r,function(c){return c!==Error.prototype}),lr.call(r,e.message,t,n,i,s),r.name=e.name,o&&Object.assign(r,o),r};var Er=lr,ym={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Mi=Yn;function oA(e,t){t=t||new FormData;var n=[];function i(o){return o===null?"":Mi.isDate(o)?o.toISOString():Mi.isArrayBuffer(o)||Mi.isTypedArray(o)?typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function s(o,r){if(Mi.isPlainObject(o)||Mi.isArray(o)){if(n.indexOf(o)!==-1)throw Error("Circular reference detected in "+r);n.push(o),Mi.forEach(o,function(c,u){if(!Mi.isUndefined(c)){var l=r?r+"."+u:u,d;if(c&&!r&&typeof c=="object"){if(Mi.endsWith(u,"{}"))c=JSON.stringify(c);else if(Mi.endsWith(u,"[]")&&(d=Mi.toArray(c))){d.forEach(function(h){!Mi.isUndefined(h)&&t.append(l,i(h))});return}}s(c,l)}}),n.pop()}else t.append(r,i(o))}return s(e),t}var wm=oA,El,Lf;function rA(){if(Lf)return El;Lf=1;var e=Er;return El=function(n,i,s){var o=s.config.validateStatus;!s.status||!o||o(s.status)?n(s):i(new e("Request failed with status code "+s.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))},El}var Cl,Df;function aA(){if(Df)return Cl;Df=1;var e=Yn;return Cl=e.isStandardBrowserEnv()?function(){return{write:function(i,s,o,r,a,c){var u=[];u.push(i+"="+encodeURIComponent(s)),e.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),e.isString(r)&&u.push("path="+r),e.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(i){var s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Cl}var cA=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},uA=function(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t},lA=cA,dA=uA,bm=function(t,n){return t&&!lA(n)?dA(t,n):n},Bl,Mf;function hA(){if(Mf)return Bl;Mf=1;var e=Yn,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Bl=function(i){var s={},o,r,a;return i&&e.forEach(i.split(`
`),function(u){if(a=u.indexOf(":"),o=e.trim(u.substr(0,a)).toLowerCase(),r=e.trim(u.substr(a+1)),o){if(s[o]&&t.indexOf(o)>=0)return;o==="set-cookie"?s[o]=(s[o]?s[o]:[]).concat([r]):s[o]=s[o]?s[o]+", "+r:r}}),s},Bl}var Il,Nf;function fA(){if(Nf)return Il;Nf=1;var e=Yn;return Il=e.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),s;function o(r){var a=r;return n&&(i.setAttribute("href",a),a=i.href),i.setAttribute("href",a),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return s=o(window.location.href),function(a){var c=e.isString(a)?o(a):a;return c.protocol===s.protocol&&c.host===s.host}}():function(){return function(){return!0}}(),Il}var Ol,Ff;function Pu(){if(Ff)return Ol;Ff=1;var e=Er,t=Yn;function n(i){e.call(this,i??"canceled",e.ERR_CANCELED),this.name="CanceledError"}return t.inherits(n,e,{__CANCEL__:!0}),Ol=n,Ol}var Rl,jf;function pA(){return jf||(jf=1,Rl=function(t){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}),Rl}var $l,zf;function Hf(){if(zf)return $l;zf=1;var e=Yn,t=rA(),n=aA(),i=pm,s=bm,o=hA(),r=fA(),a=ym,c=Er,u=Pu(),l=pA();return $l=function(h){return new Promise(function(b,v){var k=h.data,E=h.headers,N=h.responseType,A;function P(){h.cancelToken&&h.cancelToken.unsubscribe(A),h.signal&&h.signal.removeEventListener("abort",A)}e.isFormData(k)&&e.isStandardBrowserEnv()&&delete E["Content-Type"];var B=new XMLHttpRequest;if(h.auth){var W=h.auth.username||"",Q=h.auth.password?unescape(encodeURIComponent(h.auth.password)):"";E.Authorization="Basic "+btoa(W+":"+Q)}var V=s(h.baseURL,h.url);B.open(h.method.toUpperCase(),i(V,h.params,h.paramsSerializer),!0),B.timeout=h.timeout;function ee(){if(B){var U="getAllResponseHeaders"in B?o(B.getAllResponseHeaders()):null,x=!N||N==="text"||N==="json"?B.responseText:B.response,f={data:x,status:B.status,statusText:B.statusText,headers:U,config:h,request:B};t(function(T){b(T),P()},function(T){v(T),P()},f),B=null}}if("onloadend"in B?B.onloadend=ee:B.onreadystatechange=function(){!B||B.readyState!==4||B.status===0&&!(B.responseURL&&B.responseURL.indexOf("file:")===0)||setTimeout(ee)},B.onabort=function(){B&&(v(new c("Request aborted",c.ECONNABORTED,h,B)),B=null)},B.onerror=function(){v(new c("Network Error",c.ERR_NETWORK,h,B,B)),B=null},B.ontimeout=function(){var x=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded",f=h.transitional||a;h.timeoutErrorMessage&&(x=h.timeoutErrorMessage),v(new c(x,f.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,h,B)),B=null},e.isStandardBrowserEnv()){var j=(h.withCredentials||r(V))&&h.xsrfCookieName?n.read(h.xsrfCookieName):void 0;j&&(E[h.xsrfHeaderName]=j)}"setRequestHeader"in B&&e.forEach(E,function(x,f){typeof k>"u"&&f.toLowerCase()==="content-type"?delete E[f]:B.setRequestHeader(f,x)}),e.isUndefined(h.withCredentials)||(B.withCredentials=!!h.withCredentials),N&&N!=="json"&&(B.responseType=h.responseType),typeof h.onDownloadProgress=="function"&&B.addEventListener("progress",h.onDownloadProgress),typeof h.onUploadProgress=="function"&&B.upload&&B.upload.addEventListener("progress",h.onUploadProgress),(h.cancelToken||h.signal)&&(A=function(U){B&&(v(!U||U&&U.type?new u:U),B.abort(),B=null)},h.cancelToken&&h.cancelToken.subscribe(A),h.signal&&(h.signal.aborted?A():h.signal.addEventListener("abort",A))),k||(k=null);var R=l(V);if(R&&["http","https","file"].indexOf(R)===-1){v(new c("Unsupported protocol "+R+":",c.ERR_BAD_REQUEST,h));return}B.send(k)})},$l}var Ul,Kf;function gA(){return Kf||(Kf=1,Ul=null),Ul}var qn=Yn,Gf=sA,Wf=Er,_A=ym,mA=wm,yA={"Content-Type":"application/x-www-form-urlencoded"};function Vf(e,t){!qn.isUndefined(e)&&qn.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function wA(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=Hf()),e}function bA(e,t,n){if(qn.isString(e))try{return(t||JSON.parse)(e),qn.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}var Eu={transitional:_A,adapter:wA(),transformRequest:[function(t,n){if(Gf(n,"Accept"),Gf(n,"Content-Type"),qn.isFormData(t)||qn.isArrayBuffer(t)||qn.isBuffer(t)||qn.isStream(t)||qn.isFile(t)||qn.isBlob(t))return t;if(qn.isArrayBufferView(t))return t.buffer;if(qn.isURLSearchParams(t))return Vf(n,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var i=qn.isObject(t),s=n&&n["Content-Type"],o;if((o=qn.isFileList(t))||i&&s==="multipart/form-data"){var r=this.env&&this.env.FormData;return mA(o?{"files[]":t}:t,r&&new r)}else if(i||s==="application/json")return Vf(n,"application/json"),bA(t);return t}],transformResponse:[function(t){var n=this.transitional||Eu.transitional,i=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,o=!i&&this.responseType==="json";if(o||s&&qn.isString(t)&&t.length)try{return JSON.parse(t)}catch(r){if(o)throw r.name==="SyntaxError"?Wf.from(r,Wf.ERR_BAD_RESPONSE,this,null,this.response):r}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gA()},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};qn.forEach(["delete","get","head"],function(t){Eu.headers[t]={}});qn.forEach(["post","put","patch"],function(t){Eu.headers[t]=qn.merge(yA)});var Bh=Eu,vA=Yn,xA=Bh,TA=function(t,n,i){var s=this||xA;return vA.forEach(i,function(r){t=r.call(s,t,n)}),t},ql,Xf;function vm(){return Xf||(Xf=1,ql=function(t){return!!(t&&t.__CANCEL__)}),ql}var Jf=Yn,Ll=TA,AA=vm(),kA=Bh,SA=Pu();function Dl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new SA}var PA=function(t){Dl(t),t.headers=t.headers||{},t.data=Ll.call(t,t.data,t.headers,t.transformRequest),t.headers=Jf.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Jf.forEach(["delete","get","head","post","put","patch","common"],function(s){delete t.headers[s]});var n=t.adapter||kA.adapter;return n(t).then(function(s){return Dl(t),s.data=Ll.call(t,s.data,s.headers,t.transformResponse),s},function(s){return AA(s)||(Dl(t),s&&s.response&&(s.response.data=Ll.call(t,s.response.data,s.response.headers,t.transformResponse))),Promise.reject(s)})},_i=Yn,xm=function(t,n){n=n||{};var i={};function s(l,d){return _i.isPlainObject(l)&&_i.isPlainObject(d)?_i.merge(l,d):_i.isPlainObject(d)?_i.merge({},d):_i.isArray(d)?d.slice():d}function o(l){if(_i.isUndefined(n[l])){if(!_i.isUndefined(t[l]))return s(void 0,t[l])}else return s(t[l],n[l])}function r(l){if(!_i.isUndefined(n[l]))return s(void 0,n[l])}function a(l){if(_i.isUndefined(n[l])){if(!_i.isUndefined(t[l]))return s(void 0,t[l])}else return s(void 0,n[l])}function c(l){if(l in n)return s(t[l],n[l]);if(l in t)return s(void 0,t[l])}var u={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return _i.forEach(Object.keys(t).concat(Object.keys(n)),function(d){var h=u[d]||o,g=h(d);_i.isUndefined(g)&&h!==c||(i[d]=g)}),i},Ml,Zf;function Tm(){return Zf||(Zf=1,Ml={version:"0.27.2"}),Ml}var EA=Tm().version,Us=Er,Ih={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){Ih[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});var Yf={};Ih.transitional=function(t,n,i){function s(o,r){return"[Axios v"+EA+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return function(o,r,a){if(t===!1)throw new Us(s(r," has been removed"+(n?" in "+n:"")),Us.ERR_DEPRECATED);return n&&!Yf[r]&&(Yf[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,r,a):!0}};function CA(e,t,n){if(typeof e!="object")throw new Us("options must be an object",Us.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(e),s=i.length;s-- >0;){var o=i[s],r=t[o];if(r){var a=e[o],c=a===void 0||r(a,o,e);if(c!==!0)throw new Us("option "+o+" must be "+c,Us.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Us("Unknown option "+o,Us.ERR_BAD_OPTION)}}var BA={assertOptions:CA,validators:Ih},Am=Yn,IA=pm,Qf=nA,e0=PA,Cu=xm,OA=bm,km=BA,Io=km.validators;function dr(e){this.defaults=e,this.interceptors={request:new Qf,response:new Qf}}dr.prototype.request=function(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Cu(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&km.assertOptions(i,{silentJSONParsing:Io.transitional(Io.boolean),forcedJSONParsing:Io.transitional(Io.boolean),clarifyTimeoutError:Io.transitional(Io.boolean)},!1);var s=[],o=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(o=o&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var r=[];this.interceptors.response.forEach(function(g){r.push(g.fulfilled,g.rejected)});var a;if(!o){var c=[e0,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(r),a=Promise.resolve(n);c.length;)a=a.then(c.shift(),c.shift());return a}for(var u=n;s.length;){var l=s.shift(),d=s.shift();try{u=l(u)}catch(h){d(h);break}}try{a=e0(u)}catch(h){return Promise.reject(h)}for(;r.length;)a=a.then(r.shift(),r.shift());return a};dr.prototype.getUri=function(t){t=Cu(this.defaults,t);var n=OA(t.baseURL,t.url);return IA(n,t.params,t.paramsSerializer)};Am.forEach(["delete","get","head","options"],function(t){dr.prototype[t]=function(n,i){return this.request(Cu(i||{},{method:t,url:n,data:(i||{}).data}))}});Am.forEach(["post","put","patch"],function(t){function n(i){return function(o,r,a){return this.request(Cu(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}dr.prototype[t]=n(),dr.prototype[t+"Form"]=n(!0)});var RA=dr,Nl,t0;function $A(){if(t0)return Nl;t0=1;var e=Pu();function t(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(r){i=r});var s=this;this.promise.then(function(o){if(s._listeners){var r,a=s._listeners.length;for(r=0;r<a;r++)s._listeners[r](o);s._listeners=null}}),this.promise.then=function(o){var r,a=new Promise(function(c){s.subscribe(c),r=c}).then(o);return a.cancel=function(){s.unsubscribe(r)},a},n(function(r){s.reason||(s.reason=new e(r),i(s.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},t.prototype.unsubscribe=function(i){if(this._listeners){var s=this._listeners.indexOf(i);s!==-1&&this._listeners.splice(s,1)}},t.source=function(){var i,s=new t(function(r){i=r});return{token:s,cancel:i}},Nl=t,Nl}var Fl,n0;function UA(){return n0||(n0=1,Fl=function(t){return function(i){return t.apply(null,i)}}),Fl}var jl,i0;function qA(){if(i0)return jl;i0=1;var e=Yn;return jl=function(n){return e.isObject(n)&&n.isAxiosError===!0},jl}var s0=Yn,LA=dm,rc=RA,DA=xm,MA=Bh;function Sm(e){var t=new rc(e),n=LA(rc.prototype.request,t);return s0.extend(n,rc.prototype,t),s0.extend(n,t),n.create=function(s){return Sm(DA(e,s))},n}var pi=Sm(MA);pi.Axios=rc;pi.CanceledError=Pu();pi.CancelToken=$A();pi.isCancel=vm();pi.VERSION=Tm().version;pi.toFormData=wm;pi.AxiosError=Er;pi.Cancel=pi.CanceledError;pi.all=function(t){return Promise.all(t)};pi.spread=UA();pi.isAxiosError=qA();RT.exports=pi;Pc.default=pi;(function(e){e.exports=Pc})(OT);const hr=Fd(Td);var Pm=typeof self=="object"?self.FormData:window.FormData,Em=Object.defineProperty,NA=Object.getOwnPropertyDescriptor,Bu=(e,t)=>{for(var n in t)Em(e,n,{get:t[n],enumerable:!0})},ln=(e,t,n,i)=>{for(var s=i>1?void 0:i?NA(t,n):t,o=e.length-1,r;o>=0;o--)(r=e[o])&&(s=(i?r(t,n,s):r(s))||s);return i&&s&&Em(t,n,s),s},FA=/^m(\/[0-9]+')+$/,Cm=e=>e.replace("'",""),jA="ed25519 seed",zA=2147483648,HA=e=>{const n=Th.create(lm,jA).update(nm(e)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},KA=({key:e,chainCode:t},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...e,...s]),a=Th.create(lm,t).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},GA=e=>FA.test(e)?!e.split("/").slice(1).map(Cm).some(Number.isNaN):!1,WA=(e,t,n=zA)=>{if(!GA(e))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=HA(t);return e.split("/").slice(1).map(Cm).map(r=>parseInt(r,10)).reduce((r,a)=>KA(r,a+n),{key:i,chainCode:s})},$t=class{static fromBuffer(e){return $t.fromUint8Array(e)}static fromUint8Array(e){return new $t(tm(e))}static ensure(e){return typeof e=="string"?new $t(e):e}constructor(e){e.startsWith("0x")?this.hexString=e:this.hexString=`0x${e}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(nm(this.noPrefix()))}};async function VA(e){return new Promise(t=>{setTimeout(t,e)})}var o0="/v1";function XA(e){let t=`${e}`;return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.endsWith(o0)||(t=`${t}${o0}`),t}var Bm=2e5,Im=20,JA=20,ZA="0x1::aptos_coin::AptosCoin";function Iu(e){let t,n,i;return typeof e=="object"?(t=e.hashFunction,n=e.ttlMs,i=e.tags):t=e,(s,o,r)=>{if(r.value!=null)r.value=r0(r.value,t,n,i);else if(r.get!=null)r.get=r0(r.get,t,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function YA(e,t){return Iu({ttlMs:e,hashFunction:t})}var ac=new Map;function QA(e){const t=new Set;for(const n of e){const i=ac.get(n);if(i)for(const s of i)t.has(s)||(s.clear(),t.add(s))}return t.size}function r0(e,t,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)ac.has(u)?ac.get(u).push(c):ac.set(u,[c]);if(t||o.length>0||n>0){let u;t===!0?u=o.map(h=>h.toString()).join("!"):t?u=t.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const h=c.get(l);d=Date.now()-h>n}c.has(u)&&!d?r=c.get(u):(r=e.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=e.apply(a,o),c.set(u,r))}return r}}async function a0(e,t,n,i){var s;const o=[];let r;for(;;){const a=await e($t.ensure(t).hex(),(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString(),r,n);if(r=a.__headers["x-aptos-cursor"],delete a.__headers,o.push(...a),r==null)break}return o}var ek={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},tk={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1"},F={};Bu(F,{AccountAddress:()=>xn,AccountAuthenticator:()=>ra,AccountAuthenticatorEd25519:()=>$h,AccountAuthenticatorMultiEd25519:()=>Uh,ArgumentABI:()=>Oa,AuthenticationKey:()=>ao,ChainId:()=>Lu,ChangeSet:()=>fk,Ed25519PublicKey:()=>Ii,Ed25519Signature:()=>es,EntryFunction:()=>to,EntryFunctionABI:()=>mr,Identifier:()=>ai,Module:()=>Rm,ModuleId:()=>ro,MultiAgentRawTransaction:()=>Uu,MultiEd25519PublicKey:()=>ka,MultiEd25519Signature:()=>Ou,MultiSig:()=>Dh,MultiSigTransactionPayload:()=>Lh,RawTransaction:()=>Rr,RawTransactionWithData:()=>$m,RotationProofChallenge:()=>gk,Script:()=>Pa,ScriptABI:()=>Hu,SignedTransaction:()=>Ea,StructTag:()=>fr,Transaction:()=>Um,TransactionArgument:()=>Xi,TransactionArgumentAddress:()=>gr,TransactionArgumentBool:()=>zu,TransactionArgumentU128:()=>Fu,TransactionArgumentU16:()=>Mu,TransactionArgumentU256:()=>ju,TransactionArgumentU32:()=>Nu,TransactionArgumentU64:()=>pr,TransactionArgumentU8:()=>Du,TransactionArgumentU8Vector:()=>_r,TransactionAuthenticator:()=>Sa,TransactionAuthenticatorEd25519:()=>Ru,TransactionAuthenticatorMultiAgent:()=>Rh,TransactionAuthenticatorMultiEd25519:()=>$u,TransactionPayload:()=>Ca,TransactionPayloadEntryFunction:()=>qu,TransactionPayloadMultisig:()=>Mh,TransactionPayloadScript:()=>Ba,TransactionScriptABI:()=>Ku,TypeArgumentABI:()=>Ia,TypeTag:()=>Jn,TypeTagAddress:()=>Ao,TypeTagBool:()=>vo,TypeTagSigner:()=>qh,TypeTagStruct:()=>ko,TypeTagU128:()=>To,TypeTagU16:()=>Cr,TypeTagU256:()=>Ir,TypeTagU32:()=>Br,TypeTagU64:()=>xo,TypeTagU8:()=>hs,TypeTagVector:()=>Or,UserTransaction:()=>Nh,WriteSet:()=>pk});var ce={};Bu(ce,{Deserializer:()=>Oh,Serializer:()=>Sn,bcsSerializeBool:()=>lk,bcsSerializeBytes:()=>Lo,bcsSerializeFixedBytes:()=>hk,bcsSerializeStr:()=>dk,bcsSerializeU128:()=>uk,bcsSerializeU16:()=>ak,bcsSerializeU32:()=>ck,bcsSerializeU8:()=>kd,bcsSerializeUint64:()=>rk,bcsToBytes:()=>fs,deserializeVector:()=>Li,serializeVector:()=>xi,serializeVectorWithFunc:()=>ok});var nk=2**8-1,ik=2**16-1,oa=2**32-1,Zr=BigInt(2**64)-BigInt(1),Om=BigInt(2**128)-BigInt(1),sk=BigInt(2**256)-BigInt(1),Sn=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){const t=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t}}serialize(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,t,n){this.ensureBufferWillHandleSize(t);const i=new DataView(this.buffer,this.offset);e.apply(i,[0,n,!0]),this.offset+=t}serializeStr(e){const t=new TextEncoder;this.serializeBytes(t.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.serialize(e)}serializeFixedBytes(e){this.serialize(e)}serializeBool(e){if(typeof e!="boolean")throw new Error("Value needs to be a boolean");const t=e?1:0;this.serialize(new Uint8Array([t]))}serializeU8(e){this.serialize(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){const t=BigInt(e.toString())&BigInt(oa),n=BigInt(e.toString())>>BigInt(32);this.serializeU32(Number(t)),this.serializeU32(Number(n))}serializeU128(e){const t=BigInt(e.toString())&Zr,n=BigInt(e.toString())>>BigInt(64);this.serializeU64(t),this.serializeU64(n)}serializeU256(e){const t=BigInt(e.toString())&Om,n=BigInt(e.toString())>>BigInt(128);this.serializeU128(t),this.serializeU128(n)}serializeU32AsUleb128(e){let t=e;const n=[];for(;t>>>7;)n.push(t&127|128),t>>>=7;n.push(t),this.serialize(new Uint8Array(n))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};ln([bo(0,nk)],Sn.prototype,"serializeU8",1);ln([bo(0,ik)],Sn.prototype,"serializeU16",1);ln([bo(0,oa)],Sn.prototype,"serializeU32",1);ln([bo(BigInt(0),Zr)],Sn.prototype,"serializeU64",1);ln([bo(BigInt(0),Om)],Sn.prototype,"serializeU128",1);ln([bo(BigInt(0),sk)],Sn.prototype,"serializeU256",1);ln([bo(0,oa)],Sn.prototype,"serializeU32AsUleb128",1);function bo(e,t,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(t.toString())||u<BigInt(e.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var Oh=class{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}read(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}deserializeStr(){const e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeBytes(){const e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){const e=new Uint8Array(this.read(1))[0];if(e!==1&&e!==0)throw new Error("Invalid boolean value");return e===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const e=this.deserializeU32(),t=this.deserializeU32();return BigInt(BigInt(t)<<BigInt(32)|BigInt(e))}deserializeU128(){const e=this.deserializeU64(),t=this.deserializeU64();return BigInt(t<<BigInt(64)|e)}deserializeU256(){const e=this.deserializeU128(),t=this.deserializeU128();return BigInt(t<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<oa;){const n=this.deserializeU8();if(e|=BigInt(n&127)<<BigInt(t),!(n&128))break;t+=7}if(e>oa)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}};function xi(e,t){t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)})}function ok(e,t){const n=new Sn;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(s=>{i.call(n,s)}),n.getBytes()}function Li(e,t){const n=e.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(t.deserialize(e));return i}function fs(e){const t=new Sn;return e.serialize(t),t.getBytes()}function rk(e){const t=new Sn;return t.serializeU64(e),t.getBytes()}function kd(e){const t=new Sn;return t.serializeU8(e),t.getBytes()}function ak(e){const t=new Sn;return t.serializeU16(e),t.getBytes()}function ck(e){const t=new Sn;return t.serializeU32(e),t.getBytes()}function uk(e){const t=new Sn;return t.serializeU128(e),t.getBytes()}function lk(e){const t=new Sn;return t.serializeBool(e),t.getBytes()}function dk(e){const t=new Sn;return t.serializeStr(e),t.getBytes()}function Lo(e){const t=new Sn;return t.serializeBytes(e),t.getBytes()}function hk(e){const t=new Sn;return t.serializeFixedBytes(e),t.getBytes()}var Ei=class{constructor(e){if(e.length!==Ei.LENGTH)throw new Error("Expected address of length 32");this.address=e}static fromHex(e){let t=$t.ensure(e);t.noPrefix().length%2!==0&&(t=new $t(`0${t.noPrefix()}`));const n=t.toUint8Array();if(n.length>Ei.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(n.length===Ei.LENGTH)return new Ei(n);const i=new Uint8Array(Ei.LENGTH);return i.set(n,Ei.LENGTH-n.length),new Ei(i)}static isValid(e){if(e==="")return!1;let t=$t.ensure(e);return t.noPrefix().length%2!==0&&(t=new $t(`0${t.noPrefix()}`)),t.toUint8Array().length<=Ei.LENGTH}toHexString(){return $t.fromUint8Array(this.address).hex()}serialize(e){e.serializeFixedBytes(this.address)}static deserialize(e){return new Ei(e.deserializeFixedBytes(Ei.LENGTH))}},xn=Ei;xn.LENGTH=32;xn.CORE_CODE_ADDRESS=Ei.fromHex("0x1");var cc=class{constructor(e){if(e.length!==cc.LENGTH)throw new Error(`Ed25519PublicKey length should be ${cc.LENGTH}`);this.value=e}toBytes(){return this.value}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const t=e.deserializeBytes();return new cc(t)}},Ii=cc;Ii.LENGTH=32;var uc=class{constructor(e){if(this.value=e,e.length!==uc.LENGTH)throw new Error(`Ed25519Signature length should be ${uc.LENGTH}`)}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const t=e.deserializeBytes();return new uc(t)}},es=uc;es.LENGTH=64;var Sd=32,ka=class{constructor(e,t){if(this.public_keys=e,this.threshold=t,t>Sd)throw new Error(`"threshold" cannot be larger than ${Sd}`)}toBytes(){const e=new Uint8Array(this.public_keys.length*Ii.LENGTH+1);return this.public_keys.forEach((t,n)=>{e.set(t.value,n*Ii.LENGTH)}),e[this.public_keys.length*Ii.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const t=e.deserializeBytes(),n=t[t.length-1],i=[];for(let s=0;s<t.length-1;s+=Ii.LENGTH){const o=s;i.push(new Ii(t.subarray(o,o+Ii.LENGTH)))}return new ka(i,n)}},Gr=class{constructor(e,t){if(this.signatures=e,this.bitmap=t,t.length!==Gr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Gr.BITMAP_LEN}`)}toBytes(){const e=new Uint8Array(this.signatures.length*es.LENGTH+Gr.BITMAP_LEN);return this.signatures.forEach((t,n)=>{e.set(t.value,n*es.LENGTH)}),e.set(this.bitmap,this.signatures.length*es.LENGTH),e}static createBitmap(e){const n=new Uint8Array([0,0,0,0]),i=new Set;return e.forEach(s=>{if(s>=Sd)throw new Error(`Invalid bit value ${s}.`);if(i.has(s))throw new Error("Duplicated bits detected.");i.add(s);const o=Math.floor(s/8);let r=n[o];r|=128>>s%8,n[o]=r}),n}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const t=e.deserializeBytes(),n=t.subarray(t.length-4),i=[];for(let s=0;s<t.length-n.length;s+=es.LENGTH){const o=s;i.push(new es(t.subarray(o,o+es.LENGTH)))}return new Gr(i,n)}},Ou=Gr;Ou.BITMAP_LEN=4;var Sa=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Ru.load(e);case 1:return $u.load(e);case 2:return Rh.load(e);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}},Ru=class extends Sa{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=Ii.deserialize(e),n=es.deserialize(e);return new Ru(t,n)}},$u=class extends Sa{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=ka.deserialize(e),n=Ou.deserialize(e);return new $u(t,n)}},Rh=class extends Sa{constructor(e,t,n){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=n}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),xi(this.secondary_signer_addresses,e),xi(this.secondary_signers,e)}static load(e){const t=ra.deserialize(e),n=Li(e,xn),i=Li(e,ra);return new Rh(t,n,i)}},ra=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return $h.load(e);case 1:return Uh.load(e);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}},$h=class extends ra{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=Ii.deserialize(e),n=es.deserialize(e);return new $h(t,n)}},Uh=class extends ra{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const t=ka.deserialize(e),n=Ou.deserialize(e);return new Uh(t,n)}},ai=class{constructor(e){this.value=e}serialize(e){e.serializeStr(this.value)}static deserialize(e){const t=e.deserializeStr();return new ai(t)}},Jn=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return vo.load(e);case 1:return hs.load(e);case 2:return xo.load(e);case 3:return To.load(e);case 4:return Ao.load(e);case 5:return qh.load(e);case 6:return Or.load(e);case 7:return ko.load(e);case 8:return Cr.load(e);case 9:return Br.load(e);case 10:return Ir.load(e);default:throw new Error(`Unknown variant index for TypeTag: ${t}`)}}},vo=class extends Jn{serialize(e){e.serializeU32AsUleb128(0)}static load(e){return new vo}},hs=class extends Jn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new hs}},Cr=class extends Jn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Cr}},Br=class extends Jn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Br}},xo=class extends Jn{serialize(e){e.serializeU32AsUleb128(2)}static load(e){return new xo}},To=class extends Jn{serialize(e){e.serializeU32AsUleb128(3)}static load(e){return new To}},Ir=class extends Jn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Ir}},Ao=class extends Jn{serialize(e){e.serializeU32AsUleb128(4)}static load(e){return new Ao}},qh=class extends Jn{serialize(e){e.serializeU32AsUleb128(5)}static load(e){return new qh}},Or=class extends Jn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(e){const t=Jn.deserialize(e);return new Or(t)}},ko=class extends Jn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(e){const t=fr.deserialize(e);return new ko(t)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===xn.fromHex("0x1").toHexString()}},fr=class{constructor(e,t,n,i){this.address=e,this.module_name=t,this.name=n,this.type_args=i}static fromString(e){if(e.includes("<"))throw new Error("Not implemented");const t=e.split("::");if(t.length!==3)throw new Error("Invalid struct tag string literal.");return new fr(xn.fromHex(t[0]),new ai(t[1]),new ai(t[2]),[])}serialize(e){this.address.serialize(e),this.module_name.serialize(e),this.name.serialize(e),xi(this.type_args,e)}static deserialize(e){const t=xn.deserialize(e),n=ai.deserialize(e),i=ai.deserialize(e),s=Li(e,Jn);return new fr(t,n,i,s)}},Rr=class{constructor(e,t,n,i,s,o,r){this.sender=e,this.sequence_number=t,this.payload=n,this.max_gas_amount=i,this.gas_unit_price=s,this.expiration_timestamp_secs=o,this.chain_id=r}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(e){const t=xn.deserialize(e),n=e.deserializeU64(),i=Ca.deserialize(e),s=e.deserializeU64(),o=e.deserializeU64(),r=e.deserializeU64(),a=Lu.deserialize(e);return new Rr(t,n,i,s,o,r,a)}},Pa=class{constructor(e,t,n){this.code=e,this.ty_args=t,this.args=n}serialize(e){e.serializeBytes(this.code),xi(this.ty_args,e),xi(this.args,e)}static deserialize(e){const t=e.deserializeBytes(),n=Li(e,Jn),i=Li(e,Xi);return new Pa(t,n,i)}},to=class{constructor(e,t,n,i){this.module_name=e,this.function_name=t,this.ty_args=n,this.args=i}static natural(e,t,n,i){return new to(ro.fromStr(e),new ai(t),n,i)}static natual(e,t,n,i){return to.natural(e,t,n,i)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),xi(this.ty_args,e),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{e.serializeBytes(t)})}static deserialize(e){const t=ro.deserialize(e),n=ai.deserialize(e),i=Li(e,Jn),s=e.deserializeUleb128AsU32(),o=[];for(let a=0;a<s;a+=1)o.push(e.deserializeBytes());const r=o;return new to(t,n,i,r)}},Lh=class{constructor(e){this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(e){return new Lh(to.deserialize(e))}},Dh=class{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),this.transaction_payload===void 0?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(e){const t=xn.deserialize(e),n=e.deserializeBool();let i;return n&&(i=Lh.deserialize(e)),new Dh(t,i)}},Rm=class{constructor(e){this.code=e}serialize(e){e.serializeBytes(this.code)}static deserialize(e){const t=e.deserializeBytes();return new Rm(t)}},ro=class{constructor(e,t){this.address=e,this.name=t}static fromStr(e){const t=e.split("::");if(t.length!==2)throw new Error("Invalid module id.");return new ro(xn.fromHex(new $t(t[0])),new ai(t[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(e){const t=xn.deserialize(e),n=ai.deserialize(e);return new ro(t,n)}},fk=class{serialize(e){throw new Error("Not implemented.")}static deserialize(e){throw new Error("Not implemented.")}},pk=class{serialize(e){throw new Error("Not implmented.")}static deserialize(e){throw new Error("Not implmented.")}},Ea=class{constructor(e,t){this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(e){const t=Rr.deserialize(e),n=Sa.deserialize(e);return new Ea(t,n)}},$m=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Uu.load(e);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},Uu=class extends $m{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),xi(this.secondary_signer_addresses,e)}static load(e){const t=Rr.deserialize(e),n=Li(e,xn);return new Uu(t,n)}},Ca=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Ba.load(e);case 2:return qu.load(e);case 3:return Mh.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${t}`)}}},Ba=class extends Ca{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){const t=Pa.deserialize(e);return new Ba(t)}},qu=class extends Ca{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),this.value.serialize(e)}static load(e){const t=to.deserialize(e);return new qu(t)}},Mh=class extends Ca{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const t=Dh.deserialize(e);return new Mh(t)}},Lu=class{constructor(e){this.value=e}serialize(e){e.serializeU8(this.value)}static deserialize(e){const t=e.deserializeU8();return new Lu(t)}},Xi=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Du.load(e);case 1:return pr.load(e);case 2:return Fu.load(e);case 3:return gr.load(e);case 4:return _r.load(e);case 5:return zu.load(e);case 6:return Mu.load(e);case 7:return Nu.load(e);case 8:return ju.load(e);default:throw new Error(`Unknown variant index for TransactionArgument: ${t}`)}}},Du=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),e.serializeU8(this.value)}static load(e){const t=e.deserializeU8();return new Du(t)}},Mu=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),e.serializeU16(this.value)}static load(e){const t=e.deserializeU16();return new Mu(t)}},Nu=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),e.serializeU32(this.value)}static load(e){const t=e.deserializeU32();return new Nu(t)}},pr=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(1),e.serializeU64(this.value)}static load(e){const t=e.deserializeU64();return new pr(t)}},Fu=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),e.serializeU128(this.value)}static load(e){const t=e.deserializeU128();return new Fu(t)}},ju=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(8),e.serializeU256(this.value)}static load(e){const t=e.deserializeU256();return new ju(t)}},gr=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const t=xn.deserialize(e);return new gr(t)}},_r=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(4),e.serializeBytes(this.value)}static load(e){const t=e.deserializeBytes();return new _r(t)}},zu=class extends Xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(5),e.serializeBool(this.value)}static load(e){const t=e.deserializeBool();return new zu(t)}},Um=class{getHashSalt(){const e=ur.create();return e.update("APTOS::Transaction"),e.digest()}static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Nh.load(e);default:throw new Error(`Unknown variant index for Transaction: ${t}`)}}},Nh=class extends Um{constructor(e){super(),this.value=e}hash(){const e=ur.create();return e.update(this.getHashSalt()),e.update(fs(this)),e.digest()}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){return new Nh(Ea.deserialize(e))}},Ia=class{constructor(e){this.name=e}serialize(e){e.serializeStr(this.name)}static deserialize(e){const t=e.deserializeStr();return new Ia(t)}},Oa=class{constructor(e,t){this.name=e,this.type_tag=t}serialize(e){e.serializeStr(this.name),this.type_tag.serialize(e)}static deserialize(e){const t=e.deserializeStr(),n=Jn.deserialize(e);return new Oa(t,n)}},Hu=class{static deserialize(e){const t=e.deserializeUleb128AsU32();switch(t){case 0:return Ku.load(e);case 1:return mr.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${t}`)}}},Ku=class extends Hu{constructor(e,t,n,i,s){super(),this.name=e,this.doc=t,this.code=n,this.ty_args=i,this.args=s}serialize(e){e.serializeU32AsUleb128(0),e.serializeStr(this.name),e.serializeStr(this.doc),e.serializeBytes(this.code),xi(this.ty_args,e),xi(this.args,e)}static load(e){const t=e.deserializeStr(),n=e.deserializeStr(),i=e.deserializeBytes(),s=Li(e,Ia),o=Li(e,Oa);return new Ku(t,n,i,s,o)}},mr=class extends Hu{constructor(e,t,n,i,s){super(),this.name=e,this.module_name=t,this.doc=n,this.ty_args=i,this.args=s}serialize(e){e.serializeU32AsUleb128(1),e.serializeStr(this.name),this.module_name.serialize(e),e.serializeStr(this.doc),xi(this.ty_args,e),xi(this.args,e)}static load(e){const t=e.deserializeStr(),n=ro.deserialize(e),i=e.deserializeStr(),s=Li(e,Ia),o=Li(e,Oa);return new mr(t,n,i,s,o)}},Do=class{constructor(e){if(e.length!==Do.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=e}static fromMultiEd25519PublicKey(e){const t=e.toBytes(),n=new Uint8Array(t.length+1);n.set(t),n.set([Do.MULTI_ED25519_SCHEME],t.length);const i=ur.create();return i.update(n),new Do(i.digest())}static fromEd25519PublicKey(e){const t=e.value,n=new Uint8Array(t.length+1);n.set(t),n.set([Do.ED25519_SCHEME],t.length);const i=ur.create();return i.update(n),new Do(i.digest())}derivedAddress(){return $t.fromUint8Array(this.bytes)}},ao=Do;ao.LENGTH=32;ao.MULTI_ED25519_SCHEME=1;ao.ED25519_SCHEME=0;ao.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var gk=class{constructor(e,t,n,i,s,o,r){this.accountAddress=e,this.moduleName=t,this.structName=n,this.sequenceNumber=i,this.originator=s,this.currentAuthKey=o,this.newPublicKey=r}serialize(e){this.accountAddress.serialize(e),e.serializeStr(this.moduleName),e.serializeStr(this.structName),e.serializeU64(this.sequenceNumber),this.originator.serialize(e),this.currentAuthKey.serialize(e),e.serializeBytes(this.newPublicKey)}},lc=class{static fromAptosAccountObject(e){return new lc($t.ensure(e.privateKeyHex).toUint8Array(),e.address)}static fromDerivePath(e,t){if(!lc.isValidPath(e))throw new Error("Invalid derivation path");const n=t.trim().split(/\s+/).map(s=>s.toLowerCase()).join(" "),{key:i}=WA(e,tm(K_(n)));return new lc(i)}constructor(e,t){e?this.signingKey=is.sign.keyPair.fromSeed(e.slice(0,32)):this.signingKey=is.sign.keyPair(),this.accountAddress=$t.ensure(t||this.authKey().hex())}address(){return this.accountAddress}authKey(){const e=new Ii(this.signingKey.publicKey);return ao.fromEd25519PublicKey(e).derivedAddress()}static getResourceAccountAddress(e,t){const n=fs(xn.fromHex(e)),i=new Uint8Array([...n,...t,ao.DERIVE_RESOURCE_ACCOUNT_SCHEME]),s=ur.create();return s.update(i),$t.fromUint8Array(s.digest())}pubKey(){return $t.fromUint8Array(this.signingKey.publicKey)}signBuffer(e){const t=is.sign(e,this.signingKey.secretKey);return $t.fromUint8Array(t.slice(0,64))}signHexString(e){const t=$t.ensure(e).toUint8Array();return this.signBuffer(t)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:$t.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},aa=lc;aa.isValidPath=e=>!!/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(e);ln([Iu()],aa.prototype,"authKey",1);function yr(e){return e instanceof aa?e.address():$t.ensure(e)}var _k=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,mk=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,yk=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${_k}
${mk}`,wk=`
    query getTokenActivities($idHash: String!) {
  token_activities(where: {token_data_id_hash: {_eq: $idHash}}) {
    creator_address
    collection_name
    name
    token_data_id_hash
    collection_data_id_hash
    from_address
    to_address
    transaction_version
    transaction_timestamp
    property_version
    transfer_type
    event_sequence_number
    token_amount
  }
}
    `,qm=class{constructor(e){this.endpoint=e}async queryIndexer(e){const{data:t}=await hr.post(this.endpoint,e);if(t.errors)throw new Error(`Indexer data error ${t.errors}`);return t.data}async getAccountNFTs(e,t){const n={query:yk,variables:{address:e,offset:t==null?void 0:t.offset,limit:t==null?void 0:t.limit}};return this.queryIndexer(n)}async getTokenActivities(e){const t={query:wk,variables:{idHash:e}};return this.queryIndexer(t)}},bk={};Bu(bk,{$AccountData:()=>qk,$AccountSignature:()=>Lk,$AccountSignature_Ed25519Signature:()=>Dk,$AccountSignature_MultiEd25519Signature:()=>Mk,$Address:()=>Nk,$AptosError:()=>Fk,$AptosErrorCode:()=>jk,$Block:()=>zk,$BlockMetadataTransaction:()=>Hk,$DecodedTableData:()=>Kk,$DeleteModule:()=>Wk,$DeleteResource:()=>Vk,$DeleteTableItem:()=>Xk,$DeletedTableData:()=>Gk,$DirectWriteSet:()=>Jk,$Ed25519Signature:()=>Zk,$EncodeSubmissionRequest:()=>Yk,$EntryFunctionId:()=>Qk,$EntryFunctionPayload:()=>e6,$Event:()=>t6,$EventGuid:()=>n6,$GasEstimation:()=>i6,$GenesisPayload:()=>s6,$GenesisPayload_WriteSetPayload:()=>o6,$GenesisTransaction:()=>r6,$HashValue:()=>a6,$HealthCheckSuccess:()=>c6,$HexEncodedBytes:()=>u6,$IdentifierWrapper:()=>l6,$IndexResponse:()=>d6,$ModuleBundlePayload:()=>h6,$MoveAbility:()=>f6,$MoveFunction:()=>p6,$MoveFunctionGenericTypeParam:()=>g6,$MoveFunctionVisibility:()=>_6,$MoveModule:()=>m6,$MoveModuleBytecode:()=>y6,$MoveModuleId:()=>w6,$MoveResource:()=>b6,$MoveScriptBytecode:()=>v6,$MoveStruct:()=>x6,$MoveStructField:()=>T6,$MoveStructGenericTypeParam:()=>A6,$MoveStructTag:()=>k6,$MoveStructValue:()=>S6,$MoveType:()=>P6,$MoveValue:()=>E6,$MultiAgentSignature:()=>C6,$MultiEd25519Signature:()=>B6,$MultisigPayload:()=>I6,$MultisigTransactionPayload:()=>O6,$PendingTransaction:()=>R6,$RawTableItemRequest:()=>$6,$RoleType:()=>U6,$ScriptPayload:()=>q6,$ScriptWriteSet:()=>L6,$StateCheckpointTransaction:()=>D6,$StateKeyWrapper:()=>M6,$SubmitTransactionRequest:()=>N6,$TableItemRequest:()=>F6,$Transaction:()=>j6,$TransactionPayload:()=>V6,$TransactionPayload_EntryFunctionPayload:()=>X6,$TransactionPayload_ModuleBundlePayload:()=>J6,$TransactionPayload_MultisigPayload:()=>Z6,$TransactionPayload_ScriptPayload:()=>Y6,$TransactionSignature:()=>tS,$TransactionSignature_Ed25519Signature:()=>nS,$TransactionSignature_MultiAgentSignature:()=>iS,$TransactionSignature_MultiEd25519Signature:()=>sS,$Transaction_BlockMetadataTransaction:()=>z6,$Transaction_GenesisTransaction:()=>H6,$Transaction_PendingTransaction:()=>K6,$Transaction_StateCheckpointTransaction:()=>G6,$Transaction_UserTransaction:()=>W6,$TransactionsBatchSingleSubmissionFailure:()=>Q6,$TransactionsBatchSubmissionResult:()=>eS,$U128:()=>oS,$U256:()=>rS,$U64:()=>aS,$UserTransaction:()=>cS,$VersionedEvent:()=>uS,$ViewRequest:()=>lS,$WriteModule:()=>dS,$WriteResource:()=>hS,$WriteSet:()=>fS,$WriteSetChange:()=>_S,$WriteSetChange_DeleteModule:()=>mS,$WriteSetChange_DeleteResource:()=>yS,$WriteSetChange_DeleteTableItem:()=>wS,$WriteSetChange_WriteModule:()=>bS,$WriteSetChange_WriteResource:()=>vS,$WriteSetChange_WriteTableItem:()=>xS,$WriteSetPayload:()=>TS,$WriteSet_DirectWriteSet:()=>pS,$WriteSet_ScriptWriteSet:()=>gS,$WriteTableItem:()=>AS,AccountsService:()=>zm,ApiError:()=>ca,AptosErrorCode:()=>Zm,AptosGeneratedClient:()=>Jm,BaseHttpRequest:()=>Lm,BlocksService:()=>Hm,CancelError:()=>Dm,CancelablePromise:()=>Mm,EventsService:()=>Km,GeneralService:()=>Gm,MoveFunctionVisibility:()=>Ym,OpenAPI:()=>Uk,RoleType:()=>Qm,TablesService:()=>Wm,TransactionsService:()=>Vm,ViewService:()=>Xm});var Lm=class{constructor(e){this.config=e}},ca=class extends Error{constructor(e,t,n){super(n),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}},Dm=class extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}},Mm=class{constructor(e){this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n;const i=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,(a=this._resolve)==null||a.call(this,r))},s=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,(a=this._reject)==null||a.call(this,r))},o=r=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(r)};return Object.defineProperty(o,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(o,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(o,"isCancelled",{get:()=>this._isCancelled}),e(i,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(){var e;if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const t of this._cancelHandlers)t()}catch(t){console.warn("Cancellation threw an error",t);return}this._cancelHandlers.length=0,(e=this._reject)==null||e.call(this,new Dm("Request aborted"))}}get isCancelled(){return this._isCancelled}},Nm=class{constructor(e=new Map){this.jar=e}setCookie(e,t){var n;const i=e.origin.toLowerCase();this.jar.has(i)||this.jar.set(i,[]);const s=Nm.parse(t);this.jar.set(i,[...((n=this.jar.get(i))==null?void 0:n.filter(o=>o.name!==s.name))||[],s])}getCookies(e){var t;const n=e.origin.toLowerCase();return this.jar.get(n)?((t=this.jar.get(n))==null?void 0:t.filter(i=>!i.expires||i.expires>new Date))||[]:[]}static parse(e){if(typeof e!="string")throw new Error("argument str must be a string");const t=e.split(";").map(i=>i.trim());let n;if(t.length>0){const[i,s]=t[0].split("=");if(!i||!s)throw new Error("Invalid cookie");n={name:i,value:s}}else throw new Error("Invalid cookie");return t.slice(1).forEach(i=>{const[s,o]=i.split("=");if(!s.trim())throw new Error("Invalid cookie");const r=s.toLowerCase(),a=(o==null?void 0:o.charAt(0))==="'"||(o==null?void 0:o.charAt(0))==='"'?o==null?void 0:o.slice(1,-1):o;if(r==="expires"&&(n.expires=new Date(a)),r==="path"&&(n.path=a),r==="samesite"){if(a!=="Lax"&&a!=="None"&&a!=="Strict")throw new Error("Invalid cookie SameSite value");n.sameSite=a}r==="secure"&&(n.secure=!0)}),n}},Fm=new Nm;hr.interceptors.response.use(e=>(Array.isArray(e.headers["set-cookie"])&&e.headers["set-cookie"].forEach(t=>{Fm.setCookie(new URL(e.config.url),t)}),e));hr.interceptors.request.use(function(e){const t=Fm.getCookies(new URL(e.url));return(t==null?void 0:t.length)>0&&e.headers&&(e.headers.cookie=t.map(n=>`${n.name}=${n.value}`).join("; ")),e});var Fh=e=>e!=null,Gu=e=>typeof e=="string",zl=e=>Gu(e)&&e!=="",jm=e=>typeof e=="object"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.arrayBuffer=="function"&&typeof e.constructor=="function"&&typeof e.constructor.name=="string"&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),vk=e=>e instanceof Pm,xk=e=>e>=200&&e<300,Tk=e=>btoa(e),Ak=e=>{const t=[],n=(s,o)=>{t.push(`${encodeURIComponent(s)}=${encodeURIComponent(String(o))}`)},i=(s,o)=>{Fh(o)&&(Array.isArray(o)?o.forEach(r=>{i(s,r)}):typeof o=="object"?Object.entries(o).forEach(([r,a])=>{i(`${s}[${r}]`,a)}):n(s,o))};return Object.entries(e).forEach(([s,o])=>{i(s,o)}),t.length>0?`?${t.join("&")}`:""},kk=(e,t)=>{const n=e.ENCODE_PATH||encodeURI,i=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,(o,r)=>{var a;return(a=t.path)!=null&&a.hasOwnProperty(r)?n(String(t.path[r])):o}),s=`${e.BASE}${i}`;return t.query?`${s}${Ak(t.query)}`:s},Sk=e=>{if(e.formData){const t=new Pm,n=(i,s)=>{Gu(s)||jm(s)?t.append(i,s):t.append(i,JSON.stringify(s))};return Object.entries(e.formData).filter(([i,s])=>Fh(s)).forEach(([i,s])=>{Array.isArray(s)?s.forEach(o=>n(i,o)):n(i,s)}),t}},Ha=async(e,t)=>typeof t=="function"?t(e):t,Pk=async(e,t,n)=>{const i=await Ha(t,e.TOKEN),s=await Ha(t,e.USERNAME),o=await Ha(t,e.PASSWORD),r=await Ha(t,e.HEADERS),a=typeof(n==null?void 0:n.getHeaders)=="function"&&(n==null?void 0:n.getHeaders())||{},c=Object.entries({Accept:"application/json",...r,...t.headers,...a}).filter(([u,l])=>Fh(l)).reduce((u,[l,d])=>({...u,[l]:String(d)}),{});if(zl(i)&&(c.Authorization=`Bearer ${i}`),zl(s)&&zl(o)){const u=Tk(`${s}:${o}`);c.Authorization=`Basic ${u}`}return t.body&&(t.mediaType?c["Content-Type"]=t.mediaType:jm(t.body)?c["Content-Type"]=t.body.type||"application/octet-stream":Gu(t.body)?c["Content-Type"]="text/plain":vk(t.body)||(c["Content-Type"]="application/json")),c},Ek=e=>{if(e.body)return e.body},Ck=async(e,t,n,i,s,o,r)=>{const a=hr.CancelToken.source(),c={url:n,headers:o,data:i??s,method:t.method,withCredentials:e.WITH_CREDENTIALS,cancelToken:a.token};Object.keys(e.HEADERS||{}).filter(l=>l.toLowerCase()==="accept").map(l=>e.HEADERS[l]).includes("application/x-bcs")&&(c.responseType="arraybuffer"),r(()=>a.cancel("The user aborted a request."));try{return await hr.request(c)}catch(l){const d=l;if(d.response)return d.response;throw l}},Bk=(e,t)=>{if(t){const n=e.headers[t];if(Gu(n))return n}},Ik=e=>{if(e.status!==204)return e.data},Ok=(e,t)=>{const i={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(i)throw new ca(e,t,i);if(!t.ok)throw new ca(e,t,"Generic Error")},Rk=(e,t)=>new Mm(async(n,i,s)=>{try{const o=kk(e,t),r=Sk(t),a=Ek(t),c=await Pk(e,t,r);if(!s.isCancelled){const u=await Ck(e,t,o,a,r,c,s),l=Ik(u),d=Bk(u,t.responseHeader),h={url:o,ok:xk(u.status),status:u.status,statusText:u.statusText,body:d??l};Ok(t,h);const g=h.body;try{g.__headers=u.headers}catch{}n(g)}}catch(o){i(o)}}),$k=class extends Lm{constructor(e){super(e)}request(e){return Rk(this.config,e)}},zm=class{constructor(e){this.httpRequest=e}getAccount(e,t){return this.httpRequest.request({method:"GET",url:"/accounts/{address}",path:{address:e},query:{ledger_version:t}})}getAccountResources(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resources",path:{address:e},query:{ledger_version:t,start:n,limit:i}})}getAccountModules(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/modules",path:{address:e},query:{ledger_version:t,start:n,limit:i}})}getAccountResource(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resource/{resource_type}",path:{address:e,resource_type:t},query:{ledger_version:n}})}getAccountModule(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/module/{module_name}",path:{address:e,module_name:t},query:{ledger_version:n}})}},Hm=class{constructor(e){this.httpRequest=e}getBlockByHeight(e,t){return this.httpRequest.request({method:"GET",url:"/blocks/by_height/{block_height}",path:{block_height:e},query:{with_transactions:t}})}getBlockByVersion(e,t){return this.httpRequest.request({method:"GET",url:"/blocks/by_version/{version}",path:{version:e},query:{with_transactions:t}})}},Km=class{constructor(e){this.httpRequest=e}getEventsByCreationNumber(e,t,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{creation_number}",path:{address:e,creation_number:t},query:{start:n,limit:i}})}getEventsByEventHandle(e,t,n,i,s){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{event_handle}/{field_name}",path:{address:e,event_handle:t,field_name:n},query:{start:i,limit:s}})}},Gm=class{constructor(e){this.httpRequest=e}spec(){return this.httpRequest.request({method:"GET",url:"/spec"})}healthy(e){return this.httpRequest.request({method:"GET",url:"/-/healthy",query:{duration_secs:e}})}getLedgerInfo(){return this.httpRequest.request({method:"GET",url:"/"})}},Wm=class{constructor(e){this.httpRequest=e}getTableItem(e,t,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/item",path:{table_handle:e},query:{ledger_version:n},body:t,mediaType:"application/json"})}getRawTableItem(e,t,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/raw_item",path:{table_handle:e},query:{ledger_version:n},body:t,mediaType:"application/json"})}},Vm=class{constructor(e){this.httpRequest=e}getTransactions(e,t){return this.httpRequest.request({method:"GET",url:"/transactions",query:{start:e,limit:t}})}submitTransaction(e){return this.httpRequest.request({method:"POST",url:"/transactions",body:e,mediaType:"application/json"})}getTransactionByHash(e){return this.httpRequest.request({method:"GET",url:"/transactions/by_hash/{txn_hash}",path:{txn_hash:e}})}getTransactionByVersion(e){return this.httpRequest.request({method:"GET",url:"/transactions/by_version/{txn_version}",path:{txn_version:e}})}getAccountTransactions(e,t,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/transactions",path:{address:e},query:{start:t,limit:n}})}submitBatchTransactions(e){return this.httpRequest.request({method:"POST",url:"/transactions/batch",body:e,mediaType:"application/json"})}simulateTransaction(e,t,n,i){return this.httpRequest.request({method:"POST",url:"/transactions/simulate",query:{estimate_max_gas_amount:t,estimate_gas_unit_price:n,estimate_prioritized_gas_unit_price:i},body:e,mediaType:"application/json"})}encodeSubmission(e){return this.httpRequest.request({method:"POST",url:"/transactions/encode_submission",body:e,mediaType:"application/json"})}estimateGasPrice(){return this.httpRequest.request({method:"GET",url:"/estimate_gas_price"})}},Xm=class{constructor(e){this.httpRequest=e}view(e,t){return this.httpRequest.request({method:"POST",url:"/view",query:{ledger_version:t},body:e,mediaType:"application/json"})}},Jm=class{constructor(e,t=$k){var n,i,s,o;this.request=new t({BASE:(n=e==null?void 0:e.BASE)!=null?n:"/v1",VERSION:(i=e==null?void 0:e.VERSION)!=null?i:"1.2.0",WITH_CREDENTIALS:(s=e==null?void 0:e.WITH_CREDENTIALS)!=null?s:!1,CREDENTIALS:(o=e==null?void 0:e.CREDENTIALS)!=null?o:"include",TOKEN:e==null?void 0:e.TOKEN,USERNAME:e==null?void 0:e.USERNAME,PASSWORD:e==null?void 0:e.PASSWORD,HEADERS:e==null?void 0:e.HEADERS,ENCODE_PATH:e==null?void 0:e.ENCODE_PATH}),this.accounts=new zm(this.request),this.blocks=new Hm(this.request),this.events=new Km(this.request),this.general=new Gm(this.request),this.tables=new Wm(this.request),this.transactions=new Vm(this.request),this.view=new Xm(this.request)}},Uk={BASE:"/v1",VERSION:"1.2.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},Zm=(e=>(e.ACCOUNT_NOT_FOUND="account_not_found",e.RESOURCE_NOT_FOUND="resource_not_found",e.MODULE_NOT_FOUND="module_not_found",e.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",e.VERSION_NOT_FOUND="version_not_found",e.TRANSACTION_NOT_FOUND="transaction_not_found",e.TABLE_ITEM_NOT_FOUND="table_item_not_found",e.BLOCK_NOT_FOUND="block_not_found",e.VERSION_PRUNED="version_pruned",e.BLOCK_PRUNED="block_pruned",e.INVALID_INPUT="invalid_input",e.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",e.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",e.VM_ERROR="vm_error",e.HEALTH_CHECK_FAILED="health_check_failed",e.MEMPOOL_IS_FULL="mempool_is_full",e.INTERNAL_ERROR="internal_error",e.WEB_FRAMEWORK_ERROR="web_framework_error",e.BCS_NOT_SUPPORTED="bcs_not_supported",e.API_DISABLED="api_disabled",e))(Zm||{}),Ym=(e=>(e.PRIVATE="private",e.PUBLIC="public",e.FRIEND="friend",e))(Ym||{}),Qm=(e=>(e.VALIDATOR="validator",e.FULL_NODE="full_node",e))(Qm||{}),qk={description:`Account data

    A simplified version of the onchain Account resource`,properties:{sequence_number:{type:"U64",isRequired:!0},authentication_key:{type:"HexEncodedBytes",isRequired:!0}}},Lk={type:"one-of",description:`Account signature scheme

    The account signature scheme allows you to have two types of accounts:

    1. A single Ed25519 key account, one private key
    2. A k-of-n multi-Ed25519 key account, multiple private keys, such that k-of-n must sign a transaction.`,contains:[{type:"AccountSignature_Ed25519Signature"},{type:"AccountSignature_MultiEd25519Signature"}]},Dk={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},Mk={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},Nk={type:"string",description:`A hex encoded 32 byte Aptos account address.

    This is represented in a string as a 64 character hex string, sometimes
    shortened by stripping leading 0s, and adding a 0x.

    For example, address 0x0000000000000000000000000000000000000000000000000000000000000001 is represented as 0x1.
    `,format:"hex"},Fk={description:`This is the generic struct we use for all API errors, it contains a string
    message and an Aptos API specific error code.`,properties:{message:{type:"string",description:"A message describing the error",isRequired:!0},error_code:{type:"AptosErrorCode",isRequired:!0},vm_error_code:{type:"number",description:"A code providing VM error details when submitting transactions to the VM",format:"uint64"}}},jk={type:"Enum"},zk={description:`A Block with or without transactions

    This contains the information about a transactions along with
    associated transactions if requested`,properties:{block_height:{type:"U64",isRequired:!0},block_hash:{type:"HashValue",isRequired:!0},block_timestamp:{type:"U64",isRequired:!0},first_version:{type:"U64",isRequired:!0},last_version:{type:"U64",isRequired:!0},transactions:{type:"array",contains:{type:"Transaction"}}}},Hk={description:`A block metadata transaction

    This signifies the beginning of a block, and contains information
    about the specific block`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},id:{type:"HashValue",isRequired:!0},epoch:{type:"U64",isRequired:!0},round:{type:"U64",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0},previous_block_votes_bitvec:{type:"array",contains:{type:"number",format:"uint8"},isRequired:!0},proposer:{type:"Address",isRequired:!0},failed_proposer_indices:{type:"array",contains:{type:"number",format:"uint32"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},Kk={description:"Decoded table data",properties:{key:{description:"Key of table in JSON",properties:{},isRequired:!0},key_type:{type:"string",description:"Type of key",isRequired:!0},value:{description:"Value of table in JSON",properties:{},isRequired:!0},value_type:{type:"string",description:"Type of value",isRequired:!0}}},Gk={description:"Deleted table data",properties:{key:{description:"Deleted key",properties:{},isRequired:!0},key_type:{type:"string",description:"Deleted key type",isRequired:!0}}},Wk={description:"Delete a module",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},module:{type:"MoveModuleId",isRequired:!0}}},Vk={description:"Delete a resource",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},resource:{type:"MoveStructTag",isRequired:!0}}},Xk={description:"Delete a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DeletedTableData"}}},Jk={properties:{changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},Zk={description:"A single Ed25519 signature",properties:{public_key:{type:"HexEncodedBytes",isRequired:!0},signature:{type:"HexEncodedBytes",isRequired:!0}}},Yk={description:"Request to encode a submission",properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},secondary_signers:{type:"array",contains:{type:"Address"}}}},Qk={type:"string",description:"Entry function id is string representation of a entry function defined on-chain.\n\n    Format: `{address}::{module name}::{function name}`\n\n    Both `module name` and `function name` are case-sensitive.\n    "},e6={description:"Payload which runs a single entry function",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},t6={description:"An event from a transaction",properties:{guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},n6={properties:{creation_number:{type:"U64",isRequired:!0},account_address:{type:"Address",isRequired:!0}}},i6={description:"Struct holding the outputs of the estimate gas API",properties:{deprioritized_gas_estimate:{type:"number",description:"The deprioritized estimate for the gas unit price",format:"uint64"},gas_estimate:{type:"number",description:"The current estimate for the gas unit price",isRequired:!0,format:"uint64"},prioritized_gas_estimate:{type:"number",description:"The prioritized estimate for the gas unit price",format:"uint64"}}},s6={type:"one-of",description:"The writeset payload of the Genesis transaction",contains:[{type:"GenesisPayload_WriteSetPayload"}]},o6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteSetPayload"}]},r6={description:`The genesis transaction

    This only occurs at the genesis transaction (version 0)`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},payload:{type:"GenesisPayload",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},a6={type:"string"},c6={description:"Representation of a successful healthcheck",properties:{message:{type:"string",isRequired:!0}}},u6={type:"string",description:"All bytes (Vec<u8>) data is represented as hex-encoded string prefixed with `0x` and fulfilled with\n    two hex digits per byte.\n\n    Unlike the `Address` type, HexEncodedBytes will not trim any zeros.\n    ",format:"hex"},l6={type:"string"},d6={description:`The struct holding all data returned to the client by the
    index endpoint (i.e., GET "/").  Only for responding in JSON`,properties:{chain_id:{type:"number",description:"Chain ID of the current chain",isRequired:!0,format:"uint8"},epoch:{type:"U64",isRequired:!0},ledger_version:{type:"U64",isRequired:!0},oldest_ledger_version:{type:"U64",isRequired:!0},ledger_timestamp:{type:"U64",isRequired:!0},node_role:{type:"RoleType",isRequired:!0},oldest_block_height:{type:"U64",isRequired:!0},block_height:{type:"U64",isRequired:!0},git_hash:{type:"string",description:`Git hash of the build of the API endpoint.  Can be used to determine the exact
            software version used by the API endpoint.`}}},h6={properties:{modules:{type:"array",contains:{type:"MoveModuleBytecode"},isRequired:!0}}},f6={type:"string"},p6={description:"Move function",properties:{name:{type:"IdentifierWrapper",isRequired:!0},visibility:{type:"MoveFunctionVisibility",isRequired:!0},is_entry:{type:"boolean",description:"Whether the function can be called as an entry function directly in a transaction",isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveFunctionGenericTypeParam"},isRequired:!0},params:{type:"array",contains:{type:"MoveType"},isRequired:!0},return:{type:"array",contains:{type:"MoveType"},isRequired:!0}}},g6={description:"Move function generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},_6={type:"Enum"},m6={description:"A Move module",properties:{address:{type:"Address",isRequired:!0},name:{type:"IdentifierWrapper",isRequired:!0},friends:{type:"array",contains:{type:"MoveModuleId"},isRequired:!0},exposed_functions:{type:"array",contains:{type:"MoveFunction"},isRequired:!0},structs:{type:"array",contains:{type:"MoveStruct"},isRequired:!0}}},y6={description:"Move module bytecode along with it's ABI",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveModule"}}},w6={type:"string",description:`Move module id is a string representation of Move module.

    Format: \`{address}::{module name}\`

    \`address\` should be hex-encoded 32 byte account address that is prefixed with \`0x\`.

    Module name is case-sensitive.
    `},b6={description:"A parsed Move resource",properties:{type:{type:"MoveStructTag",isRequired:!0},data:{type:"MoveStructValue",isRequired:!0}}},v6={description:"Move script bytecode",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveFunction"}}},x6={description:"A move struct",properties:{name:{type:"IdentifierWrapper",isRequired:!0},is_native:{type:"boolean",description:"Whether the struct is a native struct of Move",isRequired:!0},abilities:{type:"array",contains:{type:"MoveAbility"},isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveStructGenericTypeParam"},isRequired:!0},fields:{type:"array",contains:{type:"MoveStructField"},isRequired:!0}}},T6={description:"Move struct field",properties:{name:{type:"IdentifierWrapper",isRequired:!0},type:{type:"MoveType",isRequired:!0}}},A6={description:"Move generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},k6={type:"string",description:"String representation of a MoveStructTag (on-chain Move struct type). This exists so you\n    can specify MoveStructTags as path / query parameters, e.g. for get_events_by_event_handle.\n\n    It is a combination of:\n    1. `move_module_address`, `module_name` and `struct_name`, all joined by `::`\n    2. `struct generic type parameters` joined by `, `\n\n    Examples:\n     * `0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>`\n     * `0x1::account::Account`\n\n    Note:\n    1. Empty chars should be ignored when comparing 2 struct tag ids.\n    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).\n\n    See [doc](https://aptos.dev/concepts/accounts) for more details.\n    ",pattern:"^0x[0-9a-zA-Z:_<>]+$"},S6={description:'This is a JSON representation of some data within an account resource. More specifically,\n    it is a map of strings to arbitrary JSON values / objects, where the keys are top level\n    fields within the given resource.\n\n    To clarify, you might query for 0x1::account::Account and see the example data.\n\n    Move `bool` type value is serialized into `boolean`.\n\n    Move `u8`, `u16` and `u32` type value is serialized into `integer`.\n\n    Move `u64`, `u128` and `u256` type value is serialized into `string`.\n\n    Move `address` type value (32 byte Aptos account address) is serialized into a HexEncodedBytes string.\n    For example:\n    - `0x1`\n    - `0x1668f6be25668c1a17cd8caf6b8d2f25`\n\n    Move `vector` type value is serialized into `array`, except `vector<u8>` which is serialized into a\n    HexEncodedBytes string with `0x` prefix.\n    For example:\n    - `vector<u64>{255, 255}` => `["255", "255"]`\n    - `vector<u8>{255, 255}` => `0xffff`\n\n    Move `struct` type value is serialized into `object` that looks like this (except some Move stdlib types, see the following section):\n    ```json\n    {\n        field1_name: field1_value,\n        field2_name: field2_value,\n        ......\n    }\n    ```\n\n    For example:\n    `{ "created": "0xa550c18", "role_id": "0" }`\n\n     **Special serialization for Move stdlib types**:\n    - [0x1::string::String](https://github.com/aptos-labs/aptos-core/blob/main/language/move-stdlib/docs/ascii.md)\n    is serialized into `string`. For example, struct value `0x1::string::String{bytes: b"Hello World!"}`\n    is serialized as `"Hello World!"` in JSON.\n    ',properties:{}},P6={type:"string",description:`String representation of an on-chain Move type tag that is exposed in transaction payload.
    Values:
    - bool
    - u8
    - u16
    - u32
    - u64
    - u128
    - u256
    - address
    - signer
    - vector: \`vector<{non-reference MoveTypeId}>\`
    - struct: \`{address}::{module_name}::{struct_name}::<{generic types}>\`

    Vector type value examples:
    - \`vector<u8>\`
    - \`vector<vector<u64>>\`
    - \`vector<0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>>\`

    Struct type value examples:
    - \`0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>
    - \`0x1::account::Account\`

    Note:
    1. Empty chars should be ignored when comparing 2 struct tag ids.
    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).
    `,pattern:"^(bool|u8|u64|u128|address|signer|vector<.+>|0x[0-9a-zA-Z:_<, >]+)$"},E6={type:"any-of",description:"An enum of the possible Move value types",contains:[{type:"number",format:"uint8"},{type:"number",format:"uint16"},{type:"number",format:"uint32"},{type:"U64"},{type:"U128"},{type:"U256"},{type:"boolean"},{type:"Address"},{type:"array",contains:{type:"MoveValue"}},{type:"HexEncodedBytes"},{type:"MoveStructValue"},{type:"string"}]},C6={description:`Multi agent signature for multi agent transactions

    This allows you to have transactions across multiple accounts`,properties:{sender:{type:"AccountSignature",isRequired:!0},secondary_signer_addresses:{type:"array",contains:{type:"Address"},isRequired:!0},secondary_signers:{type:"array",contains:{type:"AccountSignature"},isRequired:!0}}},B6={description:`A Ed25519 multi-sig signature

    This allows k-of-n signing for a transaction`,properties:{public_keys:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},signatures:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},threshold:{type:"number",description:"The number of signatures required for a successful transaction",isRequired:!0,format:"uint8"},bitmap:{type:"HexEncodedBytes",isRequired:!0}}},I6={description:`A multisig transaction that allows an owner of a multisig account to execute a pre-approved
    transaction as the multisig account.`,properties:{multisig_address:{type:"Address",isRequired:!0},transaction_payload:{type:"MultisigTransactionPayload"}}},O6={type:"any-of",contains:[{type:"EntryFunctionPayload"}]},R6={description:"A transaction waiting in mempool",properties:{hash:{type:"HashValue",isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"}}},$6={description:"Table Item request for the GetTableItemRaw API",properties:{key:{type:"HexEncodedBytes",isRequired:!0}}},U6={type:"Enum"},q6={description:"Payload which runs a script that can run multiple functions",properties:{code:{type:"MoveScriptBytecode",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},L6={properties:{execute_as:{type:"Address",isRequired:!0},script:{type:"ScriptPayload",isRequired:!0}}},D6={description:"A state checkpoint transaction",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},M6={type:"string",description:`Representation of a StateKey as a hex string. This is used for cursor based pagination.
    `},N6={description:`A request to submit a transaction

    This requires a transaction and a signature of it`,properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature",isRequired:!0}}},F6={description:"Table Item request for the GetTableItem API",properties:{key_type:{type:"MoveType",isRequired:!0},value_type:{type:"MoveType",isRequired:!0},key:{description:"The value of the table item's key",properties:{},isRequired:!0}}},j6={type:"one-of",description:"Enum of the different types of transactions in Aptos",contains:[{type:"Transaction_PendingTransaction"},{type:"Transaction_UserTransaction"},{type:"Transaction_GenesisTransaction"},{type:"Transaction_BlockMetadataTransaction"},{type:"Transaction_StateCheckpointTransaction"}]},z6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"BlockMetadataTransaction"}]},H6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"GenesisTransaction"}]},K6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"PendingTransaction"}]},G6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"StateCheckpointTransaction"}]},W6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"UserTransaction"}]},V6={type:"one-of",description:"An enum of the possible transaction payloads",contains:[{type:"TransactionPayload_EntryFunctionPayload"},{type:"TransactionPayload_ScriptPayload"},{type:"TransactionPayload_ModuleBundlePayload"},{type:"TransactionPayload_MultisigPayload"}]},X6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"EntryFunctionPayload"}]},J6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ModuleBundlePayload"}]},Z6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultisigPayload"}]},Y6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptPayload"}]},Q6={description:"Information telling which batch submission transactions failed",properties:{error:{type:"AptosError",isRequired:!0},transaction_index:{type:"number",description:"The index of which transaction failed, same as submission order",isRequired:!0,format:"uint64"}}},eS={description:`Batch transaction submission result

    Tells which transactions failed`,properties:{transaction_failures:{type:"array",contains:{type:"TransactionsBatchSingleSubmissionFailure"},isRequired:!0}}},tS={type:"one-of",description:"An enum representing the different transaction signatures available",contains:[{type:"TransactionSignature_Ed25519Signature"},{type:"TransactionSignature_MultiEd25519Signature"},{type:"TransactionSignature_MultiAgentSignature"}]},nS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},iS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiAgentSignature"}]},sS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},oS={type:"string",description:`A string containing a 128-bit unsigned integer.

    We represent u128 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u128s in JSON natively.
    `,format:"uint128"},rS={type:"string",description:`A string containing a 256-bit unsigned integer.

    We represent u256 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u256s in JSON natively.
    `,format:"uint256"},aS={type:"string",description:`A string containing a 64-bit unsigned integer.

    We represent u64 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u64s in JSON natively.
    `,format:"uint64"},cS={description:"A transaction submitted by a user to change the state of the blockchain",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"},events:{type:"array",contains:{type:"Event"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},uS={description:"An event from a transaction with a version",properties:{version:{type:"U64",isRequired:!0},guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},lS={description:"View request for the Move View Function API",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},dS={description:"Write a new module or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveModuleBytecode",isRequired:!0}}},hS={description:"Write a resource or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveResource",isRequired:!0}}},fS={type:"one-of",description:"The associated writeset with a payload",contains:[{type:"WriteSet_ScriptWriteSet"},{type:"WriteSet_DirectWriteSet"}]},pS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DirectWriteSet"}]},gS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptWriteSet"}]},_S={type:"one-of",description:"A final state change of a transaction on a resource or module",contains:[{type:"WriteSetChange_DeleteModule"},{type:"WriteSetChange_DeleteResource"},{type:"WriteSetChange_DeleteTableItem"},{type:"WriteSetChange_WriteModule"},{type:"WriteSetChange_WriteResource"},{type:"WriteSetChange_WriteTableItem"}]},mS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteModule"}]},yS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteResource"}]},wS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteTableItem"}]},bS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteModule"}]},vS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteResource"}]},xS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteTableItem"}]},TS={description:"A writeset payload, used only for genesis",properties:{write_set:{type:"WriteSet",isRequired:!0}}},AS={description:"Change set to write a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},value:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DecodedTableData"}}},kS=new fr(xn.fromHex("0x1"),new ai("string"),new ai("String"),[]);function Wu(e,t,n){if(!(t!=null&&t.includes(typeof e)))throw new Error(n||`Invalid arg: ${e} type should be ${t instanceof Array?t.join(" or "):t}`)}function Ks(e){throw new Error(e)}function c0(e){return!!e.match(/\s/)}function u0(e){return!!e.match(/[_A-Za-z0-9]/g)}function SS(e,t){const n=e[t];if(n===":"){if(e.slice(t,t+2)==="::")return[["COLON","::"],2];Ks("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(c0(n)){let i="";for(let s=t;s<e.length;s+=1){const o=e[s];if(c0(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(u0(n)){let i="";for(let s=t;s<e.length;s+=1){const o=e[s];if(u0(o))i=`${i}${o}`;else break}return[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function PS(e){let t=0;const n=[];for(;t<e.length;){const[i,s]=SS(e,t);i[0]!=="SPACE"&&n.push(i),t+=s}return n}var Vu=class{constructor(e){this.tokens=PS(e)}consume(e){const t=this.tokens.shift();(!t||t[1]!==e)&&Ks("Invalid type tag.")}parseCommaList(e,t){const n=[];for(this.tokens.length<=0&&Ks("Invalid type tag.");this.tokens[0][1]!==e&&(n.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===e||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===e&&t)));)this.tokens.length<=0&&Ks("Invalid type tag.");return n}parseTypeTag(){this.tokens.length===0&&Ks("Invalid type tag.");const[e,t]=this.tokens.shift();if(t==="u8")return new hs;if(t==="u16")return new Cr;if(t==="u32")return new Br;if(t==="u64")return new xo;if(t==="u128")return new To;if(t==="u256")return new Ir;if(t==="bool")return new vo;if(t==="address")return new Ao;if(t==="vector"){this.consume("<");const n=this.parseTypeTag();return this.consume(">"),new Or(n)}if(e==="IDENT"&&(t.startsWith("0x")||t.startsWith("0X"))){const n=t;this.consume("::");const[i,s]=this.tokens.shift();i!=="IDENT"&&Ks("Invalid type tag."),this.consume("::");const[o,r]=this.tokens.shift();o!=="IDENT"&&Ks("Invalid type tag.");let a=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),a=this.parseCommaList(">",!0),this.consume(">"));const c=new fr(xn.fromHex(n),new ai(s),new ai(r),a);return new ko(c)}throw new Error("Invalid type tag.")}};function ey(e){if(Wu(e,["boolean","string"]),typeof e=="boolean")return e;if(e==="true")return!0;if(e==="false")return!1;throw new Error("Invalid boolean string.")}function Zo(e){if(Wu(e,["number","string"]),typeof e=="number")return e;const t=Number.parseInt(e,10);if(Number.isNaN(t))throw new Error("Invalid number string.");return t}function Yo(e){return Wu(e,["number","bigint","string"]),BigInt(e)}function jh(e,t,n){if(t instanceof vo){n.serializeBool(ey(e));return}if(t instanceof hs){n.serializeU8(Zo(e));return}if(t instanceof Cr){n.serializeU16(Zo(e));return}if(t instanceof Br){n.serializeU32(Zo(e));return}if(t instanceof xo){n.serializeU64(Yo(e));return}if(t instanceof To){n.serializeU128(Yo(e));return}if(t instanceof Ir){n.serializeU256(Yo(e));return}if(t instanceof Ao){let i;if(typeof e=="string"||e instanceof $t)i=xn.fromHex(e);else if(e instanceof xn)i=e;else throw new Error("Invalid account address.");i.serialize(n);return}if(t instanceof Or){if(t.value instanceof hs){if(e instanceof Uint8Array){n.serializeBytes(e);return}if(typeof e=="string"){n.serializeStr(e);return}}if(!Array.isArray(e))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(e.length),e.forEach(i=>jh(i,t.value,n));return}if(t instanceof ko){const{address:i,module_name:s,name:o}=t.value;if(`${$t.fromUint8Array(i.address).toShortString()}::${s.value}::${o.value}`!="0x1::string::String")throw new Error("The only supported struct arg is of type 0x1::string::String");Wu(e,["string"]),n.serializeStr(e);return}throw new Error("Unsupported arg type.")}function ES(e,t){if(t instanceof vo)return new zu(ey(e));if(t instanceof hs)return new Du(Zo(e));if(t instanceof Cr)return new Mu(Zo(e));if(t instanceof Br)return new Nu(Zo(e));if(t instanceof xo)return new pr(Yo(e));if(t instanceof To)return new Fu(Yo(e));if(t instanceof Ir)return new ju(Yo(e));if(t instanceof Ao){let n;if(typeof e=="string"||e instanceof $t)n=xn.fromHex(e);else if(e instanceof xn)n=e;else throw new Error("Invalid account address.");return new gr(n)}if(t instanceof Or&&t.value instanceof hs){if(!(e instanceof Uint8Array))throw new Error(`${e} should be an instance of Uint8Array`);return new _r(e)}throw new Error("Unknown type for TransactionArgument.")}var CS="APTOS::RawTransaction",BS="APTOS::RawTransactionWithData",wr=class{constructor(e,t){this.rawTxnBuilder=t,this.signingFunction=e}build(e,t,n){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(e,t,n)}static getSigningMessage(e){const t=ur.create();if(e instanceof Rr)t.update(CS);else if(e instanceof Uu)t.update(BS);else throw new Error("Unknown transaction type.");const n=t.digest(),i=fs(e),s=new Uint8Array(n.length+i.length);return s.set(n),s.set(i,n.length),s}},dc=class extends wr{constructor(e,t,n){super(e,n),this.publicKey=t}rawToSigned(e){const t=wr.getSigningMessage(e),n=this.signingFunction(t),i=new Ru(new Ii(this.publicKey),n);return new Ea(e,i)}sign(e){return fs(this.rawToSigned(e))}},IS=class extends wr{constructor(e,t){super(e),this.publicKey=t}rawToSigned(e){const t=wr.getSigningMessage(e),n=this.signingFunction(t),i=new $u(this.publicKey,n);return new Ea(e,i)}sign(e){return fs(this.rawToSigned(e))}},Cc=class{constructor(e,t){this.abiMap=new Map,e.forEach(n=>{const i=new Oh(n),s=Hu.deserialize(i);let o;if(s instanceof mr){const r=s,{address:a,name:c}=r.module_name;o=`${$t.fromUint8Array(a.address).toShortString()}::${c.value}::${r.name}`}else o=s.name;if(this.abiMap.has(o))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(o,s)}),this.builderConfig={maxGasAmount:BigInt(Bm),expSecFromNow:Im,...t}}static toBCSArgs(e,t){if(e.length!==t.length)throw new Error("Wrong number of args provided.");return t.map((n,i)=>{const s=new Sn;return jh(n,e[i].type_tag,s),s.getBytes()})}static toTransactionArguments(e,t){if(e.length!==t.length)throw new Error("Wrong number of args provided.");return t.map((n,i)=>ES(n,e[i].type_tag))}setSequenceNumber(e){this.builderConfig.sequenceNumber=BigInt(e)}buildTransactionPayload(e,t,n){const i=t.map(r=>new Vu(r).parseTypeTag());let s;if(!this.abiMap.has(e))throw new Error(`Cannot find function: ${e}`);const o=this.abiMap.get(e);if(o instanceof mr){const r=o,a=Cc.toBCSArgs(r.args,n);s=new qu(new to(r.module_name,new ai(r.name),i,a))}else if(o instanceof Ku){const r=o,a=Cc.toTransactionArguments(r.args,n);s=new Ba(new Pa(r.code,i,a))}else throw new Error("Unknown ABI format.");return s}build(e,t,n){const{sender:i,sequenceNumber:s,gasUnitPrice:o,maxGasAmount:r,expSecFromNow:a,chainId:c}=this.builderConfig;if(!o)throw new Error("No gasUnitPrice provided.");const u=i instanceof xn?i:xn.fromHex(i),l=BigInt(Math.floor(Date.now()/1e3)+Number(a)),d=this.buildTransactionPayload(e,t,n);if(d)return new Rr(u,BigInt(s),d,BigInt(r),BigInt(o),l,new Lu(Number(c)));throw new Error("Invalid ABI.")}},ty=class{constructor(e,t){this.aptosClient=e,this.builderConfig=t}async fetchABI(e){const n=(await this.aptosClient.getAccountModules(e)).map(s=>s.abi).flatMap(s=>s.exposed_functions.filter(o=>o.is_entry).map(o=>({fullName:`${s.address}::${s.name}::${o.name}`,...o}))),i=new Map;return n.forEach(s=>{i.set(s.fullName,s)}),i}async build(e,t,n){if(e=(A=>A.replace(/^0[xX]0*/g,"0x"))(e),e.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coins::transfer");const[o,r]=e.split("::"),a=await this.fetchABI(o);if(!a.has(e))throw new Error(`${e} doesn't exist.`);const c=a.get(e),l=c.params.filter(A=>A!=="signer"&&A!=="&signer").map((A,P)=>new Oa(`var${P}`,new Vu(A).parseTypeTag())),d=new mr(c.name,ro.fromStr(`${o}::${r}`),"",c.generic_type_params.map((A,P)=>new Ia(`${P}`)),l),{sender:h,...g}=this.builderConfig,b=h instanceof xn?$t.fromUint8Array(h.address):h,[{sequence_number:v},k,{gas_estimate:E}]=await Promise.all([g!=null&&g.sequenceNumber?Promise.resolve({sequence_number:g==null?void 0:g.sequenceNumber}):this.aptosClient.getAccount(b),g!=null&&g.chainId?Promise.resolve(g==null?void 0:g.chainId):this.aptosClient.getChainId(),g!=null&&g.gasUnitPrice?Promise.resolve({gas_estimate:g==null?void 0:g.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Cc([fs(d)],{sender:h,sequenceNumber:v,chainId:k,gasUnitPrice:BigInt(E),...g}).build(e,t,n)}};ln([YA(10*60*1e3)],ty.prototype,"fetchABI",1);var Wr=class{constructor(e,t,n=!1){if(!e)throw new Error("Node URL cannot be empty.");const i=t==null?{}:{...t};n?this.nodeUrl=e:this.nodeUrl=XA(e),i.BASE=this.nodeUrl,(t==null?void 0:t.WITH_CREDENTIALS)===!1?i.WITH_CREDENTIALS=!1:i.WITH_CREDENTIALS=!0,this.client=new Jm(i)}async getAccount(e){return this.client.accounts.getAccount($t.ensure(e).hex())}async getAccountTransactions(e,t){var n;return this.client.transactions.getAccountTransactions($t.ensure(e).hex(),(n=t==null?void 0:t.start)==null?void 0:n.toString(),t==null?void 0:t.limit)}async getAccountModules(e,t){const n=this.client.accounts.getAccountModules.bind({httpRequest:this.client.request});return await a0(n,e,1e3,t)}async getAccountModule(e,t,n){var i;return this.client.accounts.getAccountModule($t.ensure(e).hex(),t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async getAccountResources(e,t){const n=this.client.accounts.getAccountResources.bind({httpRequest:this.client.request});return await a0(n,e,9999,t)}async getAccountResource(e,t,n){var i;return this.client.accounts.getAccountResource($t.ensure(e).hex(),t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}static generateBCSTransaction(e,t){return new dc(i=>{const s=e.signBuffer(i);return new F.Ed25519Signature(s.toUint8Array())},e.pubKey().toUint8Array()).sign(t)}static generateBCSSimulation(e,t){return new dc(i=>{const s=new Uint8Array(64);return new F.Ed25519Signature(s)},e.pubKey().toUint8Array()).sign(t)}async generateTransaction(e,t,n){const i={sender:e};if(n!=null&&n.sequence_number&&(i.sequenceNumber=n.sequence_number),n!=null&&n.gas_unit_price&&(i.gasUnitPrice=n.gas_unit_price),n!=null&&n.max_gas_amount&&(i.maxGasAmount=n.max_gas_amount),n!=null&&n.expiration_timestamp_secs){const o=Number.parseInt(n.expiration_timestamp_secs,10);i.expSecFromNow=o-Math.floor(Date.now()/1e3)}return new ty(this,i).build(t.function,t.type_arguments,t.arguments)}async signTransaction(e,t){return Promise.resolve(Wr.generateBCSTransaction(e,t))}async getEventsByCreationNumber(e,t,n){var i;return this.client.events.getEventsByCreationNumber($t.ensure(e).hex(),t.toString(),(i=n==null?void 0:n.start)==null?void 0:i.toString(),n==null?void 0:n.limit)}async getEventsByEventHandle(e,t,n,i){var s;return this.client.events.getEventsByEventHandle($t.ensure(e).hex(),t,n,(s=i==null?void 0:i.start)==null?void 0:s.toString(),i==null?void 0:i.limit)}async submitTransaction(e){return this.submitSignedBCSTransaction(e)}async simulateTransaction(e,t,n){let i;return e instanceof aa?i=Wr.generateBCSSimulation(e,t):e instanceof ka?i=new IS(()=>{const{threshold:o}=e,r=[],a=[];for(let u=0;u<o;u+=1)r.push(u),a.push(new F.Ed25519Signature(new Uint8Array(64)));const c=F.MultiEd25519Signature.createBitmap(r);return new F.MultiEd25519Signature(a,c)},e).sign(t):i=new dc(()=>{const o=new Uint8Array(64);return new F.Ed25519Signature(o)},e.toBytes()).sign(t),this.submitBCSSimulation(i,n)}async submitSignedBCSTransaction(e){return this.client.request.request({url:"/transactions",method:"POST",body:e,mediaType:"application/x.aptos.signed_transaction+bcs"})}async submitBCSSimulation(e,t){var n,i,s;const o={estimate_gas_unit_price:(n=t==null?void 0:t.estimateGasUnitPrice)!=null?n:!1,estimate_max_gas_amount:(i=t==null?void 0:t.estimateMaxGasAmount)!=null?i:!1,estimate_prioritized_gas_unit_price:(s=t==null?void 0:t.estimatePrioritizedGasUnitPrice)!=null?s:!1};return this.client.request.request({url:"/transactions/simulate",query:o,method:"POST",body:e,mediaType:"application/x.aptos.signed_transaction+bcs"})}async getTransactions(e){var t;return this.client.transactions.getTransactions((t=e==null?void 0:e.start)==null?void 0:t.toString(),e==null?void 0:e.limit)}async getTransactionByHash(e){return this.client.transactions.getTransactionByHash(e)}async getTransactionByVersion(e){return this.client.transactions.getTransactionByVersion(e.toString())}async transactionPending(e){try{return(await this.client.transactions.getTransactionByHash(e)).type==="pending_transaction"}catch(t){if((t==null?void 0:t.status)===404)return!0;throw t}}async waitForTransactionWithResult(e,t){var n,i;const s=(n=t==null?void 0:t.timeoutSecs)!=null?n:JA,o=(i=t==null?void 0:t.checkSuccess)!=null?i:!1;let r=!0,a=0,c;for(;r&&!(a>=s);){try{if(c=await this.client.transactions.getTransactionByHash(e),r=c.type==="pending_transaction",!r)break}catch(u){const l=u instanceof ca,d=l&&u.status!==404&&u.status>=400&&u.status<500;if(!l||d)throw u}await VA(1e3),a+=1}if(c===void 0)throw new Error(`Waiting for transaction ${e} failed`);if(r)throw new RS(`Waiting for transaction ${e} timed out after ${s} seconds`,c);if(!o)return c;if(!(c!=null&&c.success))throw new $S(`Transaction ${e} committed to the blockchain but execution failed`,c);return c}async waitForTransaction(e,t){await this.waitForTransactionWithResult(e,t)}async getLedgerInfo(){return this.client.general.getLedgerInfo()}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(e,t,n){var i;return await this.client.tables.getTableItem(e,t,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async generateRawTransaction(e,t,n){const[{sequence_number:i},s,{gas_estimate:o}]=await Promise.all([this.getAccount(e),this.getChainId(),n!=null&&n.gasUnitPrice?Promise.resolve({gas_estimate:n.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:r,gasUnitPrice:a,expireTimestamp:c}={maxGasAmount:BigInt(Bm),gasUnitPrice:BigInt(o),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+Im),...n};return new F.RawTransaction(F.AccountAddress.fromHex(e),BigInt(i),t,r,a,c,new F.ChainId(s))}async generateSignSubmitTransaction(e,t,n){const i=await this.generateRawTransaction(e.address(),t,n),s=Wr.generateBCSTransaction(e,i);return(await this.submitSignedBCSTransaction(s)).hash}async publishPackage(e,t,n,i){const s=new Sn;xi(n,s);const o=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::code","publish_package_txn",[],[Lo(t),s.getBytes()]));return this.generateSignSubmitTransaction(e,o,i)}async generateSignSubmitWaitForTransaction(e,t,n){const i=await this.generateSignSubmitTransaction(e,t,n);return this.waitForTransactionWithResult(i,n)}async estimateGasPrice(){return this.client.transactions.estimateGasPrice()}async estimateMaxGasAmount(e){const t=`0x1::coin::CoinStore<${ZA}>`,[{gas_estimate:n},i]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(e)]),s=i.find(r=>r.type===t);return BigInt(s.data.coin.value)/BigInt(n)}async rotateAuthKeyEd25519(e,t,n){const{sequence_number:i,authentication_key:s}=await this.getAccount(e.address()),o=new aa(t),r=new F.RotationProofChallenge(F.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(i),F.AccountAddress.fromHex(e.address()),new F.AccountAddress(new $t(s).toUint8Array()),o.pubKey().toUint8Array()),a=$t.fromUint8Array(fs(r)),c=e.signHexString(a),u=o.signHexString(a),l=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[kd(0),Lo(e.pubKey().toUint8Array()),kd(0),Lo(o.pubKey().toUint8Array()),Lo(c.toUint8Array()),Lo(u.toUint8Array())])),d=await this.generateRawTransaction(e.address(),l,n),h=Wr.generateBCSTransaction(e,d);return this.submitSignedBCSTransaction(h)}async lookupOriginalAddress(e){const t=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:n}}=t.data,i=await this.getTableItem(n,{key_type:"address",value_type:"address",key:$t.ensure(e).hex()});return new $t(i)}async getBlockByHeight(e,t){return this.client.blocks.getBlockByHeight(e,t)}async getBlockByVersion(e,t){return this.client.blocks.getBlockByVersion(e,t)}async view(e,t){return this.client.view.view(e,t)}clearCache(e){QA(e)}},cn=Wr;ln([Rn],cn.prototype,"getAccount",1);ln([Rn],cn.prototype,"getAccountTransactions",1);ln([Rn],cn.prototype,"getAccountModules",1);ln([Rn],cn.prototype,"getAccountModule",1);ln([Rn],cn.prototype,"getAccountResources",1);ln([Rn],cn.prototype,"getAccountResource",1);ln([Rn],cn.prototype,"getEventsByCreationNumber",1);ln([Rn],cn.prototype,"getEventsByEventHandle",1);ln([Rn],cn.prototype,"submitSignedBCSTransaction",1);ln([Rn],cn.prototype,"submitBCSSimulation",1);ln([Rn],cn.prototype,"getTransactions",1);ln([Rn],cn.prototype,"getTransactionByHash",1);ln([Rn],cn.prototype,"getTransactionByVersion",1);ln([Rn],cn.prototype,"getLedgerInfo",1);ln([Iu()],cn.prototype,"getChainId",1);ln([Rn],cn.prototype,"getTableItem",1);ln([Rn,Iu({ttlMs:5*60*1e3,tags:["gas_estimates"]})],cn.prototype,"estimateGasPrice",1);ln([Rn],cn.prototype,"estimateMaxGasAmount",1);ln([Rn],cn.prototype,"getBlockByHeight",1);ln([Rn],cn.prototype,"getBlockByVersion",1);ln([Rn],cn.prototype,"view",1);var OS=class extends Error{constructor(e,t,n,i){super(t),this.status=e,this.message=t,this.errorCode=n,this.vmErrorCode=i}},RS=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},$S=class extends Error{constructor(e,t){super(e),this.transaction=t}};function Rn(e,t,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof ca?new OS(c.status,JSON.stringify({message:c.message,...c.body}),(r=c.body)==null?void 0:r.error_code,(a=c.body)==null?void 0:a.vm_error_code):c}},n}var ny=class{constructor(e,t,n=!1){let i=null,s=null;if(typeof e=="object"&&US(e)?(i=e.fullnodeUrl,s=e.indexerUrl):(i=tk[e],s=ek[e]),!i||!s)throw new Error("network is not provided");this.aptosClient=new cn(i,t,n),this.indexerClient=new qm(s)}};function iy(e,t,n){Object.getOwnPropertyNames(t.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(t.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(e.prototype,i,s))})}iy(ny,cn,"aptosClient");iy(ny,qm,"indexerClient");function US(e){return e.fullnodeUrl!==void 0&&typeof e.fullnodeUrl=="string"&&e.indexerUrl!==void 0&&typeof e.indexerUrl=="string"}var qS="a11ceb0b0500000006010004020408030c0a05161d073339086c400000010100020700010307000104030100010504020007060c0508000800030503010801000405080008000304060c0801050306737472696e6705746f6b656e06537472696e6707546f6b656e4964136372656174655f746f6b656e5f69645f726177087472616e73666572000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000010c0b010b020b030b0411000c070b000b070b050b06110102",LS=["01186372656174655F636F6C6C656374696F6E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E3020637265617465206120656D70747920746F6B656E20636F6C6C656374696F6E207769746820706172616D65746572730005046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700076D6178696D756D020E6D75746174655F73657474696E670600","01136372656174655F746F6B656E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E1D2063726561746520746F6B656E20776974682072617720696E70757473000D0A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000762616C616E636502076D6178696D756D020375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E670015726F79616C74795F70617965655F61646472657373041A726F79616C74795F706F696E74735F64656E6F6D696E61746F720218726F79616C74795F706F696E74735F6E756D657261746F72020E6D75746174655F73657474696E6706000D70726F70657274795F6B6579730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000F70726F70657274795F76616C7565730606010E70726F70657274795F74797065730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700","01166469726563745f7472616e736665725f736372697074000000000000000000000000000000000000000000000000000000000000000305746f6b656e0000051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010C6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000006087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E0206616D6F756E7402","010C636C61696D5F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E73666572730000050673656E646572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","011363616E63656C5F6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000005087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","01176d75746174655f746f6b656e5f70726f70657274696573000000000000000000000000000000000000000000000000000000000000000305746f6b656eba02206d75746174652074686520746f6b656e2070726f706572747920616e64207361766520746865206e65772070726f706572747920696e20546f6b656e53746f72650a2069662074686520746f6b656e2070726f70657274795f76657273696f6e20697320302c2077652077696c6c206372656174652061206e65772070726f70657274795f76657273696f6e2070657220746f6b656e20746f2067656e65726174652061206e657720746f6b656e5f69642070657220746f6b656e0a2069662074686520746f6b656e2070726f70657274795f76657273696f6e206973206e6f7420302c2077652077696c6c206a75737420757064617465207468652070726f70657274794d617020616e642075736520746865206578697374696e6720746f6b656e5f6964202870726f70657274795f76657273696f6e2900090b746f6b656e5f6f776e6572040763726561746f72040f636f6c6c656374696f6e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000a746f6b656e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e670016746f6b656e5f70726f70657274795f76657273696f6e0206616d6f756e7402046b6579730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000676616c7565730606010574797065730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700","01166f70745f696e5f6469726563745f7472616e73666572000000000000000000000000000000000000000000000000000000000000000305746f6b656e000001066f70745f696e00","01046275726e000000000000000000000000000000000000000000000000000000000000000305746f6b656e20204275726e206120746f6b656e2062792074686520746f6b656e206f776e657200051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010f6275726e5f62795f63726561746f72000000000000000000000000000000000000000000000000000000000000000305746f6b656e6a204275726e206120746f6b656e2062792063726561746f72207768656e2074686520746f6b656e2773204255524e41424c455f42595f43524541544f5220697320747275650a2054686520746f6b656e206973206f776e65642061742061646472657373206f776e65720005056f776e6572040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402"],sy=class{constructor(e,t){this.type=e,this.value=t}},zh=class{constructor(){this.data={}}setProperty(e,t){this.data[e]=t}};function oy(e){let t;return e==="string"||e==="String"?t=new ko(kS):t=new Vu(e).parseTypeTag(),t}function DS(e,t){if(e.length!==t.length)throw new Error("Length of property values and types not match");const n=new Array;return t.forEach((i,s)=>{try{const o=oy(i),r=new Sn;jh(e[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(e[s]))}}),n}function ry(e){const t=e.map.data,n=new zh;return t.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=oy(r),c=MS(a,o),u=new sy(r,c);n.setProperty(s,u)}),n}function MS(e,t){const n=new Oh(new $t(t).toUint8Array());let i="";return e instanceof hs?i=n.deserializeU8().toString():e instanceof xo?i=n.deserializeU64().toString():e instanceof To?i=n.deserializeU128().toString():e instanceof vo?i=n.deserializeBool()?"true":"false":e instanceof Ao?i=$t.fromUint8Array(n.deserializeFixedBytes(32)).hex():e instanceof ko&&e.isStringTypeTag()?i=n.deserializeStr():i=t,i}var NS={};Bu(NS,{PropertyMap:()=>zh,PropertyValue:()=>sy,Token:()=>cy,TokenData:()=>ay});var ay=class{constructor(e,t,n,i,s,o,r,a){this.collection=e,this.description=t,this.name=n,this.maximum=i,this.supply=s,this.uri=o,this.default_properties=ry(r),this.mutability_config=a}},cy=class{constructor(e,t,n){this.id=e,this.amount=t,this.token_properties=ry(n)}},FS=class{constructor(e){this.aptosClient=e,this.transactionBuilder=new Cc(LS.map(t=>new $t(t).toUint8Array()))}async createCollection(e,t,n,i,s=Zr,o){const r=this.transactionBuilder.buildTransactionPayload("0x3::token::create_collection_script",[],[t,n,i,s,[!1,!1,!1]]);return this.aptosClient.generateSignSubmitTransaction(e,r,o)}async createToken(e,t,n,i,s,o,r=Zr,a=e.address(),c=0,u=0,l=[],d=[],h=[],g){const b=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[t,n,i,s,r,o,a,c,u,[!1,!1,!1,!1,!1],l,DS(d,h),h]);return this.aptosClient.generateSignSubmitTransaction(e,b,g)}async createTokenWithMutabilityConfig(e,t,n,i,s,o,r=Zr,a=e.address(),c=0,u=0,l=[],d=[],h=[],g=[!1,!1,!1,!1,!1],b){const v=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[t,n,i,s,r,o,a,c,u,g,l,d,h]);return this.aptosClient.generateSignSubmitTransaction(e,v,b)}async offerToken(e,t,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::offer_script",[],[t,n,i,s,r,o]);return this.aptosClient.generateSignSubmitTransaction(e,c,a)}async claimToken(e,t,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::claim_script",[],[t,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async cancelTokenOffer(e,t,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::cancel_offer_script",[],[t,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async directTransferToken(e,t,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token::direct_transfer_script",[],[n,i,s,r,o]),u=await this.aptosClient.generateRawTransaction(e.address(),c,a),l=new F.MultiAgentRawTransaction(u,[F.AccountAddress.fromHex(t.address())]),d=new F.Ed25519Signature(e.signBuffer(wr.getSigningMessage(l)).toUint8Array()),h=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(e.signingKey.publicKey),d),g=new F.Ed25519Signature(t.signBuffer(wr.getSigningMessage(l)).toUint8Array()),b=new F.AccountAuthenticatorEd25519(new F.Ed25519PublicKey(t.signingKey.publicKey),g),v=new F.TransactionAuthenticatorMultiAgent(h,[F.AccountAddress.fromHex(t.address())],[b]),k=fs(new F.SignedTransaction(u,v));return(await this.aptosClient.submitSignedBCSTransaction(k)).hash}async optInTokenTransfer(e,t,n){const i=this.transactionBuilder.buildTransactionPayload("0x3::token::opt_in_direct_transfer",[],[t]);return this.aptosClient.generateSignSubmitTransaction(e,i,n)}async transferWithOptIn(e,t,n,i,s,o,r,a){const c=new Ba(new Pa(new $t(qS).toUint8Array(),[],[new gr(F.AccountAddress.fromHex(t)),new _r(new TextEncoder().encode(n)),new _r(new TextEncoder().encode(i)),new pr(BigInt(s)),new gr(F.AccountAddress.fromHex(o)),new pr(BigInt(r))]));return this.aptosClient.generateSignSubmitTransaction(e,c,a)}async burnByCreator(e,t,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn_by_creator",[],[t,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async burnByOwner(e,t,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn",[],[t,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(e,a,r)}async mutateTokenProperties(e,t,n,i,s,o,r,a,c,u,l){const d=this.transactionBuilder.buildTransactionPayload("0x3::token::mutate_token_properties",[],[t,n,i,s,o,r,a,c,u]);return this.aptosClient.generateSignSubmitTransaction(e,d,l)}async getCollectionData(e,t){const i=(await this.aptosClient.getAccountResources(e)).find(a=>a.type==="0x3::token::Collections"),{handle:s}=i.data.collection_data,o={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:t};return await this.aptosClient.getTableItem(s,o)}async getTokenData(e,t,n){const i=e instanceof $t?e.hex():e,s=await this.aptosClient.getAccountResource(i,"0x3::token::Collections"),{handle:o}=s.data.token_data,a={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:i,collection:t,name:n}},c=await this.aptosClient.getTableItem(o,a);return new ay(c.collection,c.description,c.name,c.maximum,c.supply,c.uri,c.default_properties,c.mutability_config)}async getToken(e,t,n,i="0"){const s={creator:e instanceof $t?e.hex():e,collection:t,name:n};return this.getTokenForAccount(e,{token_data_id:s,property_version:i})}async getTokenForAccount(e,t){const n=await this.aptosClient.getAccountResource(e instanceof $t?e.hex():e,"0x3::token::TokenStore"),{handle:i}=n.data.tokens,s={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:t};try{const o=await this.aptosClient.getTableItem(i,s);return new cy(o.id,o.amount,o.token_properties)}catch(o){return(o==null?void 0:o.status)===404?{id:t,amount:"0",token_properties:new zh}:o}}},y={},jS={get exports(){return y},set exports(e){y=e}};(function(e){(function(t,n){function i(x,f){if(!x)throw new Error(f||"Assertion failed")}function s(x,f){x.super_=f;var m=function(){};m.prototype=f.prototype,x.prototype=new m,x.prototype.constructor=x}function o(x,f,m){if(o.isBN(x))return x;this.negative=0,this.words=null,this.length=0,this.red=null,x!==null&&((f==="le"||f==="be")&&(m=f,f=10),this._init(x||0,f||10,m||"be"))}typeof t=="object"?t.exports=o:n.BN=o,o.BN=o,o.wordSize=26;var r;try{typeof window<"u"&&typeof window.Buffer<"u"?r=window.Buffer:r=np.Buffer}catch{}o.isBN=function(f){return f instanceof o?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===o.wordSize&&Array.isArray(f.words)},o.max=function(f,m){return f.cmp(m)>0?f:m},o.min=function(f,m){return f.cmp(m)<0?f:m},o.prototype._init=function(f,m,T){if(typeof f=="number")return this._initNumber(f,m,T);if(typeof f=="object")return this._initArray(f,m,T);m==="hex"&&(m=16),i(m===(m|0)&&m>=2&&m<=36),f=f.toString().replace(/\s+/g,"");var $=0;f[0]==="-"&&($++,this.negative=1),$<f.length&&(m===16?this._parseHex(f,$,T):(this._parseBase(f,m,$),T==="le"&&this._initArray(this.toArray(),m,T)))},o.prototype._initNumber=function(f,m,T){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(i(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),T==="le"&&this._initArray(this.toArray(),m,T)},o.prototype._initArray=function(f,m,T){if(i(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var $=0;$<this.length;$++)this.words[$]=0;var M,z,J=0;if(T==="be")for($=f.length-1,M=0;$>=0;$-=3)z=f[$]|f[$-1]<<8|f[$-2]<<16,this.words[M]|=z<<J&67108863,this.words[M+1]=z>>>26-J&67108863,J+=24,J>=26&&(J-=26,M++);else if(T==="le")for($=0,M=0;$<f.length;$+=3)z=f[$]|f[$+1]<<8|f[$+2]<<16,this.words[M]|=z<<J&67108863,this.words[M+1]=z>>>26-J&67108863,J+=24,J>=26&&(J-=26,M++);return this._strip()};function a(x,f){var m=x.charCodeAt(f);if(m>=48&&m<=57)return m-48;if(m>=65&&m<=70)return m-55;if(m>=97&&m<=102)return m-87;i(!1,"Invalid character in "+x)}function c(x,f,m){var T=a(x,m);return m-1>=f&&(T|=a(x,m-1)<<4),T}o.prototype._parseHex=function(f,m,T){this.length=Math.ceil((f.length-m)/6),this.words=new Array(this.length);for(var $=0;$<this.length;$++)this.words[$]=0;var M=0,z=0,J;if(T==="be")for($=f.length-1;$>=m;$-=2)J=c(f,m,$)<<M,this.words[z]|=J&67108863,M>=18?(M-=18,z+=1,this.words[z]|=J>>>26):M+=8;else{var O=f.length-m;for($=O%2===0?m+1:m;$<f.length;$+=2)J=c(f,m,$)<<M,this.words[z]|=J&67108863,M>=18?(M-=18,z+=1,this.words[z]|=J>>>26):M+=8}this._strip()};function u(x,f,m,T){for(var $=0,M=0,z=Math.min(x.length,m),J=f;J<z;J++){var O=x.charCodeAt(J)-48;$*=T,O>=49?M=O-49+10:O>=17?M=O-17+10:M=O,i(O>=0&&M<T,"Invalid character"),$+=M}return $}o.prototype._parseBase=function(f,m,T){this.words=[0],this.length=1;for(var $=0,M=1;M<=67108863;M*=m)$++;$--,M=M/m|0;for(var z=f.length-T,J=z%$,O=Math.min(z,z-J)+T,_=0,q=T;q<O;q+=$)_=u(f,q,q+$,m),this.imuln(M),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_);if(J!==0){var ve=1;for(_=u(f,q,f.length,m),q=0;q<J;q++)ve*=m;this.imuln(ve),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_)}this._strip()},o.prototype.copy=function(f){f.words=new Array(this.length);for(var m=0;m<this.length;m++)f.words[m]=this.words[m];f.length=this.length,f.negative=this.negative,f.red=this.red};function l(x,f){x.words=f.words,x.length=f.length,x.negative=f.negative,x.red=f.red}if(o.prototype._move=function(f){l(f,this)},o.prototype.clone=function(){var f=new o(null);return this.copy(f),f},o.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},o.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{o.prototype.inspect=d}else o.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(f,m){f=f||10,m=m|0||1;var T;if(f===16||f==="hex"){T="";for(var $=0,M=0,z=0;z<this.length;z++){var J=this.words[z],O=((J<<$|M)&16777215).toString(16);M=J>>>24-$&16777215,$+=2,$>=26&&($-=26,z--),M!==0||z!==this.length-1?T=h[6-O.length]+O+T:T=O+T}for(M!==0&&(T=M.toString(16)+T);T.length%m!==0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}if(f===(f|0)&&f>=2&&f<=36){var _=g[f],q=b[f];T="";var ve=this.clone();for(ve.negative=0;!ve.isZero();){var ue=ve.modrn(q).toString(f);ve=ve.idivn(q),ve.isZero()?T=ue+T:T=h[_-ue.length]+ue+T}for(this.isZero()&&(T="0"+T);T.length%m!==0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}i(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},o.prototype.toJSON=function(){return this.toString(16,2)},r&&(o.prototype.toBuffer=function(f,m){return this.toArrayLike(r,f,m)}),o.prototype.toArray=function(f,m){return this.toArrayLike(Array,f,m)};var v=function(f,m){return f.allocUnsafe?f.allocUnsafe(m):new f(m)};o.prototype.toArrayLike=function(f,m,T){this._strip();var $=this.byteLength(),M=T||Math.max(1,$);i($<=M,"byte array longer than desired length"),i(M>0,"Requested array length <= 0");var z=v(f,M),J=m==="le"?"LE":"BE";return this["_toArrayLike"+J](z,$),z},o.prototype._toArrayLikeLE=function(f,m){for(var T=0,$=0,M=0,z=0;M<this.length;M++){var J=this.words[M]<<z|$;f[T++]=J&255,T<f.length&&(f[T++]=J>>8&255),T<f.length&&(f[T++]=J>>16&255),z===6?(T<f.length&&(f[T++]=J>>24&255),$=0,z=0):($=J>>>24,z+=2)}if(T<f.length)for(f[T++]=$;T<f.length;)f[T++]=0},o.prototype._toArrayLikeBE=function(f,m){for(var T=f.length-1,$=0,M=0,z=0;M<this.length;M++){var J=this.words[M]<<z|$;f[T--]=J&255,T>=0&&(f[T--]=J>>8&255),T>=0&&(f[T--]=J>>16&255),z===6?(T>=0&&(f[T--]=J>>24&255),$=0,z=0):($=J>>>24,z+=2)}if(T>=0)for(f[T--]=$;T>=0;)f[T--]=0},Math.clz32?o.prototype._countBits=function(f){return 32-Math.clz32(f)}:o.prototype._countBits=function(f){var m=f,T=0;return m>=4096&&(T+=13,m>>>=13),m>=64&&(T+=7,m>>>=7),m>=8&&(T+=4,m>>>=4),m>=2&&(T+=2,m>>>=2),T+m},o.prototype._zeroBits=function(f){if(f===0)return 26;var m=f,T=0;return m&8191||(T+=13,m>>>=13),m&127||(T+=7,m>>>=7),m&15||(T+=4,m>>>=4),m&3||(T+=2,m>>>=2),m&1||T++,T},o.prototype.bitLength=function(){var f=this.words[this.length-1],m=this._countBits(f);return(this.length-1)*26+m};function k(x){for(var f=new Array(x.bitLength()),m=0;m<f.length;m++){var T=m/26|0,$=m%26;f[m]=x.words[T]>>>$&1}return f}o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,m=0;m<this.length;m++){var T=this._zeroBits(this.words[m]);if(f+=T,T!==26)break}return f},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},o.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return this.negative!==0},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var m=0;m<f.length;m++)this.words[m]=this.words[m]|f.words[m];return this._strip()},o.prototype.ior=function(f){return i((this.negative|f.negative)===0),this.iuor(f)},o.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},o.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},o.prototype.iuand=function(f){var m;this.length>f.length?m=f:m=this;for(var T=0;T<m.length;T++)this.words[T]=this.words[T]&f.words[T];return this.length=m.length,this._strip()},o.prototype.iand=function(f){return i((this.negative|f.negative)===0),this.iuand(f)},o.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},o.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},o.prototype.iuxor=function(f){var m,T;this.length>f.length?(m=this,T=f):(m=f,T=this);for(var $=0;$<T.length;$++)this.words[$]=m.words[$]^T.words[$];if(this!==m)for(;$<m.length;$++)this.words[$]=m.words[$];return this.length=m.length,this._strip()},o.prototype.ixor=function(f){return i((this.negative|f.negative)===0),this.iuxor(f)},o.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},o.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},o.prototype.inotn=function(f){i(typeof f=="number"&&f>=0);var m=Math.ceil(f/26)|0,T=f%26;this._expand(m),T>0&&m--;for(var $=0;$<m;$++)this.words[$]=~this.words[$]&67108863;return T>0&&(this.words[$]=~this.words[$]&67108863>>26-T),this._strip()},o.prototype.notn=function(f){return this.clone().inotn(f)},o.prototype.setn=function(f,m){i(typeof f=="number"&&f>=0);var T=f/26|0,$=f%26;return this._expand(T+1),m?this.words[T]=this.words[T]|1<<$:this.words[T]=this.words[T]&~(1<<$),this._strip()},o.prototype.iadd=function(f){var m;if(this.negative!==0&&f.negative===0)return this.negative=0,m=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,m=this.isub(f),f.negative=1,m._normSign();var T,$;this.length>f.length?(T=this,$=f):(T=f,$=this);for(var M=0,z=0;z<$.length;z++)m=(T.words[z]|0)+($.words[z]|0)+M,this.words[z]=m&67108863,M=m>>>26;for(;M!==0&&z<T.length;z++)m=(T.words[z]|0)+M,this.words[z]=m&67108863,M=m>>>26;if(this.length=T.length,M!==0)this.words[this.length]=M,this.length++;else if(T!==this)for(;z<T.length;z++)this.words[z]=T.words[z];return this},o.prototype.add=function(f){var m;return f.negative!==0&&this.negative===0?(f.negative=0,m=this.sub(f),f.negative^=1,m):f.negative===0&&this.negative!==0?(this.negative=0,m=f.sub(this),this.negative=1,m):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},o.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var m=this.iadd(f);return f.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var T=this.cmp(f);if(T===0)return this.negative=0,this.length=1,this.words[0]=0,this;var $,M;T>0?($=this,M=f):($=f,M=this);for(var z=0,J=0;J<M.length;J++)m=($.words[J]|0)-(M.words[J]|0)+z,z=m>>26,this.words[J]=m&67108863;for(;z!==0&&J<$.length;J++)m=($.words[J]|0)+z,z=m>>26,this.words[J]=m&67108863;if(z===0&&J<$.length&&$!==this)for(;J<$.length;J++)this.words[J]=$.words[J];return this.length=Math.max(this.length,J),$!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(f){return this.clone().isub(f)};function E(x,f,m){m.negative=f.negative^x.negative;var T=x.length+f.length|0;m.length=T,T=T-1|0;var $=x.words[0]|0,M=f.words[0]|0,z=$*M,J=z&67108863,O=z/67108864|0;m.words[0]=J;for(var _=1;_<T;_++){for(var q=O>>>26,ve=O&67108863,ue=Math.min(_,f.length-1),xe=Math.max(0,_-x.length+1);xe<=ue;xe++){var lt=_-xe|0;$=x.words[lt]|0,M=f.words[xe]|0,z=$*M+ve,q+=z/67108864|0,ve=z&67108863}m.words[_]=ve|0,O=q|0}return O!==0?m.words[_]=O|0:m.length--,m._strip()}var N=function(f,m,T){var $=f.words,M=m.words,z=T.words,J=0,O,_,q,ve=$[0]|0,ue=ve&8191,xe=ve>>>13,lt=$[1]|0,Qe=lt&8191,yt=lt>>>13,ot=$[2]|0,rt=ot&8191,vt=ot>>>13,Pn=$[3]|0,ne=Pn&8191,de=Pn>>>13,Oe=$[4]|0,ke=Oe&8191,Le=Oe>>>13,tt=$[5]|0,Ke=tt&8191,et=tt>>>13,Xt=$[6]|0,ut=Xt&8191,nt=Xt>>>13,Kt=$[7]|0,At=Kt&8191,Pt=Kt>>>13,hn=$[8]|0,Ut=hn&8191,sn=hn>>>13,D=$[9]|0,K=D&8191,X=D>>>13,te=M[0]|0,oe=te&8191,se=te>>>13,we=M[1]|0,Be=we&8191,Ae=we>>>13,fe=M[2]|0,pe=fe&8191,Te=fe>>>13,it=M[3]|0,Re=it&8191,Ne=it>>>13,qt=M[4]|0,Ye=qt&8191,Et=qt>>>13,Lt=M[5]|0,Ct=Lt&8191,wt=Lt>>>13,Cn=M[6]|0,w=Cn&8191,S=Cn>>>13,C=M[7]|0,p=C&8191,I=C>>>13,Z=M[8]|0,Y=Z&8191,le=Z>>>13,Pe=M[9]|0,Ue=Pe&8191,Ee=Pe>>>13;T.negative=f.negative^m.negative,T.length=19,O=Math.imul(ue,oe),_=Math.imul(ue,se),_=_+Math.imul(xe,oe)|0,q=Math.imul(xe,se);var Jt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,O=Math.imul(Qe,oe),_=Math.imul(Qe,se),_=_+Math.imul(yt,oe)|0,q=Math.imul(yt,se),O=O+Math.imul(ue,Be)|0,_=_+Math.imul(ue,Ae)|0,_=_+Math.imul(xe,Be)|0,q=q+Math.imul(xe,Ae)|0;var He=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(He>>>26)|0,He&=67108863,O=Math.imul(rt,oe),_=Math.imul(rt,se),_=_+Math.imul(vt,oe)|0,q=Math.imul(vt,se),O=O+Math.imul(Qe,Be)|0,_=_+Math.imul(Qe,Ae)|0,_=_+Math.imul(yt,Be)|0,q=q+Math.imul(yt,Ae)|0,O=O+Math.imul(ue,pe)|0,_=_+Math.imul(ue,Te)|0,_=_+Math.imul(xe,pe)|0,q=q+Math.imul(xe,Te)|0;var ht=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(ht>>>26)|0,ht&=67108863,O=Math.imul(ne,oe),_=Math.imul(ne,se),_=_+Math.imul(de,oe)|0,q=Math.imul(de,se),O=O+Math.imul(rt,Be)|0,_=_+Math.imul(rt,Ae)|0,_=_+Math.imul(vt,Be)|0,q=q+Math.imul(vt,Ae)|0,O=O+Math.imul(Qe,pe)|0,_=_+Math.imul(Qe,Te)|0,_=_+Math.imul(yt,pe)|0,q=q+Math.imul(yt,Te)|0,O=O+Math.imul(ue,Re)|0,_=_+Math.imul(ue,Ne)|0,_=_+Math.imul(xe,Re)|0,q=q+Math.imul(xe,Ne)|0;var pt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(pt>>>26)|0,pt&=67108863,O=Math.imul(ke,oe),_=Math.imul(ke,se),_=_+Math.imul(Le,oe)|0,q=Math.imul(Le,se),O=O+Math.imul(ne,Be)|0,_=_+Math.imul(ne,Ae)|0,_=_+Math.imul(de,Be)|0,q=q+Math.imul(de,Ae)|0,O=O+Math.imul(rt,pe)|0,_=_+Math.imul(rt,Te)|0,_=_+Math.imul(vt,pe)|0,q=q+Math.imul(vt,Te)|0,O=O+Math.imul(Qe,Re)|0,_=_+Math.imul(Qe,Ne)|0,_=_+Math.imul(yt,Re)|0,q=q+Math.imul(yt,Ne)|0,O=O+Math.imul(ue,Ye)|0,_=_+Math.imul(ue,Et)|0,_=_+Math.imul(xe,Ye)|0,q=q+Math.imul(xe,Et)|0;var kt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(kt>>>26)|0,kt&=67108863,O=Math.imul(Ke,oe),_=Math.imul(Ke,se),_=_+Math.imul(et,oe)|0,q=Math.imul(et,se),O=O+Math.imul(ke,Be)|0,_=_+Math.imul(ke,Ae)|0,_=_+Math.imul(Le,Be)|0,q=q+Math.imul(Le,Ae)|0,O=O+Math.imul(ne,pe)|0,_=_+Math.imul(ne,Te)|0,_=_+Math.imul(de,pe)|0,q=q+Math.imul(de,Te)|0,O=O+Math.imul(rt,Re)|0,_=_+Math.imul(rt,Ne)|0,_=_+Math.imul(vt,Re)|0,q=q+Math.imul(vt,Ne)|0,O=O+Math.imul(Qe,Ye)|0,_=_+Math.imul(Qe,Et)|0,_=_+Math.imul(yt,Ye)|0,q=q+Math.imul(yt,Et)|0,O=O+Math.imul(ue,Ct)|0,_=_+Math.imul(ue,wt)|0,_=_+Math.imul(xe,Ct)|0,q=q+Math.imul(xe,wt)|0;var xt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(xt>>>26)|0,xt&=67108863,O=Math.imul(ut,oe),_=Math.imul(ut,se),_=_+Math.imul(nt,oe)|0,q=Math.imul(nt,se),O=O+Math.imul(Ke,Be)|0,_=_+Math.imul(Ke,Ae)|0,_=_+Math.imul(et,Be)|0,q=q+Math.imul(et,Ae)|0,O=O+Math.imul(ke,pe)|0,_=_+Math.imul(ke,Te)|0,_=_+Math.imul(Le,pe)|0,q=q+Math.imul(Le,Te)|0,O=O+Math.imul(ne,Re)|0,_=_+Math.imul(ne,Ne)|0,_=_+Math.imul(de,Re)|0,q=q+Math.imul(de,Ne)|0,O=O+Math.imul(rt,Ye)|0,_=_+Math.imul(rt,Et)|0,_=_+Math.imul(vt,Ye)|0,q=q+Math.imul(vt,Et)|0,O=O+Math.imul(Qe,Ct)|0,_=_+Math.imul(Qe,wt)|0,_=_+Math.imul(yt,Ct)|0,q=q+Math.imul(yt,wt)|0,O=O+Math.imul(ue,w)|0,_=_+Math.imul(ue,S)|0,_=_+Math.imul(xe,w)|0,q=q+Math.imul(xe,S)|0;var gt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(gt>>>26)|0,gt&=67108863,O=Math.imul(At,oe),_=Math.imul(At,se),_=_+Math.imul(Pt,oe)|0,q=Math.imul(Pt,se),O=O+Math.imul(ut,Be)|0,_=_+Math.imul(ut,Ae)|0,_=_+Math.imul(nt,Be)|0,q=q+Math.imul(nt,Ae)|0,O=O+Math.imul(Ke,pe)|0,_=_+Math.imul(Ke,Te)|0,_=_+Math.imul(et,pe)|0,q=q+Math.imul(et,Te)|0,O=O+Math.imul(ke,Re)|0,_=_+Math.imul(ke,Ne)|0,_=_+Math.imul(Le,Re)|0,q=q+Math.imul(Le,Ne)|0,O=O+Math.imul(ne,Ye)|0,_=_+Math.imul(ne,Et)|0,_=_+Math.imul(de,Ye)|0,q=q+Math.imul(de,Et)|0,O=O+Math.imul(rt,Ct)|0,_=_+Math.imul(rt,wt)|0,_=_+Math.imul(vt,Ct)|0,q=q+Math.imul(vt,wt)|0,O=O+Math.imul(Qe,w)|0,_=_+Math.imul(Qe,S)|0,_=_+Math.imul(yt,w)|0,q=q+Math.imul(yt,S)|0,O=O+Math.imul(ue,p)|0,_=_+Math.imul(ue,I)|0,_=_+Math.imul(xe,p)|0,q=q+Math.imul(xe,I)|0;var bt=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(bt>>>26)|0,bt&=67108863,O=Math.imul(Ut,oe),_=Math.imul(Ut,se),_=_+Math.imul(sn,oe)|0,q=Math.imul(sn,se),O=O+Math.imul(At,Be)|0,_=_+Math.imul(At,Ae)|0,_=_+Math.imul(Pt,Be)|0,q=q+Math.imul(Pt,Ae)|0,O=O+Math.imul(ut,pe)|0,_=_+Math.imul(ut,Te)|0,_=_+Math.imul(nt,pe)|0,q=q+Math.imul(nt,Te)|0,O=O+Math.imul(Ke,Re)|0,_=_+Math.imul(Ke,Ne)|0,_=_+Math.imul(et,Re)|0,q=q+Math.imul(et,Ne)|0,O=O+Math.imul(ke,Ye)|0,_=_+Math.imul(ke,Et)|0,_=_+Math.imul(Le,Ye)|0,q=q+Math.imul(Le,Et)|0,O=O+Math.imul(ne,Ct)|0,_=_+Math.imul(ne,wt)|0,_=_+Math.imul(de,Ct)|0,q=q+Math.imul(de,wt)|0,O=O+Math.imul(rt,w)|0,_=_+Math.imul(rt,S)|0,_=_+Math.imul(vt,w)|0,q=q+Math.imul(vt,S)|0,O=O+Math.imul(Qe,p)|0,_=_+Math.imul(Qe,I)|0,_=_+Math.imul(yt,p)|0,q=q+Math.imul(yt,I)|0,O=O+Math.imul(ue,Y)|0,_=_+Math.imul(ue,le)|0,_=_+Math.imul(xe,Y)|0,q=q+Math.imul(xe,le)|0;var _t=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(_t>>>26)|0,_t&=67108863,O=Math.imul(K,oe),_=Math.imul(K,se),_=_+Math.imul(X,oe)|0,q=Math.imul(X,se),O=O+Math.imul(Ut,Be)|0,_=_+Math.imul(Ut,Ae)|0,_=_+Math.imul(sn,Be)|0,q=q+Math.imul(sn,Ae)|0,O=O+Math.imul(At,pe)|0,_=_+Math.imul(At,Te)|0,_=_+Math.imul(Pt,pe)|0,q=q+Math.imul(Pt,Te)|0,O=O+Math.imul(ut,Re)|0,_=_+Math.imul(ut,Ne)|0,_=_+Math.imul(nt,Re)|0,q=q+Math.imul(nt,Ne)|0,O=O+Math.imul(Ke,Ye)|0,_=_+Math.imul(Ke,Et)|0,_=_+Math.imul(et,Ye)|0,q=q+Math.imul(et,Et)|0,O=O+Math.imul(ke,Ct)|0,_=_+Math.imul(ke,wt)|0,_=_+Math.imul(Le,Ct)|0,q=q+Math.imul(Le,wt)|0,O=O+Math.imul(ne,w)|0,_=_+Math.imul(ne,S)|0,_=_+Math.imul(de,w)|0,q=q+Math.imul(de,S)|0,O=O+Math.imul(rt,p)|0,_=_+Math.imul(rt,I)|0,_=_+Math.imul(vt,p)|0,q=q+Math.imul(vt,I)|0,O=O+Math.imul(Qe,Y)|0,_=_+Math.imul(Qe,le)|0,_=_+Math.imul(yt,Y)|0,q=q+Math.imul(yt,le)|0,O=O+Math.imul(ue,Ue)|0,_=_+Math.imul(ue,Ee)|0,_=_+Math.imul(xe,Ue)|0,q=q+Math.imul(xe,Ee)|0;var Ge=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,O=Math.imul(K,Be),_=Math.imul(K,Ae),_=_+Math.imul(X,Be)|0,q=Math.imul(X,Ae),O=O+Math.imul(Ut,pe)|0,_=_+Math.imul(Ut,Te)|0,_=_+Math.imul(sn,pe)|0,q=q+Math.imul(sn,Te)|0,O=O+Math.imul(At,Re)|0,_=_+Math.imul(At,Ne)|0,_=_+Math.imul(Pt,Re)|0,q=q+Math.imul(Pt,Ne)|0,O=O+Math.imul(ut,Ye)|0,_=_+Math.imul(ut,Et)|0,_=_+Math.imul(nt,Ye)|0,q=q+Math.imul(nt,Et)|0,O=O+Math.imul(Ke,Ct)|0,_=_+Math.imul(Ke,wt)|0,_=_+Math.imul(et,Ct)|0,q=q+Math.imul(et,wt)|0,O=O+Math.imul(ke,w)|0,_=_+Math.imul(ke,S)|0,_=_+Math.imul(Le,w)|0,q=q+Math.imul(Le,S)|0,O=O+Math.imul(ne,p)|0,_=_+Math.imul(ne,I)|0,_=_+Math.imul(de,p)|0,q=q+Math.imul(de,I)|0,O=O+Math.imul(rt,Y)|0,_=_+Math.imul(rt,le)|0,_=_+Math.imul(vt,Y)|0,q=q+Math.imul(vt,le)|0,O=O+Math.imul(Qe,Ue)|0,_=_+Math.imul(Qe,Ee)|0,_=_+Math.imul(yt,Ue)|0,q=q+Math.imul(yt,Ee)|0;var Ze=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,O=Math.imul(K,pe),_=Math.imul(K,Te),_=_+Math.imul(X,pe)|0,q=Math.imul(X,Te),O=O+Math.imul(Ut,Re)|0,_=_+Math.imul(Ut,Ne)|0,_=_+Math.imul(sn,Re)|0,q=q+Math.imul(sn,Ne)|0,O=O+Math.imul(At,Ye)|0,_=_+Math.imul(At,Et)|0,_=_+Math.imul(Pt,Ye)|0,q=q+Math.imul(Pt,Et)|0,O=O+Math.imul(ut,Ct)|0,_=_+Math.imul(ut,wt)|0,_=_+Math.imul(nt,Ct)|0,q=q+Math.imul(nt,wt)|0,O=O+Math.imul(Ke,w)|0,_=_+Math.imul(Ke,S)|0,_=_+Math.imul(et,w)|0,q=q+Math.imul(et,S)|0,O=O+Math.imul(ke,p)|0,_=_+Math.imul(ke,I)|0,_=_+Math.imul(Le,p)|0,q=q+Math.imul(Le,I)|0,O=O+Math.imul(ne,Y)|0,_=_+Math.imul(ne,le)|0,_=_+Math.imul(de,Y)|0,q=q+Math.imul(de,le)|0,O=O+Math.imul(rt,Ue)|0,_=_+Math.imul(rt,Ee)|0,_=_+Math.imul(vt,Ue)|0,q=q+Math.imul(vt,Ee)|0;var je=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(je>>>26)|0,je&=67108863,O=Math.imul(K,Re),_=Math.imul(K,Ne),_=_+Math.imul(X,Re)|0,q=Math.imul(X,Ne),O=O+Math.imul(Ut,Ye)|0,_=_+Math.imul(Ut,Et)|0,_=_+Math.imul(sn,Ye)|0,q=q+Math.imul(sn,Et)|0,O=O+Math.imul(At,Ct)|0,_=_+Math.imul(At,wt)|0,_=_+Math.imul(Pt,Ct)|0,q=q+Math.imul(Pt,wt)|0,O=O+Math.imul(ut,w)|0,_=_+Math.imul(ut,S)|0,_=_+Math.imul(nt,w)|0,q=q+Math.imul(nt,S)|0,O=O+Math.imul(Ke,p)|0,_=_+Math.imul(Ke,I)|0,_=_+Math.imul(et,p)|0,q=q+Math.imul(et,I)|0,O=O+Math.imul(ke,Y)|0,_=_+Math.imul(ke,le)|0,_=_+Math.imul(Le,Y)|0,q=q+Math.imul(Le,le)|0,O=O+Math.imul(ne,Ue)|0,_=_+Math.imul(ne,Ee)|0,_=_+Math.imul(de,Ue)|0,q=q+Math.imul(de,Ee)|0;var Ve=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,O=Math.imul(K,Ye),_=Math.imul(K,Et),_=_+Math.imul(X,Ye)|0,q=Math.imul(X,Et),O=O+Math.imul(Ut,Ct)|0,_=_+Math.imul(Ut,wt)|0,_=_+Math.imul(sn,Ct)|0,q=q+Math.imul(sn,wt)|0,O=O+Math.imul(At,w)|0,_=_+Math.imul(At,S)|0,_=_+Math.imul(Pt,w)|0,q=q+Math.imul(Pt,S)|0,O=O+Math.imul(ut,p)|0,_=_+Math.imul(ut,I)|0,_=_+Math.imul(nt,p)|0,q=q+Math.imul(nt,I)|0,O=O+Math.imul(Ke,Y)|0,_=_+Math.imul(Ke,le)|0,_=_+Math.imul(et,Y)|0,q=q+Math.imul(et,le)|0,O=O+Math.imul(ke,Ue)|0,_=_+Math.imul(ke,Ee)|0,_=_+Math.imul(Le,Ue)|0,q=q+Math.imul(Le,Ee)|0;var Xe=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,O=Math.imul(K,Ct),_=Math.imul(K,wt),_=_+Math.imul(X,Ct)|0,q=Math.imul(X,wt),O=O+Math.imul(Ut,w)|0,_=_+Math.imul(Ut,S)|0,_=_+Math.imul(sn,w)|0,q=q+Math.imul(sn,S)|0,O=O+Math.imul(At,p)|0,_=_+Math.imul(At,I)|0,_=_+Math.imul(Pt,p)|0,q=q+Math.imul(Pt,I)|0,O=O+Math.imul(ut,Y)|0,_=_+Math.imul(ut,le)|0,_=_+Math.imul(nt,Y)|0,q=q+Math.imul(nt,le)|0,O=O+Math.imul(Ke,Ue)|0,_=_+Math.imul(Ke,Ee)|0,_=_+Math.imul(et,Ue)|0,q=q+Math.imul(et,Ee)|0;var Fe=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,O=Math.imul(K,w),_=Math.imul(K,S),_=_+Math.imul(X,w)|0,q=Math.imul(X,S),O=O+Math.imul(Ut,p)|0,_=_+Math.imul(Ut,I)|0,_=_+Math.imul(sn,p)|0,q=q+Math.imul(sn,I)|0,O=O+Math.imul(At,Y)|0,_=_+Math.imul(At,le)|0,_=_+Math.imul(Pt,Y)|0,q=q+Math.imul(Pt,le)|0,O=O+Math.imul(ut,Ue)|0,_=_+Math.imul(ut,Ee)|0,_=_+Math.imul(nt,Ue)|0,q=q+Math.imul(nt,Ee)|0;var re=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(re>>>26)|0,re&=67108863,O=Math.imul(K,p),_=Math.imul(K,I),_=_+Math.imul(X,p)|0,q=Math.imul(X,I),O=O+Math.imul(Ut,Y)|0,_=_+Math.imul(Ut,le)|0,_=_+Math.imul(sn,Y)|0,q=q+Math.imul(sn,le)|0,O=O+Math.imul(At,Ue)|0,_=_+Math.imul(At,Ee)|0,_=_+Math.imul(Pt,Ue)|0,q=q+Math.imul(Pt,Ee)|0;var ae=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(ae>>>26)|0,ae&=67108863,O=Math.imul(K,Y),_=Math.imul(K,le),_=_+Math.imul(X,Y)|0,q=Math.imul(X,le),O=O+Math.imul(Ut,Ue)|0,_=_+Math.imul(Ut,Ee)|0,_=_+Math.imul(sn,Ue)|0,q=q+Math.imul(sn,Ee)|0;var be=(J+O|0)+((_&8191)<<13)|0;J=(q+(_>>>13)|0)+(be>>>26)|0,be&=67108863,O=Math.imul(K,Ue),_=Math.imul(K,Ee),_=_+Math.imul(X,Ue)|0,q=Math.imul(X,Ee);var ge=(J+O|0)+((_&8191)<<13)|0;return J=(q+(_>>>13)|0)+(ge>>>26)|0,ge&=67108863,z[0]=Jt,z[1]=He,z[2]=ht,z[3]=pt,z[4]=kt,z[5]=xt,z[6]=gt,z[7]=bt,z[8]=_t,z[9]=Ge,z[10]=Ze,z[11]=je,z[12]=Ve,z[13]=Xe,z[14]=Fe,z[15]=re,z[16]=ae,z[17]=be,z[18]=ge,J!==0&&(z[19]=J,T.length++),T};Math.imul||(N=E);function A(x,f,m){m.negative=f.negative^x.negative,m.length=x.length+f.length;for(var T=0,$=0,M=0;M<m.length-1;M++){var z=$;$=0;for(var J=T&67108863,O=Math.min(M,f.length-1),_=Math.max(0,M-x.length+1);_<=O;_++){var q=M-_,ve=x.words[q]|0,ue=f.words[_]|0,xe=ve*ue,lt=xe&67108863;z=z+(xe/67108864|0)|0,lt=lt+J|0,J=lt&67108863,z=z+(lt>>>26)|0,$+=z>>>26,z&=67108863}m.words[M]=J,T=z,z=$}return T!==0?m.words[M]=T:m.length--,m._strip()}function P(x,f,m){return A(x,f,m)}o.prototype.mulTo=function(f,m){var T,$=this.length+f.length;return this.length===10&&f.length===10?T=N(this,f,m):$<63?T=E(this,f,m):$<1024?T=A(this,f,m):T=P(this,f,m),T},o.prototype.mul=function(f){var m=new o(null);return m.words=new Array(this.length+f.length),this.mulTo(f,m)},o.prototype.mulf=function(f){var m=new o(null);return m.words=new Array(this.length+f.length),P(this,f,m)},o.prototype.imul=function(f){return this.clone().mulTo(f,this)},o.prototype.imuln=function(f){var m=f<0;m&&(f=-f),i(typeof f=="number"),i(f<67108864);for(var T=0,$=0;$<this.length;$++){var M=(this.words[$]|0)*f,z=(M&67108863)+(T&67108863);T>>=26,T+=M/67108864|0,T+=z>>>26,this.words[$]=z&67108863}return T!==0&&(this.words[$]=T,this.length++),m?this.ineg():this},o.prototype.muln=function(f){return this.clone().imuln(f)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(f){var m=k(f);if(m.length===0)return new o(1);for(var T=this,$=0;$<m.length&&m[$]===0;$++,T=T.sqr());if(++$<m.length)for(var M=T.sqr();$<m.length;$++,M=M.sqr())m[$]!==0&&(T=T.mul(M));return T},o.prototype.iushln=function(f){i(typeof f=="number"&&f>=0);var m=f%26,T=(f-m)/26,$=67108863>>>26-m<<26-m,M;if(m!==0){var z=0;for(M=0;M<this.length;M++){var J=this.words[M]&$,O=(this.words[M]|0)-J<<m;this.words[M]=O|z,z=J>>>26-m}z&&(this.words[M]=z,this.length++)}if(T!==0){for(M=this.length-1;M>=0;M--)this.words[M+T]=this.words[M];for(M=0;M<T;M++)this.words[M]=0;this.length+=T}return this._strip()},o.prototype.ishln=function(f){return i(this.negative===0),this.iushln(f)},o.prototype.iushrn=function(f,m,T){i(typeof f=="number"&&f>=0);var $;m?$=(m-m%26)/26:$=0;var M=f%26,z=Math.min((f-M)/26,this.length),J=67108863^67108863>>>M<<M,O=T;if($-=z,$=Math.max(0,$),O){for(var _=0;_<z;_++)O.words[_]=this.words[_];O.length=z}if(z!==0)if(this.length>z)for(this.length-=z,_=0;_<this.length;_++)this.words[_]=this.words[_+z];else this.words[0]=0,this.length=1;var q=0;for(_=this.length-1;_>=0&&(q!==0||_>=$);_--){var ve=this.words[_]|0;this.words[_]=q<<26-M|ve>>>M,q=ve&J}return O&&q!==0&&(O.words[O.length++]=q),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(f,m,T){return i(this.negative===0),this.iushrn(f,m,T)},o.prototype.shln=function(f){return this.clone().ishln(f)},o.prototype.ushln=function(f){return this.clone().iushln(f)},o.prototype.shrn=function(f){return this.clone().ishrn(f)},o.prototype.ushrn=function(f){return this.clone().iushrn(f)},o.prototype.testn=function(f){i(typeof f=="number"&&f>=0);var m=f%26,T=(f-m)/26,$=1<<m;if(this.length<=T)return!1;var M=this.words[T];return!!(M&$)},o.prototype.imaskn=function(f){i(typeof f=="number"&&f>=0);var m=f%26,T=(f-m)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=T)return this;if(m!==0&&T++,this.length=Math.min(T,this.length),m!==0){var $=67108863^67108863>>>m<<m;this.words[this.length-1]&=$}return this._strip()},o.prototype.maskn=function(f){return this.clone().imaskn(f)},o.prototype.iaddn=function(f){return i(typeof f=="number"),i(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<=f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},o.prototype._iaddn=function(f){this.words[0]+=f;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},o.prototype.isubn=function(f){if(i(typeof f=="number"),i(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this._strip()},o.prototype.addn=function(f){return this.clone().iaddn(f)},o.prototype.subn=function(f){return this.clone().isubn(f)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(f,m,T){var $=f.length+T,M;this._expand($);var z,J=0;for(M=0;M<f.length;M++){z=(this.words[M+T]|0)+J;var O=(f.words[M]|0)*m;z-=O&67108863,J=(z>>26)-(O/67108864|0),this.words[M+T]=z&67108863}for(;M<this.length-T;M++)z=(this.words[M+T]|0)+J,J=z>>26,this.words[M+T]=z&67108863;if(J===0)return this._strip();for(i(J===-1),J=0,M=0;M<this.length;M++)z=-(this.words[M]|0)+J,J=z>>26,this.words[M]=z&67108863;return this.negative=1,this._strip()},o.prototype._wordDiv=function(f,m){var T=this.length-f.length,$=this.clone(),M=f,z=M.words[M.length-1]|0,J=this._countBits(z);T=26-J,T!==0&&(M=M.ushln(T),$.iushln(T),z=M.words[M.length-1]|0);var O=$.length-M.length,_;if(m!=="mod"){_=new o(null),_.length=O+1,_.words=new Array(_.length);for(var q=0;q<_.length;q++)_.words[q]=0}var ve=$.clone()._ishlnsubmul(M,1,O);ve.negative===0&&($=ve,_&&(_.words[O]=1));for(var ue=O-1;ue>=0;ue--){var xe=($.words[M.length+ue]|0)*67108864+($.words[M.length+ue-1]|0);for(xe=Math.min(xe/z|0,67108863),$._ishlnsubmul(M,xe,ue);$.negative!==0;)xe--,$.negative=0,$._ishlnsubmul(M,1,ue),$.isZero()||($.negative^=1);_&&(_.words[ue]=xe)}return _&&_._strip(),$._strip(),m!=="div"&&T!==0&&$.iushrn(T),{div:_||null,mod:$}},o.prototype.divmod=function(f,m,T){if(i(!f.isZero()),this.isZero())return{div:new o(0),mod:new o(0)};var $,M,z;return this.negative!==0&&f.negative===0?(z=this.neg().divmod(f,m),m!=="mod"&&($=z.div.neg()),m!=="div"&&(M=z.mod.neg(),T&&M.negative!==0&&M.iadd(f)),{div:$,mod:M}):this.negative===0&&f.negative!==0?(z=this.divmod(f.neg(),m),m!=="mod"&&($=z.div.neg()),{div:$,mod:z.mod}):this.negative&f.negative?(z=this.neg().divmod(f.neg(),m),m!=="div"&&(M=z.mod.neg(),T&&M.negative!==0&&M.isub(f)),{div:z.div,mod:M}):f.length>this.length||this.cmp(f)<0?{div:new o(0),mod:this}:f.length===1?m==="div"?{div:this.divn(f.words[0]),mod:null}:m==="mod"?{div:null,mod:new o(this.modrn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new o(this.modrn(f.words[0]))}:this._wordDiv(f,m)},o.prototype.div=function(f){return this.divmod(f,"div",!1).div},o.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},o.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},o.prototype.divRound=function(f){var m=this.divmod(f);if(m.mod.isZero())return m.div;var T=m.div.negative!==0?m.mod.isub(f):m.mod,$=f.ushrn(1),M=f.andln(1),z=T.cmp($);return z<0||M===1&&z===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},o.prototype.modrn=function(f){var m=f<0;m&&(f=-f),i(f<=67108863);for(var T=(1<<26)%f,$=0,M=this.length-1;M>=0;M--)$=(T*$+(this.words[M]|0))%f;return m?-$:$},o.prototype.modn=function(f){return this.modrn(f)},o.prototype.idivn=function(f){var m=f<0;m&&(f=-f),i(f<=67108863);for(var T=0,$=this.length-1;$>=0;$--){var M=(this.words[$]|0)+T*67108864;this.words[$]=M/f|0,T=M%f}return this._strip(),m?this.ineg():this},o.prototype.divn=function(f){return this.clone().idivn(f)},o.prototype.egcd=function(f){i(f.negative===0),i(!f.isZero());var m=this,T=f.clone();m.negative!==0?m=m.umod(f):m=m.clone();for(var $=new o(1),M=new o(0),z=new o(0),J=new o(1),O=0;m.isEven()&&T.isEven();)m.iushrn(1),T.iushrn(1),++O;for(var _=T.clone(),q=m.clone();!m.isZero();){for(var ve=0,ue=1;!(m.words[0]&ue)&&ve<26;++ve,ue<<=1);if(ve>0)for(m.iushrn(ve);ve-- >0;)($.isOdd()||M.isOdd())&&($.iadd(_),M.isub(q)),$.iushrn(1),M.iushrn(1);for(var xe=0,lt=1;!(T.words[0]&lt)&&xe<26;++xe,lt<<=1);if(xe>0)for(T.iushrn(xe);xe-- >0;)(z.isOdd()||J.isOdd())&&(z.iadd(_),J.isub(q)),z.iushrn(1),J.iushrn(1);m.cmp(T)>=0?(m.isub(T),$.isub(z),M.isub(J)):(T.isub(m),z.isub($),J.isub(M))}return{a:z,b:J,gcd:T.iushln(O)}},o.prototype._invmp=function(f){i(f.negative===0),i(!f.isZero());var m=this,T=f.clone();m.negative!==0?m=m.umod(f):m=m.clone();for(var $=new o(1),M=new o(0),z=T.clone();m.cmpn(1)>0&&T.cmpn(1)>0;){for(var J=0,O=1;!(m.words[0]&O)&&J<26;++J,O<<=1);if(J>0)for(m.iushrn(J);J-- >0;)$.isOdd()&&$.iadd(z),$.iushrn(1);for(var _=0,q=1;!(T.words[0]&q)&&_<26;++_,q<<=1);if(_>0)for(T.iushrn(_);_-- >0;)M.isOdd()&&M.iadd(z),M.iushrn(1);m.cmp(T)>=0?(m.isub(T),$.isub(M)):(T.isub(m),M.isub($))}var ve;return m.cmpn(1)===0?ve=$:ve=M,ve.cmpn(0)<0&&ve.iadd(f),ve},o.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var m=this.clone(),T=f.clone();m.negative=0,T.negative=0;for(var $=0;m.isEven()&&T.isEven();$++)m.iushrn(1),T.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;T.isEven();)T.iushrn(1);var M=m.cmp(T);if(M<0){var z=m;m=T,T=z}else if(M===0||T.cmpn(1)===0)break;m.isub(T)}while(!0);return T.iushln($)},o.prototype.invm=function(f){return this.egcd(f).a.umod(f)},o.prototype.isEven=function(){return(this.words[0]&1)===0},o.prototype.isOdd=function(){return(this.words[0]&1)===1},o.prototype.andln=function(f){return this.words[0]&f},o.prototype.bincn=function(f){i(typeof f=="number");var m=f%26,T=(f-m)/26,$=1<<m;if(this.length<=T)return this._expand(T+1),this.words[T]|=$,this;for(var M=$,z=T;M!==0&&z<this.length;z++){var J=this.words[z]|0;J+=M,M=J>>>26,J&=67108863,this.words[z]=J}return M!==0&&(this.words[z]=M,this.length++),this},o.prototype.isZero=function(){return this.length===1&&this.words[0]===0},o.prototype.cmpn=function(f){var m=f<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this._strip();var T;if(this.length>1)T=1;else{m&&(f=-f),i(f<=67108863,"Number is too big");var $=this.words[0]|0;T=$===f?0:$<f?-1:1}return this.negative!==0?-T|0:T},o.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var m=this.ucmp(f);return this.negative!==0?-m|0:m},o.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var m=0,T=this.length-1;T>=0;T--){var $=this.words[T]|0,M=f.words[T]|0;if($!==M){$<M?m=-1:$>M&&(m=1);break}}return m},o.prototype.gtn=function(f){return this.cmpn(f)===1},o.prototype.gt=function(f){return this.cmp(f)===1},o.prototype.gten=function(f){return this.cmpn(f)>=0},o.prototype.gte=function(f){return this.cmp(f)>=0},o.prototype.ltn=function(f){return this.cmpn(f)===-1},o.prototype.lt=function(f){return this.cmp(f)===-1},o.prototype.lten=function(f){return this.cmpn(f)<=0},o.prototype.lte=function(f){return this.cmp(f)<=0},o.prototype.eqn=function(f){return this.cmpn(f)===0},o.prototype.eq=function(f){return this.cmp(f)===0},o.red=function(f){return new R(f)},o.prototype.toRed=function(f){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},o.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(f){return this.red=f,this},o.prototype.forceRed=function(f){return i(!this.red,"Already a number in reduction context"),this._forceRed(f)},o.prototype.redAdd=function(f){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},o.prototype.redIAdd=function(f){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},o.prototype.redSub=function(f){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},o.prototype.redISub=function(f){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},o.prototype.redShl=function(f){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},o.prototype.redMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},o.prototype.redIMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},o.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(f){return i(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var B={k256:null,p224:null,p192:null,p25519:null};function W(x,f){this.name=x,this.p=new o(f,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}W.prototype._tmp=function(){var f=new o(null);return f.words=new Array(Math.ceil(this.n/13)),f},W.prototype.ireduce=function(f){var m=f,T;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),T=m.bitLength();while(T>this.n);var $=T<this.n?-1:m.ucmp(this.p);return $===0?(m.words[0]=0,m.length=1):$>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},W.prototype.split=function(f,m){f.iushrn(this.n,0,m)},W.prototype.imulK=function(f){return f.imul(this.k)};function Q(){W.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(Q,W),Q.prototype.split=function(f,m){for(var T=4194303,$=Math.min(f.length,9),M=0;M<$;M++)m.words[M]=f.words[M];if(m.length=$,f.length<=9){f.words[0]=0,f.length=1;return}var z=f.words[9];for(m.words[m.length++]=z&T,M=10;M<f.length;M++){var J=f.words[M]|0;f.words[M-10]=(J&T)<<4|z>>>22,z=J}z>>>=22,f.words[M-10]=z,z===0&&f.length>10?f.length-=10:f.length-=9},Q.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var m=0,T=0;T<f.length;T++){var $=f.words[T]|0;m+=$*977,f.words[T]=m&67108863,m=$*64+(m/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function V(){W.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(V,W);function ee(){W.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(ee,W);function j(){W.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(j,W),j.prototype.imulK=function(f){for(var m=0,T=0;T<f.length;T++){var $=(f.words[T]|0)*19+m,M=$&67108863;$>>>=26,f.words[T]=M,m=$}return m!==0&&(f.words[f.length++]=m),f},o._prime=function(f){if(B[f])return B[f];var m;if(f==="k256")m=new Q;else if(f==="p224")m=new V;else if(f==="p192")m=new ee;else if(f==="p25519")m=new j;else throw new Error("Unknown prime "+f);return B[f]=m,m};function R(x){if(typeof x=="string"){var f=o._prime(x);this.m=f.p,this.prime=f}else i(x.gtn(1),"modulus must be greater than 1"),this.m=x,this.prime=null}R.prototype._verify1=function(f){i(f.negative===0,"red works only with positives"),i(f.red,"red works only with red numbers")},R.prototype._verify2=function(f,m){i((f.negative|m.negative)===0,"red works only with positives"),i(f.red&&f.red===m.red,"red works only with red numbers")},R.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):(l(f,f.umod(this.m)._forceRed(this)),f)},R.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},R.prototype.add=function(f,m){this._verify2(f,m);var T=f.add(m);return T.cmp(this.m)>=0&&T.isub(this.m),T._forceRed(this)},R.prototype.iadd=function(f,m){this._verify2(f,m);var T=f.iadd(m);return T.cmp(this.m)>=0&&T.isub(this.m),T},R.prototype.sub=function(f,m){this._verify2(f,m);var T=f.sub(m);return T.cmpn(0)<0&&T.iadd(this.m),T._forceRed(this)},R.prototype.isub=function(f,m){this._verify2(f,m);var T=f.isub(m);return T.cmpn(0)<0&&T.iadd(this.m),T},R.prototype.shl=function(f,m){return this._verify1(f),this.imod(f.ushln(m))},R.prototype.imul=function(f,m){return this._verify2(f,m),this.imod(f.imul(m))},R.prototype.mul=function(f,m){return this._verify2(f,m),this.imod(f.mul(m))},R.prototype.isqr=function(f){return this.imul(f,f.clone())},R.prototype.sqr=function(f){return this.mul(f,f)},R.prototype.sqrt=function(f){if(f.isZero())return f.clone();var m=this.m.andln(3);if(i(m%2===1),m===3){var T=this.m.add(new o(1)).iushrn(2);return this.pow(f,T)}for(var $=this.m.subn(1),M=0;!$.isZero()&&$.andln(1)===0;)M++,$.iushrn(1);i(!$.isZero());var z=new o(1).toRed(this),J=z.redNeg(),O=this.m.subn(1).iushrn(1),_=this.m.bitLength();for(_=new o(2*_*_).toRed(this);this.pow(_,O).cmp(J)!==0;)_.redIAdd(J);for(var q=this.pow(_,$),ve=this.pow(f,$.addn(1).iushrn(1)),ue=this.pow(f,$),xe=M;ue.cmp(z)!==0;){for(var lt=ue,Qe=0;lt.cmp(z)!==0;Qe++)lt=lt.redSqr();i(Qe<xe);var yt=this.pow(q,new o(1).iushln(xe-Qe-1));ve=ve.redMul(yt),q=yt.redSqr(),ue=ue.redMul(q),xe=Qe}return ve},R.prototype.invm=function(f){var m=f._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},R.prototype.pow=function(f,m){if(m.isZero())return new o(1).toRed(this);if(m.cmpn(1)===0)return f.clone();var T=4,$=new Array(1<<T);$[0]=new o(1).toRed(this),$[1]=f;for(var M=2;M<$.length;M++)$[M]=this.mul($[M-1],f);var z=$[0],J=0,O=0,_=m.bitLength()%26;for(_===0&&(_=26),M=m.length-1;M>=0;M--){for(var q=m.words[M],ve=_-1;ve>=0;ve--){var ue=q>>ve&1;if(z!==$[0]&&(z=this.sqr(z)),ue===0&&J===0){O=0;continue}J<<=1,J|=ue,O++,!(O!==T&&(M!==0||ve!==0))&&(z=this.mul(z,$[J]),O=0,J=0)}_=26}return z},R.prototype.convertTo=function(f){var m=f.umod(this.m);return m===f?m.clone():m},R.prototype.convertFrom=function(f){var m=f.clone();return m.red=null,m},o.mont=function(f){return new U(f)};function U(x){R.call(this,x),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(U,R),U.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},U.prototype.convertFrom=function(f){var m=this.imod(f.mul(this.rinv));return m.red=null,m},U.prototype.imul=function(f,m){if(f.isZero()||m.isZero())return f.words[0]=0,f.length=1,f;var T=f.imul(m),$=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=T.isub($).iushrn(this.shift),z=M;return M.cmp(this.m)>=0?z=M.isub(this.m):M.cmpn(0)<0&&(z=M.iadd(this.m)),z._forceRed(this)},U.prototype.mul=function(f,m){if(f.isZero()||m.isZero())return new o(0)._forceRed(this);var T=f.mul(m),$=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=T.isub($).iushrn(this.shift),z=M;return M.cmp(this.m)>=0?z=M.isub(this.m):M.cmpn(0)<0&&(z=M.iadd(this.m)),z._forceRed(this)},U.prototype.invm=function(f){var m=this.imod(f._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(e,bw)})(jS);var zS="Invariant failed";function HS(e,t){if(!e)throw new Error(zS)}const uy="3.7.5",KS=uy,GS=typeof atob=="function",WS=typeof btoa=="function",$r=typeof Buffer=="function",l0=typeof TextDecoder=="function"?new TextDecoder:void 0,d0=typeof TextEncoder=="function"?new TextEncoder:void 0,VS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Vr=Array.prototype.slice.call(VS),Ka=(e=>{let t={};return e.forEach((n,i)=>t[n]=i),t})(Vr),XS=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Kn=String.fromCharCode.bind(String),h0=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),ly=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),dy=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),hy=e=>{let t,n,i,s,o="";const r=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255||(s=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|s,o+=Vr[t>>18&63]+Vr[t>>12&63]+Vr[t>>6&63]+Vr[t&63]}return r?o.slice(0,r-3)+"===".substring(r):o},Hh=WS?e=>btoa(e):$r?e=>Buffer.from(e,"binary").toString("base64"):hy,Pd=$r?e=>Buffer.from(e).toString("base64"):e=>{let n=[];for(let i=0,s=e.length;i<s;i+=4096)n.push(Kn.apply(null,e.subarray(i,i+4096)));return Hh(n.join(""))},hc=(e,t=!1)=>t?ly(Pd(e)):Pd(e),JS=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?Kn(192|t>>>6)+Kn(128|t&63):Kn(224|t>>>12&15)+Kn(128|t>>>6&63)+Kn(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Kn(240|t>>>18&7)+Kn(128|t>>>12&63)+Kn(128|t>>>6&63)+Kn(128|t&63)}},ZS=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,fy=e=>e.replace(ZS,JS),f0=$r?e=>Buffer.from(e,"utf8").toString("base64"):d0?e=>Pd(d0.encode(e)):e=>Hh(fy(e)),Qo=(e,t=!1)=>t?ly(f0(e)):f0(e),p0=e=>Qo(e,!0),YS=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,QS=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return Kn((n>>>10)+55296)+Kn((n&1023)+56320);case 3:return Kn((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Kn((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},py=e=>e.replace(YS,QS),gy=e=>{if(e=e.replace(/\s+/g,""),!XS.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,n="",i,s;for(let o=0;o<e.length;)t=Ka[e.charAt(o++)]<<18|Ka[e.charAt(o++)]<<12|(i=Ka[e.charAt(o++)])<<6|(s=Ka[e.charAt(o++)]),n+=i===64?Kn(t>>16&255):s===64?Kn(t>>16&255,t>>8&255):Kn(t>>16&255,t>>8&255,t&255);return n},Kh=GS?e=>atob(dy(e)):$r?e=>Buffer.from(e,"base64").toString("binary"):gy,_y=$r?e=>h0(Buffer.from(e,"base64")):e=>h0(Kh(e).split("").map(t=>t.charCodeAt(0))),my=e=>_y(yy(e)),e2=$r?e=>Buffer.from(e,"base64").toString("utf8"):l0?e=>l0.decode(_y(e)):e=>py(Kh(e)),yy=e=>dy(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),Ed=e=>e2(yy(e)),t2=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},wy=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),by=function(){const e=(t,n)=>Object.defineProperty(String.prototype,t,wy(n));e("fromBase64",function(){return Ed(this)}),e("toBase64",function(t){return Qo(this,t)}),e("toBase64URI",function(){return Qo(this,!0)}),e("toBase64URL",function(){return Qo(this,!0)}),e("toUint8Array",function(){return my(this)})},vy=function(){const e=(t,n)=>Object.defineProperty(Uint8Array.prototype,t,wy(n));e("toBase64",function(t){return hc(this,t)}),e("toBase64URI",function(){return hc(this,!0)}),e("toBase64URL",function(){return hc(this,!0)})},n2=()=>{by(),vy()},er={version:uy,VERSION:KS,atob:Kh,atobPolyfill:gy,btoa:Hh,btoaPolyfill:hy,fromBase64:Ed,toBase64:Qo,encode:Qo,encodeURI:p0,encodeURL:p0,utob:fy,btou:py,decode:Ed,isValid:t2,fromUint8Array:hc,toUint8Array:my,extendString:by,extendUint8Array:vy,extendBuiltins:n2};function Hl(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(n=0)),n;)try{if(i=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],s=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var qs;(function(e){e[e.EQUAL=0]="EQUAL",e[e.GREATER=1]="GREATER",e[e.LESS=-1]="LESS"})(qs||(qs={}));var i2=function(){function e(t){this.compare=t||e.defaultCompareFunction}return e.defaultCompareFunction=function(t,n){return t===n?qs.EQUAL:t<n?qs.LESS:qs.GREATER},e.prototype.equal=function(t,n){return this.compare(t,n)===qs.EQUAL},e.prototype.lessThan=function(t,n){return this.compare(t,n)===qs.LESS},e.prototype.greaterThan=function(t,n){return this.compare(t,n)===qs.GREATER},e.prototype.lessThanOrEqual=function(t,n){return this.lessThan(t,n)||this.equal(t,n)},e.prototype.greaterThanOrEqual=function(t,n){return this.greaterThan(t,n)||this.equal(t,n)},e.prototype.reverse=function(){var t=this.compare;this.compare=function(n,i){return t(i,n)}},e}(),g0=function(){function e(t){this.value=t,this.next=null}return e}(),_0=function(){function e(t){this.value=t,this.next=null,this.prev=null}return e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Cd=function(e,t){return Cd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},Cd(e,t)};function Ur(e,t){Cd(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function ua(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],s=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function s2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),s,o=[],r;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function Gi(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s2(arguments[t]));return e}var o2="obfuse error occur";function Bc(e,t){if(!e)throw new Error("[linked-list] "+(t||o2))}var r2=-1,xy=function(){function e(){for(var t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this._head=null,this._tail=null,this._length=0,this.compare=new i2,n.length>0&&n.forEach(function(s){t.append(s)})}return Object.defineProperty(e.prototype,"head",{get:function(){return this._head?this._head.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tail",{get:function(){return this._tail?this._tail.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopLength",{get:function(){var t=!1,n=1;if(!this._head)return 0;for(var i=this._head,s=this._head;s.next&&s.next.next;)if(s=s.next.next,i=i.next,i===s){t=!0;break}if(t){for(s=s.next;i!==s;)n++,s=s.next;return n}else return 0},enumerable:!0,configurable:!0}),e.prototype.getNode=function(t){var n=this._length;Bc(n>0&&t>=0&&t<n,"[linked-list] index "+t+" out of scope of list, which length is "+n);for(var i=this._head,s=0;s<t;)i=i.next,s++;return i},e.prototype.get=function(t){var n=this.getNode(t);return n?n.value:null},e.prototype.find=function(t){var n=t.value,i=t.callback;if(!this._head)return null;for(var s=this._head;s;){if(i&&i(s.value)||n!==void 0&&this.compare.equal(s.value,n))return s;s=s.next}return null},e.prototype.indexOf=function(t){if(!this._head)return r2;for(var n=this._head,i=-1;n.next;){if(i++,this.compare.equal(n.value,t))return i;n=n.next}return n===this._tail&&this.compare.equal(n.value,t)&&(i+=1),i},e.prototype.first=function(t){Bc(t>=0,"[linked-list] param 'num' ("+t+") should not less than 0");for(var n=this.iterator(),i=[],s=Math.min(t,this.length),o=0;o<s;o++){var r=n.next();i.push(r.value)}return i},e.prototype.toArray=function(){return Gi(this)},e.prototype.isEmpty=function(){return this._head===null},e.prototype.iterator=function(){var t;return ua(this,function(n){switch(n.label){case 0:t=this._head,n.label=1;case 1:return t?[4,t.value]:[3,3];case 2:return n.sent(),t=t.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e}(),la=function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return e.apply(this,Gi(n))||this}return t.prototype.append=function(n){var i=new g0(n);return this._tail?(this._tail.next=i,this._tail=i):this._head=this._tail=i,this._length++,!0},t.prototype.prepend=function(n){var i=new g0(n);return this._head?(i.next=this._head,this._head=i):this._head=this._tail=i,this._length++,!0},t.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,i.next=null):this._head=this._tail=null,this._length--,n;for(var s=i;;){if(this.compare.equal(i.value,n))return i.next?s.next=i.next:(this._tail=s,this._tail.next=null),i.next=null,this._length--,n;if(i.next)s=i,i=i.next;else return}}},t.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.removeTail=function(){var n=this._tail;if(n){if(!this._head.next)this._head=null,this._tail=null;else{for(var i=this._head;i.next!==n;)i=i.next;i.next=null,this._tail=i}return this._length--,n.value}},t.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,i=n,n=s;this._head=i}},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Gi([void 0],n)))},t}(xy),a2=function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=e.apply(this,Gi(n))||this;return s.cyclization(),s}return t.prototype.iterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},t.prototype.circleIterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=e.prototype[n].apply(this,i);return this.cyclization(),o},t.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},t.prototype.append=function(n){return this.mapToNormalListFn("append",n)},t.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},t.prototype.find=function(n){return this.mapToNormalListFn("find",n)},t.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},t.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},t.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},t.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},t.prototype.first=function(n){Bc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},t.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},t.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},t}(la);(function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=e.apply(this,Gi(n))||this;return s.cyclization(),s}return t.prototype.breakCircle=function(){this._tail&&this._tail.next===this._head&&(this._tail.next=null)},t.prototype.cyclization=function(){this._tail&&this._tail.next===null&&(this._tail.next=this._head)},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Gi([void 0],n)))},t})(a2);var c2=function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return e.apply(this,Gi(n))||this}return t.prototype.append=function(n){var i=new _0(n);return this._tail?(this._tail.next=i,i.prev=this._tail,this._tail=i):this._head=this._tail=i,this._length++,!0},t.prototype.prepend=function(n){var i=new _0(n);return this._head?(i.next=this._head,this._head.prev=i,this._head=i):this._head=this._tail=i,this._length++,!0},t.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,this._head.prev=null,i.next=i.prev=null):this._head=this._tail=null,this._length--,n;for(;;){if(this.compare.equal(i.value,n))return i.next?(i.prev.next=i.next,i.next.prev=i.prev,i.next=i.prev=null):(i.prev.next=null,this._tail=i.prev,i.next=i.prev=null),this._length--,i.value;if(i.next)i=i.next;else return}}},t.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(n.next.prev=null,this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.removeTail=function(){var n=this._tail;if(n)return this._head.next?(n.prev.next=null,this._tail=n.prev,n.next=n.prev=null):(this._head=null,this._tail=null),this._length--,n.value},t.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,n.prev=s,i=n,n=s;this._head=i}},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Gi([void 0],n)))},t}(xy),u2=function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=e.apply(this,Gi(n))||this;return s.cyclization(),s}return t.prototype.iterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},t.prototype.circleIterator=function(){var n;return ua(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=e.prototype[n].apply(this,i);return this.cyclization(),o},t.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},t.prototype.append=function(n){return this.mapToNormalListFn("append",n)},t.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},t.prototype.find=function(n){return this.mapToNormalListFn("find",n)},t.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},t.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},t.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},t.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},t.prototype.first=function(n){Bc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},t.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},t.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},t}(c2);(function(e){Ur(t,e);function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=e.apply(this,Gi(n))||this;return s.cyclization(),s}return t.prototype.breakCircle=function(){this._tail&&this._head&&this._tail.next===this._head&&(this._tail.next=null,this._head.prev=null)},t.prototype.cyclization=function(){this._head&&this._tail&&this._tail.next===null&&(this._tail.next=this._head,this._head.prev=this._tail)},t.prototype.clone=function(){var n=this.toArray();return new(t.bind.apply(t,Gi([void 0],n)))},t})(u2);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function l2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),s,o=[],r;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function d2(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l2(arguments[t]));return e}var h2=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.queue=new(la.bind.apply(la,d2([void 0],t)))}return Object.defineProperty(e.prototype,"length",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"peek",{get:function(){return this.queue.head},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.queue.isEmpty()},e.prototype.enqueue=function(t){return this.queue.append(t)},e.prototype.dequeue=function(){var t=this.queue.removeHead();return typeof t<"u"?t:void 0},e.prototype.toArray=function(){return this.queue.toArray()},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function f2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),s,o=[],r;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function p2(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f2(arguments[t]));return e}var Kl=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.stack=new(la.bind.apply(la,p2([void 0],t)))}return Object.defineProperty(e.prototype,"length",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"peek",{get:function(){return this.stack.tail},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.stack.isEmpty()},e.prototype.push=function(t){return this.stack.append(t)},e.prototype.pop=function(){var t=this.stack.removeTail();return typeof t<"u"?t:void 0},e.prototype.popBottom=function(){var t=this.stack.removeHead();return typeof t<"u"?t:void 0},e.prototype.toArray=function(){return this.stack.toArray()},e}(),Ty=function(){function e(t,n,i){i===void 0&&(i=0),this.startVertex=t,this.endVertex=n,this.weight=i}return e.prototype.getKey=function(){var t=this.startVertex.getKey(),n=this.endVertex.getKey();return t+"_"+n},e.prototype.reverse=function(){var t=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=t,this},e.prototype.clone=function(){return new e(this.startVertex,this.endVertex,this.weight)},e.prototype.toString=function(){return this.getKey()},e}();function Bd(e,t,n){if(n===void 0&&(n="cc-graph"),!e)throw new Error((n?"["+n+"]":"")+" Invariant failed: "+t)}function g2(e,t){t===void 0&&(t=!0);var n=typeof e<"u"&&e!==null;return t?n&&e!=="undefined"&&e!=="null":n}var Ic=function(){function e(t){Bd(g2(t),"Graph vertex must have a value"),this.value=t,this.edges=new Map}return e.prototype.addEdge=function(t){return this.edges.set(t.getKey(),t),this},e.prototype.deleteEdge=function(t){this.edges.delete(t.getKey())},e.prototype.getNeighbors=function(){var t=this,n=this.getEdges(),i=function(s){return s.startVertex===t?s.endVertex:s.startVertex};return n.map(i)},e.prototype.getEdges=function(){return Array.from(this.edges.values())},e.prototype.getDegree=function(){return this.getEdges().length},e.prototype.hasEdge=function(t){var n=this.getEdges().find(function(i){return i===t});return!!n},e.prototype.hasNeighbor=function(t){var n=this.getEdges().find(function(i){return i.startVertex===t||i.endVertex===t});return!!n},e.prototype.findEdge=function(t){var n=function(s){return s.startVertex===t||s.endVertex===t},i=this.getEdges().find(n);return i||null},e.prototype.getKey=function(){return this.value},e.prototype.deleteAllEdges=function(){var t=this;return this.getEdges().forEach(function(n){return t.deleteEdge(n)}),this},e.prototype.toString=function(t){return t?t(this.value):""+this.value},e}();function m0(e,t,n,i){if(e){t.push(e),i.set(e.getKey(),!0);var s=e.getNeighbors().filter(function(o){return!i.get(o.getKey())});n.push(s)}}function y0(e,t,n){var i=e.pop();i&&n.set(i.getKey(),!1),t.pop()}var Ay=function(){function e(t){t===void 0&&(t=!1),this.vertices={},this.edges={},this.isDirected=t}return e.prototype.addVertex=function(t){return this.vertices[t.getKey()]=t,this},e.prototype.getVertexByKey=function(t){return this.vertices[t]},e.prototype.getNeighbors=function(t){return t.getNeighbors()},e.prototype.getAllVertices=function(){return Object.values(this.vertices)},e.prototype.getAllEdges=function(){return Object.values(this.edges)},e.prototype.addEdge=function(t,n){if(n===void 0&&(n=!1),this.edges[t.getKey()]){if(n)return this;Bd(!1,"Edge has already been added before")}var i=this.getVertexByKey(t.startVertex.getKey()),s=this.getVertexByKey(t.endVertex.getKey());if(i||(this.addVertex(t.startVertex),i=this.getVertexByKey(t.startVertex.getKey())),s||(this.addVertex(t.endVertex),s=this.getVertexByKey(t.endVertex.getKey())),this.edges[t.getKey()]=t,this.isDirected)i.addEdge(t);else{i.addEdge(t);var o=t.clone();s.addEdge(o.reverse())}return this},e.prototype.deleteEdge=function(t,n){if(n===void 0&&(n=!1),!this.edges[t.getKey()]){if(n)return this;Bd(!1,"Edge not found in graph")}delete this.edges[t.getKey()];var i=this.getVertexByKey(t.startVertex.getKey()),s=this.getVertexByKey(t.endVertex.getKey());return i.deleteEdge(t),s.deleteEdge(t),this},e.prototype.findEdge=function(t,n){var i=this.getVertexByKey(t.getKey());return i?i.findEdge(n):null},e.prototype.getWeight=function(){return this.getAllEdges().reduce(function(t,n){return t+n.weight},0)},e.prototype.reverse=function(){var t=this;return this.getAllEdges().forEach(function(n){t.deleteEdge(n),n.reverse(),t.addEdge(n)}),this},e.prototype.getVerticesIndices=function(){var t={};return this.getAllVertices().forEach(function(n,i){t[n.getKey()]=i}),t},e.prototype.getAdjacencyMatrix=function(){var t=this,n=this.getAllVertices(),i=this.getVerticesIndices(),s=Array(n.length).fill(null).map(function(){return Array(n.length).fill(1/0)});return n.forEach(function(o,r){o.getNeighbors().forEach(function(a){var c=i[a.getKey()],u=t.findEdge(o,a);u&&(s[r][c]=u.weight)})}),s},e.prototype.toString=function(){return Object.keys(this.vertices).toString()},e.prototype.bfs=function(t){var n,i,s;return Hl(this,function(o){switch(o.label){case 0:n=new Map,i=new h2,i.enqueue(t),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.dequeue(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.enqueue(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},e.prototype.dfs=function(t){var n,i,s;return Hl(this,function(o){switch(o.label){case 0:n=new Map,i=new Kl,i.push(t),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.pop(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.push(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},e.prototype.findAllPath=function(t,n){var i,s,o,r,a,c,u;return Hl(this,function(l){switch(l.label){case 0:return i=[],t!==n?[3,2]:(i.push(t),[4,i]);case 1:return l.sent(),[2];case 2:s=new Map,o=new Kl,r=new Kl,m0(t,o,r,s),l.label=3;case 3:if(o.isEmpty())return[3,6];if(a=r.pop(),a&&a.length)c=a.shift(),r.push(a),c&&m0(c,o,r,s);else return r.push(a),y0(o,r,s),[3,3];return u=o.peek,u!==n?[3,5]:[4,o.toArray()];case 4:l.sent(),y0(o,r,s),l.label=5;case 5:return[3,3];case 6:return[2]}})},e}();ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var ri=ie,zn=class extends Error{constructor(t,n){super(t),this.message=t,this.errorCode=n}static isClmmpoolsErrorCode(t,n){return t instanceof zn&&t.errorCode===n}},Ie=new y(0),no=new y(1),Xu=new y(2);Xu.pow(new y(128));var Oc=Xu.pow(new y(64)).sub(no),_2=Xu.pow(new y(128)).sub(no),Tt=class{static toX64_BN(t){return t.mul(new y(2).pow(new y(64)))}static toX64_Decimal(t){return t.mul(ri.pow(2,64))}static toX64(t){return new y(t.mul(ri.pow(2,64)).floor().toFixed())}static fromX64(t){return new ri(t.toString()).mul(ri.pow(2,-64))}static fromX64_Decimal(t){return t.mul(ri.pow(2,-64))}static fromX64_BN(t){return t.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(t){let n=t.shrn(64);return t.mod(Oc).gt(Ie)&&(n=n.add(no)),n}static divRoundUp(t,n){return t.mod(n).eq(Ie)?t.div(n):t.div(n).add(new y(1))}static subUnderflowU128(t,n){return t.lt(n)?t.sub(n).add(_2):t.sub(n)}static checkUnsignedSub(t,n){const i=t.sub(n);if(i.isNeg())throw new zn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return i}static checkMul(t,n,i){const s=t.mul(n);if(this.isOverflow(s,i))throw new zn("Multiplication overflow","MultiplicationOverflow");return s}static checkMulDivFloor(t,n,i,s){if(i.eq(Ie))throw new zn("Devide by zero","DivideByZero");const o=t.mul(n).div(i);if(this.isOverflow(o,s))throw new zn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivCeil(t,n,i,s){if(i.eq(Ie))throw new zn("Devide by zero","DivideByZero");const o=t.mul(n).add(i.sub(no)).div(i);if(this.isOverflow(o,s))throw new zn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivRound(t,n,i,s){if(i.eq(Ie))throw new zn("Devide by zero","DivideByZero");const o=t.mul(n.add(i.shrn(1))).div(i);if(this.isOverflow(o,s))throw new zn("Multiplication div overflow","MulDivOverflow");return o}static checkMulShiftRight(t,n,i,s){const o=t.mul(n).div(new y(2).pow(new y(i)));if(this.isOverflow(o,s))throw new zn("Multiplication shift right overflow","MulShiftRightOverflow");return o}static checkMulShiftRight64RoundUpIf(t,n,i,s){const o=t.mul(n),a=s&&o.and(Oc).gt(Ie)?o.shrn(64).add(no):o.shrn(64);if(this.isOverflow(a,i))throw new zn("Multiplication shift right overflow","MulShiftRightOverflow");return a}static checkMulShiftLeft(t,n,i,s){const o=t.mul(n).shln(i);if(this.isOverflow(o,s))throw new zn("Multiplication shift left overflow","MulShiftLeftOverflow");return o}static checkDivRoundUpIf(t,n,i){if(n.eq(Ie))throw new zn("Devide by zero","DivideByZero");return i?this.divRoundUp(t,n):t.div(n)}static isOverflow(t,n){return t.gte(Xu.pow(new y(n)))}};function ky(e){return{coinA:e.coinTypeA.toString(),coinB:e.coinTypeB.toString(),currentSqrtPrice:new y(e.current_sqrt_price),currentTickIndex:e.current_tick_index,feeGrowthGlobalA:new y(e.fee_growth_global_a),feeGrowthGlobalB:new y(e.fee_growth_global_b),feeProtocolCoinA:new y(e.fee_protocol_coin_a),feeProtocolCoinB:new y(e.fee_protocol_coin_b),feeRate:e.fee_rate,liquidity:new y(e.liquidity),tickIndexes:[],tickSpacing:Number(e.tickSpacing),ticks:[],collection_name:e.collectionName}}function m2(e){const t=new y(e);return t.lt(Ie)?{bits:t.neg().xor(new y(2).pow(new y(64)).sub(new y(1))).add(new y(1)).toString()}:{bits:t.toString()}}var Sy="0x1::coin::CoinInfo",Py="0x1::coin::CoinStore",w0="0x3::token::TokenStore",y2="0x3::token::WithdrawEvent",w2="PoolLiquidityCoin",Js="clmm_router",Ey="factory",Cy="Pools",b2="pool",v2="Pool",x2="crowdsale",T2="CrowdsalePool",A2="fairlaunch",k2="FairlaunchPool",Zi="cetus_script",By="cscoin",Iy="liquidity",Id="scripts";function S2(e){return e.startsWith("0x")?`${e.slice(2)}`:e}function ts(e){let t="";const n=S2(e),i=n.length/2;for(let s=0;s<i;s++)t+=String.fromCharCode(parseInt(n.substr(s*2,2),16));return P2(t)}function P2(e){let t,n,i,s,o,r;for(t="",i=e.length,n=0;n<i;)switch(s=e.charCodeAt(n++),s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(n-1);break;case 12:case 13:o=e.charCodeAt(n++),t+=String.fromCharCode((s&31)<<6|o&63);break;case 14:o=e.charCodeAt(n++),r=e.charCodeAt(n++),t+=String.fromCharCode((s&15)<<12|(o&63)<<6|(r&63)<<0);break}return t}var E2=/^0x1::coin::CoinStore<(.+)>$/;function Ot(e,...t){const n=Array.isArray(t[t.length-1])?t.pop():[];let s=[e,...t].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function b0(e){return Ot($t.fromUint8Array(e.value.address.address).hex(),e.value.module_name.value,e.value.name.value,[])}function C2(e){const t=e.value.type_args[0],n=e.value.type_args[1],i=b0(t),s=b0(n),o=Ot($t.fromUint8Array(e.value.address.address).hex(),e.value.module_name.value,e.value.name.value,[i,s]);return{coinA:i,coinB:s,lpAddress:o}}function Gh(e){var t;let n=e.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(t=i==null?void 0:i[0])==null?void 0:t.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s)return n=n.slice(0,n.indexOf("<")),{...Gh(n),type_arguments:[...s]};const o=n.split("::");return{full_address:n,address:o[0],module:o[1],name:o[2],type_arguments:[]}}function v0(e){const t=e.match(E2);return t?t[1]:""}function B2(e){return`${Py}<${e}>`}function I2(e){return`${Sy}<${e}>`}var Ju=class{constructor(t,n=0){this.overdueTime=n,this.value=t}getCacheData(){return this.value===null?null:this.overdueTime===0?this.value:Date.parse(new Date().toString())>this.overdueTime?(this.value=null,null):this.value}},x0=443636,T0=-443636,Zu="79226673515401279992447579055",Yu="4295048016",jo=new y(1e6),Rc=class{static getDefaultSqrtPriceLimit(t){return new y(t?Yu:Zu)}static getDefaultOtherAmountThreshold(t){return t?Ie:Oc}},$c=class{constructor(t,n){this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=t,this.denominator=n}static fromDecimal(t){return $c.fromFraction(t.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(t,n){const i=typeof t=="number"?new y(t.toString()):t,s=typeof n=="number"?new y(n.toString()):n;return new $c(i,s)}},O2=14,R2="59543866431248",$2="184467440737095516",U2="15793534762490258745";function q2(e,t,n){const i=e.toTwos(n).shln(t);return i.imaskn(n+1),i.fromTwos(n)}function Wt(e,t,n){const i=e.toTwos(n).shrn(t);return i.imaskn(n-t+1),i.fromTwos(n-t)}function L2(e){let t;return e&1?t=new y("79232123823359799118286999567"):t=new y("79228162514264337593543950336"),e&2&&(t=Wt(t.mul(new y("79236085330515764027303304731")),96,256)),e&4&&(t=Wt(t.mul(new y("79244008939048815603706035061")),96,256)),e&8&&(t=Wt(t.mul(new y("79259858533276714757314932305")),96,256)),e&16&&(t=Wt(t.mul(new y("79291567232598584799939703904")),96,256)),e&32&&(t=Wt(t.mul(new y("79355022692464371645785046466")),96,256)),e&64&&(t=Wt(t.mul(new y("79482085999252804386437311141")),96,256)),e&128&&(t=Wt(t.mul(new y("79736823300114093921829183326")),96,256)),e&256&&(t=Wt(t.mul(new y("80248749790819932309965073892")),96,256)),e&512&&(t=Wt(t.mul(new y("81282483887344747381513967011")),96,256)),e&1024&&(t=Wt(t.mul(new y("83390072131320151908154831281")),96,256)),e&2048&&(t=Wt(t.mul(new y("87770609709833776024991924138")),96,256)),e&4096&&(t=Wt(t.mul(new y("97234110755111693312479820773")),96,256)),e&8192&&(t=Wt(t.mul(new y("119332217159966728226237229890")),96,256)),e&16384&&(t=Wt(t.mul(new y("179736315981702064433883588727")),96,256)),e&32768&&(t=Wt(t.mul(new y("407748233172238350107850275304")),96,256)),e&65536&&(t=Wt(t.mul(new y("2098478828474011932436660412517")),96,256)),e&131072&&(t=Wt(t.mul(new y("55581415166113811149459800483533")),96,256)),e&262144&&(t=Wt(t.mul(new y("38992368544603139932233054999993551")),96,256)),Wt(t,32,256)}function D2(e){const t=Math.abs(e);let n;return t&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),t&2&&(n=Wt(n.mul(new y("18444899583751176498")),64,256)),t&4&&(n=Wt(n.mul(new y("18443055278223354162")),64,256)),t&8&&(n=Wt(n.mul(new y("18439367220385604838")),64,256)),t&16&&(n=Wt(n.mul(new y("18431993317065449817")),64,256)),t&32&&(n=Wt(n.mul(new y("18417254355718160513")),64,256)),t&64&&(n=Wt(n.mul(new y("18387811781193591352")),64,256)),t&128&&(n=Wt(n.mul(new y("18329067761203520168")),64,256)),t&256&&(n=Wt(n.mul(new y("18212142134806087854")),64,256)),t&512&&(n=Wt(n.mul(new y("17980523815641551639")),64,256)),t&1024&&(n=Wt(n.mul(new y("17526086738831147013")),64,256)),t&2048&&(n=Wt(n.mul(new y("16651378430235024244")),64,256)),t&4096&&(n=Wt(n.mul(new y("15030750278693429944")),64,256)),t&8192&&(n=Wt(n.mul(new y("12247334978882834399")),64,256)),t&16384&&(n=Wt(n.mul(new y("8131365268884726200")),64,256)),t&32768&&(n=Wt(n.mul(new y("3584323654723342297")),64,256)),t&65536&&(n=Wt(n.mul(new y("696457651847595233")),64,256)),t&131072&&(n=Wt(n.mul(new y("26294789957452057")),64,256)),t&262144&&(n=Wt(n.mul(new y("37481735321082")),64,256)),n}var Yt=class{static priceToSqrtPriceX64(t,n,i){return Tt.toX64(t.mul(ri.pow(10,i-n)).sqrt())}static sqrtPriceX64ToPrice(t,n,i){return Tt.fromX64(t).pow(2).mul(ri.pow(10,n-i))}static tickIndexToSqrtPriceX64(t){return t>0?new y(L2(t)):new y(D2(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new y(Zu))||t.lt(new y(Yu)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const n=t.bitLength()-1,i=new y(n-64),s=q2(i,32,128);let o=new y("8000000000000000","hex"),r=0,a=new y(0),c=n>=64?t.shrn(n-63):t.shln(63-n);for(;o.gt(new y(0))&&r<O2;){c=c.mul(c);const v=c.shrn(127);c=c.shrn(63+v.toNumber()),a=a.add(o.mul(v)),o=o.shrn(1),r+=1}const u=a.shrn(32),d=s.add(u).mul(new y(R2)),h=Wt(d.sub(new y($2)),64,128).toNumber(),g=Wt(d.add(new y(U2)),64,128).toNumber();return h===g?h:Yt.tickIndexToSqrtPriceX64(g).lte(t)?g:h}static tickIndexToPrice(t,n,i){return Yt.sqrtPriceX64ToPrice(Yt.tickIndexToSqrtPriceX64(t),n,i)}static priceToTickIndex(t,n,i){return Yt.sqrtPriceX64ToTickIndex(Yt.priceToSqrtPriceX64(t,n,i))}static priceToInitializableTickIndex(t,n,i,s){return Yt.getInitializableTickIndex(Yt.priceToTickIndex(t,n,i),s)}static getInitializableTickIndex(t,n){return t-t%n}static getNextInitializableTickIndex(t,n){return Yt.getInitializableTickIndex(t,n)+n}static getPrevInitializableTickIndex(t,n){return Yt.getInitializableTickIndex(t,n)-n}};function Oy(e){const t=[];for(const n of e){const i={index:Number(BigInt.asIntN(64,BigInt(n.index.bits)).toString()),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(BigInt.asIntN(64,BigInt(n.liquidity_net.bits)).toString()),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:[new y(n.rewarders_growth_outside[0]),new y(n.rewarders_growth_outside[1]),new y(n.rewarders_growth_outside[2])]};t.push(i)}return t}function A0(e){return e.isAxiosError,e}function mt(e){return ri.isDecimal(e)?e:new ri(e===void 0?0:e)}function Wh(e){return mt(10).pow(mt(e).abs())}function M2(e){return e!=null&&e!==""&&!isNaN(Number(e.toString()))}new y(365);new y(24);new y(3600);new y(.5);function N2(e,t,n,i,s,o){const r=new ie(e.toString()).div(new ie(10**n)),a=new ie(t.toString()).div(new ie(10**i));return r.mul(s).add(a.mul(o))}function F2(e,t,n,i,s,o,r,a,c,u,l,d,h,g,b,v,k,E,N,A,P,B,W,Q){const V=new ie(d),ee=new ie(h),j=new ie(v),R=new ie(k),U=new ie(E),x=new ie(N),f=new ie(A),m=new ie(P),T=new ie(B),$=new ie(W),M=new ie(Q),z=Yt.tickIndexToSqrtPriceX64(t),J=Yt.tickIndexToSqrtPriceX64(n),O=Tt.toX64_Decimal(Tt.fromX64(z)).round(),_=Tt.toX64_Decimal(Tt.fromX64(J)).round(),q=Tt.toX64_Decimal(Tt.fromX64(i)).round();let ve;const ue=V.mul(new ie(10**o)).mul(_.mul(O)).div(_.sub(O)).round(),xe=ee.mul(new ie(10**r)).div(_.sub(O)).round();e<t?ve=ue:e>n?ve=xe:ve=ie.min(ue,xe);const lt=ve.mul(q.sub(O)),yt=ve.mul(_.sub(q)).div(q.mul(_)).div(new ie(10**o)).mul(f).add(lt.div(new ie(10**r).mul(m))),ot=N2(g,b,o,r,f,m),rt=yt.div(ot),vt=ve.eq(new ie(0))?new ie(0):new ie(l/1e4).mul(j).mul(new ie(ve.toString()).div(new ie(s.toString()).add(new ie(ve.toString())))).div(yt),Pn=rt.eq(new ie(0))?new ie(0):rt.mul(new ie(36500/7)).div(yt),ne=R.div(new ie(10**a)).mul(T).mul(Pn),de=U.div(new ie(10**c)).mul($).mul(Pn),Oe=x.div(new ie(10**u)).mul(M).mul(Pn);return{feeAPR:vt,posRewarder0APR:ne,posRewarder1APR:de,posRewarder2APR:Oe}}function j2(e,t,n,i){const s=Math.max(e,n),r=Math.min(t,i)-s,a=t-e,c=i-n,u=new ie(a.toString()),l=new ie(c.toString()),d=new ie(r.toString());let h=new ie("0");return r<0?h=new ie("0"):a===r?h=l.div(d):c===r?h=d.div(u):h=d.mul(d).div(l).div(u),h}function z2(e){const{clmmpool:t,position:n,tickLower:i,tickUpper:s}=e,{current_tick_index:o,fee_growth_global_a:r,fee_growth_global_b:a}=t;console.log({currentTickIndex:o,feeGrowthGlobalAX64:r,feeGrowthGlobalBX64:a});const{tick_lower_index:c,tick_upper_index:u,liquidity:l,fee_owed_a:d,fee_owed_b:h,fee_growth_inside_a:g,fee_growth_inside_b:b}=n,{feeGrowthOutsideA:v,feeGrowthOutsideB:k}=i,{feeGrowthOutsideA:E,feeGrowthOutsideB:N}=s;let A=null,P=null;o<Number(c)?(A=Tt.subUnderflowU128(new y(r),new y(v)),P=Tt.subUnderflowU128(new y(a),new y(k))):(A=v,P=k);let B=null,W=null;o<Number(u)?(B=E,W=N):(B=Tt.subUnderflowU128(new y(r),new y(E)),W=Tt.subUnderflowU128(new y(a),new y(N)));const Q=Tt.subUnderflowU128(Tt.subUnderflowU128(new y(r),new y(A)),new y(B)),V=Tt.subUnderflowU128(Tt.subUnderflowU128(new y(a),new y(P)),new y(W)),ee=Tt.subUnderflowU128(new y(Q),new y(g)).mul(new y(l)).shrn(64),j=Tt.subUnderflowU128(new y(V),new y(b)).mul(new y(l)).shrn(64),R=new y(mt(d).add(mt(ee.toString())).toString()),U=new y(mt(h).add(mt(j.toString())).toString());return{feeOwedA:R,feeOwedB:U}}var Es=1e9,H2=5*60*1e3,Ga=24*60*60*1e3;function k0(e){return Date.parse(new Date().toString())+e}var K2=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getPoolImmutablesResource(t=!1){const n=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,i=`${n}_getMmutablesPools`,s=this.getCacheData(i);let o;if(!t&&s!=null)o=s;else{const r=Ot(n,Ey,Cy),a=await this._sdk.Resources.fetchAccountResource(n,r);o=JSON.parse(JSON.stringify(a==null?void 0:a.data)),this.updateCache(i,o,Ga)}return o}async getLaunchpadPools(t=[],n=0,i=100,s=null,o=!1){const r=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,a=[],u=(await this.getPoolImmutablesResource(o)).data.data,l=t.length>0;for(let d=0;d<u.length;d+=1){const h=u[d],{pool_address:g,creater_address:b,pool_type:v}=h.value;if(s==="fixed_price"&&v!==0||s==="fair_launch"&&v===0||l&&!t.includes(g))continue;if(!l){const V=Number(d);if(V<n||V>=n+i)continue}const k=h.key,E=Ot(k.coin_raise.account_address,ts(k.coin_raise.module_name),ts(k.coin_raise.struct_name)),N=Ot(k.coin_sale.account_address,ts(k.coin_sale.module_name),ts(k.coin_sale.struct_name)),A=Ni.buildLaunchpadPoolType(v===0,r,N,E),P={coin_type_sale:N,coin_type_raise:E,pool_type:A,pool_address:g,creator:b,pool_mode:v===0?"fixed_price":"fair_launch"},B=await this.getLaunchpadPoolState(P.pool_address,P.pool_type,P.pool_mode),W={...P,...B};await this.calculateLaunchpadPoolField(W),a.push(W);const Q=`${g}_pool`;this.updateCache(Q,W,Ga)}return a}async getLaunchpadPool(t,n=!0){const i=`${t}_pool`,s=this.getCacheData(i);let o;if(s!==null&&!n&&(o=s),o==null)return(await this.getLaunchpadPools([t]))[0];const r=await this.getLaunchpadPoolState(t,o.pool_type,o.pool_mode),a={...o,...r};return await this.calculateLaunchpadPoolField(a),this.updateCache(i,a,Ga),a}async getSpecifyCoinDecimals(t){const n={};(await this._sdk.Token.getSpecifyTokenListByCache(t)).forEach(r=>{n[r.address]=r.decimals});const s=t.filter(r=>n[r]===void 0);return(await this._sdk.Resources.getSpecifyCoinInfos(s)).forEach(r=>{n[r.coinAddress]=Number(r.decimals)}),n}async calculateLaunchpadPoolField(t){const n=await this.getSpecifyCoinDecimals([t.coin_type_sale,t.coin_type_raise]),i=Number(n[t.coin_type_sale]),s=Number(n[t.coin_type_raise]);if(t.initialize_price=Ni.priceFixToReal(t.initialize_price,i,s),Ni.isFixedPricePool(t))t.raise_total=Ni.raiseTotalAmount(t,i,s);else{t.raise_total=Ni.raiseTotalAmount(t,i,s);const r=mt(t.raise_coin_amount).div(mt(10).pow(mt(s))),a=mt(t.sale_total).div(mt(10).pow(mt(i)));a.toNumber()>0?t.price=r.div(a).toNumber():t.price=0}return Ni.updatePoolStaus(t),!0}async getLaunchpadPoolState(t,n,i,s=!0){const o=`${t}_${n}_getLaunchpadPoolState`;if(!s){const u=this.getCacheData(o);if(u!==null)return u}const r=await this._sdk.Resources.fetchAccountResource(t,n),a=JSON.parse(JSON.stringify(r==null?void 0:r.data)),c=Ni.buildLaunchpadFixedPoolState(i,a);return this.updateCache(o,c,Ga),c}async getOwnerLaunchpadCoins(t){const n=await this._sdk.Resources.getCoinStores(t),i=[];return n.forEach(s=>{const o=Gh(s.coinAddress);o.module===By&&i.push({coin_type_sale:o.type_arguments[0],coin_type_raise:o.type_arguments[1],coin_address:s.coinAddress,balance:Number(s.coin.value)})}),i}async getSimplePosition(t){const n=await this._sdk.Resources.fetchAccountResource(t,Ot(this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,"clmmProxy","LockedPosition")),i=JSON.parse(JSON.stringify(n==null?void 0:n.data));return{position_name:i.token_id.token_data_id.name,collection:i.token_id.token_data_id.collection,creator:i.token_id.token_data_id.creator,unlock_time:i.unlock_time,is_redeem:i.is_redeem}}async hasPoolWhitelist(t){const{launchpad:n}=this._sdk.sdkOptions.networkOptions,i={handle:"",exist:!1};try{const s=await this._sdk.Resources.fetchAccountResource(t,Ot(n.cetusLaunchpad,"whitelist","Whitelist")),o=JSON.parse(JSON.stringify(s==null?void 0:s.data));return i.exist=Number(o.users.length)>0,i.handle=o.users.inner.handle,i}catch(s){console.log(s)}return i}async inPoolWhitelist(t,n){if(!n.exist)return!1;try{return await this._sdk.client.getTableItem(n.handle,{key_type:"address",value_type:"u8",key:t}),!0}catch(i){console.log(i)}return!1}buildLaunchpadCoinType(t,n){return Ot(this._sdk.sdkOptions.networkOptions.launchpad.crowdCoin,"cscoin","CS",[t,n])}creatPoolTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s="is_admin"in t,o=`${i.cetusLaunchpad}::${Zi}`,r=s?t.is_admin?"create_crowdsale_pool_authority":"create_crowdsale_pool":"create_fairlaunch_pool",a=Ni.priceRealToFix(t.initialize_price,t.sale_decimals,t.raise_decimals);console.log("fixPrice:",a);const c=Yt.priceToSqrtPriceX64(mt(t.initialize_price),t.sale_decimals,t.raise_decimals).toString();return s?Ni.buildCreatCrowdsalePoolPayload(t,c,a,o,r,n):Ni.buildCreatFairlaunchPoolPayload(t,c,a,o,r,n)}updatePoolTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="update_pool";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),ce.bcsSerializeUint64(t.start_time),ce.bcsSerializeUint64(t.liquidity_rate*100),ce.bcsSerializeUint64(t.activity_duration),ce.bcsSerializeUint64(t.calmdown_duraction),ce.bcsSerializeUint64(t.settle_duration),ce.bcsSerializeUint64(t.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.start_time,t.liquidity_rate*100,t.activity_duration,t.calmdown_duraction,t.settle_duration,t.locked_duration];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}purchaseTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="purchase";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),ce.bcsSerializeUint64(t.raise_amount_in)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.raise_amount_in];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}revokeTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="revoke";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),ce.bcsSerializeUint64(t.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}settleTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o=t.pool_mode==="fixed_price",r=o?"crowd_sale_settle":"fair_launch_settle";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))];return o?new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,u,[])):new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r,u,[ce.bcsSerializeU128(BigInt(t.initialize_sqrt_price))]))}const a=Ot(s,r),c=[t.coin_type_sale,t.coin_type_raise];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:o?[]:[t.initialize_sqrt_price]}}claimTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="claim";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),ce.bcsSerializeUint64(t.cs_coin_amount)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr,t.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}claimFeeTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="claim_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}withdrawTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o=t.is_withdraw_sale?"withdraw_sale":"withdraw_raise";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}redeemPositionTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o="redeem_position";if(n){const c=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,c,[]))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:[]}}userToWhitelistTransactionPayload(t,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Zi}`,o=t.isAdd?"add_user_to_whitelist":"remove_user_from_whitelist";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.user_addr))];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coin_type_sale,t.coin_type_raise],c=[t.user_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}updateCache(t,n,i=H2){let s=this._cache[t];s?(s.overdueTime=k0(i),s.value=n):s=new Ju(n,k0(i)),this._cache[t]=s}getCacheData(t){const n=this._cache[t];return n!==void 0&&n.getCacheData()?n.value:null}};function G2(e,t,n,i){const s=e.shln(64),o=n.sub(t);return i?Tt.divRoundUp(s,o):s.div(o)}var Ni=class{static minSettlePurchaseAmount(t){return mt(t.sale_total).mul(t.initialize_price).mul(t.least_raise_rate).toNumber()}static get_sale_liquidity_amount(t,n,i,s,o,r){const a=Od.getMinIndex(t),c=Od.getMaxIndex(t),u=this.priceRealToFix(s,o,r),l=new y(n*u*i),d=new y(Yt.priceToSqrtPriceX64(mt(u),0,0).toString()),h=G2(l,Yt.tickIndexToSqrtPriceX64(a),d,!1);return s3(d,Yt.tickIndexToSqrtPriceX64(c),h,!0).toString()}static raiseTotalAmount(t,n,i){const s=mt(n-i).abs().toNumber();return n>i?Number(mt(t.sale_total).mul(t.initialize_price).div(mt(10).pow(mt(s))).toString()):Number(mt(t.sale_total).mul(t.initialize_price).mul(mt(10).pow(mt(s))).toString())}static priceRealToFix(t,n,i){const s=mt(n-i).toNumber();return Number(mt(t).div(mt(10).pow(mt(s))).toString())}static priceFixToReal(t,n,i){const s=mt(n-i).toNumber();return Number(mt(t).mul(mt(10).pow(mt(s))).toString())}static buildLaunchpadPoolType(t,n,i,s){return t?Ot(Ot(n,x2,T2),[i,s]):Ot(Ot(n,A2,k2),[i,s])}static isFixedPricePool(t){return t.pool_mode==="fixed_price"}static getFairLaunchSettleSqrtPrice(t,n,i){if(t.pool_status!=="Settle")throw new Error("The pool is not in settle ");const s=Yt.priceToSqrtPriceX64(mt(t.price),n,i).toString();return console.log("sqrtPrice: ",s.toString()),s.toString()}static async updatePoolStaus(t){const n=Ni.isFixedPricePool(t),i=Number(mt(Date.now()/1e3).toFixed(0));if(t.end_activity_time=Number(t.start_activity_time)+Number(t.activity_duration),n)if(t.end_settle_time=Number(t.end_activity_time)+Number(t.settle_duration),t.is_settle)t.pool_status="Ended";else if(i<Number(t.start_activity_time))t.pool_status="Upcoming";else if(i>=t.start_activity_time&&i<t.end_activity_time)t.pool_status="Live";else if(i>=t.end_activity_time&&i<t.end_settle_time){const s=t.raise_coin_amount,o=mt(t.raise_total).mul(mt(t.least_raise_rate)).toNumber();s<o?t.pool_status="Failed":t.pool_status="Settle"}else t.pool_status="Failed";else if(t.end_calm_down_time=Number(t.end_activity_time)+Number(t.calmdown_duration),t.end_settle_time=Number(t.end_calm_down_time)+Number(t.settle_duration),t.is_settle)t.pool_status="Ended";else if(i<Number(t.start_activity_time))t.pool_status="Upcoming";else if(i>=t.start_activity_time&&i<t.end_activity_time)t.pool_status="Live";else if(i>=t.end_activity_time&&i<t.end_calm_down_time)t.pool_status="Calmdown";else if(i>=t.end_calm_down_time&&i<t.end_settle_time){const s=t.raise_coin_amount,o=mt(t.raise_total).mul(mt(t.least_raise_rate)).toNumber();s<o?t.pool_status="Failed":t.pool_status="Settle"}else t.pool_status="Failed";return!0}static buildLaunchpadFixedPoolState(t,n){return t==="fixed_price"?{sale_coin_amount:n.sale_coin.value,raise_coin_amount:n.raise_coin.value,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,initialize_price:Number(n.initialize_price)/Es,initialize_sqrt_price:BigInt(n.initialize_sqrt_price),is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_rate)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,sale_total:n.sale_total,raise_total:0,settle_duration:n.settle_duration,start_activity_time:n.start_time,unused_raise:n.unused_raise,unused_sale:n.unused_sale,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_settle_time:0}:{price:0,sale_coin_amount:0,raise_coin_amount:n.raise_coin.value,sale_total:n.sale_coin.value,raise_total:0,calmdown_duration:n.calmdown_duration,initialize_price:Number(n.price)/Es,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_amount)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,settle_duration:n.settle_duration,start_activity_time:n.start_time,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_calm_down_time:0,end_settle_time:0}}static buildCreatCrowdsalePoolPayload(t,n,i,s,o,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],d=t.is_admin?[ce.bcsSerializeU128(i*Es),ce.bcsSerializeU128(BigInt(n)),ce.bcsSerializeUint64(t.tick_spacing),ce.bcsSerializeUint64(t.sale_total),ce.bcsSerializeUint64(t.start_time),ce.bcsSerializeUint64(t.least_raise_rate*100),ce.bcsSerializeUint64(t.activity_duration),ce.bcsSerializeUint64(t.settle_duration),ce.bcsSerializeUint64(t.locked_duration),ce.bcsSerializeU8(0)]:[ce.bcsSerializeU128(i*Es),ce.bcsSerializeU128(BigInt(n)),ce.bcsSerializeUint64(t.tick_spacing),ce.bcsSerializeUint64(t.sale_total),ce.bcsSerializeUint64(t.start_time),ce.bcsSerializeUint64(t.least_raise_rate*100),ce.bcsSerializeUint64(t.liquidity_rate*100),ce.bcsSerializeUint64(t.activity_duration),ce.bcsSerializeUint64(t.settle_duration),ce.bcsSerializeUint64(t.locked_duration),ce.bcsSerializeU8(0)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,l,d))}const a=Ot(s,o),c=[t.coin_type_sale,t.coin_type_raise],u=t.is_admin?[i*Es,n,t.tick_spacing,t.sale_total,t.start_time,t.least_raise_rate*100,t.activity_duration,t.settle_duration,t.locked_duration,0]:[i*Es,n,t.tick_spacing,t.sale_total,t.start_time,t.least_raise_rate*100,t.liquidity_rate*100,t.activity_duration,t.settle_duration,t.locked_duration,0];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}static buildCreatFairlaunchPoolPayload(t,n,i,s,o,r=!1){if(r){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_sale)),new F.TypeTagStruct(F.StructTag.fromString(t.coin_type_raise))],d=[ce.bcsSerializeU128(i*Es),ce.bcsSerializeU128(BigInt(n)),ce.bcsSerializeUint64(t.tick_spacing),ce.bcsSerializeUint64(t.sale_total),ce.bcsSerializeUint64(t.start_time),ce.bcsSerializeUint64(t.least_raise_rate*100),ce.bcsSerializeUint64(t.liquidity_rate*100),ce.bcsSerializeUint64(t.activity_duration),ce.bcsSerializeUint64(t.calmdown_duraction),ce.bcsSerializeUint64(t.settle_duration),ce.bcsSerializeUint64(t.locked_duration)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,l,d))}const a=Ot(s,o),c=[t.coin_type_sale,t.coin_type_raise],u=[i*Es,n,t.tick_spacing,t.sale_total,t.start_time,t.liquidity_rate*100,ce.bcsSerializeUint64(t.least_raise_rate*100),t.activity_duration,t.calmdown_duraction,t.settle_duration,t.locked_duration];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}};function W2(e){let t;switch(e){case 5:t=5;break;case 10:t=10;break;case 20:t=20;break;case 25:t=25;break;case 50:t=50;break;case 100:t=100;break;default:t=1}const n=100/t+1,i=new Array(n);for(let s=0;s<n;s+=1)i[s]=s*t;return i}function fc(e,t){const n=W2(t),i=new Array(n.length);for(let s=0;s<n.length;s+=1)i[s]=e.muln(n[s]).divn(100);return i}function V2(e,t,n,i){for(let s=t;s<e;s+=1)n.amountInArray[s]=n.amountInArray[s].add(i.amountIn),n.amountOutArray[s]=n.amountOutArray[s].add(i.amountOut),n.feeAmountArray[s]=n.feeAmountArray[s].add(i.feeAmount);return n}function X2(e,t,n,i,s){let o=new y(i.liquidity),{currentSqrtPrice:r}=i,a={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]};n.forEach(()=>{a.amountInArray.push(Ie),a.amountOutArray.push(Ie),a.feeAmountArray.push(Ie),a.nextSqrtPriceArray.push(Ie)});let c,u;const l=Rc.getDefaultSqrtPriceLimit(e),d=n.length;let h=n[1],g=1,b;e?b=s.sort((v,k)=>k.index-v.index):b=s.sort((v,k)=>v.index-k.index);for(const v of b){if(e){if(i.currentTickIndex<v.index)continue}else if(i.currentTickIndex>v.index)continue;if(v===null)continue;e&&l.gt(v.sqrtPrice)||!e&&l.lt(v.sqrtPrice)?c=l:c=v.sqrtPrice;let k={amountIn:Ie,amountOut:Ie,nextSqrtPrice:Ie,feeAmount:Ie};const E=r,N=o;let A=h,P=g;for(let B=g;B<d;B+=1){const W=Uy(r,c,o,h,new y(i.feeRate),t);if(k=W,W.amountIn.eq(Ie)||(h=t?h.sub(W.amountIn.add(W.feeAmount)):h.sub(W.amountOut)),h.eq(Ie))a.amountInArray[B]=a.amountInArray[B].add(W.amountIn),a.amountOutArray[B]=a.amountOutArray[B].add(W.amountOut),a.feeAmountArray[B]=a.feeAmountArray[B].add(W.feeAmount),W.nextSqrtPrice.eq(v.sqrtPrice)?(u=e?v.liquidityNet.mul(new y(-1)):v.liquidityNet,o=u.gt(Ie)?o.add(u):o.sub(u.abs()),r=v.sqrtPrice):r=W.nextSqrtPrice,a.amountInArray[B]=a.amountInArray[B].add(a.feeAmountArray[B]),a.nextSqrtPriceArray[B]=r,o=N,r=E,B!==d-1&&(h=A.add(n[B+1].sub(n[P]))),g+=1;else{a=V2(d,B,a,W),A=h,P=g;break}}if(g===d)break;k.nextSqrtPrice.eq(v.sqrtPrice)?(u=e?v.liquidityNet.mul(new y(-1)):v.liquidityNet,o=u.gt(Ie)?o.add(u):o.sub(u.abs()),r=v.sqrtPrice):r=k.nextSqrtPrice}return t?n.forEach((v,k)=>{a.isExceed.push(a.amountInArray[k].lt(v))}):n.forEach((v,k)=>{a.isExceed.push(a.amountOutArray[k].lt(v))}),a}var J2=class{constructor(e,t,n,i,s,o){this.minSplitUnit=t,this.a2b=i,this.byAmountIn=s,this.clmmpool=n,this.ticks=o,this.amountArray=[],this.createSplitSwapParams=this.createSplitSwapParams.bind(this),this.createSplitSwapParams(e,t),this.splitSwapResult={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]},this.computeSwap=this.computeSwap.bind(this)}createSplitSwapParams(e,t){const n=fc(e,t);this.amountArray=n}computeSwap(){const e=ky(this.clmmpool);return this.splitSwapResult=X2(this.a2b,this.byAmountIn,this.amountArray,e,this.ticks),this.splitSwapResult}},Od=class{static getMinIndex(t){return T0+Math.abs(T0)%t}static getMaxIndex(t){return x0-x0%t}};function Z2(e,t,n,i,s,o){const r=e.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];t!==null&&(e.current_tick_index<i?u=o[c].sub(new y(t.rewardersGrowthOutside[c])):u=t.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(e.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Tt.subUnderflowU128(Tt.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function Y2(e){if(e){const t={};return e.maxGasAmount&&(t.maxGasAmount=BigInt(e.maxGasAmount)),e.gasUnitPrice&&(t.gasUnitPrice=BigInt(e.gasUnitPrice)),e.expireTimestamp&&(t.expireTimestamp=BigInt(e.expireTimestamp)),t}}function Q2(e,t){return new dc(i=>{const s=new Uint8Array(64);return new F.Ed25519Signature(s)},e.toUint8Array()).sign(t)}function e3(e){if(e){const t={};return e.maxGasAmount&&(t.max_gas_amount=e.maxGasAmount.toString()),e.gasUnitPrice&&(t.gas_unit_price=e.gasUnitPrice.toString()),e.expireTimestamp&&(t.expiration_timestamp_secs=e.expireTimestamp.toString()),t}}async function t3(e,t,n,i,s=!0){if(n instanceof F.TransactionPayload){const l=await e.generateRawTransaction(t.address,n,Y2(i)),d=Q2(t.pubkey,l),h=await e.submitBCSSimulation(d);return s&&console.log(h[0]),h[0]}const o=n,r=await e.generateTransaction(t.address,o,e3(i)),a={type:"ed25519_signature",public_key:t.pubkey.hex(),signature:$t.fromUint8Array(new Uint8Array(64)).hex()},c={sender:t.address.hex(),sequence_number:r.sequence_number.toString(),max_gas_amount:r.max_gas_amount.toString(),gas_unit_price:r.gas_unit_price.toString(),expiration_timestamp_secs:r.expiration_timestamp_secs.toString(),payload:o,signature:a},u=await e.client.transactions.simulateTransaction(c);return s&&console.log(u[0]),u[0]}async function Wa(e,t,n,i){return t3(e,t,n,i,!1)}function S0(e,t){const n=new ce.Serializer;n.serializeU32AsUleb128(e.length);const i=n[t];return e.forEach(s=>{n.serializeU32AsUleb128(s.length),s.forEach(o=>{i.call(n,o)})}),n.getBytes()}function n3(e){const t=new ce.Serializer;return t.serializeU32AsUleb128(e.length),e.forEach(n=>{t.serializeU32AsUleb128(n.length),n.forEach(i=>{i.serialize(t)})}),t.getBytes()}function i3(e){const t=new ce.Serializer;return t.serializeU32AsUleb128(e.length),e.forEach(n=>{n.serialize(t)}),t.getBytes()}function s3(e,t,n,i){const s=e.gt(t)?e.sub(t):t.sub(e),o=n.mul(s).shln(64),r=e.mul(t),a=o.div(r),c=o.mod(r);return i&&!c.eq(Ie)?a.add(new y(1)):a}function Ry(e,t,n,i){if(n.eq(Ie))return e;const s=Tt.checkMulShiftLeft(e,t,64,256),o=t.shln(64),r=Tt.checkMul(e,n,256);if(!i&&o.lte(r))throw new zn("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Tt.checkDivRoundUpIf(s,o.add(r),!0):Tt.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(Yu)))throw new zn("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(Zu)))throw new zn("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function $y(e,t,n,i){const s=Tt.checkDivRoundUpIf(n.shln(64),t,!i),o=i?e.add(s):e.sub(s);if(o.lt(new y(Yu))||o.gt(new y(Zu)))throw new zn("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function o3(e,t,n,i){return i?Ry(e,t,n,!0):$y(e,t,n,!0)}function r3(e,t,n,i){return i?$y(e,t,n,!1):Ry(e,t,n,!1)}function P0(e,t,n,i){const s=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(Ie)||s.eq(Ie))return Ie;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=t.mul(e),c=r.div(a);o=r.mod(a).eq(Ie)?c:c.add(no)}else{const r=new y(n).mul(new y(s));o=r.and(Oc).gt(Ie)?r.shrn(64).add(no):r.shrn(64)}return o}function E0(e,t,n,i){const s=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(Ie)||s.eq(Ie))return Ie;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=t.mul(e);o=r.div(a)}return o}function Uy(e,t,n,i,s,o){if(n===Ie)return{amountIn:Ie,amountOut:Ie,nextSqrtPrice:t,feeAmount:Ie};const r=e.gte(t);let a,c,u,l;if(o){const d=Tt.checkMulDivFloor(i,Tt.checkUnsignedSub(jo,s),jo,64),h=P0(e,t,n,r);h.gt(d)?(a=d,l=Tt.checkUnsignedSub(i,d),u=o3(e,n,d,r)):(a=h,l=Tt.checkMulDivCeil(a,s,jo.sub(s),64),u=t),c=E0(e,u,n,r)}else{const d=E0(e,t,n,r);d.gt(i)?(c=i,u=r3(e,n,i,r)):(c=d,u=t),a=P0(e,u,n,r),l=Tt.checkMulDivCeil(a,s,jo.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function a3(e,t,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:Ie,amountOut:Ie,feeAmount:Ie,refAmount:Ie,nextSqrtPrice:Ie,crossTickNum:0};let u,l;const d=Rc.getDefaultSqrtPriceLimit(e);for(const h of s){if(e){if(i.currentTickIndex<h.index)continue}else if(i.currentTickIndex>h.index)continue;if(h===null)continue;e&&d.gt(h.sqrtPrice)||!e&&d.lt(h.sqrtPrice)?u=d:u=h.sqrtPrice;const g=Uy(a,u,r,o,new y(i.feeRate),t);if(g.amountIn.eq(Ie)||(o=t?o.sub(g.amountIn.add(g.feeAmount)):o.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(h.sqrtPrice)?(l=e?h.liquidityNet.mul(new y(-1)):h.liquidityNet,r=l.gt(Ie)?r.add(l):r.sub(l.abs()),a=h.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,o.eq(Ie))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function zo(e,t,n){const i=y.min(e,t),s=y.max(e,t),o=Tt.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Ho(e,t,n){const i=y.min(e,t),o=y.max(e,t).sub(i);return n.shln(64).div(o)}var Ci=class{constructor(){}static getFeeRate(t){return $c.fromFraction(t,1e6)}static updateFeeRate(t,n,i,s,o){const r=Tt.checkMulDivCeil(n,new y(s),jo,64),a=i===0?Ie:Tt.checkMulDivFloor(n,new y(i),jo,64),c=n.mul(r).mul(a);if(o?t.feeProtocolCoinA=t.feeProtocolCoinA.add(r):t.feeProtocolCoinB=t.feeProtocolCoinB.add(r),c.eq(Ie)||t.liquidity.eq(Ie))return{refFee:a,clmm:t};const u=c.shln(64).div(t.liquidity);return o?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(u):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(u),{refFee:a,clmm:t}}static getProtocolFeeRate(t){return $c.fromFraction(t,1e4)}static getCoinAmountFromLiquidity(t,n,i,s,o){const r=new ri(t.toString()),a=new ri(n.toString()),c=new ri(i.toString()),u=new ri(s.toString());let l,d;return n.lt(i)?(l=Tt.toX64_Decimal(r).mul(u.sub(c)).div(c.mul(u)),d=new ri(0)):n.lt(s)?(l=Tt.toX64_Decimal(r).mul(u.sub(a)).div(a.mul(u)),d=Tt.fromX64_Decimal(r.mul(a.sub(c)))):(l=new ri(0),d=Tt.fromX64_Decimal(r.mul(u.sub(c)))),o?{coinA:new y(l.ceil().toString()),coinB:new y(d.ceil().toString())}:{coinA:new y(l.floor().toString()),coinB:new y(d.floor().toString())}}static estimateLiquidityFromcoinAmounts(t,n,i,s){if(n>i)throw new Error("lower tick cannot be greater than lower tick");const o=Yt.sqrtPriceX64ToTickIndex(t),r=Yt.tickIndexToSqrtPriceX64(n),a=Yt.tickIndexToSqrtPriceX64(i);if(o<n)return zo(r,a,s.coinA);if(o>=i)return Ho(a,r,s.coinB);const c=zo(t,a,s.coinA),u=Ho(t,r,s.coinB);return y.min(c,u)}static estLiquidityAndcoinAmountFromOneAmounts(t,n,i,s,o,r,a){const c=Yt.sqrtPriceX64ToTickIndex(a),u=Yt.tickIndexToSqrtPriceX64(t),l=Yt.tickIndexToSqrtPriceX64(n);let d;if(c<t){if(!s)throw new Error("lower tick cannot calculate liquidity by coinB");d=zo(u,l,i)}else if(c>n){if(s)throw new Error("upper tick cannot calculate liquidity by coinA");d=Ho(l,u,i)}else s?d=zo(a,l,i):d=Ho(a,u,i);const h=Ci.getCoinAmountFromLiquidity(d,a,u,l,o),g=h.coinA.mul(new y(1+r)),b=h.coinB.mul(new y(1+r));return{tokenMaxA:g,tokenMaxB:b,liquidityAmount:d}}static estCoinAmountsFromTotalAmount(t,n,i,s,o,r){const{ratioA:a,ratioB:c}=Ci.calculateDepositRatioFixTokenA(t,n,i);console.log({ratioA:a,ratioB:c});const u=mt(s).mul(a).div(o),l=mt(s).mul(c).div(r);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(t,n,i){const s=new y(1),{tokenMaxB:o}=Ci.estLiquidityAndcoinAmountFromOneAmounts(t,n,s,!0,!0,0,i),r=Yt.sqrtPriceX64ToPrice(i,0,0),a=mt(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=mt(o.toString()).div(c);return{ratioA:u,ratioB:l}}},c3=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async fetchAccountResource(t,n,i=0){let s=this._cache[t+n];if(s!=null&&s.getCacheData())return s.value;const o=await this.sdk.Resources.fetchAccountResource(t,n);return s=new Ju(o,i),this._cache[t+n]=s,o}calculateRates(t){const{currentPool:n}=t,i=ky(n);let s;t.a2b?s=t.swapTicks.sort((h,g)=>g.index-h.index):s=t.swapTicks.sort((h,g)=>h.index-g.index);const o=a3(t.a2b,t.byAmountIn,t.amount,i,s);let r=!1;t.byAmountIn?r=o.amountIn.lt(t.amount):r=o.amountOut.lt(t.amount);const a=Rc.getDefaultSqrtPriceLimit(t.a2b);t.a2b&&o.nextSqrtPrice.lt(a)&&(r=!0),!t.a2b&&o.nextSqrtPrice.gt(a)&&(r=!0);let c=0;o.crossTickNum>6&&o.crossTickNum<40&&(c=22e3*(o.crossTickNum-6)),o.crossTickNum>40&&(r=!0);const u=Yt.sqrtPriceX64ToPrice(i.currentSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),l=Yt.sqrtPriceX64ToPrice(o.nextSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),d=Math.abs(u-l)/u*100;return{estimatedAmountIn:o.amountIn,estimatedAmountOut:o.amountOut,estimatedEndSqrtPrice:o.nextSqrtPrice,estimatedFeeAmount:o.feeAmount,isExceed:r,extraComputeLimit:c,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn,priceImpactPct:d}}transformSwapData(t){const{modules:n}=this._sdk.sdkOptions.networkOptions,i=t.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.ClmmIntegrate}::calculator::CalculatedSwapResult`);return i.length===0?[]:i[0].data.data.data||[]}async preswap(t){const{modules:n,simulationAccount:i}=this.sdk.sdkOptions.networkOptions,s=new cn(this.sdk.sdkOptions.rpcUrl),o=`${n.ClmmIntegrate}::scripts`,r="calculate_swap_result",a=[new F.TypeTagStruct(F.StructTag.fromString(t.pool.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.pool.coinTypeB))],c=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool.poolAddress)),ce.bcsSerializeBool(t.a2b),ce.bcsSerializeBool(t.by_amount_in),ce.bcsSerializeUint64(BigInt(t.amount))],u=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,a,c)),l=yr(i.address),d=await s.generateRawTransaction(l,u),h=yr(i.pubkey),g=new F.Ed25519PublicKey(h.toUint8Array()),b=await s.simulateTransaction(g,d),v=this.transformSwapData(b[0].changes),k=Yt.sqrtPriceX64ToPrice(new y(t.pool.current_sqrt_price),t.decimalsA,t.decimalsB).toNumber(),E=Yt.sqrtPriceX64ToPrice(new y(v.after_sqrt_price),t.decimalsA,t.decimalsB).toNumber(),N=Math.abs(k-E)/k*100;return{estimatedAmountIn:v.amount_in&&v.fee_amount?new y(v.amount_in).add(new y(v.fee_amount)).toString():"",estimatedAmountOut:v.amount_out,estimatedEndSqrtPrice:v.after_sqrt_price,estimatedFeeAmount:v.fee_amount,isExceed:v.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.by_amount_in,priceImpactPct:N}}createSwapTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Js}`,o="swap",r=Rc.getDefaultSqrtPriceLimit(t.a_to_b);if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_addr)),ce.bcsSerializeBool(t.a_to_b),ce.bcsSerializeBool(t.by_amount_in),ce.bcsSerializeUint64(BigInt(t.amount)),ce.bcsSerializeUint64(BigInt(t.amount_limit)),ce.bcsSerializeU128(BigInt(r.toString())),ce.bcsSerializeStr(t.partner)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const a=[t.pool_addr,t.a_to_b,t.by_amount_in,t.amount,t.amount_limit,r.toString(),t.partner],c=[t.coinTypeA,t.coinTypeB];return{type:"entry_function_payload",function:Ot(s,o),type_arguments:c,arguments:a}}},u3=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}createAddLiquidityTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=!("delta_liquidity"in t),o=`${i.LiquidswapDeployer}::${Js}`,r=s?"add_liquidity_fix_token":"add_liquidity";if(n){const d=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],h=s?[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeUint64(Number(t.amount_a)),ce.bcsSerializeUint64(Number(t.amount_b)),ce.bcsSerializeBool(t.fix_amount_a),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper))),ce.bcsSerializeBool(t.is_open),ce.bcsSerializeUint64(t.index)]:[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeU128(t.delta_liquidity.toNumber()),ce.bcsSerializeUint64(Number(t.max_amount_a)),ce.bcsSerializeUint64(Number(t.max_amount_b)),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper))),ce.bcsSerializeBool(t.is_open),ce.bcsSerializeUint64(t.index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,d,h))}const a=BigInt.asUintN(64,BigInt(t.tick_lower)).toString(),c=BigInt.asUintN(64,BigInt(t.tick_upper)).toString(),u=s?[t.pool,t.amount_a,t.amount_b,t.fix_amount_a,a,c,t.is_open,t.index]:[t.pool,t.delta_liquidity.toString(),String(t.max_amount_a),String(t.max_amount_b),a,c,t.is_open,t.index],l=[t.coinTypeA,t.coinTypeB];return{type:"entry_function_payload",function:Ot(o,r),type_arguments:l,arguments:u}}removeLiquidityTransactionPayload(t,n=!1){HS(t.delta_liquidity.gtn(0));const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Js}`,o=`${i.ClmmIntegrate}::${Iy}`,r=["remove_liquidity","remove_all_liquidity","remove_all_liquidity_for_two","remove_all_liquidity_for_three"];let a,c,u=[];if(t.rewards_num===0){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],d=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeU128(t.delta_liquidity.toNumber()),ce.bcsSerializeUint64(t.min_amount_a),ce.bcsSerializeUint64(t.min_amount_b),ce.bcsSerializeUint64(t.pos_index),ce.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,r[0],l,d))}a=Ot(s,r[0]),c=[t.coinTypeA,t.coinTypeB],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else if(t.rewards_num===1){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC))],d=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeU128(t.delta_liquidity.toNumber()),ce.bcsSerializeUint64(t.min_amount_a),ce.bcsSerializeUint64(t.min_amount_b),ce.bcsSerializeUint64(t.pos_index),ce.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[1],l,d))}a=Ot(o,r[1]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else if(t.rewards_num===2){if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD))],d=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeU128(t.delta_liquidity.toNumber()),ce.bcsSerializeUint64(t.min_amount_a),ce.bcsSerializeUint64(t.min_amount_b),ce.bcsSerializeUint64(t.pos_index),ce.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[2],l,d))}a=Ot(o,r[2]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}else{if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeE))],d=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeU128(t.delta_liquidity.toNumber()),ce.bcsSerializeUint64(t.min_amount_a),ce.bcsSerializeUint64(t.min_amount_b),ce.bcsSerializeUint64(t.pos_index),ce.bcsSerializeBool(t.is_close)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r[3],l,d))}a=Ot(o,r[3]),c=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD,t.coinTypeE],u=[t.pool,t.delta_liquidity.toNumber(),t.min_amount_a,t.min_amount_b,t.pos_index,t.is_close]}return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}closePositionTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Js}`,o="close_position";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),ce.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coinTypeA,t.coinTypeB],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectFeeTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Js}`,o="collect_fee";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool)),ce.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coinTypeA,t.coinTypeB],c=[t.pool,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}};function l3(e){let t="";const i=new Vu(e).parseTypeTag().value.type_args;if(i.length>0){const s=i[0];s.value.name.value===w2||s.value.name.value===By?t=C2(s).lpAddress:t=Ot($t.fromUint8Array(s.value.address.address).toShortString(),s.value.module_name.value,s.value.name.value,[])}return t}var d3=5*60*1e3,Yi=24*60*60*1e3;function C0(e){return Date.parse(new Date().toString())+e}var h3=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getPoolImmutablesResource(e=!1){const t=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,n=`${t}_getMmutablesPools`,i=this.getCacheData(n);let s;if(!e&&i!=null)s=i;else{const r=Ot(t,Ey,Cy),a=await this.fetchAccountResource(t,r);s=JSON.parse(JSON.stringify(a==null?void 0:a.data.data)),this.updateCache(n,s,Yi)}return s.data}buildPoolImmutables(e,t,n){const i=n.key,s=Ot(i.coin_type_a.account_address,ts(i.coin_type_a.module_name),ts(i.coin_type_a.struct_name)),o=Ot(i.coin_type_b.account_address,ts(i.coin_type_b.module_name),ts(i.coin_type_b.struct_name)),r=Ot(Ot(t,b2,v2),[s,o]);return{coinTypeA:s,coinTypeB:o,poolType:r,poolAddress:e,tickSpacing:i.tick_spacing}}async getPoolImmutables(e=[],t=0,n=100,i=!0){const s=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,o=[],r=await this.getPoolImmutablesResource(i),a=e.length>0;for(let c=0;c<r.length;c+=1){const u=r[c],l=u.value;if(!(a&&!e.includes(l))){if(!a){const d=Number(c);if(d<t||d>=t+n)continue}o.push(this.buildPoolImmutables(l,s,u))}}return o}async getPools(e=[],t=0,n=100){const i=[],s=(await this.sdk.getGlobalConfig()).is_pause,o=await this.getPoolImmutables(e,t,n,!1);for(let r=0;r<o.length;r+=1){const a=o[r],c=await this.getPoolState(a.poolAddress,a.poolType,s),u={...a,...c};i.push(u);const l=`${a.poolAddress}_pool`;this.updateCache(l,u,Yi)}return i}async getPool(e,t=!0){const n=`${e}_pool`,i=this.getCacheData(n);let s;if(i!==null&&!t&&(s=i),s==null)return(await this.getPools([e]))[0];const o=(await this.sdk.getGlobalConfig(!0)).is_pause,r=await this.getPoolState(e,s.poolType,o),a={...s,...r};return this.updateCache(n,a,Yi),a}async getPoolState(e,t,n,i=!0){const s=`${e}_${t}getPool`;if(!i){const l=this.getCacheData(s);if(l!==null)return l}const o=await this.fetchAccountResource(e,t),r=JSON.parse(JSON.stringify(o==null?void 0:o.data)),a=r.rewarder_infos,c=[];a.forEach(l=>{const d=Ot(l.coin_type.account_address,ts(l.coin_type.module_name),ts(l.coin_type.struct_name)),h=Tt.fromX64(new y(l.emissions_per_second)),g=Math.floor(h.toNumber()*60*60*24);c.push({...l,coinAddress:d,emissionsEveryDay:g})});const u={coinAmountA:r.coin_a.value,coinAmountB:r.coin_b.value,current_sqrt_price:r.current_sqrt_price,current_tick_index:Number(BigInt.asIntN(64,BigInt(r.current_tick_index.bits)).toString()),fee_growth_global_a:r.fee_growth_global_a,fee_growth_global_b:r.fee_growth_global_b,fee_protocol_coin_a:r.fee_protocol_coin_a,fee_protocol_coin_b:r.fee_protocol_coin_b,fee_rate:r.fee_rate,liquidity:r.liquidity,index:r.index,positionIndex:r.position_index,tick_indexes_handle:r.tick_indexes.handle,ticks_handle:r.ticks.handle,positions_handle:r.positions.handle,collectionName:r.collection_name,uri:r.uri,is_pause:n||r.is_pause,rewarder_infos:c,rewarder_last_updated_time:r.rewarder_last_updated_time};return this.updateCache(s,u,Yi),u}async getTickDataByIndex(e,t){const n=await this._sdk.client.getTableItem(e,{key_type:`${this.sdk.sdkOptions.networkOptions.modules.IntegerMate}::i64::I64`,value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Tick`,key:m2(t)}),i=JSON.parse(JSON.stringify(n));return{index:i.index,sqrtPrice:i.sqrt_price,liquidityGross:i.liquidity_gross,liquidityNet:i.liquidity_net,feeGrowthOutsideA:i.fee_growth_outside_a,feeGrowthOutsideB:i.fee_growth_outside_b,rewardersGrowthOutside:i.rewarders_growth_outside}}async getPoolLowerAndUpperTicks(e,t){const n=[],i=[],s=t.ticks_handle,o=await this.sdk.Resources.getPositionList(e,[t]);for(const r of o){const a=await this.sdk.Resources.getTickDataByIndex(s,r.tick_lower_index),c=await this.sdk.Resources.getTickDataByIndex(s,r.tick_upper_index);n.push(a),i.push(c)}return[n,i]}async getPositionInfoByIndex(e,t){const n=await this._sdk.client.getTableItem(e,{key_type:"u64",value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Position`,key:t.toString()}),i=JSON.parse(JSON.stringify(n));return{name:"",pool:i.pool,liquidity:i.liquidity,tick_lower_index:BigInt.asIntN(64,BigInt(i.tick_lower_index.bits)).toString(),tick_upper_index:BigInt.asIntN(64,BigInt(i.tick_upper_index.bits)).toString(),fee_growth_inside_a:i.fee_growth_inside_a,fee_growth_inside_b:i.fee_growth_inside_b,fee_owed_a:i.fee_owed_a,fee_owed_b:i.fee_owed_b,reward_amount_owed_0:i.rewarder_infos[0].amount_owed,reward_amount_owed_1:i.rewarder_infos[1].amount_owed,reward_amount_owed_2:i.rewarder_infos[2].amount_owed,reward_growth_inside_0:i.rewarder_infos[0].growth_inside,reward_growth_inside_1:i.rewarder_infos[1].growth_inside,reward_growth_inside_2:i.rewarder_infos[2].growth_inside,index:t}}createPositionName(e,t){return`Cetus LP | Pool${e}-${t}`}async getPositionInfo(e,t,n=!0){if(M2(t)){const i=await this.getPositionInfoByIndex(e.positions_handle,Number(t));return i.name=this.createPositionName(e.index,i.index),i}return this.getPositionInfoByTokenName(e.poolAddress,e.positions_handle,e.collectionName,t,n)}async getPositionIndex(e,t,n,i=!1){const s=`${e}_${t}_${n}_getPositionIndex`;if(!i){const a=this.getCacheData(s);if(a!==null)return a}const o=await this._sdk.tokenClient.getTokenData(e,t,n),r=JSON.parse(JSON.stringify(o)).default_properties.data.index.value;return this.updateCache(s,r,Yi),r}async getPositionInfoByTokenName(e,t,n,i,s=!0){const o=`${e}_${n}_${i}_getPositionInfo`;if(!s){const c=this.getCacheData(o);if(c!==null)return c}const r=await this.getPositionIndex(e,n,i,!1),a=await this.getPositionInfoByIndex(t,r);return a.name=i,this.updateCache(o,a,Yi),a}async getGlobalConfig(e,t=!0){const n=`${e}_getGlobalConfig`;if(!t){const r=this.getCacheData(n);if(r!==null)return r}const i=await this.fetchAccountResource(e,Ot(e,"config","GlobalConfig")),s=JSON.parse(JSON.stringify(i)).data,o={protocol_fee_rate:s.protocol_fee_rate,is_pause:s.is_pause};return this.updateCache(n,o,Yi),o}async getSpecifyCoinInfos(e){const t=[];for(const n of e){const i=`${n}_getCoinInfos`,s=this.getCacheData(i);if(s!==null)t.push(s);else{const o=Gh(n).address,r=await this._sdk.Resources.fetchAccountResource(o,I2(n));if(r!=null){const a={coinAddress:n,...r.data};t.push(a),this.updateCache(i,a,Yi)}}}return t}async getCoinInfos(e,t=!0){const n=`${e}_getCoinInfos`;if(!t){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(e),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(Sy)){const r=l3(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Yi),s}async getCoinStores(e,t=!0){const n=`${e}_getCoinStores`;if(!t){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(e),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(Py)){const r=v0(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Yi),s}async getCoinStore(e,t){const n=await this.fetchAccountResource(e,B2(t));if(n){const i=v0(n.type);if(i.length>0)return{coinAddress:i,...n.data}}return null}async getPositionList(e,t){const n=[];if(t.length===0)return[];const i=await this.getFilterTokenEvent(e);for(let s=0;s<i.length;s++){const o=i[s];try{for(const r of t)if(o.creator===r.poolAddress){const a=await this.getPositionInfoByTokenName(o.creator,r.positions_handle,o.collection,o.name);a.pool.length>0&&n.push({...o,...a})}}catch(r){console.log(r)}}return n}async getCollectionList(e){return await this.getFilterTokenEvent(e)}async getFilterTokenEvent(e){const t=[],n=[];let i=[];try{i=await this._sdk.client.getEventsByEventHandle(e,w0,"deposit_events")}catch(o){console.log(o)}i.forEach(o=>{t.push({key:`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`,creator:o.data.id.token_data_id.creator,name:o.data.id.token_data_id.name,collection:o.data.id.token_data_id.collection,count:0})});let s=[];try{s=await this._sdk.client.getEventsByEventHandle(e,w0,"withdraw_events")}catch(o){console.log(o)}return s.forEach(o=>{if(o.type===y2){for(const r of t)if(r.count===0&&r.key===`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`){r.count-=1;break}}}),t.forEach(o=>{o.count===0&&n.push({...o})}),n}async fetchAccountResource(e,t){var n;try{return await this._sdk.client.getAccountResource(e,t)}catch(i){if(A0(i)&&((n=i.response)==null?void 0:n.status)===404)return null;throw i}}async fetchAccountResources(e){var t;try{return await this._sdk.client.getAccountResources(e)}catch(n){if(A0(n)&&((t=n.response)==null?void 0:t.status)===404)return null;throw n}}updateCache(e,t,n=d3){let i=this._cache[e];i?(i.overdueTime=C0(n),i.value=t):i=new Ju(t,C0(n)),this._cache[e]=i}getCacheData(e){const t=this._cache[e];return t!==void 0&&t.getCacheData()?t.value:null}},f3=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}creatPoolTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=t.delta_liquidity.gt(Ie),o=s?`${i.LiquidswapDeployer}::${Iy}`:`${i.LiquidswapDeployer}::${Js}`,r=s?"create_and_add_liquidity":"create_pool";if(n){const l=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB))],d=s?[ce.bcsSerializeUint64(t.tick_spacing),ce.bcsSerializeU128(BigInt(t.initialize_sqrt_price.toString())),ce.bcsSerializeStr(t.uri),ce.bcsSerializeU128(BigInt(t.delta_liquidity.toString())),ce.bcsSerializeUint64(BigInt(t.max_amount_a.toString())),ce.bcsSerializeUint64(BigInt(t.max_amount_b.toString())),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_lower))),ce.bcsSerializeUint64(BigInt.asUintN(64,BigInt(t.tick_upper)))]:[ce.bcsSerializeUint64(t.tick_spacing),ce.bcsSerializeU128(BigInt(t.initialize_sqrt_price.toString())),ce.bcsSerializeStr(t.uri)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,l,d))}const a=Ot(o,r),c=[t.coinTypeA,t.coinTypeB],u=s?[t.tick_spacing.toString(),t.initialize_sqrt_price.toString(),t.uri.toString(),t.delta_liquidity.toString(),t.max_amount_a.toString(),t.max_amount_b.toString(),BigInt.asUintN(64,BigInt(t.tick_lower)).toString(),BigInt.asUintN(64,BigInt(t.tick_upper)).toString()]:[t.tick_spacing.toString(),t.initialize_sqrt_price.toString(),t.uri.toString()];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}},p3=class{constructor(t){this._sdk=t,this.growthGlobal=[Ie,Ie,Ie]}get sdk(){return this._sdk}async listRewarderInfosFromClmmpool(t){const n=await this.sdk.Resources.getPool(t),i=[];for(const s of n.rewarder_infos)i.push(s);return i}async emissionsEveryDay(t){const n=await this.listRewarderInfosFromClmmpool(t);if(!n)return null;const i=[];for(const s of n){const o=Tt.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async collectRewarderAmount(t,n){const i=await this.sdk.Resources.getPositionInfo(t,n);return i?{reward_amount_owed_0:i.reward_amount_owed_0,reward_amount_owed_1:i.reward_amount_owed_1,reward_amount_owed_2:i.reward_amount_owed_2}:null}async updatePoolRewarder(t,n){const i=await this.sdk.Resources.getPool(t),s=i.rewarder_last_updated_time;if(i.rewarder_last_updated_time=n,i.liquidity===0||n.eq(s))return i;const o=n.div(new y(1e3)).sub(new y(s)).add(new y(15)),r=i.rewarder_infos;for(let a=0;a<r.length;a+=1){const c=r[a],u=Tt.checkMulDivFloor(o,new y(c.emissions_per_second),new y(i.liquidity),128);this.growthGlobal[a]=new y(c.growth_global).add(new y(u))}return i}async posRewardersAmount(t,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(t,new y(o)),a=await this.sdk.Resources.getPositionInfo(r,n),c=parseInt(a.tick_lower_index,10),u=parseInt(a.tick_upper_index,10),l=Z2(r,i,s,c,u,this.growthGlobal),d=[],h=[];if(l.length>0){const g=Tt.subUnderflowU128(l[0],new y(a.reward_growth_inside_0)),b=Tt.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[0]),h.push({amount_owed:new y(a.reward_amount_owed_0).add(b),coin_address:r.rewarder_infos[0].coinAddress})}if(l.length>1){const g=Tt.subUnderflowU128(l[1],new y(a.reward_growth_inside_1)),b=Tt.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[1]),h.push({amount_owed:new y(a.reward_amount_owed_1).add(b),coin_address:r.rewarder_infos[1].coinAddress})}if(l.length>2){const g=Tt.subUnderflowU128(l[2],new y(a.reward_growth_inside_2)),b=Tt.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[2]),h.push({amount_owed:new y(a.reward_amount_owed_2).add(b),coin_address:r.rewarder_infos[2].coinAddress})}return h}async poolRewardersAmount(t,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(n,new y(o)),a=await this.sdk.Resources.getPositionList(t,[r]),c=[Ie,Ie,Ie];for(let u=0;u<a.length;u+=1){const l=await this.posRewardersAmount(n,a[u],i[u],s[u]);for(let d=0;d<3;d+=1)c[d]=c[d].add(l[d].amount_owed)}return c}collectPosRewarderTransactionPayload(t,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Js}`,o="collect_rewarder";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),ce.bcsSerializeU8(t.index),ce.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC],c=[t.pool_address,t.index,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectPoolRewarderTransactionPayload(t,n=!1){if(t.rewarder_nums===1){const o={pool_address:t.pool_address,index:0,pos_index:t.pos_index,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,coinTypeC:t.coinTypeC};return this.collectPosRewarderTransactionPayload(o,n)}const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.ClmmIntegrate}::${Id}`;if(t.rewarder_nums===2){const o="collect_rewarder_for_two";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),ce.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}if(t.rewarder_nums===3){const o="collect_rewarder_for_three";if(n){const u=[new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeB)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeC)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeD)),new F.TypeTagStruct(F.StructTag.fromString(t.coinTypeE))],l=[ce.bcsToBytes(F.AccountAddress.fromHex(t.pool_address)),ce.bcsSerializeUint64(t.pos_index)];return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,u,l))}const r=Ot(s,o),a=[t.coinTypeA,t.coinTypeB,t.coinTypeC,t.coinTypeD,t.coinTypeE],c=[t.pool_address,t.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}}},g3=5*60*1e3,Va=24*60*60*1e3;function B0(e){return Date.parse(new Date().toString())+e}var _3=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getOwnerTokenList(t,n,i=!1){const s="getAllRegisteredTokenList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::coin_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[ce.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await Wa(new cn(this.sdk.sdkOptions.rpcUrl),t,c),l=this.transformTokenData(u.changes);return this.updateCache(s,l,Va),l}async getTokenListByCoinType(t,n=0,i=20){const{fraphQLUrl:s}=this._sdk.sdkOptions;if(!s)throw Error("The fraphQLUrl is not configured in the SDK");const o={query:`query MyQuery {
  coin_infos(
  limit: ${i}, offset: ${n},  order_by: {name: desc}, where: {  coin_type: {_regex: "${t}"}}
  ) {
    coin_type
    symbol
    name
    decimals
    creator_address
    coin_type_hash
  }
}
`,variables:null,operationName:"MyQuery"},r=await hr.post(s,o),a=[];return r.data.data.coin_infos.forEach(c=>{a.push({address:c.coin_type,symbol:c.symbol,official_symbol:c.symbol,decimals:c.decimals,name:c.name,coingecko_id:"",project_url:"",logo_url:""})}),a}async getSpecifyTokenListByCache(t){const n="getAllRegisteredTokenList",i=this.getCacheData(n),s=[];if(i!==null){const o=i;for(const r of t)for(const a of o)if(r===a.address){s.push(a);continue}}return s}async getAllRegisteredTokenList(t,n=!1){const i="getAllRegisteredTokenList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::coin_list`,r="fetch_all_registered_coin_info",a=new cn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,[],[])),u=await Wa(a,t,c),l=this.transformTokenData(u.changes);return this.updateCache(i,l,Va),l}transformTokenData(t){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=t.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::coin_list::CoinList<${i.TokenDeployer}::coin_list::CoinInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(er.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getAllRegisteredPoolList(t,n=!1){const i="getAllRegisteredPoolList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::lp_list`,r="fetch_all_registered_coin_info",a=new cn(this.sdk.sdkOptions.rpcUrl),c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,[],[])),u=await Wa(a,t,c),l=this.transformPoolData(u.changes);return this.updateCache(i,l,Va),l}async getOwnerPoolList(t,n,i=!1){const s="getAllRegisteredPoolList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::lp_list`,a="fetch_full_list",c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,a,[],[ce.bcsToBytes(F.AccountAddress.fromHex(n))])),u=await Wa(new cn(this.sdk.sdkOptions.rpcUrl),t,c),l=this.transformPoolData(u.changes);return this.updateCache(s,l,Va),l}transformPoolData(t){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=t.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::lp_list::PoolList<${i.TokenDeployer}::lp_list::PoolInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(er.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getOwnerWarpPoolList(t,n,i=!1){const s=await this.getOwnerTokenList(n,t,i),o=await this.getOwnerPoolList(n,t,i),r=[];for(const a of o){for(const c of s)c.address===a.coin_a_address&&(a.coinA=c),c.address===a.coin_b_address&&(a.coinB=c);r.push(a)}return r}async getWarpPoolList(t,n=!1){const i=await this.getAllRegisteredTokenList(t,n),s=await this.getAllRegisteredPoolList(t,n),o=[];for(const r of s){for(const a of i)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}updateCache(t,n,i=g3){let s=this._cache[t];s?(s.overdueTime=B0(i),s.value=n):s=new Ju(n,B0(i)),this._cache[t]=s}getCacheData(t){const n=this._cache[t];return n!==void 0&&n.getCacheData()?n.value:null}},m3=3e4,mn={maxAmountOut:Ie,isExceed:!1,path:[]};function I0(e,t){return{pair:`${e}-${t}`,reversePair:`${t}-${e}`}}function y3(e,t,n,i){const s=e.length;if(!e.length)throw new Error("routerTable is empty");if(s!==t.length)throw new Error("routerTable length not equal to feeRateArray length");let o=i?Ie:new y(2).pow(new y(64)),r=[];const a=100/(e[0].length-1);switch(s){case 1:{o=e[0][e[0].length-1],n[0][n[0].length-1]||r.push({feeRate:t[0],percent:100});break}case 2:{for(let c=0;c<e[0].length;c+=1){const u=e[0].length-c-1,l=e[0][c].add(e[1][u]);if(l.gt(o)&&i||l.lt(o)&&!i)if(!n[0][c]&&!n[1][u])r=[],o=l,c>0&&r.push({feeRate:t[0],percent:c*a}),u>0&&r.push({feeRate:t[1],percent:u*a});else continue}break}case 3:{for(let c=0;c<e[0].length;c+=1)for(let u=0;u<e[0].length-c;u+=1){const l=e[0].length-c-u-1,d=e[0][c].add(e[1][u]).add(e[2][l]);if(d.gt(o)&&i||d.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l])continue;r=[],o=d,c>0&&r.push({feeRate:t[0],percent:a*c}),u>0&&r.push({feeRate:t[1],percent:u*a}),l>0&&r.push({feeRate:t[2],percent:l*a})}}break}case 4:{for(let c=0;c<e[0].length;c+=1)for(let u=0;u<e[0].length-c;u+=1)for(let l=0;l<e[0].length-c-u;l+=1){const d=e[0].length-c-u-l-1,h=e[0][c].add(e[1][u]).add(e[2][l]).add(e[3][d]);if(h.gt(o)&&i||h.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l]||n[3][d])continue;r=[],o=h,c>0&&r.push({feeRate:t[0],percent:a*c}),u>0&&r.push({feeRate:t[1],percent:u*a}),l>0&&r.push({feeRate:t[2],percent:l*a}),d>0&&r.push({feeRate:t[3],percent:d*a})}}break}}return r.length===0||o.eq(Ie)?{maxAmountOut:Ie,path:[],isExceed:!0}:{maxAmountOut:o,path:r,isExceed:!1}}var w3=class{constructor(t){this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new Ay,this._coinSymbolMap=new Map,this._coinAddressMap=new Map,this.poolAddressMap=new Map,this.poolMap=new Map,this.ticksMap=new Map,this._sdk=t,this.leastRefreshTime=Date.now(),this.createTxParams={partitionQuantities:[],swapDirects:[],poolAddresses:[],percents:[],totalAmounts:[],partner:"",amountLimit:"0",amountOut:"0",coinTypes:[]},this.splitUnit=50,this.poolDirectionMap=new Map,this.isInited=!1,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.splitSwap=this.splitSwap.bind(this),this.splitSwapForRouter=this.splitSwapForRouter.bind(this),this.splitSwapForRouters=this.splitSwapForRouters.bind(this),this.refreshPoolofSwapRouter=this.refreshPoolofSwapRouter.bind(this),this.getBestSplitResultInOnePair=this.getBestSplitResultInOnePair.bind(this),this.findBestSplitPriceWithOneSkip=this.findBestSplitPriceWithOneSkip.bind(this),this.findBestSplitPriceWithTwoSkip=this.findBestSplitPriceWithTwoSkip.bind(this),this.findBestSplitPriceWithThreeSkip=this.findBestSplitPriceWithThreeSkip.bind(this),this.findBestSplitPrice=this.findBestSplitPrice.bind(this),this.price=this.price.bind(this),this.routerSwap=this.routerSwap.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(t,n){const{pair:i,reversePair:s}=I0(t,n);let o=this.poolAddressMap.get(i);if(o!=null)return{addressMap:o,direction:!0};if(o=this.poolAddressMap.get(s),o!=null)return{addressMap:o,direction:!1}}async setCoinList(){this.coinProviders.coins.forEach(t=>{this._coinSymbolMap.set(t.symbol,t),this._coinAddressMap.set(t.address,t)})}loadGraph(){return this.pathProviders.forEach(t=>{const{paths:n}=t;n.forEach(i=>{var s,o;const r=(s=this.graph.getVertexByKey(i.base))!=null?s:new Ic(i.base),a=(o=this.graph.getVertexByKey(i.quote))!=null?o:new Ic(i.quote);this.graph.addEdge(new Ty(r,a));const c=this._coinSymbolMap.get(i.base),u=this._coinSymbolMap.get(i.quote);if(c!=null&&u!=null){const l=I0(i.base,i.quote).pair;this.poolAddressMap.set(l,i.addressMap)}})}),this}addPathProvider(t){return this.pathProviders.push(t),this}addCoinProvider(t){return this.coinProviders=t,this}tokenInfo(t){return this._coinAddressMap.has(t)?this._coinAddressMap.get(t):this._coinSymbolMap.get(t)}getCreateTxParams(){return this.createTxParams}isPoolDirectionSet(t){return this.poolDirectionMap.get(t)!=null}getPoolDirection(t){if(this.isPoolDirectionSet(t))return this.poolDirectionMap.get(t)}setPoolDirection(t,n){this.poolDirectionMap.set(t,n)}getBestSplitResultInOnePair(t,n,i,s,o,r){if(s.eq(Ie))return{maxAmountOut:Ie,path:[],isExceed:!1};console.log(s.toString());const a=[],c=[],u=[],l=this.getPoolAddressMapAndDirection(n,i),d=l==null?void 0:l.addressMap;if(d)for(const[h,g]of d.entries()){const b=this.poolMap.get(g),v=this.poolDirectionMap.get(g),k=o===v,E=this.ticksMap.get(g),A=new J2(s,t,b,k,r,E).computeSwap();r?a.push(A.amountOutArray):a.push(A.amountInArray),u.push(A.isExceed),c.push(h)}return y3(a.slice(0,4),c.slice(0,4),u.slice(0,4),r)}findBestSplitPriceWithOneSkip(t,n,i,s,o){const r={maxAmountOut:new y(0),path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},a=[],c=[],u=[],l=[];if(!o){let g=mn,b=mn;if(s){if(g=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],n,i[0][0],s),g.isExceed||(b=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],g.maxAmountOut,i[0][1],s),b.isExceed))return r.isExceed=!0,r;r.maxAmountOut=b.maxAmountOut}else{if(b=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],n,i[0][1],s),b.isExceed||(g=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],b.maxAmountOut,i[0][0],s),g.isExceed))return r.isExceed=!0,r;r.maxAmountOut=g.maxAmountOut}a.push(g.path),a.push([]),a.push(b.path);const v=[],k=[],E=[];g.path.forEach(Q=>{var V;s?v.push(n.muln(Q.percent).divn(100)):v.push(b.maxAmountOut.muln(Q.percent).divn(100)),E.push(Q.percent);const ee=(V=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:V.addressMap.get(Q.feeRate);k.push(ee)});const N=[],A=[],P=[];b.path.forEach(Q=>{var V;s?N.push(g.maxAmountOut.muln(Q.percent).divn(100)):N.push(n.muln(Q.percent).divn(100)),P.push(Q.percent);const ee=(V=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:V.addressMap.get(Q.feeRate);A.push(ee)});let B=Ie;v.forEach(Q=>{B=B.add(Q)});const W=Ie;return N.forEach(Q=>{W.add(Q)}),c.push(B.toString()),c.push(Ie.toString()),u.push(E),u.push([]),u.push(P),l.push(k),l.push([]),l.push(A),r.totalAmounts=c,r.path=a,r.percents=u,r.poolAddresses=l,s?r.maxAmountOut=b.maxAmountOut:r.maxAmountOut=g.maxAmountOut,r.path.length||(r.isExceed=!0),r}let d=Ie;s||(d=new y(2).pow(new y(64)));const h=fc(n,this.splitUnit);for(let g=0;g<h.length;g+=1){const b=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],h[g],i[0][0],s);if(b.isExceed)continue;let v=mn,k=mn;if(s){if(v=this.getBestSplitResultInOnePair(50,t[1][0],t[1][1],h[h.length-g-1],i[1][0],s),v.isExceed||(k=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],v.maxAmountOut,i[1][1],s),k.isExceed))continue}else if(k=this.getBestSplitResultInOnePair(50,t[1][2],t[1][3],h[h.length-g-1],i[1][1],s),k.isExceed||(v=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],k.maxAmountOut,i[1][0],s),v.isExceed))continue;const E=[],N=[],A=[];b.path.forEach(x=>{var f;E.push(n.muln(g*this.splitUnit).divn(100).muln(x.percent).divn(100)),A.push(x.percent);const m=(f=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:f.addressMap.get(x.feeRate);N.push(m)});const P=[],B=[],W=[];v.path.forEach(x=>{var f;s?P.push(n.muln((h.length-g-1)*this.splitUnit).divn(100).muln(x.percent).divn(100)):P.push(k.maxAmountOut.muln(x.percent).divn(100)),W.push(x.percent);const m=(f=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:f.addressMap.get(x.feeRate);B.push(m)});const Q=[],V=[],ee=[];k.path.forEach(x=>{var f;s?Q.push(v.maxAmountOut.muln(x.percent).divn(100)):Q.push(n.muln((h.length-g-1)*this.splitUnit).divn(100).muln(x.percent).divn(100)),ee.push(x.percent);const m=(f=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:f.addressMap.get(x.feeRate);V.push(m)});const j=[],R=[],U=[];if(k.maxAmountOut.add(b.maxAmountOut).gt(d)||v.maxAmountOut.add(b.maxAmountOut).lt(d)){s?d=k.maxAmountOut.add(b.maxAmountOut):d=v.maxAmountOut.add(b.maxAmountOut);let x=Ie;E.forEach(m=>{x=x.add(m)});const f=Ie;P.forEach(m=>{f.add(m)}),j.push(v.path),j.push(b.path),j.push(k.path),R.push(f.toString()),R.push(x.toString()),u.push(W),u.push(A),u.push(ee),U.push(B),U.push(N),U.push(V),r.maxAmountOut=d,r.path=j,r.totalAmounts=R,r.percents=u,r.poolAddresses=U,r.path.length||(r.isExceed=!0)}}return r}findBestSplitPriceWithTwoSkip(t,n,i,s,o){const r={maxAmountOut:Ie,path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1},a=fc(n,this.splitUnit);let c=Ie;if(s||(c=new y(2).pow(new y(64))),!o){for(let u=0;u<a.length;u+=1){let l=mn,d=mn,h=mn,g=mn;if(s){if(l=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],a[u],i[1][0],s),l.isExceed||(d=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],l.maxAmountOut,i[1][1],s),d.isExceed)||(h=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],a[a.length-u-1],i[1][0],s),h.isExceed)||(g=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],h.maxAmountOut,i[1][1],s),g.isExceed))continue}else if(d=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],a[u],i[1][1],s),d.isExceed||(l=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],d.maxAmountOut,i[1][0],s),l.isExceed)||(g=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],a[a.length-u-1],i[1][1],s),g.isExceed)||(h=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],g.maxAmountOut,i[1][0],s),h.isExceed))continue;const b=[],v=[],k=[];l.path.forEach(f=>{var m;s?b.push(n.muln(u*this.splitUnit).divn(100).muln(f.percent).divn(100)):b.push(d.maxAmountOut.muln(f.percent).divn(100)),k.push(f.percent);const T=(m=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:m.addressMap.get(f.feeRate);v.push(T)});const E=[],N=[],A=[];d.path.forEach(f=>{var m;s?E.push(l.maxAmountOut.muln(f.percent).divn(100)):E.push(n.muln(u*this.splitUnit).divn(100).muln(f.percent).divn(100)),A.push(f.percent);const T=(m=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:m.addressMap.get(f.feeRate);N.push(T)});const P=[],B=[],W=[];h.path.forEach(f=>{var m;s?P.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(f.percent).divn(100)):P.push(g.maxAmountOut.muln(f.percent).divn(100)),W.push(f.percent);const T=(m=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:m.addressMap.get(f.feeRate);B.push(T)});const Q=[],V=[],ee=[];g.path.forEach(f=>{var m;s?Q.push(h.maxAmountOut.muln(f.percent).divn(100)):Q.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(f.percent).divn(100)),ee.push(f.percent);const T=(m=this.getPoolAddressMapAndDirection(t[1][1],t[1][2]))==null?void 0:m.addressMap.get(f.feeRate);V.push(T)});const j=[],R=[],U=[],x=[];if(d.maxAmountOut.add(g.maxAmountOut).gt(c)&&s||!s&&l.maxAmountOut.add(h.maxAmountOut).lt(c)){s?c=d.maxAmountOut.add(g.maxAmountOut):c=l.maxAmountOut.add(h.maxAmountOut);let f=Ie;b.forEach(T=>{f=f.add(T)});let m=Ie;P.forEach(T=>{m=m.add(T)}),j.push(l.path),j.push(d.path),j.push([]),j.push(h.path),j.push(g.path),R.push(f.toString()),R.push(m.toString()),R.push(Ie.toString()),x.push(k),x.push(W),x.push([]),x.push(A),x.push(ee),U.push(v),U.push(B),U.push([]),U.push(N),U.push(V),r.maxAmountOut=c,r.percents=x,r.totalAmounts=R,r.path=j,r.poolAddresses=U}}return r.path.length||(r.isExceed=!0),r}for(let u=0;u<a.length;u+=1)for(let l=0;l<a.length-u-1;l+=1){const d=a.length-u-l-1,h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],a[d],i[0][0],s);if(h.isExceed)continue;let g=mn,b=mn,v=mn,k=mn;if(s){if(g=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],a[l],i[1][0],s),g.isExceed||(b=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],g.maxAmountOut,i[1][1],s),b.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],a[u],i[2][0],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],v.maxAmountOut,i[2][1],s),k.isExceed))continue}else if(b=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],a[l],i[1][1],s),b.isExceed||(g=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],b.maxAmountOut,i[1][0],s),g.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],a[u],i[2][1],s),k.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],k.maxAmountOut,i[2][0],s),v.isExceed))continue;const E=[],N=[],A=[];g.path.forEach(O=>{var _;s?E.push(n.muln(l*this.splitUnit).divn(100).muln(O.percent).divn(100)):E.push(b.maxAmountOut.muln(O.percent).divn(100)),A.push(O.percent);const q=(_=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:_.addressMap.get(O.feeRate);N.push(q)});const P=[],B=[],W=[];b.path.forEach(O=>{var _;s?P.push(g.maxAmountOut.muln(O.percent).divn(100)):P.push(n.muln(l*this.splitUnit).divn(100).muln(O.percent).divn(100)),W.push(O.percent);const q=(_=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:_.addressMap.get(O.feeRate);B.push(q)});const Q=[],V=[],ee=[];v.path.forEach(O=>{var _;s?Q.push(n.muln(u*this.splitUnit).divn(100).muln(O.percent).divn(100)):Q.push(k.maxAmountOut.muln(O.percent).divn(100)),ee.push(O.percent);const q=(_=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:_.addressMap.get(O.feeRate);V.push(q)});const j=[],R=[],U=[];k.path.forEach(O=>{var _;s?j.push(v.maxAmountOut.muln(O.percent).divn(100)):j.push(n.muln(u*this.splitUnit).divn(100).muln(O.percent).divn(100)),U.push(O.percent);const q=(_=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:_.addressMap.get(O.feeRate);R.push(q)});const x=[],f=[],m=[];h.path.forEach(O=>{var _;x.push(n.muln(d*this.splitUnit).divn(100).muln(O.percent).divn(100)),m.push(O.percent);const q=(_=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:_.addressMap.get(O.feeRate);f.push(q)});let T=Ie;s?T=h.maxAmountOut.add(b.maxAmountOut).add(k.maxAmountOut):T=h.maxAmountOut.add(g.maxAmountOut).add(v.maxAmountOut);const $=[],M=[],z=[],J=[];if(T.gt(c)&&s||T.lt(c)&&!s){let O=Ie;E.forEach(ve=>{O=O.add(ve)});let _=Ie;Q.forEach(ve=>{_=_.add(ve)});let q=Ie;x.forEach(ve=>{q=q.add(ve)}),c=T,$.push(g.path),$.push(v.path),$.push(h.path),$.push(b.path),$.push(k.path),M.push(O.toString()),M.push(_.toString()),M.push(q.toString()),z.push(A),z.push(ee),z.push(m),z.push(W),z.push(U),J.push(N),J.push(V),J.push(f),J.push(B),J.push(R),r.maxAmountOut=T,r.path=$,r.totalAmounts=M,r.poolAddresses=J,r.percents=z}}return r.path.length||(r.isExceed=!0),r}findBestSplitPriceWithThreeSkip(t,n,i,s,o){const r={maxAmountOut:new y(0),path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1};let a=Ie;s||(a=new y(2).pow(new y(64)));const c=fc(n,this.splitUnit);for(let u=0;u<c.length;u+=1)for(let l=0;l<c.length-u-1;l+=1)if(o)for(let d=0;d<c.length-u-l-1;d+=1){const h=c.length-u-l-d-1,g=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],c[d],i[0][0],s);let b=mn,v=mn,k=mn,E=mn,N=mn,A=mn;if(s){if(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],c[l],i[1][0],s),b.isExceed||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],b.maxAmountOut,i[1][1],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],c[u],i[2][0],s),k.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],k.maxAmountOut,i[2][1],s),E.isExceed)||(N=this.getBestSplitResultInOnePair(5,t[3][0],t[3][1],c[h],i[3][0],s),N.isExceed)||(A=this.getBestSplitResultInOnePair(5,t[3][2],t[3][3],N.maxAmountOut,i[3][1],s),A.isExceed))continue}else if(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],c[l],i[1][1],s),v.isExceed||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],v.maxAmountOut,i[1][0],s),b.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],c[u],i[2][1],s),E.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],E.maxAmountOut,i[2][0],s),k.isExceed)||(A=this.getBestSplitResultInOnePair(5,t[3][2],t[3][3],c[h],i[3][1],s),A.isExceed)||(N=this.getBestSplitResultInOnePair(5,t[3][0],t[3][1],A.maxAmountOut,i[3][0],s),N.isExceed))continue;const P=[],B=[],W=[];b.path.forEach(ot=>{var rt;s?P.push(n.muln(l*this.splitUnit).divn(100).muln(ot.percent).divn(100)):P.push(v.maxAmountOut.muln(ot.percent).divn(100)),W.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:rt.addressMap.get(ot.feeRate);B.push(vt)});const Q=[],V=[],ee=[];v.path.forEach(ot=>{var rt;s?Q.push(b.maxAmountOut.muln(ot.percent).divn(100)):Q.push(n.muln(l*this.splitUnit).divn(100).muln(ot.percent).divn(100)),ee.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:rt.addressMap.get(ot.feeRate);V.push(vt)});const j=[],R=[],U=[];k.path.forEach(ot=>{var rt;s?j.push(n.muln(u*this.splitUnit).divn(100).muln(ot.percent).divn(100)):j.push(E.maxAmountOut.muln(ot.percent).divn(100)),U.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:rt.addressMap.get(ot.feeRate);R.push(vt)});const x=[],f=[],m=[];E.path.forEach(ot=>{var rt;s?x.push(k.maxAmountOut.muln(ot.percent).divn(100)):x.push(n.muln(u*this.splitUnit).divn(100).muln(ot.percent).divn(100)),m.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:rt.addressMap.get(ot.feeRate);f.push(vt)});const T=[],$=[],M=[];N.path.forEach(ot=>{var rt;s?T.push(n.muln(h*this.splitUnit).divn(100).muln(ot.percent).divn(100)):T.push(A.maxAmountOut.muln(ot.percent).divn(100)),M.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[3][0],t[3][1]))==null?void 0:rt.addressMap.get(ot.feeRate);$.push(vt)});const z=[],J=[],O=[];A.path.forEach(ot=>{var rt;s?z.push(N.maxAmountOut.muln(ot.percent).divn(100)):z.push(n.muln(h*this.splitUnit).divn(100).muln(ot.percent).divn(100)),O.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[3][2],t[3][3]))==null?void 0:rt.addressMap.get(ot.feeRate);J.push(vt)});const _=[],q=[],ve=[];g.path.forEach(ot=>{var rt;_.push(n.muln(d*this.splitUnit).divn(100).muln(ot.percent).divn(100)),ve.push(ot.percent);const vt=(rt=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:rt.addressMap.get(ot.feeRate);q.push(vt)});let ue=Ie;s?ue=g.maxAmountOut.add(v.maxAmountOut).add(E.maxAmountOut).add(A.maxAmountOut):ue=g.maxAmountOut.add(b.maxAmountOut).add(k.maxAmountOut).add(N.maxAmountOut);const xe=[],lt=[],Qe=[],yt=[];if(ue.gt(a)&&s||!s&&ue.lt(a)){let ot=Ie;P.forEach(ne=>{ot=ot.add(ne)});let rt=Ie;j.forEach(ne=>{rt=rt.add(ne)});let vt=Ie;T.forEach(ne=>{vt=vt.add(ne)});let Pn=Ie;_.forEach(ne=>{Pn=Pn.add(ne)}),a=ue,xe.push(b.path),xe.push(k.path),xe.push(N.path),xe.push(g.path),xe.push(v.path),xe.push(E.path),xe.push(A.path),lt.push(ot.toString()),lt.push(rt.toString()),lt.push(vt.toString()),lt.push(Pn.toString()),Qe.push(W),Qe.push(U),Qe.push(M),Qe.push(ve),Qe.push(ee),Qe.push(m),Qe.push(O),yt.push(B),yt.push(R),yt.push($),yt.push(q),yt.push(V),yt.push(f),yt.push(J),r.maxAmountOut=ue,r.path=xe,r.totalAmounts=lt,r.percents=Qe,r.poolAddresses=yt}}else{const d=c.length-u-l-1;let h=mn,g=mn,b=mn,v=mn,k=mn,E=mn;if(s){if(h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],c[l],i[0][0],s),h.isExceed||(g=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],h.maxAmountOut,i[0][1],s),g.isExceed)||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],c[u],i[1][0],s),b.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],b.maxAmountOut,i[1][1],s),v.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],c[d],i[2][0],s),k.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],b.maxAmountOut,i[2][1],s),E.isExceed))continue}else if(g=this.getBestSplitResultInOnePair(5,t[0][2],t[0][3],c[l],i[0][1],s),g.isExceed||(h=this.getBestSplitResultInOnePair(5,t[0][0],t[0][1],g.maxAmountOut,i[0][0],s),h.isExceed)||(v=this.getBestSplitResultInOnePair(5,t[1][2],t[1][3],c[u],i[1][1],s),v.isExceed)||(b=this.getBestSplitResultInOnePair(5,t[1][0],t[1][1],v.maxAmountOut,i[1][0],s),b.isExceed)||(E=this.getBestSplitResultInOnePair(5,t[2][2],t[2][3],c[d],i[2][1],s),E.isExceed)||(k=this.getBestSplitResultInOnePair(5,t[2][0],t[2][1],v.maxAmountOut,i[2][0],s),k.isExceed))continue;const N=[],A=[],P=[];h.path.forEach(ue=>{var xe;s?N.push(n.muln(l*this.splitUnit).divn(100).muln(ue.percent).divn(100)):N.push(g.maxAmountOut.muln(ue.percent).divn(100)),P.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:xe.addressMap.get(ue.feeRate);A.push(lt)});const B=[],W=[],Q=[];g.path.forEach(ue=>{var xe;s?B.push(h.maxAmountOut.muln(ue.percent).divn(100)):B.push(n.muln(l*this.splitUnit).divn(100).muln(ue.percent).divn(100)),Q.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[0][2],t[0][3]))==null?void 0:xe.addressMap.get(ue.feeRate);W.push(lt)});const V=[],ee=[],j=[];b.path.forEach(ue=>{var xe;s?V.push(n.muln(u*this.splitUnit).divn(100).muln(ue.percent).divn(100)):V.push(v.maxAmountOut.muln(ue.percent).divn(100)),j.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[1][0],t[1][1]))==null?void 0:xe.addressMap.get(ue.feeRate);ee.push(lt)});const R=[],U=[],x=[];v.path.forEach(ue=>{var xe;s?R.push(b.maxAmountOut.muln(ue.percent).divn(100)):R.push(n.muln(u*this.splitUnit).divn(100).muln(ue.percent).divn(100)),x.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[1][2],t[1][3]))==null?void 0:xe.addressMap.get(ue.feeRate);U.push(lt)});const f=[],m=[],T=[];k.path.forEach(ue=>{var xe;s?f.push(n.muln(d*this.splitUnit).divn(100).muln(ue.percent).divn(100)):f.push(E.maxAmountOut.muln(ue.percent).divn(100)),T.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[2][0],t[2][1]))==null?void 0:xe.addressMap.get(ue.feeRate);m.push(lt)});const $=[],M=[],z=[];E.path.forEach(ue=>{var xe;s?$.push(k.maxAmountOut.muln(ue.percent).divn(100)):$.push(n.muln(d*this.splitUnit).divn(100).muln(ue.percent).divn(100)),z.push(ue.percent);const lt=(xe=this.getPoolAddressMapAndDirection(t[2][2],t[2][3]))==null?void 0:xe.addressMap.get(ue.feeRate);M.push(lt)});const J=[],O=[],_=[],q=[];let ve=Ie;if(s?ve=g.maxAmountOut.add(v.maxAmountOut).add(E.maxAmountOut):ve=h.maxAmountOut.add(b.maxAmountOut).add(k.maxAmountOut),ve.gt(a)&&s||ve.lt(a)&&!s){let ue=Ie;N.forEach(Qe=>{ue=ue.add(Qe)});let xe=Ie;V.forEach(Qe=>{xe=xe.add(Qe)});let lt=Ie;f.forEach(Qe=>{lt=lt.add(Qe)}),a=ve,J.push(h.path),J.push(b.path),J.push(k.path),J.push([]),J.push(g.path),J.push(v.path),J.push(E.path),O.push(ue.toString()),O.push(xe.toString()),O.push(lt.toString()),O.push(Ie.toString()),_.push(P),_.push(j),_.push(T),_.push([]),_.push(Q),_.push(x),_.push(z),q.push(A),q.push(ee),q.push(m),q.push([]),q.push(W),q.push(U),q.push(M),r.maxAmountOut=ve,r.path=J,r.percents=_,r.totalAmounts=O,r.poolAddresses=q}}return r.path.length||(r.isExceed=!0),r}findBestSplitPrice(t,n,i,s,o,r){var a,c,u,l;let d=t.length,h=!1;t[0].length===2&&(h=!0,d-=1);let g={maxAmountOut:Ie,path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},b={maxAmountOut:Ie,path:[],isExceed:!1};const v=[],k=[];let E=Ie;const N=[];switch(console.log(d,"skipNumber"),d){case 0:b=this.getBestSplitResultInOnePair(50,t[0][0],t[0][1],n,i[0][0],s),g.maxAmountOut=b.maxAmountOut,g.path.push(b.path),b.path.forEach(V=>{var ee;const j=(ee=this.getPoolAddressMapAndDirection(t[0][0],t[0][1]))==null?void 0:ee.addressMap.get(V.feeRate);v.push(j);const R=n.muln(V.percent).divn(100);k.push(R),N.push(V.percent)}),k.forEach(V=>{E=E.add(V)}),g.percents.push(N),g.totalAmounts.push(E.toString()),g.poolAddresses.push(v);break;case 1:g=this.findBestSplitPriceWithOneSkip(t,n,i,s,h);break;case 2:g=this.findBestSplitPriceWithTwoSkip(t,n,i,s,h);break;case 3:g=this.findBestSplitPriceWithThreeSkip(t,n,i,s,h);break}if(g.isExceed)return g;const A=[];for(let V=0;V<g.path.length;V+=1){const{length:ee}=g.path[V];A.push(ee)}const P=[];if(d!==0)if(h){for(let ee=1;ee<1+d;ee+=1){const j=[];if(A[ee-1]>0)for(let R=0;R<A[ee-1];R+=1)j.push(i[ee][0]);P.push(j)}const V=[];for(let ee=0;ee<A[d];ee+=1)if(A[d]>0)for(let j=0;j<A[d];j+=1)V.push(i[0][0]);P.push(V);for(let ee=1;ee<1+d;ee+=1){const j=[];if(A[ee+d]>0)for(let R=0;R<A[ee+d];R+=1)j.push(i[ee][1]);P.push(j)}}else{for(let V=0;V<d;V+=1){const ee=[];if(A[V]>0)for(let j=0;j<A[V];j+=1)ee.push(i[V][0]);P.push(ee)}P.push([]);for(let V=0;V<d;V+=1){const ee=[];if(A[V+d+1]>0)for(let j=0;j<A[V+d+1];j+=1)ee.push(i[V][1]);P.push(ee)}}else P.push([i[0][0]]);for(let V=0;V<g.poolAddresses.length;V+=1)for(let ee=0;ee<g.poolAddresses[V].length;ee+=1){const j=this.getPoolDirection(g.poolAddresses[V][ee]);j&&(P[V][ee]=P[V][ee]&&j)}const B=[],W=(a=this._coinSymbolMap.get(t[0][0]))==null?void 0:a.address;B.push(W);for(let V=0;V<t.length;V+=1)if(t[V].length!==2){const ee=(c=this._coinSymbolMap.get(t[V][1]))==null?void 0:c.address;B.push(ee)}if(t[0].length===2){const V=(u=this._coinSymbolMap.get(t[0][1]))==null?void 0:u.address;B.push(V)}else{const V=(l=this._coinSymbolMap.get(t[0][t[0].length-1]))==null?void 0:l.address;B.push(V)}const Q=s?g.maxAmountOut.muln((1-o)*1e5).divn(1e5).toString():g.maxAmountOut.muln((1+o)*1e5).divn(1e5).toString();return this.createTxParams={partitionQuantities:A,swapDirects:P,poolAddresses:g.poolAddresses,totalAmounts:g.totalAmounts,percents:g.percents,amountLimit:Q,amountOut:n.toString(),partner:r,coinTypes:B},g}async price(t,n,i,s,o,r){var a,c;const u=this.tokenInfo(t),l=this.tokenInfo(n);if(u===void 0||l===void 0)return;const d=this.graph.getVertexByKey(u.symbol),h=this.graph.getVertexByKey(l.symbol),g=this.graph.findAllPath(d,h),b=Array.from(g),v=[],k=[],E=[];for(let N=0;N<b.length;N+=1){const A=b[N];if(A.length>3)continue;const P=[],B=[];for(let W=0;W<A.length-1;W+=1){const Q=A[W].value.toString(),V=A[W+1].value.toString(),ee=(a=this.getPoolAddressMapAndDirection(Q,V))==null?void 0:a.addressMap,j=(c=this.getPoolAddressMapAndDirection(Q,V))==null?void 0:c.direction;ee!==void 0&&j!==void 0&&(B.push(j),P.push(Q),P.push(V),ee.forEach(R=>{v.push(R)}))}if(E.push(B),k.push(P),P.length===2&&k.length>1){const W=k[0].slice();k[0]=P,k[k.length-1]=W;const Q=E[0].slice();E[0]=B,E[k.length-1]=Q}}return await this.refreshPoolofSwapRouter(v),this.findBestSplitPrice(k,i,E,s,o,r)}async routerSwap(t,n,i,s,o,r){const a=await this.price(t,n,i,s,o,r),c=this.getCreateTxParams();if(a.isExceed)return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:[],showRouters:[],gasFee:0};const u=this.splitSwapForRouters(c,s,!0),{simulationAccount:l}=this.sdk.sdkOptions.networkOptions,d=new cn(this.sdk.sdkOptions.rpcUrl),h=yr(l.address),g=await d.generateRawTransaction(h,u),b=yr(l.pubkey),v=new F.Ed25519PublicKey(b.toUint8Array()),k=await d.simulateTransaction(v,g),E=k[0].gas_used,N=k[0].gas_unit_price,A=parseInt(E,10)*parseInt(N,10),P=[];let B=Ie;a.totalAmounts.forEach(Q=>{B=B.add(new y(Q))}),a.totalAmounts.forEach(Q=>{let V;B.isZero()?V=0:V=Number(Q)/Number(B.toString())*100,P.push(V)});const W=[];for(let Q=0;Q<a.totalAmounts.length;Q+=1){const V={amount:a.totalAmounts[Q],poolAddress:[]};Q===Math.floor(a.poolAddresses.length/2)?a.poolAddresses[Q].length>0&&(V.poolAddress.push(a.poolAddresses[Q]),W.unshift(V)):a.poolAddresses[Q].length>0&&(V.poolAddress.push(a.poolAddresses[Q],a.poolAddresses[Q+Math.floor(a.poolAddresses.length/2)+1]),W.push(V))}return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:P,showRouters:W,gasFee:A}}splitSwap(t,n,i=!1){const{modules:s}=this.sdk.sdkOptions.networkOptions,o=`${s.ClmmIntegrate}::${Id}`,r=n?"exact_input_split_swap":"exact_output_split_swap",a=[];t.poolAddresses.forEach(h=>{const g=[];h.forEach(b=>{g.push(F.AccountAddress.fromHex(b))}),a.push(g)});const c=[ce.bcsSerializeUint64(t.partitionQuantities[0]),ce.serializeVectorWithFunc(t.swapDirects[0],"serializeBool"),i3(a[0]),ce.serializeVectorWithFunc(t.percents[0],"serializeU64"),ce.bcsSerializeUint64(parseInt(t.totalAmounts[0],10)),ce.bcsSerializeUint64(parseInt(t.amountLimit,10)),ce.bcsSerializeStr(t.partner)];if(i){const h=[];for(const g of t.coinTypes){const b=new F.TypeTagStruct(F.StructTag.fromString(g));h.push(b)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(o,r,h,c))}const u=Ot(o,r),l=t.coinTypes,d=[t.partitionQuantities[0],t.swapDirects[0],t.poolAddresses[0],t.percents[0],t.totalAmounts[0],t.amountLimit,t.partner];return{type:"entry_function_payload",function:u,type_arguments:l,arguments:d}}splitSwapForRouter(t,n,i,s=!1){const{modules:o}=this.sdk.sdkOptions.networkOptions,r=`${o.ClmmIntegrate}::${Id}`,a=[];t.poolAddresses.forEach(h=>{const g=[];h.forEach(b=>{g.push(F.AccountAddress.fromHex(b))}),a.push(g)});const c=[ce.serializeVectorWithFunc(t.partitionQuantities,"serializeU64"),S0(t.swapDirects,"serializeBool"),n3(a),S0(t.percents,"serializeU64"),ce.serializeVectorWithFunc(t.totalAmounts,"serializeU64"),ce.bcsSerializeUint64(parseInt(t.amountLimit,10)),ce.bcsSerializeStr(t.partner)];if(s){const h=[];for(const g of t.coinTypes){const b=new F.TypeTagStruct(F.StructTag.fromString(g));h.push(b)}return new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(r,i,h,c))}const u=[t.partitionQuantities,t.swapDirects,t.poolAddresses,t.percents,t.totalAmounts,t.amountLimit,t.partner],l=Ot(r,i),d=t.coinTypes;return{type:"entry_function_payload",function:l,type_arguments:d,arguments:u}}splitSwapForRouters(t,n,i=!1){const{length:s}=t.partitionQuantities;let o;switch(s){case 3:n?o="exact_input_split_swap_for_router_three":o="exact_output_split_swap_for_router_three";break;case 5:n?o="exact_input_split_swap_for_router_four":o="exact_output_split_swap_for_router_four";break;case 7:n?o="exact_input_split_swap_for_router_five":o="exact_output_split_swap_for_router_five";break;default:return this.splitSwap(t,n,i)}return this.splitSwapForRouter(t,n,o,i)}findUnFetchPools(t){const n=[];for(const i of t)this.poolMap.get(i)==null&&n.push(i);return n}async refreshPoolofSwapRouter(t){var n,i,s;const o=Date.now();if(this.isInited){const a=this.findUnFetchPools(t);if(o-this.leastRefreshTime<m3&&a.length===0)return}else this.isInited=!0;const r=await this._sdk.Resources.getPools(t);for(let a=0;a<t.length;a+=1)if(this.poolMap.set(r[a].poolAddress,r[a]),this.getPoolDirection(r[a].poolAddress)==null){const c=(n=this._coinAddressMap.get(r[a].coinTypeA))==null?void 0:n.symbol,u=(i=this._coinAddressMap.get(r[a].coinTypeB))==null?void 0:i.symbol,l=(s=this.getPoolAddressMapAndDirection(c,u))==null?void 0:s.direction;this.poolDirectionMap.set(r[a].poolAddress,l);const d=await this._sdk.Fetcher.fetchTicks({pool:r[a].poolAddress,coinTypeA:r[a].coinTypeA,coinTypeB:r[a].coinTypeB}),h=Oy(d);this.ticksMap.set(r[a].poolAddress,h)}this.leastRefreshTime=o}},b3=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}transformTickData(e){const t=[],{modules:n}=this._sdk.sdkOptions.networkOptions,i=e.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.FetcherDeployer}::fetcher::FetchTicksResult`);if(i.length===0)return{ticks:t,index:0,offset:0};const o=i[0].data.data;return{ticks:o.ticks||[],index:Number(o.index),offset:Number(o.offset)}}async getTicks(e){const{modules:t,simulationAccount:n}=this.sdk.sdkOptions.networkOptions,i=new cn(this.sdk.sdkOptions.rpcUrl),s=`${t.FetcherDeployer}::scripts`,o="fetch_ticks",r=[new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeA)),new F.TypeTagStruct(F.StructTag.fromString(e.coinTypeB))],a=[ce.bcsToBytes(F.AccountAddress.fromHex(e.pool)),ce.bcsSerializeUint64(e.index),ce.bcsSerializeUint64(e.offset),ce.bcsSerializeUint64(e.limit)],c=new F.TransactionPayloadEntryFunction(F.EntryFunction.natural(s,o,r,a)),u=yr(n.address),l=await i.generateRawTransaction(u,c),d=yr(n.pubkey),h=new F.Ed25519PublicKey(d.toUint8Array()),g=await i.simulateTransaction(h,l);return this.transformTickData(g[0].changes)}async fetchTicks(e){let t=[],n=0,i=0;const s=512;for(;;){const o=await this.getTicks({pool:e.pool,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,index:n,offset:i,limit:s});if(t=[...t,...o.ticks],o.ticks.length<s)break;o.offset<999?(i=o.offset+1,n=o.index):(n=o.index+1,i=0)}return t}},v3=class{constructor(e){this.globalConfig={protocol_fee_rate:"",is_pause:!1},this._sdkOptions=e,this._client=new cn(e.rpcUrl),this._tokenClient=new FS(this._client),this._swap=new c3(this),this._position=new u3(this),this._resources=new h3(this),this._pool=new f3(this),this._rewarder=new p3(this),this._router=new w3(this),this._token=new _3(this),this._fetcher=new b3(this),this._launchpad=new K2(this),this.globalConfig.protocol_fee_rate=""}async getGlobalConfig(e=!1){return(this.globalConfig.protocol_fee_rate.length===0||e)&&(this.globalConfig=await this._resources.getGlobalConfig(this._sdkOptions.networkOptions.modules.LiquidswapDeployer)),this.globalConfig}get client(){return this._client}get tokenClient(){return this._tokenClient}get Swap(){return this._swap}get Position(){return this._position}get Pool(){return this._pool}get Resources(){return this._resources}get Rewarder(){return this._rewarder}get Token(){return this._token}get Router(){return this._router}get Fetcher(){return this._fetcher}get Launchpad(){return this._launchpad}get sdkOptions(){return this._sdkOptions}};function fn(e,t){const n=Wh(t);return mt(e).div(n).toString()}function Ln(e,t){const n=Wh(t);return mt(e).mul(n)}function x3(e){const t=e.split("x");let n=e;return t[1][0]==="0"&&(n=t[0]+"x"+t[1].slice(1)),n}const O5=(e,t)=>JSON.stringify(e)===JSON.stringify(t),O0=e=>{switch(e){case"account":return"account";case"token":return"";case"nftAddress":return"token";case"tx":return"txn";case"poolAddress":return"account"}},T3=e=>{switch(e){case"account":return"address";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"object"}},qy=e=>{switch(e){case"account":return"address";case"token":return"object";case"tx":return"tx";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}},R0=e=>{switch(e){case"account":return"account";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}};function R5(){const t=(localStorage.getItem("theme")||"sui")=="sui"?"Sui":"Aptos";return localStorage.getItem(`${t}-currentExplorerName`)||cd[t][0].name}function Uc(e,t,n){const i=localStorage.getItem("theme")||"sui",s=i=="sui"?"Sui":"Aptos";console.log(e,"url###111");const o=e.indexOf("suivision")>-1?"SuiVision":e.indexOf("suiscan")>-1?"Suiscan":"";console.log(e,o,"url##");const r=De[s].network;let a;return s=="Aptos"?t=="nftAddress"?a=`${e}/${O0(t)}/${n}/0?network=${r}`:a=`${e}/${O0(t)}/${n}?network=${r}`:o=="SuiVision"?a=`${e}/${R0(t)}/${n}`:o=="Suiscan"?a=`${e}/${r}/${qy(t)}/${n}`:a=`${e}/${T3(t)}/${n}?network=${r}`,console.log("href, chain, chainName, url, urlName, network==>",t,R0(t),a,i,s,e,o,r),a}function $5(e,t){const n="Sui",i=cd[n][2].link,s=cd[n][2].name,o=De[n].network;let r;return s=="Suiscan"&&(r=`${i}/${o}/${qy(e)}/${t}`),r}function qc(e,t){const n=Wh(mt(t));return Number(mt(e).mul(n))}function U5(e){const t=e.toString(),n=t.indexOf(".");if(n!==-1){for(let i=n+1;i<t.length;i++)if(t[i]!=="0")return i-n-1}return-1}function q5(e,t){let n=e,i=t;if(e.includes("sui::SUI")&&e.includes("sui::SUI")){if(e.slice(-10)===t.slice(-10))return!0}else return e[2]=="0"&&(n=e.slice(0,2)+e.slice(3)),t[2]=="0"&&(i=t.slice(0,2)+t.slice(3)),(n==null?void 0:n.toLowerCase())==(i==null?void 0:i.toLowerCase());return!1}var A3=xw();const k3=Fd(A3),S3=-443636;function L5(e,t){const n=P3(e),i=(n-S3)%t;return i>t/2?n-i+t:n-i}const Ly=new ie("1.0001");function P3(e){return e.log(Ly).toDP(0,ie.ROUND_HALF_UP).toNumber()}function D5(e){return Ly.pow(e)}function pc(e,t,n){const i=Math.abs(e)%t;return e>0?i>t/2||n&&t<=2?e+t-i:e-i:i>t/2?e-t+i:e+i}function E3(){const e=De.Aptos.liquidswapDeployer,t={rpcUrl:localStorage.getItem("Aptos-currentRpclocal4")||De.Aptos.rpcUrl,fraphQLUrl:De.Aptos.fraphQLUrl,networkOptions:{nativeToken:"0x1::aptos_coin::AptosCoin",launchpad:{cetusLaunchpad:De.Aptos.Launchpad,crowdCoin:De.Aptos.LaunchpadCrowdCoin},simulationAccount:{pubkey:De.Aptos.accountPublicKey,address:De.Aptos.accountAddress},modules:{LiquidswapDeployer:e,ClmmIntegrate:De.Aptos.clmmIntegrate,FetcherDeployer:De.Aptos.fetcher,TokenDeployer:De.Aptos.TokenDeployer,IntegerMate:De.Aptos.IntegerMate}}},n=new v3(t),i=jd(),s=ip(),o=Ls(()=>s),r=Ls(()=>o.value.currentExplorer),{$notify:a}=Gs(),c=ne=>{const{$notify:de}=Gs();de.success({key:ne.hash+"loading",icon:St("img",{class:{"notify-icon":!0,"loading-animate":!0},src:o.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:St("div",{class:"notification-title"},[St("span",{innerHTML:ne.title},null)]),description:St("div",{class:"notification-title"},[St("div",{class:"notification-text",innerHTML:hi.global.t("newAdd.confirmingTransaction")},null),St("a",{href:Uc(r.value,"tx",ne.hash),target:"_blank",innerHTML:hi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},u=ne=>{a.success({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-icon-change1"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:`${ne.title} `+hi.global.t("newAdd.success")},null)]),description:St("div",{class:"notification-title"},[St("div",{class:"notification-text",innerHTML:ne.desc},null),St("a",{href:Uc(r.value,"tx",ne.hash),target:"_blank",innerHTML:hi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},l=ne=>{a.error({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:`${ne} `+hi.global.t("newAdd.failed")},null)]),description:hi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},d=async(ne,de=!1)=>{const Oe=await n.client.waitForTransactionWithResult(ne.hash);if(console.log("watchTransaction###res###",Oe),Oe&&Oe.success){a.close(ne.hash+"loading"),console.log("watchTransaction#####success"),u(ne);const ke={walletAddress:i.address,chainName:"Aptos",...ne,...Oe,date:new Date().getTime()+6048e5};return s.setTransactionList(ke),de?{status:!0,nftInfo:Oe.events.filter(Ke=>Ke.type.includes("CreateTokenDataEvent"))}:!0}else{if(Oe&&!Oe.success)return a.close(ne.hash+"loading"),console.log("watchTransaction#####error"),l(ne.title),!1;console.log("watchTransaction#####one more"),setTimeout(()=>d(ne,de),3e3)}},h=async(ne,de=!1)=>{const Oe=await n.client.waitForTransactionWithResult(ne.hash);if(console.log("watchTransaction###res###",Oe),Oe&&Oe.success){console.log("watchTransaction#####success");const ke={walletAddress:i.address,chainName:"Aptos",...ne,...Oe,date:new Date().getTime()+6048e5};s.setTransactionList(ke)}},g=async ne=>{try{const de=await n.Resources.getCoinStores(ne),Oe=[];return de.forEach(ke=>{let Le="";ke.coinAddress.includes("0x0000000000000000000000000000000000000000000000000000000000000001")?Le=ke.coinAddress.replace(/0x0000000000000000000000000000000000000000000000000000000000000001/,"0x1"):Le=ke.coinAddress,Oe.push({...ke,coinAddress:Le})}),Oe}catch{return[]}},b=async ne=>{try{i.setLoading(!0);const de=await g(ne),Oe={};de.forEach(ke=>{const Le=ke?ke.coin.value:"0";Oe[ke.coinAddress]={...ke,balance:Le}}),console.log("1212###assets####",Oe),i.setAssets(Oe),i.setLoading(!1)}catch(de){console.log("getAccount##error###",de),i.setLoading(!1),i.setAssets({})}},v=async()=>{const ne={pubkey:ji(De.Aptos.accountPublicKey),address:ji(De.Aptos.accountAddress)},de=await n.Token.getAllRegisteredTokenList(ne);return console.log("0215####tokenList####",de),de},k=async(ne,de,Oe)=>n.Resources.getPoolState(ne,de,Oe),E=async ne=>{const de={pubkey:ji(De.Aptos.accountPublicKey),address:ji(De.Aptos.accountAddress)};return await n.Token.getOwnerWarpPoolList(De.Aptos.TokenDeployer,de)},N=async ne=>await n.Resources.getPool(ne);return{setTransations:h,showTransitionPending:c,showTransitionSuccess:u,showTransitionError:l,watchTransaction:d,getAccount:b,getPoolState:k,getPools:async ne=>await n.Resources.getPools(ne),getPool:N,registerCoin:ne=>({function:"0x1::managed_coin::register",type_arguments:[ne],arguments:[],type:"entry_function_payload"}),estLiquidityAndcoinAmountFromOneAmounts:ne=>{console.log("estLiquidityAndcoinAmountFromOneAmounts###params####",ne);const{tokenA:de,tokenB:Oe,lowerTick:ke,upperTick:Le,coinAmount:tt,iscoinA:Ke,roundUp:et,slippage:Xt,curSqrtPrice:ut}=ne,nt=Ci.estLiquidityAndcoinAmountFromOneAmounts(ke,Le,tt,Ke,et,Xt,ut),Kt=de.decimals,At=Oe.decimals,{tokenMaxA:Pt,tokenMaxB:hn,liquidityAmount:Ut}=nt;return{tokenMaxAOrigin:Pt.toString(),tokenMaxBOrigin:hn.toString(),tokenMaxA:fn(Pt.toString(),Kt),tokenMaxB:fn(hn.toString(),At),liquidityAmount:Ut}},getCoinAmountFromLiquidity:ne=>{const{pool:de,position:Oe,roundUp:ke}=ne,Le=Number(Oe.tick_lower_index),tt=Number(Oe.tick_upper_index),Ke=Yt.tickIndexToSqrtPriceX64(Le),et=Yt.tickIndexToSqrtPriceX64(tt),Xt=Ci.getCoinAmountFromLiquidity(new y(Oe.liquidity),new y(de.current_sqrt_price),Ke,et,ke),ut=fn(Xt.coinA.toString(),de.coinA.decimals),nt=fn(Xt.coinB.toString(),de.coinB.decimals);return{coinaAmount:ut,coinbAmount:nt}},getAddLiquidityTransactionPayload:async ne=>{const{pool:de,amount:Oe,fix_amount_a:ke,roundUp:Le,tick_lower:tt,tick_upper:Ke,index:et,slippage:Xt}=ne;console.log(ne,"===>params411");const ut=await N(de.poolAddress),nt=ke?Ln(Oe,de.token_a.decimals):Ln(Oe,de.token_b.decimals),Kt=Yt.sqrtPriceX64ToTickIndex(new y(ut.current_sqrt_price));let At,Pt;if(Kt>=tt&&Kt<=Ke){const Ut=Ci.estLiquidityAndcoinAmountFromOneAmounts(tt,Ke,new y(nt.toString()),ke,Le,Xt,new y(ut.current_sqrt_price));At=ke?nt.toNumber():Ut.tokenMaxA.toNumber(),Pt=ke?Ut.tokenMaxB.toNumber():nt.toNumber()}else Kt>Ke?(At=0,Pt=nt.toNumber()):Kt<tt&&(At=nt.toNumber(),Pt=0);return n.Position.createAddLiquidityTransactionPayload({pool:de.poolAddress,coinTypeA:de.token_a.address,coinTypeB:de.token_b.address,amount_a:At,amount_b:Pt,fix_amount_a:ke,tick_lower:tt,tick_upper:Ke,is_open:!et,index:et})},getRemoveLiquidityTransactionPayload:async ne=>{const{pool:de,coinTypeA:Oe,coinTypeB:ke,coinTypeC:Le,coinTypeD:tt,coinTypeE:Ke,position:et,delta_liquidity:Xt,rewards_num:ut}=ne;console.log("getRemoveLiquidityTransactionPayload####delta_liquidity#####",Xt.toString());const nt=await N(de.poolAddress),Kt={...de,...nt},At=Number(et.tick_lower_index),Pt=Number(et.tick_upper_index),hn=Yt.tickIndexToSqrtPriceX64(At),Ut=Yt.tickIndexToSqrtPriceX64(Pt),sn=Ci.getCoinAmountFromLiquidity(Xt,new y(Kt.current_sqrt_price),hn,Ut,!0),D=mt(sn.coinA.toString()).mul(mt(1-ne.slippage/100)),K=mt(sn.coinB.toString()).mul(mt(1-ne.slippage/100));return await n.Position.removeLiquidityTransactionPayload({pool:de.poolAddress,coinTypeA:Oe,coinTypeB:ke,coinTypeC:Le,coinTypeD:tt,coinTypeE:Ke,delta_liquidity:Xt,min_amount_a:Number(yn(D.toString(),0)),min_amount_b:Number(yn(K.toString(),0)),pos_index:ne.position.index,is_close:!1,rewards_num:ut})},getCollectFeeTransactionPayload:async ne=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:ne.pool.poolAddress,coinTypeA:ne.pool.token_a.address,coinTypeB:ne.pool.token_b.address,pos_index:ne.position.index});const de=await n.Position.collectFeeTransactionPayload({pool:ne.pool.poolAddress,coinTypeA:ne.pool.token_a.address,coinTypeB:ne.pool.token_b.address,pos_index:ne.position.index});return console.log("1130###getCollectFeeTransactionPayload###result##",de),de},getPositionList:async(ne,de)=>{if(De.Aptos.network==="mainnet"){const Oe={operationName:"AccountTokensData",variables:{owner_address:ne,limit:1e5,offset:0},query:`query AccountTokensData($owner_address: String, $limit: Int, $offset: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $owner_address}, amount: {_gt: "0"}}
    limit: $limit
    offset: $offset
  ) {
    token_data_id_hash
 creator_address
 name
    collection_name
  table_type
    property_version
    amount
    __typename
  }
}`},ke=await $fetch("https://indexer.mainnet.aptoslabs.com/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe)});console.log("0116###pools####",de);const Le=ke&&ke.data&&ke.data.current_token_ownerships||[];console.log("###list",Le);const tt=[];for(let Ke=0;Ke<Le.length;Ke++){const et=Le[Ke],Xt=de[x3(et.creator_address)];if(console.log(Xt,"##pool"),Xt){const ut=et.name.split("-")[1],nt=Xt.positions_handle,Kt=await n.Resources.getPositionInfoByIndex(nt,ut);tt.push({...Kt,tokenName:et.name})}}return console.log("0221###aptos###getPositionList###",tt),tt}else{const Oe=Object.values(de);console.log(Oe,"###poolList");const ke=await n.Resources.getPositionList(ne,Oe);return console.log("0221###aptos###getPositionList###list###",ke),ke}},getPositionInfo:async(ne,de,Oe,ke="")=>({...await n.Resources.getPositionInfo(ne,Oe),tokenName:Oe,collectionName:de}),getSwapTransactionPayload:async ne=>{const{pool:de,a2b:Oe,byAmountIn:ke,amount:Le,slippage:tt}=ne,Ke=de.poolAddress||de.address,et=de.token_a.decimals,Xt=de.token_b.decimals,ut=await N(de.address);let nt;Oe&&ke||!Oe&&!ke?nt=Ln(Le,et):nt=Ln(Le,Xt);const Kt=await n.Swap.preswap({pool:ut,decimalsA:et,decimalsB:Xt,a2b:Oe,by_amount_in:ke,amount:nt.toString()});console.log("1130###getSwapTransactionPayload###preSwapRes###",Kt),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountOut###",Kt.estimatedAmountOut.toString()),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountIn###",Kt.estimatedAmountIn.toString());const At=mt(Kt.estimatedAmountOut.toString()),Pt=mt(Kt.estimatedAmountIn.toString()),hn=ke?At.sub(At.mul(tt)):Pt.add(Pt.mul(tt));console.log("1130###amountLimit####",hn.toString()),console.log("1130###swap##params###",{pool_addr:Ke,coinTypeA:de.token_a.address,coinTypeB:de.token_b.address,a_to_b:Kt.aToB,by_amount_in:Kt.byAmountIn,amount:Kt.amount.toString(),amount_limit:yn(hn.toString(),0)||""});const Ut=n.Swap.createSwapTransactionPayload({pool_addr:Ke,coinTypeA:de.token_a.address,coinTypeB:de.token_b.address,a_to_b:Kt.aToB,by_amount_in:Kt.byAmountIn,amount:Kt.amount.toString(),amount_limit:yn(hn.toString(),0)||"",partner:""});return console.log("1130###swap##result###",Ut),Ut},getCoin:ne=>({type:"entry_function_payload",function:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet",arguments:[],type_arguments:[]}),preSwap:async ne=>{const{pool:de,a2b:Oe,byAmountIn:ke,amount:Le}=ne;console.log(ne,"===>params");const tt=de.coinA.decimals,Ke=de.coinB.decimals;let et=de;de.coinTypeA||(et={...de,poolAddress:de.address,coinTypeA:de.coinA.address,coinTypeB:de.coinB.address});let Xt;Oe&&ke||!Oe&&!ke?Xt=Ln(Le,tt):Xt=Ln(Le,Ke);const ut=await n.Swap.preswap({pool:et,decimalsA:tt,decimalsB:Ke,a2b:Oe,by_amount_in:ke,amount:Xt.toString()});return{...ut,estimatedAmountIn:No(fn(ut.estimatedAmountIn.toString(),Oe?tt:Ke),Oe?tt:Ke),estimatedAmountOut:No(fn(ut.estimatedAmountOut.toString(),Oe?Ke:tt),Oe?Ke:tt),priceImpactPct:yn(ut.priceImpactPct,2)}},getTicks:async ne=>{try{return{list:await n.Fetcher.fetchTicks({pool:ne.poolAddress,coinTypeA:ne.coinTypeA,coinTypeB:ne.coinTypeB}),address:ne.poolAddress}}catch(de){console.log("getTicks Error###",de)}},TickMath:Yt,TickUtil:Od,ClmmPoolUtil:Ci,getNearestTickByTick:pc,getTickDataFromUrlData:Oy,getCollectFeesQuote:async ne=>{console.log(ne,"params====>");const{pool:de,position:Oe,tickLowerData:ke,tickUpperData:Le}=ne,tt=z2({clmmpool:de,position:Oe,tickLower:ke,tickUpper:Le}),Ke=fn(tt.feeOwedA.toString(),de.token_a.decimals),et=fn(tt.feeOwedB.toString(),de.token_b.decimals);return console.log("0118###useApots###result.feeOwedA.toString()###",tt.feeOwedA.toString()),console.log("0118###useApots###result.feeOwedB.toString()###",tt.feeOwedB.toString()),console.log("0118###useApots###feeOwedA###",Ke),console.log("0118###useApots###feeOwedB###",et),{feeOwedA:Number(Ke)>99999999999||Number(Ke)<0?"0":Ke,feeOwedB:Number(et)>99999999999||Number(et)<0?"0":et}},mintCoin:ne=>({function:`${De.Aptos.faucetObjectId}::coin::mint`,type_arguments:[`${De.Aptos.faucetObjectId}::coin::${ne.name}`],arguments:[ne.amount],type:"entry_function_payload"}),getNftHash:ne=>{const de=`${ne.creator}::${ne.collection}::${ne.name}`;return k3(de).toString()},getCollectRewarderTransactionPayload:ne=>n.Rewarder.collectPoolRewarderTransactionPayload(ne),getPosRewardersAmount:async ne=>{console.log(JSON.stringify(ne),"=====>params792");const{poolAddress:de,positionName:Oe,tickLowerData:ke,tickUpperData:Le}=ne;return await n.Rewarder.posRewardersAmount(de,Oe,ke,Le)},getTokenList:v,getTickDataByIndex:async(ne,de)=>(console.log(ne,de,"getTickDataByIndex"),await n.Resources.getTickDataByIndex(ne,de)),initSwapRouter:async ne=>{n.Router.addPathProvider(ne),await n.Router.setCoinList({pubkey:ji(De.Aptos.accountPublicKey),address:ji(De.Aptos.accountAddress)}),await n.Router.loadGraph()},getSwapRouter:async(ne,de)=>await n.Router.price(ne,de),getEstPositionAPRWithDelta:async(ne,de,Oe,ke,Le,tt,Ke,et,Xt,ut,nt,Kt,At,Pt,hn,Ut,sn,D,K,X,te,oe,se,we)=>await F2(ne,de,Oe,ke,Le,tt,Ke,et,Xt,ut,nt,Kt,At,Pt,hn,Ut,sn,D,K,X,te,oe,se,we),getPriceImpactPct:(ne,de,Oe)=>{const ke=Yt.sqrtPriceX64ToPrice(new y(ne.current_sqrt_price),ne.coinA.decimals,ne.coinB.decimals).toNumber(),Le=Oe?ke:1/ke,tt=Math.abs(Le-Number(de))/Number(Le)*100;return Number(yn(tt,2))},getLpList:E,getEstPositionAPRWithMulti:async(ne,de,Oe,ke)=>await j2(ne,de,Oe,ke),getCreatPoolTransactionPayload:async ne=>{const{coinTypeA:de,coinTypeB:Oe,tick_lower:ke,tick_upper:Le,tick_spacing:tt,initialize_sqrt_price:Ke,max_amount_a:et,max_amount_b:Xt,slippage:ut,fix_amount_a:nt,decimalsA:Kt,decimalsB:At,liquidityInput:Pt}=ne;console.log(ne,"params===>");const hn=nt?Ln(et,Kt):Ln(Xt,At);console.log(hn,"===>coinAmount");const Ut=Yt.sqrtPriceX64ToTickIndex(new y(Ke));let sn,D;const K=Yt.tickIndexToSqrtPriceX64(ke),X=Yt.tickIndexToSqrtPriceX64(Le);console.log(K,"===>minPriceX64"),console.log(X,"===>maxPriceX64");let te;return Ut>ke&&Ut<Le?(te=Ci.estLiquidityAndcoinAmountFromOneAmounts(ke,Le,new y(hn.toString()),nt,!0,ut,new y(Ke)),sn=nt?hn.toNumber():te.tokenMaxA.toNumber(),D=nt?te.tokenMaxB.toNumber():hn.toNumber()):Ut>=Le?(te=Ho(K,X,new y(hn.toString())),sn=new y(Pt.tokenMaxA*Math.pow(10,Kt)),D=new y(Pt.tokenMaxB*Math.pow(10,At))):Ut<=ke&&(te=zo(K,X,new y(hn.toString())),sn=new y(Pt.tokenMaxA*Math.pow(10,Kt)),D=new y(Pt.tokenMaxB*Math.pow(10,At))),console.log(te,"===>preAddResult"),await n.Pool.creatPoolTransactionPayload({coinTypeA:de,coinTypeB:Oe,tick_spacing:tt,initialize_sqrt_price:new y(Ke),uri:"",delta_liquidity:Ut>ke&&Ut<Le?te.liquidityAmount:te,max_amount_a:sn,max_amount_b:D,tick_lower:ke,tick_upper:Le},!0)},getTokenListByCoinType:async()=>await n.Token.getTokenListByCoinType("",0,99999),getPoolImmutables:async()=>await n.Resources.getPoolImmutables(),estimateLiquidityForCoinA:zo,estimateLiquidityForCoinB:Ho,getTokenBySymbol:async(ne,de)=>{if(!de)return null;let Oe=null;for(const ke in ne){const Le=ne[ke];if(Le.address.toUpperCase()===de.toUpperCase()){Oe=Le;break}}return Oe},estCoinAmountsFromTotalAmount:ne=>{const{lowerTick:de,upperTick:Oe,decimalsA:ke,decimalsB:Le,curSqrtPrice:tt,totalAmount:Ke,tokenPriceA:et,tokenPriceB:Xt}=ne;console.log(JSON.stringify({...ne,curSqrtPrice:tt.toString()}),"params===>");const ut=Ci.estCoinAmountsFromTotalAmount(de,Oe,tt,Ke,et,Xt);console.log("coinAmounts: ",ut);const nt=qc(ut.amountA.toFixed(ke,ie.ROUND_UP).toString(),ke),Kt=qc(ut.amountB.toFixed(Le,ie.ROUND_UP).toString(),Le),At={coinA:new y(nt),coinB:new y(Kt)};return{amountA:fn(nt.toString(),ke),amountB:fn(Kt.toString(),Le),tokenAmountsInfo:At}},getCreateAddLiquidityPayload:async ne=>{const{curSqrtPrice:de,tickLower:Oe,tickUpper:ke,tokenAmounts:Le,pool:tt,slippage:Ke}=ne;console.log(JSON.stringify(ne),"####getCreateAddLiquidityPayload 1593");const et=Ci.estimateLiquidityFromcoinAmounts(de,Oe,ke,Le),Xt=new ie(Le.coinA.toString()).mul(1+Ke),ut=new ie(Le.coinB.toString()).mul(1+Ke),nt={coinTypeA:tt.coinTypeA,coinTypeB:tt.coinTypeB,tick_lower:Oe,tick_upper:ke,pool:tt.address,delta_liquidity:et,max_amount_a:ie.ceil(Xt).toString(),max_amount_b:ie.ceil(ut).toString(),is_open:!0,index:0};return console.log(JSON.stringify(nt),"==>addLiquidityPayloadParams"),await n.Position.createAddLiquidityTransactionPayload(nt)},calculateDepositRatioFixTokenA:(ne,de,Oe)=>Ci.calculateDepositRatioFixTokenA(ne,de,Oe)}}let Xa;const C3=new Uint8Array(16);function B3(){if(!Xa&&(Xa=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Xa))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xa(C3)}const jn=[];for(let e=0;e<256;++e)jn.push((e+256).toString(16).slice(1));function I3(e,t=0){return jn[e[t+0]]+jn[e[t+1]]+jn[e[t+2]]+jn[e[t+3]]+"-"+jn[e[t+4]]+jn[e[t+5]]+"-"+jn[e[t+6]]+jn[e[t+7]]+"-"+jn[e[t+8]]+jn[e[t+9]]+"-"+jn[e[t+10]]+jn[e[t+11]]+jn[e[t+12]]+jn[e[t+13]]+jn[e[t+14]]+jn[e[t+15]]}const O3=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$0={randomUUID:O3};function Gl(e,t,n){if($0.randomUUID&&!t&&!e)return $0.randomUUID();e=e||{};const i=e.random||(e.rng||B3)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){n=n||0;for(let s=0;s<16;++s)t[n+s]=i[s];return t}return I3(i)}function Dy(e,t){return function(){return e.apply(t,arguments)}}const{toString:R3}=Object.prototype,{getPrototypeOf:Vh}=Object,Qu=(e=>t=>{const n=R3.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),rs=e=>(e=e.toLowerCase(),t=>Qu(t)===e),el=e=>t=>typeof t===e,{isArray:qr}=Array,da=el("undefined");function $3(e){return e!==null&&!da(e)&&e.constructor!==null&&!da(e.constructor)&&Ui(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const My=rs("ArrayBuffer");function U3(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&My(e.buffer),t}const q3=el("string"),Ui=el("function"),Ny=el("number"),tl=e=>e!==null&&typeof e=="object",L3=e=>e===!0||e===!1,gc=e=>{if(Qu(e)!=="object")return!1;const t=Vh(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},D3=rs("Date"),M3=rs("File"),N3=rs("Blob"),F3=rs("FileList"),j3=e=>tl(e)&&Ui(e.pipe),z3=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ui(e.append)&&((t=Qu(e))==="formdata"||t==="object"&&Ui(e.toString)&&e.toString()==="[object FormData]"))},H3=rs("URLSearchParams"),K3=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ra(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let i,s;if(typeof e!="object"&&(e=[e]),qr(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),r=o.length;let a;for(i=0;i<r;i++)a=o[i],t.call(null,e[a],a,e)}}function Fy(e,t){t=t.toLowerCase();const n=Object.keys(e);let i=n.length,s;for(;i-- >0;)if(s=n[i],t===s.toLowerCase())return s;return null}const jy=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),zy=e=>!da(e)&&e!==jy;function Rd(){const{caseless:e}=zy(this)&&this||{},t={},n=(i,s)=>{const o=e&&Fy(t,s)||s;gc(t[o])&&gc(i)?t[o]=Rd(t[o],i):gc(i)?t[o]=Rd({},i):qr(i)?t[o]=i.slice():t[o]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&Ra(arguments[i],n);return t}const G3=(e,t,n,{allOwnKeys:i}={})=>(Ra(t,(s,o)=>{n&&Ui(s)?e[o]=Dy(s,n):e[o]=s},{allOwnKeys:i}),e),W3=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),V3=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},X3=(e,t,n,i)=>{let s,o,r;const a={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)r=s[o],(!i||i(r,e,t))&&!a[r]&&(t[r]=e[r],a[r]=!0);e=n!==!1&&Vh(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},J3=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return i!==-1&&i===n},Z3=e=>{if(!e)return null;if(qr(e))return e;let t=e.length;if(!Ny(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Y3=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Vh(Uint8Array)),Q3=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let s;for(;(s=i.next())&&!s.done;){const o=s.value;t.call(e,o[0],o[1])}},eP=(e,t)=>{let n;const i=[];for(;(n=e.exec(t))!==null;)i.push(n);return i},tP=rs("HTMLFormElement"),nP=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,s){return i.toUpperCase()+s}),U0=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),iP=rs("RegExp"),Hy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};Ra(n,(s,o)=>{let r;(r=t(s,o,e))!==!1&&(i[o]=r||s)}),Object.defineProperties(e,i)},sP=e=>{Hy(e,(t,n)=>{if(Ui(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=e[n];if(Ui(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},oP=(e,t)=>{const n={},i=s=>{s.forEach(o=>{n[o]=!0})};return qr(e)?i(e):i(String(e).split(t)),n},rP=()=>{},aP=(e,t)=>(e=+e,Number.isFinite(e)?e:t),Wl="abcdefghijklmnopqrstuvwxyz",q0="0123456789",Ky={DIGIT:q0,ALPHA:Wl,ALPHA_DIGIT:Wl+Wl.toUpperCase()+q0},cP=(e=16,t=Ky.ALPHA_DIGIT)=>{let n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n};function uP(e){return!!(e&&Ui(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const lP=e=>{const t=new Array(10),n=(i,s)=>{if(tl(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[s]=i;const o=qr(i)?[]:{};return Ra(i,(r,a)=>{const c=n(r,s+1);!da(c)&&(o[a]=c)}),t[s]=void 0,o}}return i};return n(e,0)},dP=rs("AsyncFunction"),hP=e=>e&&(tl(e)||Ui(e))&&Ui(e.then)&&Ui(e.catch),_e={isArray:qr,isArrayBuffer:My,isBuffer:$3,isFormData:z3,isArrayBufferView:U3,isString:q3,isNumber:Ny,isBoolean:L3,isObject:tl,isPlainObject:gc,isUndefined:da,isDate:D3,isFile:M3,isBlob:N3,isRegExp:iP,isFunction:Ui,isStream:j3,isURLSearchParams:H3,isTypedArray:Y3,isFileList:F3,forEach:Ra,merge:Rd,extend:G3,trim:K3,stripBOM:W3,inherits:V3,toFlatObject:X3,kindOf:Qu,kindOfTest:rs,endsWith:J3,toArray:Z3,forEachEntry:Q3,matchAll:eP,isHTMLForm:tP,hasOwnProperty:U0,hasOwnProp:U0,reduceDescriptors:Hy,freezeMethods:sP,toObjectSet:oP,toCamelCase:nP,noop:rP,toFiniteNumber:aP,findKey:Fy,global:jy,isContextDefined:zy,ALPHABET:Ky,generateString:cP,isSpecCompliantForm:uP,toJSONObject:lP,isAsyncFn:dP,isThenable:hP};function tn(e,t,n,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}_e.inherits(tn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_e.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Gy=tn.prototype,Wy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Wy[e]={value:e}});Object.defineProperties(tn,Wy);Object.defineProperty(Gy,"isAxiosError",{value:!0});tn.from=(e,t,n,i,s,o)=>{const r=Object.create(Gy);return _e.toFlatObject(e,r,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),tn.call(r,e.message,t,n,i,s),r.cause=e,r.name=e.name,o&&Object.assign(r,o),r};const fP=null;function $d(e){return _e.isPlainObject(e)||_e.isArray(e)}function Vy(e){return _e.endsWith(e,"[]")?e.slice(0,-2):e}function L0(e,t,n){return e?e.concat(t).map(function(s,o){return s=Vy(s),!n&&o?"["+s+"]":s}).join(n?".":""):t}function pP(e){return _e.isArray(e)&&!e.some($d)}const gP=_e.toFlatObject(_e,{},null,function(t){return/^is[A-Z]/.test(t)});function nl(e,t,n){if(!_e.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=_e.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,k){return!_e.isUndefined(k[v])});const i=n.metaTokens,s=n.visitor||l,o=n.dots,r=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&_e.isSpecCompliantForm(t);if(!_e.isFunction(s))throw new TypeError("visitor must be a function");function u(b){if(b===null)return"";if(_e.isDate(b))return b.toISOString();if(!c&&_e.isBlob(b))throw new tn("Blob is not supported. Use a Buffer instead.");return _e.isArrayBuffer(b)||_e.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function l(b,v,k){let E=b;if(b&&!k&&typeof b=="object"){if(_e.endsWith(v,"{}"))v=i?v:v.slice(0,-2),b=JSON.stringify(b);else if(_e.isArray(b)&&pP(b)||(_e.isFileList(b)||_e.endsWith(v,"[]"))&&(E=_e.toArray(b)))return v=Vy(v),E.forEach(function(A,P){!(_e.isUndefined(A)||A===null)&&t.append(r===!0?L0([v],P,o):r===null?v:v+"[]",u(A))}),!1}return $d(b)?!0:(t.append(L0(k,v,o),u(b)),!1)}const d=[],h=Object.assign(gP,{defaultVisitor:l,convertValue:u,isVisitable:$d});function g(b,v){if(!_e.isUndefined(b)){if(d.indexOf(b)!==-1)throw Error("Circular reference detected in "+v.join("."));d.push(b),_e.forEach(b,function(E,N){(!(_e.isUndefined(E)||E===null)&&s.call(t,E,_e.isString(N)?N.trim():N,v,h))===!0&&g(E,v?v.concat(N):[N])}),d.pop()}}if(!_e.isObject(e))throw new TypeError("data must be an object");return g(e),t}function D0(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Xh(e,t){this._pairs=[],e&&nl(e,this,t)}const Xy=Xh.prototype;Xy.append=function(t,n){this._pairs.push([t,n])};Xy.toString=function(t){const n=t?function(i){return t.call(this,i,D0)}:D0;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function _P(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Jy(e,t,n){if(!t)return e;const i=n&&n.encode||_P,s=n&&n.serialize;let o;if(s?o=s(t,n):o=_e.isURLSearchParams(t)?t.toString():new Xh(t,n).toString(i),o){const r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class mP{constructor(){this.handlers=[]}use(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){_e.forEach(this.handlers,function(i){i!==null&&t(i)})}}const M0=mP,Zy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yP=typeof URLSearchParams<"u"?URLSearchParams:Xh,wP=typeof FormData<"u"?FormData:null,bP=typeof Blob<"u"?Blob:null,vP={isBrowser:!0,classes:{URLSearchParams:yP,FormData:wP,Blob:bP},protocols:["http","https","file","blob","url","data"]},Yy=typeof window<"u"&&typeof document<"u",xP=(e=>Yy&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),TP=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),AP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yy,hasStandardBrowserEnv:xP,hasStandardBrowserWebWorkerEnv:TP},Symbol.toStringTag,{value:"Module"})),ss={...AP,...vP};function kP(e,t){return nl(e,new ss.classes.URLSearchParams,Object.assign({visitor:function(n,i,s,o){return ss.isNode&&_e.isBuffer(n)?(this.append(i,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function SP(e){return _e.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function PP(e){const t={},n=Object.keys(e);let i;const s=n.length;let o;for(i=0;i<s;i++)o=n[i],t[o]=e[o];return t}function Qy(e){function t(n,i,s,o){let r=n[o++];const a=Number.isFinite(+r),c=o>=n.length;return r=!r&&_e.isArray(s)?s.length:r,c?(_e.hasOwnProp(s,r)?s[r]=[s[r],i]:s[r]=i,!a):((!s[r]||!_e.isObject(s[r]))&&(s[r]=[]),t(n,i,s[r],o)&&_e.isArray(s[r])&&(s[r]=PP(s[r])),!a)}if(_e.isFormData(e)&&_e.isFunction(e.entries)){const n={};return _e.forEachEntry(e,(i,s)=>{t(SP(i),s,n,0)}),n}return null}function EP(e,t,n){if(_e.isString(e))try{return(t||JSON.parse)(e),_e.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}const Jh={transitional:Zy,adapter:["xhr","http"],transformRequest:[function(t,n){const i=n.getContentType()||"",s=i.indexOf("application/json")>-1,o=_e.isObject(t);if(o&&_e.isHTMLForm(t)&&(t=new FormData(t)),_e.isFormData(t))return s&&s?JSON.stringify(Qy(t)):t;if(_e.isArrayBuffer(t)||_e.isBuffer(t)||_e.isStream(t)||_e.isFile(t)||_e.isBlob(t))return t;if(_e.isArrayBufferView(t))return t.buffer;if(_e.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return kP(t,this.formSerializer).toString();if((a=_e.isFileList(t))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return nl(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return o||s?(n.setContentType("application/json",!1),EP(t)):t}],transformResponse:[function(t){const n=this.transitional||Jh.transitional,i=n&&n.forcedJSONParsing,s=this.responseType==="json";if(t&&_e.isString(t)&&(i&&!this.responseType||s)){const r=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(a){if(r)throw a.name==="SyntaxError"?tn.from(a,tn.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ss.classes.FormData,Blob:ss.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_e.forEach(["delete","get","head","post","put","patch"],e=>{Jh.headers[e]={}});const Zh=Jh,CP=_e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),BP=e=>{const t={};let n,i,s;return e&&e.split(`
`).forEach(function(r){s=r.indexOf(":"),n=r.substring(0,s).trim().toLowerCase(),i=r.substring(s+1).trim(),!(!n||t[n]&&CP[n])&&(n==="set-cookie"?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t},N0=Symbol("internals");function Fr(e){return e&&String(e).trim().toLowerCase()}function _c(e){return e===!1||e==null?e:_e.isArray(e)?e.map(_c):String(e)}function IP(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}const OP=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Vl(e,t,n,i,s){if(_e.isFunction(i))return i.call(this,t,n);if(s&&(t=n),!!_e.isString(t)){if(_e.isString(i))return t.indexOf(i)!==-1;if(_e.isRegExp(i))return i.test(t)}}function RP(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,i)=>n.toUpperCase()+i)}function $P(e,t){const n=_e.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(s,o,r){return this[i].call(this,t,s,o,r)},configurable:!0})})}class il{constructor(t){t&&this.set(t)}set(t,n,i){const s=this;function o(a,c,u){const l=Fr(c);if(!l)throw new Error("header name must be a non-empty string");const d=_e.findKey(s,l);(!d||s[d]===void 0||u===!0||u===void 0&&s[d]!==!1)&&(s[d||c]=_c(a))}const r=(a,c)=>_e.forEach(a,(u,l)=>o(u,l,c));return _e.isPlainObject(t)||t instanceof this.constructor?r(t,n):_e.isString(t)&&(t=t.trim())&&!OP(t)?r(BP(t),n):t!=null&&o(n,t,i),this}get(t,n){if(t=Fr(t),t){const i=_e.findKey(this,t);if(i){const s=this[i];if(!n)return s;if(n===!0)return IP(s);if(_e.isFunction(n))return n.call(this,s,i);if(_e.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Fr(t),t){const i=_e.findKey(this,t);return!!(i&&this[i]!==void 0&&(!n||Vl(this,this[i],i,n)))}return!1}delete(t,n){const i=this;let s=!1;function o(r){if(r=Fr(r),r){const a=_e.findKey(i,r);a&&(!n||Vl(i,i[a],a,n))&&(delete i[a],s=!0)}}return _e.isArray(t)?t.forEach(o):o(t),s}clear(t){const n=Object.keys(this);let i=n.length,s=!1;for(;i--;){const o=n[i];(!t||Vl(this,this[o],o,t,!0))&&(delete this[o],s=!0)}return s}normalize(t){const n=this,i={};return _e.forEach(this,(s,o)=>{const r=_e.findKey(i,o);if(r){n[r]=_c(s),delete n[o];return}const a=t?RP(o):String(o).trim();a!==o&&delete n[o],n[a]=_c(s),i[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return _e.forEach(this,(i,s)=>{i!=null&&i!==!1&&(n[s]=t&&_e.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const i=new this(t);return n.forEach(s=>i.set(s)),i}static accessor(t){const i=(this[N0]=this[N0]={accessors:{}}).accessors,s=this.prototype;function o(r){const a=Fr(r);i[a]||($P(s,r),i[a]=!0)}return _e.isArray(t)?t.forEach(o):o(t),this}}il.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_e.reduceDescriptors(il.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}});_e.freezeMethods(il);const ls=il;function Xl(e,t){const n=this||Zh,i=t||n,s=ls.from(i.headers);let o=i.data;return _e.forEach(e,function(a){o=a.call(n,o,s.normalize(),t?t.status:void 0)}),s.normalize(),o}function ew(e){return!!(e&&e.__CANCEL__)}function $a(e,t,n){tn.call(this,e??"canceled",tn.ERR_CANCELED,t,n),this.name="CanceledError"}_e.inherits($a,tn,{__CANCEL__:!0});function UP(e,t,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?e(n):t(new tn("Request failed with status code "+n.status,[tn.ERR_BAD_REQUEST,tn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const qP=ss.hasStandardBrowserEnv?function(){return{write:function(n,i,s,o,r,a){const c=[];c.push(n+"="+encodeURIComponent(i)),_e.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),_e.isString(o)&&c.push("path="+o),_e.isString(r)&&c.push("domain="+r),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(n){const i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function LP(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function DP(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function tw(e,t){return e&&!LP(t)?DP(e,t):t}const MP=ss.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let i;function s(o){let r=o;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=s(window.location.href),function(r){const a=_e.isString(r)?s(r):r;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();function NP(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FP(e,t){e=e||10;const n=new Array(e),i=new Array(e);let s=0,o=0,r;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),l=i[o];r||(r=u),n[s]=c,i[s]=u;let d=o,h=0;for(;d!==s;)h+=n[d++],d=d%e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),u-r<t)return;const g=l&&u-l;return g?Math.round(h*1e3/g):void 0}}function F0(e,t){let n=0;const i=FP(50,250);return s=>{const o=s.loaded,r=s.lengthComputable?s.total:void 0,a=o-n,c=i(a),u=o<=r;n=o;const l={loaded:o,total:r,progress:r?o/r:void 0,bytes:a,rate:c||void 0,estimated:c&&r&&u?(r-o)/c:void 0,event:s};l[t?"download":"upload"]=!0,e(l)}}const jP=typeof XMLHttpRequest<"u",zP=jP&&function(e){return new Promise(function(n,i){let s=e.data;const o=ls.from(e.headers).normalize(),r=e.responseType;let a;function c(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}let u;if(_e.isFormData(s)){if(ss.hasStandardBrowserEnv||ss.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((u=o.getContentType())!==!1){const[b,...v]=u?u.split(";").map(k=>k.trim()).filter(Boolean):[];o.setContentType([b||"multipart/form-data",...v].join("; "))}}let l=new XMLHttpRequest;if(e.auth){const b=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.set("Authorization","Basic "+btoa(b+":"+v))}const d=tw(e.baseURL,e.url);l.open(e.method.toUpperCase(),Jy(d,e.params,e.paramsSerializer),!0),l.timeout=e.timeout;function h(){if(!l)return;const b=ls.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),k={data:!r||r==="text"||r==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:b,config:e,request:l};UP(function(N){n(N),c()},function(N){i(N),c()},k),l=null}if("onloadend"in l?l.onloadend=h:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(h)},l.onabort=function(){l&&(i(new tn("Request aborted",tn.ECONNABORTED,e,l)),l=null)},l.onerror=function(){i(new tn("Network Error",tn.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let v=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const k=e.transitional||Zy;e.timeoutErrorMessage&&(v=e.timeoutErrorMessage),i(new tn(v,k.clarifyTimeoutError?tn.ETIMEDOUT:tn.ECONNABORTED,e,l)),l=null},ss.hasStandardBrowserEnv){const b=MP(d)&&e.xsrfCookieName&&qP.read(e.xsrfCookieName);b&&o.set(e.xsrfHeaderName,b)}s===void 0&&o.setContentType(null),"setRequestHeader"in l&&_e.forEach(o.toJSON(),function(v,k){l.setRequestHeader(k,v)}),_e.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),r&&r!=="json"&&(l.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&l.addEventListener("progress",F0(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",F0(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=b=>{l&&(i(!b||b.type?new $a(null,e,l):b),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const g=NP(d);if(g&&ss.protocols.indexOf(g)===-1){i(new tn("Unsupported protocol "+g+":",tn.ERR_BAD_REQUEST,e));return}l.send(s||null)})},Ud={http:fP,xhr:zP};_e.forEach(Ud,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const j0=e=>`- ${e}`,HP=e=>_e.isFunction(e)||e===null||e===!1,nw={getAdapter:e=>{e=_e.isArray(e)?e:[e];const{length:t}=e;let n,i;const s={};for(let o=0;o<t;o++){n=e[o];let r;if(i=n,!HP(n)&&(i=Ud[(r=String(n)).toLowerCase()],i===void 0))throw new tn(`Unknown adapter '${r}'`);if(i)break;s[r||"#"+o]=i}if(!i){const o=Object.entries(s).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let r=t?o.length>1?`since :
`+o.map(j0).join(`
`):" "+j0(o[0]):"as no adapter specified";throw new tn("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return i},adapters:Ud};function Jl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new $a(null,e)}function z0(e){return Jl(e),e.headers=ls.from(e.headers),e.data=Xl.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),nw.getAdapter(e.adapter||Zh.adapter)(e).then(function(i){return Jl(e),i.data=Xl.call(e,e.transformResponse,i),i.headers=ls.from(i.headers),i},function(i){return ew(i)||(Jl(e),i&&i.response&&(i.response.data=Xl.call(e,e.transformResponse,i.response),i.response.headers=ls.from(i.response.headers))),Promise.reject(i)})}const H0=e=>e instanceof ls?e.toJSON():e;function br(e,t){t=t||{};const n={};function i(u,l,d){return _e.isPlainObject(u)&&_e.isPlainObject(l)?_e.merge.call({caseless:d},u,l):_e.isPlainObject(l)?_e.merge({},l):_e.isArray(l)?l.slice():l}function s(u,l,d){if(_e.isUndefined(l)){if(!_e.isUndefined(u))return i(void 0,u,d)}else return i(u,l,d)}function o(u,l){if(!_e.isUndefined(l))return i(void 0,l)}function r(u,l){if(_e.isUndefined(l)){if(!_e.isUndefined(u))return i(void 0,u)}else return i(void 0,l)}function a(u,l,d){if(d in t)return i(u,l);if(d in e)return i(void 0,u)}const c={url:o,method:o,data:o,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:a,headers:(u,l)=>s(H0(u),H0(l),!0)};return _e.forEach(Object.keys(Object.assign({},e,t)),function(l){const d=c[l]||s,h=d(e[l],t[l],l);_e.isUndefined(h)&&d!==a||(n[l]=h)}),n}const iw="1.6.1",Yh={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Yh[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const K0={};Yh.transitional=function(t,n,i){function s(o,r){return"[Axios v"+iw+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return(o,r,a)=>{if(t===!1)throw new tn(s(r," has been removed"+(n?" in "+n:"")),tn.ERR_DEPRECATED);return n&&!K0[r]&&(K0[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,r,a):!0}};function KP(e,t,n){if(typeof e!="object")throw new tn("options must be an object",tn.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const o=i[s],r=t[o];if(r){const a=e[o],c=a===void 0||r(a,o,e);if(c!==!0)throw new tn("option "+o+" must be "+c,tn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new tn("Unknown option "+o,tn.ERR_BAD_OPTION)}}const qd={assertOptions:KP,validators:Yh},Cs=qd.validators;class Lc{constructor(t){this.defaults=t,this.interceptors={request:new M0,response:new M0}}request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=br(this.defaults,n);const{transitional:i,paramsSerializer:s,headers:o}=n;i!==void 0&&qd.assertOptions(i,{silentJSONParsing:Cs.transitional(Cs.boolean),forcedJSONParsing:Cs.transitional(Cs.boolean),clarifyTimeoutError:Cs.transitional(Cs.boolean)},!1),s!=null&&(_e.isFunction(s)?n.paramsSerializer={serialize:s}:qd.assertOptions(s,{encode:Cs.function,serialize:Cs.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let r=o&&_e.merge(o.common,o[n.method]);o&&_e.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),n.headers=ls.concat(r,o);const a=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(c=c&&v.synchronous,a.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let l,d=0,h;if(!c){const b=[z0.bind(this),void 0];for(b.unshift.apply(b,a),b.push.apply(b,u),h=b.length,l=Promise.resolve(n);d<h;)l=l.then(b[d++],b[d++]);return l}h=a.length;let g=n;for(d=0;d<h;){const b=a[d++],v=a[d++];try{g=b(g)}catch(k){v.call(this,k);break}}try{l=z0.call(this,g)}catch(b){return Promise.reject(b)}for(d=0,h=u.length;d<h;)l=l.then(u[d++],u[d++]);return l}getUri(t){t=br(this.defaults,t);const n=tw(t.baseURL,t.url);return Jy(n,t.params,t.paramsSerializer)}}_e.forEach(["delete","get","head","options"],function(t){Lc.prototype[t]=function(n,i){return this.request(br(i||{},{method:t,url:n,data:(i||{}).data}))}});_e.forEach(["post","put","patch"],function(t){function n(i){return function(o,r,a){return this.request(br(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}Lc.prototype[t]=n(),Lc.prototype[t+"Form"]=n(!0)});const mc=Lc;class Qh{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const i=this;this.promise.then(s=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](s);i._listeners=null}),this.promise.then=s=>{let o;const r=new Promise(a=>{i.subscribe(a),o=a}).then(s);return r.cancel=function(){i.unsubscribe(o)},r},t(function(o,r,a){i.reason||(i.reason=new $a(o,r,a),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Qh(function(s){t=s}),cancel:t}}}const GP=Qh;function WP(e){return function(n){return e.apply(null,n)}}function VP(e){return _e.isObject(e)&&e.isAxiosError===!0}const Ld={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ld).forEach(([e,t])=>{Ld[t]=e});const XP=Ld;function sw(e){const t=new mc(e),n=Dy(mc.prototype.request,t);return _e.extend(n,mc.prototype,t,{allOwnKeys:!0}),_e.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return sw(br(e,s))},n}const In=sw(Zh);In.Axios=mc;In.CanceledError=$a;In.CancelToken=GP;In.isCancel=ew;In.VERSION=iw;In.toFormData=nl;In.AxiosError=tn;In.Cancel=In.CanceledError;In.all=function(t){return Promise.all(t)};In.spread=WP;In.isAxiosError=VP;In.mergeConfig=br;In.AxiosHeaders=ls;In.formToJSON=e=>Qy(_e.isHTMLForm(e)?new FormData(e):e);In.getAdapter=nw.getAdapter;In.HttpStatusCode=XP;In.default=In;const JP=In;var ZP=Object.defineProperty,YP=(e,t,n)=>t in e?ZP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,QP=(e,t,n)=>(YP(e,typeof t!="symbol"?t+"":t,n),n),Ti=5*60*1e3,We=24*60*60*1e3;function an(e){return Date.parse(new Date().toString())+e}var si=class{constructor(e,t=0){ze(this,"overdueTime");ze(this,"value");this.overdueTime=t,this.value=e}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var Hn=ie,Me=class extends Error{constructor(t,n){super(t);ze(this,"message");ze(this,"errorCode");this.message=t,this.errorCode=n}static isClmmpoolsErrorCode(t,n){return t instanceof Me&&t.errorCode===n}},st=new y(0),os=new y(1),sl=new y(2);sl.pow(new y(128));var vr=sl.pow(new y(64)).sub(os),eE=sl.pow(new y(128)).sub(os),Nt=class{static toX64_BN(e){return e.mul(new y(2).pow(new y(64)))}static toX64_Decimal(e){return e.mul(Hn.pow(2,64))}static toX64(e){return new y(e.mul(Hn.pow(2,64)).floor().toFixed())}static fromX64(e){return new Hn(e.toString()).mul(Hn.pow(2,-64))}static fromX64_Decimal(e){return e.mul(Hn.pow(2,-64))}static fromX64_BN(e){return e.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(e){let t=e.shrn(64);return e.mod(vr).gt(st)&&(t=t.add(os)),t}static divRoundUp(e,t){return e.mod(t).eq(st)?e.div(t):e.div(t).add(new y(1))}static subUnderflowU128(e,t){return e.lt(t)?e.sub(t).add(eE):e.sub(t)}static checkUnsignedSub(e,t){const n=e.sub(t);if(n.isNeg())throw new Me("Unsigned integer sub overflow","UnsignedIntegerOverflow");return n}static checkMul(e,t,n){const i=e.mul(t);if(this.isOverflow(i,n))throw new Me("Multiplication overflow","MultiplicationOverflow");return i}static checkMulDivFloor(e,t,n,i){if(n.eq(st))throw new Me("Devide by zero","DivideByZero");const s=e.mul(t).div(n);if(this.isOverflow(s,i))throw new Me("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(e,t,n,i){if(n.eq(st))throw new Me("Devide by zero","DivideByZero");const s=e.mul(t).add(n.sub(os)).div(n);if(this.isOverflow(s,i))throw new Me("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(e,t,n,i){if(n.eq(st))throw new Me("Devide by zero","DivideByZero");const s=e.mul(t.add(n.shrn(1))).div(n);if(this.isOverflow(s,i))throw new Me("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(e,t,n,i){const s=e.mul(t).div(new y(2).pow(new y(n)));if(this.isOverflow(s,i))throw new Me("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(e,t,n,i){const s=e.mul(t),r=i&&s.and(vr).gt(st)?s.shrn(64).add(os):s.shrn(64);if(this.isOverflow(r,n))throw new Me("Multiplication shift right overflow","MulShiftRightOverflow");return r}static checkMulShiftLeft(e,t,n,i){const s=e.mul(t).shln(n);if(this.isOverflow(s,i))throw new Me("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(e,t,n){if(t.eq(st))throw new Me("Devide by zero","DivideByZero");return n?this.divRoundUp(e,t):e.div(t)}static isOverflow(e,t){return e.gte(sl.pow(new y(t)))}static sign(e){return e.testn(127)?1:0}static is_neg(e){return this.sign(e)===1}static abs_u128(e){return e.gt(st)?e:this.u128_neg(e.subn(1))}static u128_neg(e){return e.uxor(new y("ffffffffffffffffffffffffffffffff",16))}static neg(e){return this.is_neg(e)?e.abs():this.neg_from(e)}static abs(e){return this.sign(e)===0?e:this.u128_neg(e.sub(new y(1)))}static neg_from(e){return e.eq(st)?e:this.u128_neg(e).add(new y(1)).or(new y(1).shln(127))}};function tE(e){return{coinA:e.coinTypeA,coinB:e.coinTypeB,currentSqrtPrice:new y(e.current_sqrt_price),currentTickIndex:e.current_tick_index,feeGrowthGlobalA:new y(e.fee_growth_global_a),feeGrowthGlobalB:new y(e.fee_growth_global_b),feeProtocolCoinA:new y(e.fee_protocol_coin_a),feeProtocolCoinB:new y(e.fee_protocol_coin_b),feeRate:new y(e.fee_rate),liquidity:new y(e.liquidity),tickIndexes:[],tickSpacing:Number(e.tickSpacing),ticks:[],collection_name:""}}var Dd=443636,Md=-443636,ol="79226673515401279992447579055",rl="4295048016",Ko=new y(1e6),Ce="0x0000000000000000000000000000000000000000000000000000000000000006",nE="partner",Yr="pool_script",Ms="pool_script_v2",ow="pool_script_v3",Zs="router",Zl="router_with_partner",qi="fetcher_script",iE="expect_swap",G0="utils",Yl="custodian_v2",sE="clob_v2",oE="endpoints_v2",rw=(e=>(e.Deleted="Deleted",e.Exists="Exists",e.NotExists="NotExists",e))(rw||{});function G(e){if(e.config===void 0)throw new Me(`package: ${e.package_id}  not config in sdk SdkOptions`,"InvalidConfig");return e.config}var rE=14,aE="59543866431248",cE="184467440737095516",uE="15793534762490258745",lE=443636;function dE(e,t,n){const i=e.toTwos(n).shln(t);return i.imaskn(n+1),i.fromTwos(n)}function Vt(e,t,n){const i=e.toTwos(n).shrn(t);return i.imaskn(n-t+1),i.fromTwos(n-t)}function hE(e){let t;return e&1?t=new y("79232123823359799118286999567"):t=new y("79228162514264337593543950336"),e&2&&(t=Vt(t.mul(new y("79236085330515764027303304731")),96,256)),e&4&&(t=Vt(t.mul(new y("79244008939048815603706035061")),96,256)),e&8&&(t=Vt(t.mul(new y("79259858533276714757314932305")),96,256)),e&16&&(t=Vt(t.mul(new y("79291567232598584799939703904")),96,256)),e&32&&(t=Vt(t.mul(new y("79355022692464371645785046466")),96,256)),e&64&&(t=Vt(t.mul(new y("79482085999252804386437311141")),96,256)),e&128&&(t=Vt(t.mul(new y("79736823300114093921829183326")),96,256)),e&256&&(t=Vt(t.mul(new y("80248749790819932309965073892")),96,256)),e&512&&(t=Vt(t.mul(new y("81282483887344747381513967011")),96,256)),e&1024&&(t=Vt(t.mul(new y("83390072131320151908154831281")),96,256)),e&2048&&(t=Vt(t.mul(new y("87770609709833776024991924138")),96,256)),e&4096&&(t=Vt(t.mul(new y("97234110755111693312479820773")),96,256)),e&8192&&(t=Vt(t.mul(new y("119332217159966728226237229890")),96,256)),e&16384&&(t=Vt(t.mul(new y("179736315981702064433883588727")),96,256)),e&32768&&(t=Vt(t.mul(new y("407748233172238350107850275304")),96,256)),e&65536&&(t=Vt(t.mul(new y("2098478828474011932436660412517")),96,256)),e&131072&&(t=Vt(t.mul(new y("55581415166113811149459800483533")),96,256)),e&262144&&(t=Vt(t.mul(new y("38992368544603139932233054999993551")),96,256)),Vt(t,32,256)}function fE(e){const t=Math.abs(e);let n;return t&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),t&2&&(n=Vt(n.mul(new y("18444899583751176498")),64,256)),t&4&&(n=Vt(n.mul(new y("18443055278223354162")),64,256)),t&8&&(n=Vt(n.mul(new y("18439367220385604838")),64,256)),t&16&&(n=Vt(n.mul(new y("18431993317065449817")),64,256)),t&32&&(n=Vt(n.mul(new y("18417254355718160513")),64,256)),t&64&&(n=Vt(n.mul(new y("18387811781193591352")),64,256)),t&128&&(n=Vt(n.mul(new y("18329067761203520168")),64,256)),t&256&&(n=Vt(n.mul(new y("18212142134806087854")),64,256)),t&512&&(n=Vt(n.mul(new y("17980523815641551639")),64,256)),t&1024&&(n=Vt(n.mul(new y("17526086738831147013")),64,256)),t&2048&&(n=Vt(n.mul(new y("16651378430235024244")),64,256)),t&4096&&(n=Vt(n.mul(new y("15030750278693429944")),64,256)),t&8192&&(n=Vt(n.mul(new y("12247334978882834399")),64,256)),t&16384&&(n=Vt(n.mul(new y("8131365268884726200")),64,256)),t&32768&&(n=Vt(n.mul(new y("3584323654723342297")),64,256)),t&65536&&(n=Vt(n.mul(new y("696457651847595233")),64,256)),t&131072&&(n=Vt(n.mul(new y("26294789957452057")),64,256)),t&262144&&(n=Vt(n.mul(new y("37481735321082")),64,256)),n}var qe=class{static priceToSqrtPriceX64(e,t,n){return Nt.toX64(e.mul(Hn.pow(10,n-t)).sqrt())}static sqrtPriceX64ToPrice(e,t,n){return Nt.fromX64(e).pow(2).mul(Hn.pow(10,t-n))}static tickIndexToSqrtPriceX64(e){return e>0?new y(hE(e)):new y(fE(e))}static sqrtPriceX64ToTickIndex(e){if(e.gt(new y(ol))||e.lt(new y(rl)))throw new Me("Provided sqrtPrice is not within the supported sqrtPrice range.","InvalidSqrtPrice");const t=e.bitLength()-1,n=new y(t-64),i=dE(n,32,128);let s=new y("8000000000000000","hex"),o=0,r=new y(0),a=t>=64?e.shrn(t-63):e.shln(63-t);for(;s.gt(new y(0))&&o<rE;){a=a.mul(a);const b=a.shrn(127);a=a.shrn(63+b.toNumber()),r=r.add(s.mul(b)),s=s.shrn(1),o+=1}const c=r.shrn(32),l=i.add(c).mul(new y(aE)),d=Vt(l.sub(new y(cE)),64,128).toNumber(),h=Vt(l.add(new y(uE)),64,128).toNumber();return d===h?d:qe.tickIndexToSqrtPriceX64(h).lte(e)?h:d}static tickIndexToPrice(e,t,n){return qe.sqrtPriceX64ToPrice(qe.tickIndexToSqrtPriceX64(e),t,n)}static priceToTickIndex(e,t,n){return qe.sqrtPriceX64ToTickIndex(qe.priceToSqrtPriceX64(e,t,n))}static priceToInitializableTickIndex(e,t,n,i){return qe.getInitializableTickIndex(qe.priceToTickIndex(e,t,n),i)}static getInitializableTickIndex(e,t){return e-e%t}static getNextInitializableTickIndex(e,t){return qe.getInitializableTickIndex(e,t)+t}static getPrevInitializableTickIndex(e,t){return qe.getInitializableTickIndex(e,t)-t}};function pE(e){const t=[];for(const n of e){const i={objectId:n.objectId,index:Number(Bn(BigInt(n.index)).toString()),sqrtPrice:n.sqrtPrice,liquidityNet:new y(BigInt.asIntN(128,BigInt(BigInt(n.liquidityNet.toString()))).toString()),liquidityGross:n.liquidityGross,feeGrowthOutsideA:n.feeGrowthOutsideA,feeGrowthOutsideB:n.feeGrowthOutsideB,rewardersGrowthOutside:[new y(n.rewardersGrowthOutside[0]),new y(n.rewardersGrowthOutside[1]),new y(n.rewardersGrowthOutside[2])]};t.push(i)}return t}function gE(e){return L(e).add(L(lE))}new y(365);new y(24);new y(3600);new y(.5);function _E(e,t,n,i){const s=Math.max(e,n),r=Math.min(t,i)-s,a=t-e,c=i-n,u=new ie(a.toString()),l=new ie(c.toString()),d=new ie(r.toString());let h=new ie("0");return r<0?h=new ie("0"):a===r?h=l.div(d):c===r?h=d.div(u):h=d.mul(d).div(l).div(u),h}var ns=class{static getDefaultSqrtPriceLimit(e){return new y(e?rl:ol)}static getDefaultOtherAmountThreshold(e){return e?st:vr}};function aw(e,t,n,i){if(n.eq(st))return e;const s=Nt.checkMulShiftLeft(e,t,64,256),o=t.shln(64),r=Nt.checkMul(e,n,256);if(!i&&o.lte(r))throw new Me("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Nt.checkDivRoundUpIf(s,o.add(r),!0):Nt.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(rl)))throw new Me("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(ol)))throw new Me("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function cw(e,t,n,i){const s=Nt.checkDivRoundUpIf(n.shln(64),t,!i),o=i?e.add(s):e.sub(s);if(o.lt(new y(rl))||o.gt(new y(ol)))throw new Me("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function mE(e,t,n,i){return i?aw(e,t,n,!0):cw(e,t,n,!0)}function yE(e,t,n,i){return i?cw(e,t,n,!1):aw(e,t,n,!1)}function W0(e,t,n,i){const s=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(st)||s.eq(st))return st;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=t.mul(e),c=r.div(a);o=r.mod(a).eq(st)?c:c.add(os)}else{const r=new y(n).mul(new y(s));o=r.and(vr).gt(st)?r.shrn(64).add(os):r.shrn(64)}return o}function V0(e,t,n,i){const s=e.gt(t)?e.sub(t):t.sub(e);if(n.lte(st)||s.eq(st))return st;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=t.mul(e);o=r.div(a)}return o}function wE(e,t,n,i,s,o){if(n===st)return{amountIn:st,amountOut:st,nextSqrtPrice:t,feeAmount:st};const r=e.gte(t);let a,c,u,l;if(o){const d=Nt.checkMulDivFloor(i,Nt.checkUnsignedSub(Ko,s),Ko,64),h=W0(e,t,n,r);h.gt(d)?(a=d,l=Nt.checkUnsignedSub(i,d),u=mE(e,n,d,r)):(a=h,l=Nt.checkMulDivCeil(a,s,Ko.sub(s),64),u=t),c=V0(e,u,n,r)}else{const d=V0(e,t,n,r);d.gt(i)?(c=i,u=yE(e,n,i,r)):(c=d,u=t),a=W0(e,u,n,r),l=Nt.checkMulDivCeil(a,s,Ko.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function bE(e,t,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:st,amountOut:st,feeAmount:st,refAmount:st,nextSqrtPrice:st,crossTickNum:0};let u,l;const d=ns.getDefaultSqrtPriceLimit(e);for(const h of s){if(e&&i.currentTickIndex<h.index||!e&&i.currentTickIndex>=h.index||h===null)continue;e&&d.gt(h.sqrtPrice)||!e&&d.lt(h.sqrtPrice)?u=d:u=h.sqrtPrice;const g=wE(a,u,r,o,i.feeRate,t);if(g.amountIn.eq(st)||(o=t?o.sub(g.amountIn.add(g.feeAmount)):o.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(h.sqrtPrice)?(l=h.liquidityNet.mul(new y(-1)),e?Nt.is_neg(l)?r=r.add(new y(Gn(BigInt(l.toString()),128))):r=r.add(l):Nt.is_neg(l)?r=r.sub(new y(Gn(BigInt(l.toString()),128))):r=r.sub(l),a=h.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,o.eq(st))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Xr(e,t,n){const i=y.min(e,t),s=y.max(e,t),o=Nt.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Jr(e,t,n){const i=y.min(e,t),o=y.max(e,t).sub(i);return n.shln(64).div(o)}var pn=class{static updateFeeRate(e,t,n,i,s){const o=Nt.checkMulDivCeil(t,new y(i),Ko,64),r=n===0?st:Nt.checkMulDivFloor(t,new y(n),Ko,64),a=t.mul(o).mul(r);if(s?e.feeProtocolCoinA=e.feeProtocolCoinA.add(o):e.feeProtocolCoinB=e.feeProtocolCoinB.add(o),a.eq(st)||e.liquidity.eq(st))return{refFee:r,clmm:e};const c=a.shln(64).div(e.liquidity);return s?e.feeGrowthGlobalA=e.feeGrowthGlobalA.add(c):e.feeGrowthGlobalB=e.feeGrowthGlobalB.add(c),{refFee:r,clmm:e}}static getCoinAmountFromLiquidity(e,t,n,i,s){const o=new Hn(e.toString()),r=new Hn(t.toString()),a=new Hn(n.toString()),c=new Hn(i.toString());let u,l;return t.lt(n)?(u=Nt.toX64_Decimal(o).mul(c.sub(a)).div(a.mul(c)),l=new Hn(0)):t.lt(i)?(u=Nt.toX64_Decimal(o).mul(c.sub(r)).div(r.mul(c)),l=Nt.fromX64_Decimal(o.mul(r.sub(a)))):(u=new Hn(0),l=Nt.fromX64_Decimal(o.mul(c.sub(a)))),s?{coinA:new y(u.ceil().toString()),coinB:new y(l.ceil().toString())}:{coinA:new y(u.floor().toString()),coinB:new y(l.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(e,t,n,i,s,o,r){const a=qe.sqrtPriceX64ToTickIndex(r),c=qe.tickIndexToSqrtPriceX64(e),u=qe.tickIndexToSqrtPriceX64(t);let l;if(a<e){if(!i)throw new Me("lower tick cannot calculate liquidity by coinB","NotSupportedThisCoin");l=Xr(c,u,n)}else if(a>t){if(i)throw new Me("upper tick cannot calculate liquidity by coinA","NotSupportedThisCoin");l=Jr(u,c,n)}else i?l=Xr(r,u,n):l=Jr(r,c,n);const d=pn.getCoinAmountFromLiquidity(l,r,c,u,s),h=s?L(d.coinA.toString()).mul(1+o).toString():L(d.coinA.toString()).mul(1-o).toString(),g=s?L(d.coinB.toString()).mul(1+o).toString():L(d.coinB.toString()).mul(1-o).toString();return{coinAmountA:d.coinA,coinAmountB:d.coinB,tokenMaxA:s?new y(Hn.ceil(h).toString()):new y(Hn.floor(h).toString()),tokenMaxB:s?new y(Hn.ceil(g).toString()):new y(Hn.floor(g).toString()),liquidityAmount:l,fix_amount_a:i}}static estimateLiquidityFromcoinAmounts(e,t,n,i){if(t>n)throw new Me("lower tick cannot be greater than lower tick","InvalidTwoTickIndex");const s=qe.sqrtPriceX64ToTickIndex(e),o=qe.tickIndexToSqrtPriceX64(t),r=qe.tickIndexToSqrtPriceX64(n);if(s<t)return Xr(o,r,i.coinA);if(s>=n)return Jr(r,o,i.coinB);const a=Xr(e,r,i.coinA),c=Jr(e,o,i.coinB);return y.min(a,c)}static estCoinAmountsFromTotalAmount(e,t,n,i,s,o){const{ratioA:r,ratioB:a}=pn.calculateDepositRatioFixTokenA(e,t,n),c=L(i).mul(r).div(s),u=L(i).mul(a).div(o);return{amountA:c,amountB:u}}static calculateDepositRatioFixTokenA(e,t,n){const i=new y(1e8),{coinAmountB:s}=pn.estLiquidityAndcoinAmountFromOneAmounts(e,t,i,!0,!0,0,n),o=qe.sqrtPriceX64ToPrice(n,0,0),r=L(i.toString()).mul(o),a=r.add(s.toString()),c=r.div(a),u=L(s.toString()).div(a);return{ratioA:c,ratioB:u}}};function uw(e){return e.startsWith("0x")?`${e.slice(2)}`:e}var vE=0,lw=1,xE=2;function X0(e,t){return e===t?vE:e<t?lw:xE}function TE(e,t){let n=0;const i=e.length<=t.length?e.length:t.length,s=X0(e.length,t.length);for(;n<i;){const o=X0(e.charCodeAt(n),t.charCodeAt(n));if(n+=1,o!==0)return o}return s}function Dc(e,t){return TE(e,t)===lw}function Mc(e,...t){const n=Array.isArray(t[t.length-1])?t.pop():[];let s=[e,...t].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function he(e){var t;try{let n=e.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(t=i==null?void 0:i[0])==null?void 0:t.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s){n=n.slice(0,n.indexOf("<"));const u={...he(n),type_arguments:s.map(l=>he(l).source_address)};return u.type_arguments=u.type_arguments.map(l=>Zt.isSuiCoin(l)?l:he(l).source_address),u.source_address=Mc(u.full_address,u.type_arguments),u}const o=n.split("::"),a={full_address:n,address:n===Nc||n===EE?"0x2":vn(o[0]),module:o[1],name:o[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=Mc(a.full_address,a.type_arguments),a}catch{return{full_address:e,address:"",module:"",name:"",type_arguments:[],source_address:e}}}function bn(e){return he(e).source_address}function AE(e){return e.toLowerCase().startsWith("0x")?vn(e):e}var kE=(e,t=!0)=>{const n=e.split("::"),i=n.shift();let s=vn(i);return t&&(s=uw(s)),`${s}::${n.join("::")}`};function ef(e){for(const t in e){const n=typeof e[t];if(n==="object")ef(e[t]);else if(n==="string"){const i=e[t];i&&!i.includes("::")&&(e[t]=AE(i))}}}var SE="0x2::coin::Coin",PE=/^0x2::coin::Coin<(.+)>$/,Nc="0x2::sui::SUI",EE="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Zt=class{static getCoinTypeArg(e){const t=e.type.match(PE);return t?t[1]:null}static isSUI(e){const t=Zt.getCoinTypeArg(e);return t?Zt.getCoinSymbol(t)==="SUI":!1}static getCoinSymbol(e){return e.substring(e.lastIndexOf(":")+1)}static getBalance(e){return BigInt(e.fields.balance)}static totalBalance(e,t){let n=BigInt(0);return e.forEach(i=>{t===i.coinAddress&&(n+=BigInt(i.balance))}),n}static getID(e){return e.fields.id.id}static getCoinTypeFromArg(e){return`${SE}<${e}>`}static getFaucetCoins(e){const{events:t}=e,n=[];return t==null||t.forEach(i=>{const{type:s}=i;if(he(s).name==="InitEvent"){const o=i.parsedJson;n.push({transactionModule:i.transactionModule,suplyID:o.suplyID,decimals:o.decimals})}}),n}static getCoinAssets(e,t){const n=[];return t.forEach(i=>{bn(i.coinAddress)===bn(e)&&n.push(i)}),n}static isSuiCoin(e){return he(e).full_address===Nc}static selectCoinObjectIdGreaterThanOrEqual(e,t,n=[]){const i=Zt.selectCoinAssetGreaterThanOrEqual(e,t,n),s=i.selectedCoins.map(a=>a.coinObjectId),o=i.remainingCoins,r=i.selectedCoins.map(a=>a.balance.toString());return{objectArray:s,remainCoins:o,amountArray:r}}static selectCoinAssetGreaterThanOrEqual(e,t,n=[]){const i=Zt.sortByBalance(e.filter(c=>!n.includes(c.coinObjectId))),s=Zt.calculateTotalBalance(i);if(s<t)return{selectedCoins:[],remainingCoins:i};if(s===t)return{selectedCoins:i,remainingCoins:[]};let o=BigInt(0);const r=[],a=[...i];for(;o<s;){const c=t-o,u=a.findIndex(d=>d.balance>=c);if(u!==-1){r.push(a[u]),a.splice(u,1);break}const l=a.pop();l.balance>0&&(r.push(l),o+=l.balance)}return{selectedCoins:Zt.sortByBalance(r),remainingCoins:Zt.sortByBalance(a)}}static sortByBalance(e){return e.sort((t,n)=>t.balance<n.balance?-1:t.balance>n.balance?1:0)}static sortByBalanceDes(e){return e.sort((t,n)=>t.balance>n.balance?-1:t.balance<n.balance?0:1)}static calculateTotalBalance(e){return e.reduce((t,n)=>t+n.balance,BigInt(0))}};function CE(e,t,n){let i=new y(0),s=new y(0);e.current_tick_index<t.index?(i=Nt.subUnderflowU128(new y(e.fee_growth_global_a),new y(t.feeGrowthOutsideA)),s=Nt.subUnderflowU128(new y(e.fee_growth_global_b),new y(t.feeGrowthOutsideB))):(i=new y(t.feeGrowthOutsideA),s=new y(t.feeGrowthOutsideB));let o=new y(0),r=new y(0);e.current_tick_index<n.index?(o=new y(n.feeGrowthOutsideA),r=new y(n.feeGrowthOutsideB)):(o=Nt.subUnderflowU128(new y(e.fee_growth_global_a),new y(n.feeGrowthOutsideA)),r=Nt.subUnderflowU128(new y(e.fee_growth_global_b),new y(n.feeGrowthOutsideB)));const a=Nt.subUnderflowU128(Nt.subUnderflowU128(new y(e.fee_growth_global_a),i),o),c=Nt.subUnderflowU128(Nt.subUnderflowU128(new y(e.fee_growth_global_b),s),r);return{fee_growth_inside_a:a,fee_growth_inside_b:c}}function BE(e,t,n){const i=Nt.subUnderflowU128(t,new y(e.fee_growth_inside_a)),s=new y(e.liquidity).mul(i).shrn(64),o=Nt.subUnderflowU128(n,new y(e.fee_growth_inside_b)),r=new y(e.liquidity).mul(o).shrn(64),a=new y(e.fee_owed_a).add(s),c=new y(e.fee_owed_b).add(r);return{position_id:e.pos_object_id,feeOwedA:a,feeOwedB:c}}function IE(e){const{fee_growth_inside_a:t,fee_growth_inside_b:n}=CE(e.clmmpool,e.tickLower,e.tickUpper);return BE(e.position,t,n)}var Qr=class{constructor(e,t){ze(this,"numerator");ze(this,"denominator");this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=e,this.denominator=t}static fromDecimal(e){return Qr.fromFraction(e.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(e,t){const n=typeof e=="number"?new y(e.toString()):e,i=typeof t=="number"?new y(t.toString()):t;return new Qr(n,i)}};function Nd(e,{numerator:t,denominator:n},i){return i?e.mul(n.add(t)).div(n):e.mul(n).div(n.add(t))}function Ql(e,t,n){return{tokenMaxA:Nd(e.coinA,t,n),tokenMaxB:Nd(e.coinB,t,n)}}function L(e){return ie.isDecimal(e)?e:new ie(e===void 0?0:e)}function OE(e){return L(10).pow(L(e).abs())}function Ua(e){return e.data}function dw(e){if(e.error&&"object_id"in e.error&&"version"in e.error&&"digest"in e.error){const{error:t}=e;return{objectId:t.object_id,version:t.version,digest:t.digest}}}function hw(e){if(e.error&&"object_id"in e.error&&!("version"in e.error)&&!("digest"in e.error))return e.error.object_id}function RE(e){if("reference"in e)return e.reference;const t=Ua(e);return t?{objectId:t.objectId,version:t.version,digest:t.digest}:dw(e)}function Hi(e){var t;return"objectId"in e?e.objectId:((t=RE(e))==null?void 0:t.objectId)??hw(e)}function $E(e){return e.data!==void 0}function UE(e){return e.content!==void 0}function fw(e){const t="data"in e?Ua(e):e;if(!(!t||!UE(t)||t.content.dataType!=="moveObject"))return t.content}function Wi(e){var t;return(t=fw(e))==null?void 0:t.type}function co(e){var n;const t=$E(e)?e.data:e;return!(t!=null&&t.type)&&"data"in e?((n=t==null?void 0:t.content)==null?void 0:n.dataType)==="package"?"package":Wi(e):t==null?void 0:t.type}function qa(e){var t;return(t=Ua(e))==null?void 0:t.previousTransaction}function Fc(e){var t;return(t=Ua(e))==null?void 0:t.owner}function qE(e){var n;const t=(n=Ua(e))==null?void 0:n.display;return t||{data:null,error:null}}function ft(e){var n;const t=(n=fw(e))==null?void 0:n.fields;if(t)return"fields"in t?t.fields:t}function LE(e,t){const n=OE(L(t));return Number(L(e).mul(n))}function Gn(e,t=32){return BigInt.asUintN(t,BigInt(e)).toString()}function Bn(e,t=32){return Number(BigInt.asIntN(t,BigInt(e)))}function DE(e,t,n){const i=he(e).name,s=he(t).name;return`${i}-${s}[${n}]`}function ed(e){const t=Wi(e),n=he(t),i=ft(e);if(i==null)throw new Me(`Pool id ${Hi(e)} not exists.`,"InvalidPoolObject");const s=[];i.rewarder_manager.fields.rewarders.forEach(r=>{const{emissions_per_second:a}=r.fields,c=Nt.fromX64(new y(a)),u=Math.floor(c.toNumber()*60*60*24);s.push({emissions_per_second:a,coinAddress:he(r.fields.reward_coin.fields.name).source_address,growth_global:r.fields.growth_global,emissionsEveryDay:u})});const o={poolAddress:Hi(e),poolType:t,coinTypeA:n.type_arguments[0],coinTypeB:n.type_arguments[1],coinAmountA:i.coin_a,coinAmountB:i.coin_b,current_sqrt_price:i.current_sqrt_price,current_tick_index:Bn(BigInt(i.current_tick_index.fields.bits)),fee_growth_global_a:i.fee_growth_global_a,fee_growth_global_b:i.fee_growth_global_b,fee_protocol_coin_a:i.fee_protocol_coin_a,fee_protocol_coin_b:i.fee_protocol_coin_b,fee_rate:i.fee_rate,is_pause:i.is_pause,liquidity:i.liquidity,position_manager:{positions_handle:i.position_manager.fields.positions.fields.id.id,size:i.position_manager.fields.positions.fields.size},rewarder_infos:s,rewarder_last_updated_time:i.rewarder_manager.fields.last_updated_time,tickSpacing:i.tick_spacing,ticks_handle:i.tick_manager.fields.ticks.fields.id.id,uri:i.url,index:Number(i.index),name:""};return o.name=DE(o.coinTypeA,o.coinTypeB,o.tickSpacing),o}function al(e){const t=qE(e).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return t&&(n.creator=t.creator,n.description=t.description,n.image_url=t.image_url,n.link=t.link,n.name=t.name,n.project_url=t.project_url),n}function io(e){var r,a;if(e.error!=null||((a=(r=e.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Me(`Position not exists. Get Position error:${e.error}`,"InvalidPositionObject");let t={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...t,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},i=ft(e);if(i){const c=Wi(e),u=Fc(e);"nft"in i?(i=i.nft.fields,t.description=i.description,t.name=i.name,t.link=i.url):t=al(e),n={...t,pos_object_id:i.id.id,owner:u.AddressOwner,type:c,coin_type_a:i.coin_type_a.fields.name,coin_type_b:i.coin_type_b.fields.name,liquidity:i.liquidity,tick_lower_index:Bn(BigInt(i.tick_lower_index.fields.bits)),tick_upper_index:Bn(BigInt(i.tick_upper_index.fields.bits)),index:i.index,pool:i.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const s=dw(e);s&&(n.pos_object_id=s.objectId,n.position_status="Deleted");const o=hw(e);return o&&(n.pos_object_id=o,n.position_status="NotExists"),n}function pw(e){const t={reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0"};e="fields"in e?e.fields:e,e.rewards.forEach((o,r)=>{const{amount_owned:a,growth_inside:c}="fields"in o?o.fields:o;r===0?(t.reward_amount_owed_0=a,t.reward_growth_inside_0=c):r===1?(t.reward_amount_owed_1=a,t.reward_growth_inside_1=c):r===2&&(t.reward_amount_owed_2=a,t.reward_growth_inside_2=c)});const n="fields"in e.tick_lower_index?e.tick_lower_index.fields.bits:e.tick_lower_index.bits,i="fields"in e.tick_upper_index?e.tick_upper_index.fields.bits:e.tick_upper_index.bits;return{liquidity:e.liquidity,tick_lower_index:Bn(BigInt(n)),tick_upper_index:Bn(BigInt(i)),...t,fee_growth_inside_a:e.fee_growth_inside_a,fee_owed_a:e.fee_owned_a,fee_growth_inside_b:e.fee_growth_inside_b,fee_owed_b:e.fee_owned_b,pos_object_id:e.position_id}}function td(e){var s,o;if(e.error!=null||((o=(s=e.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Me(`Tick not exists. Get tick data error:${e.error}`,"InvalidTickObject");const n=ft(e).value.fields.value.fields;return{objectId:Hi(e),index:Bn(BigInt(n.index.fields.bits)),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(n.liquidity_net.fields.bits),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:n.rewards_growth_outside}}function ME(e){if(!e||!e.index||!e.sqrt_price||!e.liquidity_net||!e.liquidity_gross||!e.fee_growth_outside_a||!e.fee_growth_outside_b)throw new Me("Invalid tick fields.","InvalidTickFields");const t=Bn(BigInt(e.index.bits)),n=new y(e.sqrt_price),i=new y(e.liquidity_net.bits),s=new y(e.liquidity_gross),o=new y(e.fee_growth_outside_a),r=new y(e.fee_growth_outside_b),a=e.rewards_growth_outside||[];return{objectId:"",index:t,sqrtPrice:n,liquidityNet:i,liquidityGross:s,feeGrowthOutsideA:o,feeGrowthOutsideB:r,rewardersGrowthOutside:a}}var jr=class{static getMinIndex(e){return Md+Math.abs(Md)%e}static getMaxIndex(e){return Dd-Dd%e}};function M5(e,t){const n=Math.abs(e)%t;return e>0?n>t/2?e+t-n:e-n:n>t/2?e-t+n:e+n}function NE(e,t,n,i,s,o){const r=e.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];t!==null&&(e.current_tick_index<i?u=o[c].sub(new y(t.rewardersGrowthOutside[c])):u=t.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(e.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Nt.subUnderflowU128(Nt.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function jc(e){const t=Zt.isSuiCoin(e.coinTypeA),n=Zt.isSuiCoin(e.coinTypeB);return{isAdjustCoinA:t,isAdjustCoinB:n}}function FE(e,t){return ie.ceil(L(e).div(1+t)).toString()}var at=class{static createCollectRewarderAndFeeParams(e,t,n,i,s,o){s===void 0&&(s=[...i]),o===void 0&&(o=[...i]);const r=bn(n.coinTypeA),a=bn(n.coinTypeB);if(n.collect_fee){const u=at.buildCoinForAmount(t,s,BigInt(0),r,!1);s=u.remainCoins;const l=at.buildCoinForAmount(t,o,BigInt(0),a,!1);o=l.remainCoins,t=e.Position.createCollectFeePaylod({pool_id:n.pool_id,pos_id:n.pos_id,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB},t,u.targetCoin,l.targetCoin)}const c=[];return n.rewarder_coin_types.forEach(u=>{switch(bn(u)){case r:c.push(at.buildCoinForAmount(t,s,BigInt(0),u,!1).targetCoin);break;case a:c.push(at.buildCoinForAmount(t,o,BigInt(0),u,!1).targetCoin);break;default:c.push(at.buildCoinForAmount(t,i,BigInt(0),u,!1).targetCoin);break}}),t=e.Rewarder.createCollectRewarderPaylod(n,t,c),t}static async adjustTransactionForGas(e,t,n,i){i.setSender(e.senderAddress);const s=Zt.selectCoinAssetGreaterThanOrEqual(t,n).selectedCoins;if(s.length===0)throw new Me("Insufficient balance","InsufficientBalance");const o=Zt.calculateTotalBalance(t);if(o-n>1e9)return{fixAmount:n};const r=await e.fullClient.calculationTxGas(i);if(Zt.selectCoinAssetGreaterThanOrEqual(t,BigInt(r),s.map(c=>c.coinObjectId)).selectedCoins.length===0){const c=BigInt(r)+BigInt(500);if(o-n<c){if(n-=c,n<0)throw new Me("gas Insufficient balance","InsufficientBalance");const u=new ye;return{fixAmount:n,newTx:u}}}return{fixAmount:n}}static async buildAddLiquidityFixTokenForGas(e,t,n,i){let s=await at.buildAddLiquidityFixToken(e,t,n);const{isAdjustCoinA:o}=jc(n),r=o?n.amount_a:n.amount_b,a=await at.adjustTransactionForGas(e,Zt.getCoinAssets(o?n.coinTypeA:n.coinTypeB,t),BigInt(r),s),{fixAmount:c}=a,{newTx:u}=a;if(u!==void 0){let l,d;if(o)n.amount_a=Number(c),l=at.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,c.toString(),n.slippage,n.coinTypeA,t,!1),d=at.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,t,!1);else return n.amount_b=Number(c),l=at.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,t,!1),d=at.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,c.toString(),n.slippage,n.coinTypeB,t,!1),n=at.fixAddLiquidityFixTokenParams(n,i.slippage,i.curSqrtPrice),s=await at.buildAddLiquidityFixTokenArgs(u,e,t,n,l,d),s}return s}static async buildAddLiquidityFixToken(e,t,n){if(e.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let i=new ye;const s=at.buildAddLiquidityFixTokenCoinInput(i,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,t,!1),o=at.buildAddLiquidityFixTokenCoinInput(i,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,t,!1);return i=at.buildAddLiquidityFixTokenArgs(i,e,t,n,s,o),i}static buildAddLiquidityFixTokenCoinInput(e,t,n,i,s,o,r=!0){return t?at.buildCoinForAmountInterval(e,o,{amountSecond:BigInt(FE(n,i)),amountFirst:BigInt(n)},s,r):at.buildCoinForAmount(e,o,BigInt(n),s,r)}static fixAddLiquidityFixTokenParams(e,t,n){const i=e.fix_amount_a?e.amount_a:e.amount_b,s=pn.estLiquidityAndcoinAmountFromOneAmounts(Number(e.tick_lower),Number(e.tick_upper),new y(i),e.fix_amount_a,!0,t,n);return e.amount_a=e.fix_amount_a?e.amount_a:s.tokenMaxA.toNumber(),e.amount_b=e.fix_amount_a?s.tokenMaxB.toNumber():e.amount_b,e}static buildAddLiquidityFixTokenArgs(e,t,n,i,s,o){const r=[i.coinTypeA,i.coinTypeB],a=i.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:c,integrate:u}=t.sdkOptions;i.is_open||(e=at.createCollectRewarderAndFeeParams(t,e,i,n,s.remainCoins,o.remainCoins));const l=G(c),d=i.is_open?[e.object(l.global_config_id),e.object(i.pool_id),e.pure(Gn(BigInt(i.tick_lower)).toString()),e.pure(Gn(BigInt(i.tick_upper)).toString()),s.targetCoin,o.targetCoin,e.pure(i.amount_a),e.pure(i.amount_b),e.pure(i.fix_amount_a),e.object(Ce)]:[e.object(l.global_config_id),e.object(i.pool_id),e.object(i.pos_id),s.targetCoin,o.targetCoin,e.pure(i.amount_a),e.pure(i.amount_b),e.pure(i.fix_amount_a),e.object(Ce)];return e.moveCall({target:`${u.published_at}::${Ms}::${a}`,typeArguments:r,arguments:d}),e}static async buildSwapTransactionForGas(e,t,n,i){let s=at.buildSwapTransaction(e,t,n);s.setSender(e.senderAddress);const o=await at.adjustTransactionForGas(e,Zt.getCoinAssets(t.a2b?t.coinTypeA:t.coinTypeB,n),BigInt(t.by_amount_in?t.amount:t.amount_limit),s),{fixAmount:r,newTx:a}=o;if(a!==void 0){a.setSender(e.senderAddress),t.by_amount_in?t.amount=r.toString():t.amount_limit=r.toString(),t=await at.fixSwapParams(e,t,i);const c=at.buildCoinForAmount(s,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA),u=at.buildCoinForAmount(s,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB);s=at.buildSwapTransactionArgs(a,t,e.sdkOptions,c,u)}return s}static buildSwapTransaction(e,t,n){let i=new ye;i.setSender(e.senderAddress);const s=at.buildCoinForAmount(i,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1),o=at.buildCoinForAmount(i,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1);return i=at.buildSwapTransactionArgs(i,t,e.sdkOptions,s,o),i}static buildSwapTransactionArgs(e,t,n,i,s){const{clmm_pool:o,integrate:r}=n,a=ns.getDefaultSqrtPriceLimit(t.a2b),c=[t.coinTypeA,t.coinTypeB],{global_config_id:u}=G(o);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=t.swap_partner!==void 0,d=l?t.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":t.a2b?"swap_a2b":"swap_b2a",h=l?[e.pure(u),e.pure(t.pool_id),e.pure(t.swap_partner),i.targetCoin,s.targetCoin,e.pure(t.by_amount_in),e.pure(t.amount),e.pure(t.amount_limit),e.pure(a.toString()),e.pure(Ce)]:[e.pure(u),e.pure(t.pool_id),i.targetCoin,s.targetCoin,e.pure(t.by_amount_in),e.pure(t.amount),e.pure(t.amount_limit),e.pure(a.toString()),e.pure(Ce)];return e.moveCall({target:`${r.published_at}::${Ms}::${d}`,typeArguments:c,arguments:h}),e}static async buildSwapTransactionWithoutTransferCoinsForGas(e,t,n,i){let{tx:s,coinABs:o}=at.buildSwapTransactionWithoutTransferCoins(e,t,n);s.setSender(e.senderAddress);const r=await at.adjustTransactionForGas(e,Zt.getCoinAssets(t.a2b?t.coinTypeA:t.coinTypeB,n),BigInt(t.by_amount_in?t.amount:t.amount_limit),s),{fixAmount:a,newTx:c}=r;if(c!==void 0){c.setSender(e.senderAddress),t.by_amount_in?t.amount=a.toString():t.amount_limit=a.toString(),t=await at.fixSwapParams(e,t,i);const u=at.buildCoinForAmount(s,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1,!0),l=at.buildCoinForAmount(s,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1,!0),d=at.buildSwapTransactionWithoutTransferCoinArgs(e,c,t,e.sdkOptions,u,l);s=d.tx,o=d.txRes}return{tx:s,coinABs:o}}static buildSwapTransactionWithoutTransferCoins(e,t,n){const i=new ye;i.setSender(e.senderAddress);const s=at.buildCoinForAmount(i,n,t.a2b?BigInt(t.by_amount_in?t.amount:t.amount_limit):BigInt(0),t.coinTypeA,!1,!0),o=at.buildCoinForAmount(i,n,t.a2b?BigInt(0):BigInt(t.by_amount_in?t.amount:t.amount_limit),t.coinTypeB,!1,!0),r=at.buildSwapTransactionWithoutTransferCoinArgs(e,i,t,e.sdkOptions,s,o);return{tx:r.tx,coinABs:r.txRes}}static buildSwapTransactionWithoutTransferCoinArgs(e,t,n,i,s,o){const{clmm_pool:r,integrate:a}=i,c=ns.getDefaultSqrtPriceLimit(n.a2b),{global_config_id:u}=G(r);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=n.swap_partner!==void 0,d=l?"swap_with_partner":"swap",h=l?Zl:Zs,g=l?[t.pure(u),t.pure(n.pool_id),t.pure(n.swap_partner),s.targetCoin,o.targetCoin,t.pure(n.a2b),t.pure(n.by_amount_in),t.pure(n.amount),t.pure(c.toString()),t.pure(!1),t.pure(Ce)]:[t.pure(u),t.pure(n.pool_id),s.targetCoin,o.targetCoin,t.pure(n.a2b),t.pure(n.by_amount_in),t.pure(n.amount),t.pure(c.toString()),t.pure(!1),t.pure(Ce)],b=[n.coinTypeA,n.coinTypeB],v=t.moveCall({target:`${a.published_at}::${h}::${d}`,typeArguments:b,arguments:g});if(n.by_amount_in){const k=n.a2b?n.coinTypeB:n.coinTypeA,E=n.a2b?v[1]:v[0],N=Number(n.amount_limit);this.checkCoinThreshold(e,n.by_amount_in,t,E,N,k)}return{tx:t,txRes:v}}static async fixSwapParams(e,t,n){const{currentPool:i}=n;try{const s=await e.Swap.preswap({decimalsA:n.decimalsA,decimalsB:n.decimalsB,a2b:t.a2b,byAmountIn:t.by_amount_in,amount:t.amount,pool:i,currentSqrtPrice:i.current_sqrt_price,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB}),o=n.byAmountIn?s.estimatedAmountOut:s.estimatedAmountIn,r=Nd(o,n.slippage,!n.byAmountIn);t.amount_limit=r.toString()}catch(s){console.log("fixSwapParams",s)}return t}static async syncBuildCoinInputForAmount(e,t,n,i,s=!0){if(e.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const o=await e.getOwnerCoinAssets(e.senderAddress,i);return at.buildCoinForAmount(t,o,n,i,s).targetCoin}static buildCoinForAmount(e,t,n,i,s=!0,o=!1){const r=Zt.getCoinAssets(i,t);if(n===BigInt(0)&&r.length===0)return at.buildZeroValueCoin(t,e,i,s);const a=Zt.calculateTotalBalance(r);if(a<n)throw new Me(`The amount(${a}) is Insufficient balance for ${i} , expect ${n} `,"InsufficientBalance");return at.buildCoin(e,t,r,n,i,s,o)}static buildCoin(e,t,n,i,s,o=!0,r=!1){if(Zt.isSuiCoin(s)){if(o){const N=e.splitCoins(e.gas,[e.pure(i.toString())]);return{targetCoin:e.makeMoveVec({objects:[N]}),remainCoins:t,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:e.gas}}if(i===0n&&n.length>1){const N=Zt.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:e.object(N.objectArray[0]),remainCoins:N.remainCoins,tragetCoinAmount:N.amountArray[0],isMintZeroCoin:!1}}const k=Zt.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:e.splitCoins(e.gas,[e.pure(i.toString())]),remainCoins:k.remainCoins,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:e.gas}}const a=Zt.selectCoinObjectIdGreaterThanOrEqual(n,i),c=a.amountArray.reduce((k,E)=>Number(k)+Number(E),0).toString(),u=a.objectArray;if(o)return{targetCoin:e.makeMoveVec({objects:u.map(k=>e.object(k))}),remainCoins:a.remainCoins,tragetCoinAmount:a.amountArray.reduce((k,E)=>Number(k)+Number(E),0).toString(),isMintZeroCoin:!1};const[l,...d]=u,h=e.object(l);let g=h,b=a.amountArray.reduce((k,E)=>Number(k)+Number(E),0).toString(),v;return d.length>0&&e.mergeCoins(h,d.map(k=>e.object(k))),r&&Number(c)>Number(i)&&(g=e.splitCoins(h,[e.pure(i.toString())]),b=i.toString(),v=h),{targetCoin:g,remainCoins:a.remainCoins,originalSplitedCoin:v,tragetCoinAmount:b,isMintZeroCoin:!1}}static buildZeroValueCoin(e,t,n,i=!0){const s=at.callMintZeroValueCoin(t,n);let o;return i?o=t.makeMoveVec({objects:[s]}):o=s,{targetCoin:o,remainCoins:e,isMintZeroCoin:!0,tragetCoinAmount:"0"}}static buildCoinForAmountInterval(e,t,n,i,s=!0){const o=Zt.getCoinAssets(i,t);if(n.amountFirst===BigInt(0))return o.length>0?at.buildCoin(e,[...t],[...o],n.amountFirst,i,s):at.buildZeroValueCoin(t,e,i,s);const r=Zt.calculateTotalBalance(o);if(r>=n.amountFirst)return at.buildCoin(e,[...t],[...o],n.amountFirst,i,s);if(r<n.amountSecond)throw new Me(`The amount(${r}) is Insufficient balance for ${i} , expect ${n.amountSecond} `,"InsufficientBalance");return at.buildCoin(e,[...t],[...o],n.amountSecond,i,s)}static async buildRouterSwapTransaction(e,t,n,i,s){let o=new ye;return t.paths.length>1&&(t.partner=""),o=await this.buildRouterBasePathTx(e,t,n,i,o,s),o}static async buildRouterBasePathTx(e,t,n,i,s,o){const r=t.paths.filter(A=>A&&A.poolAddress),a=Number(r.reduce((A,P)=>A.add(P.amountIn),st).toString()),c=Number(r.reduce((A,P)=>A.add(P.amountOut),st).toString()),u=Math.round(n?Number(c.toString())*(1-t.priceSlippagePoint):Number(a.toString())*(1+t.priceSlippagePoint)),l=t.paths[0].coinType[0],d=t.paths[0].coinType[t.paths[0].coinType.length-1],h=at.buildCoinForAmount(s,i,BigInt(n?a:u),l,!1,!0),g=h.originalSplitedCoin!==void 0,b=at.buildCoinForAmount(s,i,0n,d,!1),v=await this.buildRouterBasePathReturnCoins(e,t,n,h,b,s),k=[],{toCoin:E,fromCoin:N}=v;if(s=v.tx,b.isMintZeroCoin?k.push({coinType:d,coin:E}):b.originalSplitedCoin!==void 0?s.mergeCoins(b.originalSplitedCoin,[E]):s.mergeCoins(b.targetCoin,[E]),g){const A=h==null?void 0:h.originalSplitedCoin;s.mergeCoins(A,[N])}else k.push({coinType:l,coin:N});for(let A=0;A<k.length;A++)this.buildTransferCoin(e,s,k[A].coin,k[A].coinType,o);return s}static async buildRouterBasePathReturnCoins(e,t,n,i,s,o){const{clmm_pool:r,integrate:a}=e.sdkOptions,c=G(r).global_config_id,u=t.paths.filter(A=>A&&A.poolAddress),l=Number(u.reduce((A,P)=>A.add(P.amountIn),st).toString()),d=Number(u.reduce((A,P)=>A.add(P.amountOut),st).toString()),h=Math.round(n?Number(d.toString())*(1-t.priceSlippagePoint):Number(l.toString())*(1+t.priceSlippagePoint)),g=t.paths[0].coinType[0],b=t.paths[0].coinType[t.paths[0].coinType.length-1];let v=i.targetCoin,k;s.isMintZeroCoin||s.originalSplitedCoin!==void 0?k=s.targetCoin:k=at.callMintZeroValueCoin(o,b);const E=t.partner==="",N=E?Zs:Zl;for(const A of u)if(A.poolAddress.length===1){const P=A.a2b[0],B={amount:Number(A.amountIn.toString()),amountLimit:h,poolCoinA:A.a2b[0]?g:b,poolCoinB:A.a2b[0]?b:g},W=E?"swap":"swap_with_partner",Q=P?v:k,V=P?k:v,ee=n?A.amountIn.toString():A.amountOut.toString(),j=ns.getDefaultSqrtPriceLimit(P).toString(),R=E?[o.object(c),o.object(A.poolAddress[0]),Q,V,o.pure(P),o.pure(n),o.pure(ee),o.pure(j),o.pure(!1),o.object(Ce)]:[o.object(c),o.object(A.poolAddress[0]),o.pure(t.partner),Q,V,o.pure(P),o.pure(n),o.pure(ee),o.pure(j),o.pure(!1),o.object(Ce)],U=[B.poolCoinA,B.poolCoinB],x=o.moveCall({target:`${e.sdkOptions.integrate.published_at}::${N}::${W}`,typeArguments:U,arguments:R});v=P?x[0]:x[1],k=P?x[1]:x[0]}else{const P=n?A.amountIn:A.rawAmountLimit[0],B=n?0:A.amountOut;let W="";A.a2b[0]?A.a2b[1]?W="swap_ab_bc":W="swap_ab_cb":A.a2b[1]?W="swap_ba_bc":W="swap_ba_cb",E||(W=`${W}_with_partner`);const Q=ns.getDefaultSqrtPriceLimit(A.a2b[0]),V=ns.getDefaultSqrtPriceLimit(A.a2b[1]),ee=E?[o.object(c),o.object(A.poolAddress[0]),o.object(A.poolAddress[1]),v,k,o.pure(n),o.pure(P.toString()),o.pure(B.toString()),o.pure(Q.toString()),o.pure(V.toString()),o.object(Ce)]:[o.object(c),o.object(A.poolAddress[0]),o.object(A.poolAddress[1]),o.pure(t.partner),v,k,o.pure(n),o.pure(P.toString()),o.pure(B.toString()),o.pure(Q.toString()),o.pure(V.toString()),o.object(Ce)],j=[A.coinType[0],A.coinType[1],A.coinType[2]],R=o.moveCall({target:`${a.published_at}::${N}::${W}`,typeArguments:j,arguments:ee});v=R[0],k=R[1]}return this.checkCoinThreshold(e,n,o,k,h,b),{fromCoin:v,toCoin:k,tx:o}}static async buildAggregatorSwapReturnCoins(e,t,n,i,s,o,r,a){if(a==null){if(e.senderAddress.length===0)throw Error("recipient and this config sdk senderAddress all not set");a=e.senderAddress}t.splitPaths.length>1&&(s="");let c,u;const l=t.splitPaths.some(d=>d.basePaths.some(h=>h.label==="Deepbook"));if((!t.byAmountIn||t.splitPaths.length===1)&&!l){const d=[];for(const b of t.splitPaths){const v=[],k=[],E=[],N=[];for(let P=0;P<b.basePaths.length;P+=1){const B=b.basePaths[P];v.push(B.direction),k.push(B.poolAddress),E.push(new y(B.inputAmount.toString())),P===0?N.push(B.fromCoin,B.toCoin):N.push(B.toCoin)}const A={amountIn:new y(b.inputAmount.toString()),amountOut:new y(b.outputAmount.toString()),poolAddress:k,a2b:v,rawAmountLimit:E,isExceed:!1,coinType:N};d.push(A)}const h={paths:d,partner:s,priceSlippagePoint:o},g=await this.buildRouterBasePathReturnCoins(e,h,t.byAmountIn,n,i,r);c=g.fromCoin,u=g.toCoin,r=g.tx}else{const d=Math.round(t.outputAmount*(1-o));c=n.targetCoin,i.isMintZeroCoin||i.originalSplitedCoin!==void 0?u=i.targetCoin:u=at.callMintZeroValueCoin(r,t.toCoin);let h=!1,g;if(l){const[b,v]=J0.createAccountCap(a,e.sdkOptions,r);r=v,g=b,h=!0}for(let b=0;b<t.splitPaths.length;b+=1){const v=t.splitPaths[b];let k;for(let E=0;E<v.basePaths.length;E+=1){const N=v.basePaths[E];if(N.label==="Deepbook")if(E===0)if(v.basePaths.length===1){const A=this.buildDeepbookBasePathTx(e,N,r,g,c,u,!1);c=A.from,u=A.to}else{k=at.callMintZeroValueCoin(r,N.toCoin);const A=this.buildDeepbookBasePathTx(e,N,r,g,c,k,!1);c=A.from,k=A.to}else{const A=this.buildDeepbookBasePathTx(e,N,r,g,k,u,!0);k=A.from,u=A.to}if(N.label==="Cetus")if(E===0)if(v.basePaths.length===1){const A=this.buildClmmBasePathTx(e,N,r,t.byAmountIn,c,u,!1,s);c=A.from,u=A.to}else{k=at.callMintZeroValueCoin(r,N.toCoin);const A=this.buildClmmBasePathTx(e,N,r,t.byAmountIn,c,k,!1,s);c=A.from,k=A.to}else{const A=this.buildClmmBasePathTx(e,N,r,t.byAmountIn,k,u,!0,s);k=A.from,u=A.to,r.moveCall({target:`${e.sdkOptions.integrate.published_at}::${G0}::send_coin`,typeArguments:[N.fromCoin],arguments:[k,r.pure(a)]})}}}this.checkCoinThreshold(e,t.byAmountIn,r,u,d,t.toCoin),h&&(r=J0.deleteAccountCapByObject(g,e.sdkOptions,r))}return{fromCoin:c,toCoin:u,tx:r}}static async buildAggregatorSwapTransaction(e,t,n,i,s,o){let r=new ye;const a=t.byAmountIn?Math.round(t.outputAmount*(1-s)):Math.round(t.inputAmount*(1+s)),c=at.buildCoinForAmount(r,n,t.byAmountIn?BigInt(t.inputAmount):BigInt(a),t.fromCoin,!1,!0),u=c.originalSplitedCoin!=null,l=at.buildCoinForAmount(r,n,0n,t.toCoin,!1),d=await this.buildAggregatorSwapReturnCoins(e,t,c,l,i,s,r,o),{fromCoin:h,toCoin:g}=d;r=d.tx;const b=[];if(l.isMintZeroCoin?b.push({coinType:t.toCoin,coin:g}):l.originalSplitedCoin!=null?r.mergeCoins(l.originalSplitedCoin,[g]):r.mergeCoins(l.targetCoin,[g]),u){const v=c.originalSplitedCoin;r.mergeCoins(v,[h])}else b.push({coinType:t.fromCoin,coin:h});for(let v=0;v<b.length;v++)this.buildTransferCoin(e,r,b[v].coin,b[v].coinType,o);return r}static checkCoinThreshold(e,t,n,i,s,o){t&&n.moveCall({target:`${e.sdkOptions.integrate.published_at}::${Zs}::check_coin_threshold`,typeArguments:[o],arguments:[i,n.pure(s)]})}static buildDeepbookBasePathTx(e,t,n,i,s,o,r){const a=t.direction?s:o,c=t.direction?o:s,u=[n.object(t.poolAddress),i,n.pure(t.inputAmount),n.pure(0),n.pure(t.direction),a,c,n.pure(r),n.object(Ce)],l=t.direction?[t.fromCoin,t.toCoin]:[t.toCoin,t.fromCoin],d=n.moveCall({target:`${e.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:l,arguments:u});return s=t.direction?d[0]:d[1],o=t.direction?d[1]:d[0],{from:s,to:o,tx:n}}static buildClmmBasePathTx(e,t,n,i,s,o,r,a){const{clmm_pool:c,integrate:u}=e.sdkOptions,l=G(c).global_config_id;let d=t.direction?s:o,h=t.direction?o:s;const g=a==="",b=g?Zs:Zl,v=g?"swap":"swap_with_partner",k=i?t.inputAmount.toString():t.outputAmount.toString(),E=ns.getDefaultSqrtPriceLimit(t.direction),N=g?[n.object(l),n.object(t.poolAddress),d,h,n.pure(t.direction),n.pure(i),n.pure(k),n.pure(E.toString()),n.pure(r),n.object(Ce)]:[n.object(l),n.object(t.poolAddress),n.pure(a),d,h,n.pure(t.direction),n.pure(i),n.pure(k),n.pure(E.toString()),n.pure(r),n.object(Ce)],A=t.direction?[t.fromCoin,t.toCoin]:[t.toCoin,t.fromCoin],P=n.moveCall({target:`${u.published_at}::${b}::${v}`,typeArguments:A,arguments:N});return d=P[0],h=P[1],s=t.direction?d:h,o=t.direction?h:d,{from:s,to:o,tx:n}}static buildCoinTypePair(e,t){const n=[];if(e.length===2){const i=[];i.push(e[0],e[1]),n.push(i)}else{const i=[];i.push(e[0],e[e.length-1]),n.push(i);for(let s=1;s<e.length-1;s+=1){if(t[s-1]===0)continue;const o=[];o.push(e[0],e[s],e[e.length-1]),n.push(o)}}return n}static buildTransferCoinToSender(e,t,n,i){t.moveCall({target:`${e.sdkOptions.integrate.published_at}::${G0}::transfer_coin_to_sender`,typeArguments:[i],arguments:[n]})}static buildTransferCoin(e,t,n,i,s){s!=null?t.transferObjects([n],t.pure(s)):at.buildTransferCoinToSender(e,t,n,i)}},Je=at;QP(Je,"callMintZeroValueCoin",(e,t)=>e.moveCall({target:"0x2::coin::zero",typeArguments:[t]}));function Mn(e){return!(!e.startsWith("0x")||e.length!==66)}var Oo=new y(1e9),J0=class{static createAccountCap(e,t,n,i=!1){if(e.length===0)throw Error("this config sdk senderAddress is empty");const{deepbook:s}=t,[o]=n.moveCall({target:`${s.published_at}::${sE}::create_account`,typeArguments:[],arguments:[]});return i&&n.transferObjects([o],n.pure(e)),[o,n]}static deleteAccountCap(e,t,n){const{deepbook:i}=t,s=[n.pure(e)];return n.moveCall({target:`${i.published_at}::${Yl}::delete_account_cap`,typeArguments:[],arguments:s}),n}static deleteAccountCapByObject(e,t,n){const{deepbook:i}=t,s=[e];return n.moveCall({target:`${i.published_at}::${Yl}::delete_account_cap`,typeArguments:[],arguments:s}),n}static async getAccountCap(e){const t=await e.fullClient.getOwnedObjectsByPage(e.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:e.sdkOptions.deepbook.package_id,module:Yl}}});return t.data.length===0?"":t.data[0].data.objectId}static async getPools(e){const t=e.sdkOptions.deepbook.package_id,n=[];try{(await e.fullClient.queryEventsByPage({MoveEventType:`${t}::clob_v2::PoolCreated`})).data.forEach(s=>{const o=s.parsedJson;o&&n.push({poolID:o.pool_id,tickSize:Number(o.tick_size),lotSize:Number(o.lot_size),takerFeeRate:Number(o.taker_fee_rate),makerRebateRate:Number(o.maker_rebate_rate),baseAsset:o.base_asset.name,quoteAsset:o.quote_asset.name})})}catch(i){console.log("getPoolImmutables",i)}return n}static async getPoolAsks(e,t,n,i){var h;const{simulationAccount:s}=e.sdkOptions,{deepbook_endpoint_v2:o}=e.sdkOptions,r=new ye,a=[],c=[n,i],u=[r.pure(t),r.pure("0"),r.pure("999999999999"),r.pure(Ce)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:u,typeArguments:c});const d=(h=(await e.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:h.filter(g=>he(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],v=d[0].parsedJson.depths[g],k={price:parseInt(b,10),quantity:parseInt(v,10)};a.push(k)}return a}static async getPoolBids(e,t,n,i){var h;const{simulationAccount:s}=e.sdkOptions,{deepbook_endpoint_v2:o}=e.sdkOptions,r=new ye,a=[],c=[n,i],u=[r.pure(t),r.pure("0"),r.pure("999999999999"),r.pure(Ce)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:u,typeArguments:c});const d=(h=(await e.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:h.filter(g=>he(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],v=d[0].parsedJson.depths[g],k={price:parseInt(b,10),quantity:parseInt(v,10)};a.push(k)}return a}static async preSwap(e,t,n,i){let s=!1,o=st,r=new y(i),a=st;const c=new y(i);if(n){let u=await this.getPoolBids(e,t.poolID,t.baseAsset,t.quoteAsset);u===null&&(s=!0),u=u.sort((l,d)=>d.price-l.price);for(let l=0;l<u.length;l+=1){const d=new y(u[l].quantity),h=new y(u[l].price),g=d.mul(new y(h)).mul(new y(t.takerFeeRate)).div(Oo).div(Oo);if(r.gt(d))r=r.sub(d),o=o.add(d.mul(h).div(Oo).sub(g)),a=a.add(g);else{const b=r.mul(new y(u[l].price)).div(Oo),v=b.mul(new y(t.takerFeeRate)).div(Oo);o=o.add(b.sub(v)),r=r.sub(r),a=a.add(v)}if(r.eq(st))break}}else{const u=await this.getPoolAsks(e,t.poolID,t.baseAsset,t.quoteAsset);u===null&&(s=!0);for(let l=0;l<u.length;l+=1){const d=new y(u[l].price).mul(new y(u[l].quantity)).div(new y(1e9)),h=d.mul(new y(t.takerFeeRate)).div(Oo),g=d.add(h);if(r.gt(d))o=o.add(new y(u[l].quantity)),r=r.sub(g),a=a.add(h);else{const b=new y(u[l].quantity).div(new y(t.lotSize)),v=g.div(b),k=r.div(v);o=o.add(k.muln(t.lotSize)),r=r.sub(k.mul(v)),a=a.add(k.div(b).mul(h))}if(r.eq(st))break}}return{poolAddress:t.poolID,estimatedAmountIn:c.sub(r).toNumber(),estimatedAmountOut:o.toNumber(),estimatedFeeAmount:a,isExceed:s,amount:Number(i),aToB:n,byAmountIn:!0}}static async simulateSwap(e,t,n,i,s,o){var B;const{deepbook_endpoint_v2:r}=e.sdkOptions;let a=new ye;const c=await this.getAccountCap(e);let u;if(c===""){const W=this.createAccountCap(e.senderAddress,e.sdkOptions,a),Q=W[0];a=W[1],u=Q}else u=a.pure(c);const l=await e.getOwnerCoinAssets(e.senderAddress),d=Je.buildCoinForAmount(a,l,BigInt(o),n,!1),h=d==null?void 0:d.targetCoin,g=Je.buildCoinForAmount(a,l,BigInt(o),i,!1),b=g==null?void 0:g.targetCoin,v=[n,i],k=[a.pure(t),u,a.pure(o),a.pure(0),a.pure(s),h,b,a.pure(Ce)];a.moveCall({target:`${r.published_at}::${oE}::swap`,arguments:k,typeArguments:v});const{simulationAccount:E}=e.sdkOptions,A=(B=(await e.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:E.address})).events)==null?void 0:B.filter(W=>he(W.type).name==="DeepbookSwapEvent");if(A.length===0)return null;const P=A[0].parsedJson;return{poolAddress:P.pool,estimatedAmountIn:P.amount_in,estimatedAmountOut:P.amount_out,aToB:P.atob}}},jE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPositionList(e,t="all"){const n={data:[],hasNextPage:!0},i=await this._sdk.fullClient.getDynamicFieldsByPage(e,t);n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor;const s=i.data.map(r=>{var a,c;if(r.error!=null||((c=(a=r.data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Me(`when getPositionList get position objects error: ${r.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");return r.name.value}),o=await this._sdk.Position.getSipmlePositionList(s);return n.data=o,n}async getPoolImmutables(e=[],t=0,n=100,i=!1){const{package_id:s}=this._sdk.sdkOptions.clmm_pool,o=`${s}_getInitPoolEvent`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{(await this._sdk.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`})).data.forEach(d=>{const h=d.parsedJson;h&&a.push({poolAddress:h.pool_id,tickSpacing:h.tick_spacing,coinTypeA:he(h.coin_type_a).full_address,coinTypeB:he(h.coin_type_b).full_address})}),this.updateCache(o,a,We)}catch(l){console.log("getPoolImmutables",l)}const u=e.length>0;for(let l=0;l<a.length;l+=1){const d=a[l];u&&!e.includes(d.poolAddress)||!u&&(l<t||l>=t+n)||c.push(d)}return c}async getPools(e=[],t=0,n=100){var r,a,c;const i=[];let s=[];e.length>0?s=[...e]:(await this.getPoolImmutables([],t,n,!1)).forEach(l=>s.push(l.poolAddress));const o=await this._sdk.fullClient.batchGetObjects(s,{showContent:!0,showType:!0});for(const u of o){if(u.error!=null||((a=(r=u.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Me(`getPools error code: ${((c=u.error)==null?void 0:c.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const l=ed(u);i.push(l);const d=`${l.poolAddress}_getPoolObject`;this.updateCache(d,l,We)}return i}async getPoolImmutablesWithPage(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.clmm_pool,i=[],s={data:[],hasNextPage:!1},o=e==="all",r=`${n}_getPoolImmutables`;if(o){const a=this.getCache(r,t);a&&i.push(...a)}if(i.length===0)try{const a=`${n}::factory::CreatePoolEvent`,c=await this._sdk.fullClient.queryEventsByPage({MoveEventType:a},e);s.hasNextPage=c.hasNextPage,s.nextCursor=c.nextCursor,c.data.forEach(u=>{const l=u.parsedJson;if(l){const d={poolAddress:l.pool_id,tickSpacing:l.tick_spacing,coinTypeA:he(l.coin_type_a).full_address,coinTypeB:he(l.coin_type_b).full_address};i.push(d)}})}catch(a){console.log("getPoolImmutables",a)}return s.data=i,o&&this.updateCache(`${n}_getPoolImmutables`,i,We),s}async getPoolsWithPage(e=[]){var s,o,r;const t=[];let n=[];e.length>0?n=[...e]:(await this.getPoolImmutablesWithPage()).data.forEach(c=>n.push(c.poolAddress));const i=await this._sdk.fullClient.batchGetObjects(n,{showContent:!0,showType:!0});for(const a of i){if(a.error!=null||((o=(s=a.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Me(`getPoolWithPages error code: ${((r=a.error)==null?void 0:r.code)??"unknown error"}, please check config and object ids`,"InvalidPoolObject");const c=ed(a);t.push(c);const u=`${c.poolAddress}_getPoolObject`;this.updateCache(u,c,We)}return t}async getPool(e,t=!0){var r,a,c;const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if(s.error!=null||((a=(r=s.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Me(`getPool error code: ${((c=s.error)==null?void 0:c.code)??"unknown error"}, please check config and object id`,"InvalidPoolObject");const o=ed(s);return this.updateCache(n,o),o}async creatPoolsTransactionPayload(e){for(const n of e)if(Dc(ni(n.coinTypeA),ni(n.coinTypeB))){const i=n.coinTypeB;n.coinTypeB=n.coinTypeA,n.coinTypeA=i}return await this.creatPool(e)}async creatPoolTransactionPayload(e){if(Dc(ni(e.coinTypeA),ni(e.coinTypeB))){const t=e.coinTypeB;e.coinTypeB=e.coinTypeA,e.coinTypeA=t}return"fix_amount_a"in e?await this.creatPoolAndAddLiquidity(e):await this.creatPool([e])}async getClmmConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.clmm_pool,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),o=qa(s),r=(await this._sdk.fullClient.queryEventsByPage({Transaction:o})).data,a={pools_id:"",global_config_id:"",global_vault_id:"",admin_cap_id:""};return r.length>0&&(r.forEach(c=>{const u=c.parsedJson;if(c.type)switch(he(c.type).full_address){case`${t}::config::InitConfigEvent`:a.global_config_id=u.global_config_id,a.admin_cap_id=u.admin_cap_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=u.pools_id;break;case`${t}::rewarder::RewarderInitEvent`:a.global_vault_id=u.global_vault_id;break;case`${t}::partner::InitPartnerEvent`:a.partners_id=u.partners_id;break}}),this.updateCache(n,a,We)),a}async getSuiTransactionResponse(e,t=!1){const n=`${e}_getSuiTransactionResponse`,i=this.getCache(n,t);if(i!==void 0)return i;let s;try{s=await this._sdk.fullClient.getTransactionBlock({digest:e,options:{showEvents:!0,showEffects:!0,showBalanceChanges:!0,showInput:!0,showObjectChanges:!0}})}catch{s=await this._sdk.fullClient.getTransactionBlock({digest:e,options:{showEvents:!0,showEffects:!0}})}return this.updateCache(n,s,We),s}async creatPool(e){const t=new ye,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=G(i),o=s.global_config_id,r=s.pools_id;return e.forEach(a=>{const c=[t.object(o),t.object(r),t.pure(a.tick_spacing.toString()),t.pure(a.initialize_sqrt_price),t.pure(a.uri),t.object(Ce)];t.moveCall({target:`${n.published_at}::${Yr}::create_pool`,typeArguments:[a.coinTypeA,a.coinTypeB],arguments:c})}),t}async creatPoolAndAddLiquidity(e){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const t=new ye,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=G(i),o=s.global_config_id,r=s.pools_id,a=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),c=Je.buildAddLiquidityFixTokenCoinInput(t,!e.fix_amount_a,e.amount_a,e.slippage,e.coinTypeA,a,!1),u=Je.buildAddLiquidityFixTokenCoinInput(t,e.fix_amount_a,e.amount_b,e.slippage,e.coinTypeB,a,!1),l=[t.pure(o),t.pure(r),t.pure(e.tick_spacing.toString()),t.pure(e.initialize_sqrt_price),t.pure(e.uri),c.targetCoin,u.targetCoin,t.pure(Gn(BigInt(e.tick_lower)).toString()),t.pure(Gn(BigInt(e.tick_upper)).toString()),t.pure(e.amount_a),t.pure(e.amount_b),t.pure(e.fix_amount_a),t.pure(Ce)];return t.moveCall({target:`${n.published_at}::${Ms}::create_pool_with_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:l}),t}async fetchTicks(e){let t=[],n=[];for(;;){const s=await this.getTicks({pool_id:e.pool_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,start:n,limit:512});if(t=[...t,...s],s.length<512)break;n=[s[s.length-1].index]}return t}async getTicks(e){var c;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=[],s=[e.coinTypeA,e.coinTypeB],o=new ye,r=[o.pure(e.pool_id),o.pure(e.start),o.pure(e.limit.toString())];if(o.moveCall({target:`${t.published_at}::${qi}::fetch_ticks`,arguments:r,typeArguments:s}),!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const a=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address});if(a.error!=null)throw new Me(`getTicks error code: ${a.error??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return(c=a.events)==null||c.forEach(u=>{he(u.type).name==="FetchTicksResultEvent"&&u.parsedJson.ticks.forEach(l=>{i.push(ME(l))})}),i}async fetchPositionRewardList(e){var r;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=[];let s=[];const o=512;for(;;){const a=[e.coinTypeA,e.coinTypeB],c=new ye,u=[c.object(e.pool_id),c.pure(s,"u64"),c.pure(o.toString(),"u64")];if(c.moveCall({target:`${t.published_at}::${qi}::fetch_positions`,arguments:u,typeArguments:a}),!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const l=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:n.address});if(l.error!=null)throw new Me(`fetch position reward error code: ${l.error??"unknown error"}, please check config and tick object ids`,"InvalidPositionRewardObject");const d=[];if((r=l==null?void 0:l.events)==null||r.forEach(h=>{he(h.type).name==="FetchPositionsEvent"&&h.parsedJson.positions.forEach(g=>{const b=pw(g);d.push(b)})}),i.push(...d),d.length<o)break;s=[d[d.length-1].pos_object_id]}return i}async fetchTicksByRpc(e){let t=[],n=null;const i=512;for(;;){const s=[],o=await this.sdk.fullClient.getDynamicFields({parentId:e,cursor:n,limit:i});if(n=o.nextCursor,o.data.forEach(r=>{he(r.objectType).module==="skip_list"&&s.push(r.objectId)}),t=[...t,...await this.getTicksByRpc(s)],n===null||o.data.length<i)break}return t}async getTicksByRpc(e){var i,s,o;const t=[],n=await this.sdk.fullClient.batchGetObjects(e,{showContent:!0,showType:!0});for(const r of n){if(r.error!=null||((s=(i=r.data)==null?void 0:i.content)==null?void 0:s.dataType)!=="moveObject")throw new Me(`getTicksByRpc error code: ${((o=r.error)==null?void 0:o.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");const a=td(r);a!=null&&t.push(a)}return t}async getTickDataByIndex(e,t){var s,o;const n={type:"u64",value:Gn(BigInt(gE(t).toString())).toString()},i=await this.sdk.fullClient.getDynamicFieldObject({parentId:e,name:n});if(i.error!=null||((o=(s=i.data)==null?void 0:s.content)==null?void 0:o.dataType)!=="moveObject")throw new Me(`get tick by index: ${t} error: ${i.error}`,"InvalidTickIndex");return td(i)}async getTickDataByObjectId(e){var n,i,s;const t=await this.sdk.fullClient.getObject({id:e,options:{showContent:!0}});if(t.error!=null||((i=(n=t.data)==null?void 0:n.content)==null?void 0:i.dataType)!=="moveObject")throw new Me(`getTicksByRpc error code: ${((s=t.error)==null?void 0:s.code)??"unknown error"}, please check config and tick object ids`,"InvalidTickObjectId");return td(t)}async getPartnerRefFeeAmount(e){var a,c;const t=await this._sdk.fullClient.batchGetObjects([e],{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0});if(t[0].error!=null||((c=(a=t[0].data)==null?void 0:a.content)==null?void 0:c.dataType)!=="moveObject")throw new Me(`get partner by object id: ${e} error: ${t[0].error}`,"NotFoundPartnerObject");const n=t[0].data.content.fields.balances,i=await this._sdk.fullClient.getDynamicFieldsByPage(n.fields.id.id),s=[];i.data.forEach(u=>{var l,d;if(u.error!=null||((d=(l=u.data)==null?void 0:l.content)==null?void 0:d.dataType)!=="moveObject")throw new Me(`when getPartnerRefFeeAmount get partner object error: ${u.error}, please check the rpc, contracts address config and position id.`,"InvalidConfig");s.push(u.objectId)});const o=[];return(await this._sdk.fullClient.batchGetObjects(s,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Me(`get coin by object id: ${u.data.objectId} error: ${u.error}`,"InvalidParnterRefFeeFields");const l={coinAddress:u.data.content.fields.name,coinObjectId:u.data.objectId,balance:BigInt(u.data.content.fields.value)};o.push(l)}),o}async claimPartnerRefFeePayload(e,t,n){const i=new ye,{clmm_pool:s}=this.sdk.sdkOptions,{global_config_id:o}=G(s),r=[n],a=[i.object(o),i.object(e),i.object(t)];return i.moveCall({target:`${s.published_at}::${nE}::claim_ref_fee`,arguments:a,typeArguments:r}),i}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},zE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}buildPositionType(){return`${this._sdk.sdkOptions.clmm_pool.package_id}::position::Position`}async getPositionList(e,t=[]){const n=[],i=await this._sdk.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.clmm_pool.package_id}}),s=t.length>0;for(const o of i.data)if(he(o.data.type).full_address===this.buildPositionType()){const a=io(o),c=`${a.pos_object_id}_getPositionList`;this.updateCache(c,a,We),s?t.includes(a.pool)&&n.push(a):n.push(a)}return n}async getPosition(e,t,n=!0){let i=await this.getSimplePosition(t);return n&&(i=await this.updatePositionRewarders(e,i)),i}async getPositionById(e,t=!0){const n=await this.getSimplePosition(e);if(t){const i=await this._sdk.Pool.getPool(n.pool,!1);return await this.updatePositionRewarders(i.position_manager.positions_handle,n)}return n}async getSimplePosition(e){const t=`${e}_getPositionList`;let n=this.getSimplePositionByCache(e);if(n===void 0){const i=await this.sdk.fullClient.getObject({id:e,options:{showContent:!0,showType:!0,showDisplay:!0,showOwner:!0}});n=io(i),this.updateCache(t,n,We)}return n}getSimplePositionByCache(e){const t=`${e}_getPositionList`;return this.getCache(t)}async getSipmlePositionList(e){const t=[],n=[];return e.forEach(i=>{const s=this.getSimplePositionByCache(i);s?t.push(s):n.push(i)}),n.length>0&&(await this._sdk.fullClient.batchGetObjects(n,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(s=>{const o=io(s);t.push(o);const r=`${o.pos_object_id}_getPositionList`;this.updateCache(r,o,We)}),t}async updatePositionRewarders(e,t){const n=await this.getPositionRewarders(e,t.pos_object_id);return{...t,...n}}async getPositionRewarders(e,t){try{const n=await this._sdk.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),s=ft(n.data).value.fields.value;return pw(s)}catch(n){console.log(n);return}}async fetchPosFeeAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new ye;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(G(t).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${qi}::fetch_position_fees`,arguments:d,typeArguments:l})}if(!Mn(i.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address});if(o.error!=null)throw new Me(`fetch position fee error code: ${o.error??"unknown error"}, please check config and postion and pool object ids`,"InvalidPoolObject");const r=(c=o.events)==null?void 0:c.filter(u=>he(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async batchFetchPositionFees(e){const t=[];for(const i of e){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);t.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(t.length>0){const i=await this.fetchPosFeeAmount(t);for(const s of i)n[s.position_id]=s;return n}return n}async createAddLiquidityFixTokenPayload(e,t){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:s}=jc(e);if(e=e,e.fix_amount_a&&i||!e.fix_amount_a&&s)return await Je.buildAddLiquidityFixTokenForGas(this._sdk,n,e,t)}return Je.buildAddLiquidityFixToken(this._sdk,n,e)}async createAddLiquidityPayload(e){const{integrate:t,clmm_pool:n}=this._sdk.sdkOptions;if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const i=Gn(BigInt(e.tick_lower)).toString(),s=Gn(BigInt(e.tick_upper)).toString(),o=[e.coinTypeA,e.coinTypeB];let r=new ye;const a=!Tw(e.pos_id),c=BigInt(e.max_amount_a),u=BigInt(e.max_amount_b),l=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),d=Je.buildCoinForAmount(r,l,c,e.coinTypeA,!1),h=Je.buildCoinForAmount(r,l,u,e.coinTypeB,!1);return a?r.moveCall({target:`${t.published_at}::${Ms}::open_position_with_liquidity`,typeArguments:o,arguments:[r.object(G(n).global_config_id),r.object(e.pool_id),r.pure(i),r.pure(s),d.targetCoin,h.targetCoin,r.pure(e.max_amount_a),r.pure(e.max_amount_b),r.pure(e.delta_liquidity),r.object(Ce)]}):(r=Je.createCollectRewarderAndFeeParams(this._sdk,r,e,l,d.remainCoins,h.remainCoins),r.moveCall({target:`${t.published_at}::${Ms}::add_liquidity`,typeArguments:o,arguments:[r.object(G(n).global_config_id),r.object(e.pool_id),r.object(e.pos_id),d.targetCoin,h.targetCoin,r.pure(e.max_amount_a),r.pure(e.max_amount_b),r.pure(e.delta_liquidity),r.object(Ce)]})),r}async removeLiquidityTransactionPayload(e){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions,i="remove_liquidity";let s=new ye;const o=[e.coinTypeA,e.coinTypeB],r=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);s=Je.createCollectRewarderAndFeeParams(this._sdk,s,e,r);const a=[s.object(G(t).global_config_id),s.object(e.pool_id),s.object(e.pos_id),s.pure(e.delta_liquidity),s.pure(e.min_amount_a),s.pure(e.min_amount_b),s.object(Ce)];return s.moveCall({target:`${n.published_at}::${Yr}::${i}`,typeArguments:o,arguments:a}),s}async closePositionTransactionPayload(e){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions;let i=new ye;const s=[e.coinTypeA,e.coinTypeB],o=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);return i=Je.createCollectRewarderAndFeeParams(this._sdk,i,e,o),i.moveCall({target:`${n.published_at}::${Yr}::close_position`,typeArguments:s,arguments:[i.object(G(t).global_config_id),i.object(e.pool_id),i.object(e.pos_id),i.pure(e.min_amount_a),i.pure(e.min_amount_b),i.object(Ce)]}),i}openPositionTransactionPayload(e){const{clmm_pool:t,integrate:n}=this.sdk.sdkOptions,i=new ye,s=[e.coinTypeA,e.coinTypeB],o=Gn(BigInt(e.tick_lower)).toString(),r=Gn(BigInt(e.tick_upper)).toString(),a=[i.pure(G(t).global_config_id),i.pure(e.pool_id),i.pure(o),i.pure(r)];return i.moveCall({target:`${n.published_at}::${Yr}::open_position`,typeArguments:s,arguments:a}),i}async collectFeeTransactionPayload(e){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const t=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null,!0),n=new ye,i=Je.buildCoinForAmount(n,t,BigInt(0),e.coinTypeA,!1),s=Je.buildCoinForAmount(n,t,BigInt(0),e.coinTypeB,!1);return this.createCollectFeePaylod(e,n,i.targetCoin,s.targetCoin),n}createCollectFeePaylod(e,t,n,i){const{clmm_pool:s,integrate:o}=this.sdk.sdkOptions,r=[e.coinTypeA,e.coinTypeB],a=[t.object(G(s).global_config_id),t.object(e.pool_id),t.object(e.pos_id),n,i];return t.moveCall({target:`${o.published_at}::${Ms}::collect_fee`,typeArguments:r,arguments:a}),t}createCollectFeeNoSendPaylod(e,t,n,i){const{clmm_pool:s,integrate:o}=this.sdk.sdkOptions,r=[e.coinTypeA,e.coinTypeB],a=[t.object(G(s).global_config_id),t.object(e.pool_id),t.object(e.pos_id),n,i];return t.moveCall({target:`${o.published_at}::${ow}::collect_fee`,typeArguments:r,arguments:a}),t}async calculateFee(e){const t=await this.collectFeeTransactionPayload(e);if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.fullClient.devInspectTransactionBlock({transactionBlock:t,sender:this._sdk.senderAddress});for(const i of n.events)if(he(i.type).name==="CollectFeeEvent"){const s=i.parsedJson;return{feeOwedA:s.amount_a,feeOwedB:s.amount_b}}return{feeOwedA:"0",feeOwedB:"0"}}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},HE=class{constructor(e){ze(this,"_sdk");ze(this,"growthGlobal");this._sdk=e,this.growthGlobal=[st,st,st]}get sdk(){return this._sdk}async emissionsEveryDay(e){const n=(await this.sdk.Pool.getPool(e)).rewarder_infos;if(!n)return null;const i=[];for(const s of n){const o=Nt.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async updatePoolRewarder(e,t){const n=await this.sdk.Pool.getPool(e),i=n.rewarder_last_updated_time;if(n.rewarder_last_updated_time=t.toString(),Number(n.liquidity)===0||t.eq(new y(i)))return n;const s=t.div(new y(1e3)).sub(new y(i)).add(new y(15)),o=n.rewarder_infos;for(let r=0;r<o.length;r+=1){const a=o[r],c=Nt.checkMulDivFloor(s,new y(a.emissions_per_second),new y(n.liquidity),128);this.growthGlobal[r]=new y(a.growth_global).add(new y(c))}return n}async posRewardersAmount(e,t,n){const i=Date.parse(new Date().toString()),s=await this.updatePoolRewarder(e,new y(i)),o=await this.sdk.Position.getPositionRewarders(t,n);if(o===void 0)return[];const r=s.ticks_handle,a=await this.sdk.Pool.getTickDataByIndex(r,o.tick_lower_index),c=await this.sdk.Pool.getTickDataByIndex(r,o.tick_upper_index);return this.posRewardersAmountInternal(s,o,a,c)}async poolRewardersAmount(e,t){const n=Date.parse(new Date().toString()),i=await this.updatePoolRewarder(t,new y(n)),s=await this.sdk.Position.getPositionList(e,[t]),o=await this.getPoolLowerAndUpperTicks(i.ticks_handle,s),r=[st,st,st];for(let a=0;a<s.length;a+=1){const c=await this.posRewardersAmountInternal(i,s[a],o[0][a],o[1][a]);for(let u=0;u<3;u+=1)r[u]=r[u].add(c[u].amount_owed)}return r}posRewardersAmountInternal(e,t,n,i){const s=t.tick_lower_index,o=t.tick_upper_index,r=NE(e,n,i,s,o,this.growthGlobal),a=[],c=[];if(r.length>0){let u=Nt.subUnderflowU128(r[0],new y(t.reward_growth_inside_0));u.gt(new y("3402823669209384634633745948738404"))&&(u=os);const l=Nt.checkMulShiftRight(new y(t.liquidity),u,64,128);a.push(r[0]),c.push({amount_owed:new y(t.reward_amount_owed_0).add(l),coin_address:e.rewarder_infos[0].coinAddress})}if(r.length>1){let u=Nt.subUnderflowU128(r[1],new y(t.reward_growth_inside_1));u.gt(new y("3402823669209384634633745948738404"))&&(u=os);const l=Nt.checkMulShiftRight(new y(t.liquidity),u,64,128);a.push(r[1]),c.push({amount_owed:new y(t.reward_amount_owed_1).add(l),coin_address:e.rewarder_infos[1].coinAddress})}if(r.length>2){let u=Nt.subUnderflowU128(r[2],new y(t.reward_growth_inside_2));u.gt(new y("3402823669209384634633745948738404"))&&(u=os);const l=Nt.checkMulShiftRight(new y(t.liquidity),u,64,128);a.push(r[2]),c.push({amount_owed:new y(t.reward_amount_owed_2).add(l),coin_address:e.rewarder_infos[2].coinAddress})}return c}async batchFetchPositionRewarders(e){const t=[];for(const i of e){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);t.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos})}const n={};if(t.length>0){const i=await this.fetchPosRewardersAmount(t);for(const s of i)n[s.positionId]=s.rewarderAmountOwed;return n}return n}async fetchPositionRewarders(e,t){const n={poolAddress:e.poolAddress,positionId:t,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,rewarderInfo:e.rewarder_infos};return(await this.fetchPosRewardersAmount([n]))[0].rewarderAmountOwed}async batchFetchPositionFees(e){const t=[];for(const i of e){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);t.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(t.length>0){const i=await this.fetchPosFeeAmount(t);for(const s of i)n[s.position_id]=s;return n}return n}async fetchPosFeeAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new ye;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(G(t).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${qi}::fetch_position_fees`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address})).events)==null?void 0:c.filter(u=>he(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async fetchPosRewardersAmount(e){var c;const{clmm_pool:t,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new ye;for(const u of e){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(G(t).global_config_id),s.object(u.poolAddress),s.pure(u.positionId),s.object(Ce)];s.moveCall({target:`${n.published_at}::${qi}::fetch_position_rewards`,arguments:d,typeArguments:l})}if(!Mn(i.address))throw new Me(`this config simulationAccount: ${i.address} is not set right`,"InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address});if(o.error!=null)throw new Me(`fetch position rewards error code: ${o.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(c=o.events)==null?void 0:c.filter(u=>he(u.type).name==="FetchPositionRewardsEvent");if(r.length===0)return[];if(r.length!==e.length)throw new Me("valueData.length !== params.pools.length");const a=[];for(let u=0;u<r.length;u+=1){const l={poolAddress:e[u].poolAddress,positionId:e[u].positionId,rewarderAmountOwed:[]};for(let d=0;d<e[u].rewarderInfo.length;d+=1)l.rewarderAmountOwed.push({amount_owed:new y(r[u].parsedJson.data[d]),coin_address:e[u].rewarderInfo[d].coinAddress});a.push(l)}return a}async fetchPoolRewardersAmount(e,t){const n=await this.sdk.Pool.getPool(t),i=await this.sdk.Position.getPositionList(e,[t]),s=[];for(const a of i)s.push({poolAddress:n.poolAddress,positionId:a.pos_object_id,rewarderInfo:n.rewarder_infos,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB});const o=await this.fetchPosRewardersAmount(s),r=[st,st,st];if(o!=null)for(const a of o)for(let c=0;c<a.rewarderAmountOwed.length;c+=1)r[c]=r[c].add(a.rewarderAmountOwed[c].amount_owed);return r}async getPoolLowerAndUpperTicks(e,t){const n=[],i=[];for(const s of t){const o=await this.sdk.Pool.getTickDataByIndex(e,s.tick_lower_index),r=await this.sdk.Pool.getTickDataByIndex(e,s.tick_upper_index);n.push(o),i.push(r)}return[n,i]}async collectRewarderTransactionPayload(e){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const t=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);let n=new ye;return n=Je.createCollectRewarderAndFeeParams(this._sdk,n,e,t),n}async batchCollectRewardePayload(e,t){if(!Mn(this._sdk.senderAddress))throw new Me("this config sdk senderAddress is not set right","InvalidSendAddress");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);t=t||new ye;const i={};return e.forEach(s=>{const o=bn(s.coinTypeA),r=bn(s.coinTypeB);if(s.collect_fee){let c=i[o];c===void 0&&(c=Je.buildCoinForAmount(t,n,BigInt(0),o,!1),i[o]=c);let u=i[r];u===void 0&&(u=Je.buildCoinForAmount(t,n,BigInt(0),r,!1),i[r]=u),t=this._sdk.Position.createCollectFeeNoSendPaylod({pool_id:s.pool_id,pos_id:s.pos_id,coinTypeA:s.coinTypeA,coinTypeB:s.coinTypeB},t,c.targetCoin,u.targetCoin)}const a=[];s.rewarder_coin_types.forEach(c=>{const u=bn(c);let l=i[c];l===void 0&&(l=Je.buildCoinForAmount(t,n,BigInt(0),u,!1),i[u]=l),a.push(l.targetCoin)}),t=this.createCollectRewarderNoSendPaylod(s,t,a)}),Object.keys(i).forEach(s=>{const o=i[s];o.isMintZeroCoin&&Je.buildTransferCoin(this._sdk,t,o.targetCoin,s,this._sdk.senderAddress)}),t}createCollectRewarderPaylod(e,t,n){const{clmm_pool:i,integrate:s}=this.sdk.sdkOptions,o=G(i),r=[e.coinTypeA,e.coinTypeB];return e.rewarder_coin_types.forEach((a,c)=>{t&&t.moveCall({target:`${s.published_at}::${Ms}::collect_reward`,typeArguments:[...r,a],arguments:[t.object(o.global_config_id),t.object(e.pool_id),t.object(e.pos_id),t.object(o.global_vault_id),n[c],t.object(Ce)]})}),t}createCollectRewarderNoSendPaylod(e,t,n){const{clmm_pool:i,integrate:s}=this.sdk.sdkOptions,o=G(i),r=[e.coinTypeA,e.coinTypeB];return e.rewarder_coin_types.forEach((a,c)=>{t&&t.moveCall({target:`${s.published_at}::${ow}::collect_reward`,typeArguments:[...r,a],arguments:[t.object(o.global_config_id),t.object(e.pool_id),t.object(e.pos_id),t.object(o.global_vault_id),n[c],t.object(Ce)]})}),t}};function Ja(e,t){return{pair:`${e}-${t}`,reversePair:`${t}-${e}`}}var KE=class{constructor(e){ze(this,"graph");ze(this,"pathProviders");ze(this,"coinProviders");ze(this,"_coinAddressMap");ze(this,"poolAddressMap");ze(this,"_sdk");this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new Ay(!1),this._coinAddressMap=new Map,this.poolAddressMap=new Map,this._sdk=e,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.preRouterSwapA2B2C=this.preRouterSwapA2B2C.bind(this),this.price=this.price.bind(this),this.getPoolWithTVL=this.getPoolWithTVL.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(e,t){const{pair:n,reversePair:i}=Ja(e,t);let s=this.poolAddressMap.get(n);if(s!=null)return{addressMap:s,direction:!0};if(s=this.poolAddressMap.get(i),s!=null)return{addressMap:s,direction:!1}}setCoinList(){this.coinProviders.coins.forEach(e=>{this._coinAddressMap.set(e.address,e)})}loadGraph(e,t){this.addCoinProvider(e),this.addPathProvider(t),this.setCoinList(),this.pathProviders.forEach(n=>{const{paths:i}=n;i.forEach(s=>{const o=this.graph.getVertexByKey(s.base)??new Ic(s.base),r=this.graph.getVertexByKey(s.quote)??new Ic(s.quote);this.graph.addEdge(new Ty(o,r));const a=this._coinAddressMap.get(s.base),c=this._coinAddressMap.get(s.quote);if(a!=null&&c!=null){const u=Ja(s.base,s.quote).pair;this.poolAddressMap.set(u,s.addressMap)}})})}addPathProvider(e){for(let t=0;t<e.paths.length;t+=1){const{base:n,quote:i}=e.paths[t];n.localeCompare(i)<0&&(e.paths[t].base=i,e.paths[t].quote=n),n==="0x2::sui::SUI"&&(e.paths[t].base=i,e.paths[t].quote=n),i==="0x2::sui::SUI"&&(e.paths[t].base=n,e.paths[t].quote=i)}return this.pathProviders.push(e),this}addCoinProvider(e){return this.coinProviders=e,this}tokenInfo(e){return this._coinAddressMap.get(e)}getFeeRate(e,t,n){const i=Ja(e,t).pair,s=this.poolAddressMap.get(i);if(s!=null){for(const[a,c]of s.entries())if(c===n)return a*100}const o=Ja(e,t).reversePair,r=this.poolAddressMap.get(o);if(r!=null){for(const[a,c]of r.entries())if(c===n)return a*100}return 0}async price(e,t,n,i,s,o,r){const a=this.tokenInfo(e),c=this.tokenInfo(t);if(a===void 0||c===void 0)throw new Me("From/To coin is undefined","InvalidCoin");const u=this.graph.getVertexByKey(a.address),l=this.graph.getVertexByKey(c.address),d=this.graph.findAllPath(u,l),h=Array.from(d);if(h.length===0)throw new Me("No find valid path in coin graph","NotFoundPath");let g=[];for(let j=0;j<h.length;j+=1){const R=h[j];if(R.length>3)continue;const U=[],x=[],f=[],m=[];for(let T=0;T<R.length-1;T+=1){const $=R[T].value.toString(),M=R[T+1].value.toString(),z=this.getPoolAddressMapAndDirection($,M),J=z==null?void 0:z.addressMap,O=z==null?void 0:z.direction;J!=null&&O!=null&&(x.push(O),U.push($),U.push(M),J.forEach(_=>{T===0?f.push(_):m.push(_)}))}for(const T of f)if(m.length>0)for(const $ of m){const M={stepNums:2,poolAB:T,poolBC:$,a2b:x[0],b2c:x[1],amount:n,byAmountIn:i,coinTypeA:U[0],coinTypeB:U[1],coinTypeC:U[3]};g.push(M)}else{const $={stepNums:1,poolAB:T,poolBC:void 0,a2b:x[0],b2c:void 0,amount:n,byAmountIn:i,coinTypeA:U[0],coinTypeB:U[1],coinTypeC:void 0};g.push($)}}const b=g.filter(j=>j.stepNums===1),v=g.filter(j=>j.stepNums!==1);let k=[];try{k=await this.getPoolWithTVL()}catch{k=[]}if(k.length>0){const j=new Map(k.map(R=>[R.poolAddress,R]));v.sort((R,U)=>{let x=0,f=0;if(j.has(R.poolAB)&&j.has(R.poolBC)){const m=j.get(R.poolAB),T=j.get(R.poolBC);x=Math.min(m.tvl,T.tvl)}if(j.has(U.poolAB)&&j.has(U.poolBC)){const m=j.get(U.poolAB),T=j.get(U.poolBC);f=Math.min(m.tvl,T.tvl)}return f-x})}if(g=[...b,...v],g.length===0){if(r!=null){const j=await this.sdk.Swap.preSwapWithMultiPool(r),R={amountIn:new y(j.estimatedAmountIn),amountOut:new y(j.estimatedAmountOut),poolAddress:[j.poolAddress],a2b:[j.aToB],rawAmountLimit:i?[j.estimatedAmountOut]:[j.estimatedAmountIn],isExceed:j.isExceed,coinType:[e,t]},U={paths:[R],partner:o,priceSlippagePoint:s};return{amountIn:new y(j.estimatedAmountIn),amountOut:new y(j.estimatedAmountOut),paths:[R],a2b:j.aToB,b2c:void 0,byAmountIn:i,isExceed:j.isExceed,targetSqrtPrice:[j.estimatedEndSqrtPrice],currentSqrtPrice:[j.estimatedStartSqrtPrice],coinTypeA:e,coinTypeB:t,coinTypeC:void 0,createTxParams:U}}throw new Me("No parameters available for service downgrade","NoDowngradeNeedParams")}const E=await this.preRouterSwapA2B2C(g.slice(0,16));if(E==null){if(r!=null){const R=await this.sdk.Swap.preSwapWithMultiPool(r),U={amountIn:new y(R.estimatedAmountIn),amountOut:new y(R.estimatedAmountOut),poolAddress:[R.poolAddress],a2b:[R.aToB],rawAmountLimit:i?[R.estimatedAmountOut]:[R.estimatedAmountIn],isExceed:R.isExceed,coinType:[e,t]},x={paths:[U],partner:o,priceSlippagePoint:s};return{amountIn:new y(R.estimatedAmountIn),amountOut:new y(R.estimatedAmountOut),paths:[U],a2b:R.aToB,b2c:void 0,byAmountIn:i,isExceed:R.isExceed,targetSqrtPrice:[R.estimatedEndSqrtPrice],currentSqrtPrice:[R.estimatedStartSqrtPrice],coinTypeA:e,coinTypeB:t,coinTypeC:void 0,createTxParams:x}}return{amountIn:st,amountOut:st,paths:[],a2b:!1,b2c:!1,byAmountIn:i,isExceed:!0,targetSqrtPrice:[],currentSqrtPrice:[],coinTypeA:"",coinTypeB:"",coinTypeC:void 0,createTxParams:void 0}}const N=E.index,A=g[N].poolBC!=null?[g[N].poolAB,g[N].poolBC]:[g[N].poolAB],P=i?[E.amountMedium,E.amountOut]:[E.amountIn,E.amountMedium],B=[];B.push(g[N].a2b),E.stepNum>1&&B.push(g[N].b2c);const W=[];W.push(g[N].coinTypeA),W.push(g[N].coinTypeB),E.stepNum>1&&W.push(g[N].coinTypeC);const Q={amountIn:E.amountIn,amountOut:E.amountOut,poolAddress:A,a2b:B,rawAmountLimit:P,isExceed:E.isExceed,coinType:W},V={paths:[Q],partner:o,priceSlippagePoint:s};return{amountIn:E.amountIn,amountOut:E.amountOut,paths:[Q],a2b:g[N].a2b,b2c:E.stepNum>1?g[N].b2c:void 0,byAmountIn:i,isExceed:E.isExceed,targetSqrtPrice:E.targetSqrtPrice,currentSqrtPrice:E.currentSqrtPrice,coinTypeA:g[N].coinTypeA,coinTypeB:g[N].coinTypeB,coinTypeC:E.stepNum>1?g[N].coinTypeC:void 0,createTxParams:V}}async priceUseV1(e,t,n,i,s,o,r){if(r!=null){const a=await this.sdk.Swap.preSwapWithMultiPool(r),c={amountIn:new y(a.estimatedAmountIn),amountOut:new y(a.estimatedAmountOut),poolAddress:[a.poolAddress],a2b:[a.aToB],rawAmountLimit:i?[a.estimatedAmountOut]:[a.estimatedAmountIn],isExceed:a.isExceed,coinType:[e,t]},u={paths:[c],partner:o,priceSlippagePoint:s};return{amountIn:new y(a.estimatedAmountIn),amountOut:new y(a.estimatedAmountOut),paths:[c],a2b:a.aToB,b2c:void 0,byAmountIn:i,isExceed:a.isExceed,targetSqrtPrice:[a.estimatedEndSqrtPrice],currentSqrtPrice:[a.estimatedStartSqrtPrice],coinTypeA:e,coinTypeB:t,coinTypeC:void 0,createTxParams:u}}throw new Me("No parameters available for service downgrade","NoDowngradeNeedParams")}async preRouterSwapA2B2C(e){var d;if(e.length===0)return null;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new ye;for(const h of e)if(h.stepNums>1){const g=[i.object(h.poolAB),i.object(h.poolBC),i.pure(h.a2b),i.pure(h.b2c),i.pure(h.byAmountIn),i.pure(h.amount.toString())],b=[];h.a2b?b.push(h.coinTypeA,h.coinTypeB):b.push(h.coinTypeB,h.coinTypeA),h.b2c?b.push(h.coinTypeB,h.coinTypeC):b.push(h.coinTypeC,h.coinTypeB),i.moveCall({target:`${t.published_at}::${Zs}::calculate_router_swap_result`,typeArguments:b,arguments:g})}else{const g=[i.pure(h.poolAB),i.pure(h.a2b),i.pure(h.byAmountIn),i.pure(h.amount.toString())],b=h.a2b?[h.coinTypeA,h.coinTypeB]:[h.coinTypeB,h.coinTypeA];i.moveCall({target:`${t.published_at}::${iE}::get_expect_swap_result`,arguments:g,typeArguments:b})}if(!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const o=(d=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:d.filter(h=>he(h.type).name==="CalculatedRouterSwapResultEvent"||he(h.type).name==="ExpectSwapResultEvent");if(o.length===0)return null;let r=e[0].byAmountIn?st:vr,a=0;for(let h=0;h<o.length;h+=1)if(!o[h].parsedJson.data.is_exceed)if(e[0].byAmountIn){const g=new y(o[h].parsedJson.data.amount_out);g.gt(r)&&(a=h,r=g)}else{const g=e[h].stepNums>1?new y(o[h].parsedJson.data.amount_in):new y(o[h].parsedJson.data.amount_in).add(new y(o[h].parsedJson.data.fee_amount));g.lt(r)&&(a=h,r=g)}const c=[],u=[];return e[a].stepNums>1?(u.push(o[a].parsedJson.data.target_sqrt_price_ab,o[a].parsedJson.data.target_sqrt_price_cd),c.push(o[a].parsedJson.data.current_sqrt_price_ab,o[a].parsedJson.data.current_sqrt_price_cd)):(u.push(o[a].parsedJson.data.after_sqrt_price),c.push(o[a].parsedJson.current_sqrt_price)),{index:a,amountIn:e[0].byAmountIn?e[a].amount:r,amountMedium:o[a].parsedJson.data.amount_medium,amountOut:e[0].byAmountIn?r:e[a].amount,targetSqrtPrice:u,currentSqrtPrice:c,isExceed:o[a].parsedJson.data.is_exceed,stepNum:e[a].stepNums}}async getPoolWithTVL(){const e=[],{swapCountUrl:t}=this._sdk.sdkOptions;if(!t)return e;let n;try{n=await fetch(t)}catch{throw new Me(`Failed to get pool list with liquidity from ${t}.`,"InvalidSwapCountUrl")}let i;try{i=await n.json()}catch{throw new Me(`Failed tp [arse response from ${t}].`,"InvalidSwapCountUrl")}if(i.code!==200)throw new Me(`Failed to get pool list from ${t}. Statu code is ${i.code}.`,"InvalidSwapCountUrl");const{pools:s}=i.data;for(const o of s)e.push({poolAddress:o.swap_account,tvl:Number(o.tvl_in_usd)});return e}},GE=class{constructor(e){ze(this,"_sdk");ze(this,"calculateSingleImpact",(e,t)=>t.minus(e).div(t).mul(100));this._sdk=e}get sdk(){return this._sdk}calculateSwapFee(e){let t=L(0);return e.forEach(n=>{const i=n.basePaths.length;if(i>0){const s=n.basePaths[0],o=s.label==="Cetus"?new ie(s.feeRate).div(10**6):new ie(s.feeRate).div(10**9),r=L(s.inputAmount).div(10**s.fromDecimal).mul(o);if(t=t.add(r),i>1){const a=n.basePaths[1],c=s.direction?s.currentPrice:new ie(1).div(s.currentPrice),u=a.direction?a.currentPrice:new ie(1).div(a.currentPrice),l=a.label==="Cetus"?new ie(a.feeRate).div(10**6):new ie(a.feeRate).div(10**9),h=L(a.outputAmount).div(10**a.toDecimal).mul(l).div(c.mul(u));t=t.add(h)}}}),t.toString()}calculateSwapPriceImpact(e){let t=L(0);return e.forEach(n=>{const i=n.basePaths.length;if(i===1){const s=n.basePaths[0],o=L(s.outputAmount).div(10**s.toDecimal),r=L(s.inputAmount).div(10**s.fromDecimal),a=o.div(r),c=s.direction?new ie(s.currentPrice):new ie(1).div(s.currentPrice);t=t.add(this.calculateSingleImpact(a,c))}if(i===2){const s=n.basePaths[0],o=n.basePaths[1],r=s.direction?new ie(s.currentPrice):new ie(1).div(s.currentPrice),a=o.direction?new ie(o.currentPrice):new ie(1).div(o.currentPrice),c=r.mul(a),u=new ie(o.outputAmount).div(10**o.toDecimal),l=new ie(s.inputAmount).div(10**s.fromDecimal),d=u.div(l);t=t.add(this.calculateSingleImpact(d,c))}}),t.toString()}async preSwapWithMultiPool(e){var u;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new ye,s=[e.coinTypeA,e.coinTypeB];for(let l=0;l<e.poolAddresses.length;l+=1){const d=[i.pure(e.poolAddresses[l]),i.pure(e.a2b),i.pure(e.byAmountIn),i.pure(e.amount)];i.moveCall({target:`${t.published_at}::${qi}::calculate_swap_result`,arguments:d,typeArguments:s})}if(!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const o=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(o.error!=null)throw new Me(`pre swap with multi pools error code: ${o.error??"unknown error"}, please check config and params`,"InvalidConfig");const r=(u=o.events)==null?void 0:u.filter(l=>he(l.type).name==="CalculatedSwapResultEvent");if(r.length===0)return null;if(r.length!==e.poolAddresses.length)throw new Me("valueData.length !== params.pools.length","ParamsLengthNotEqual");let a=e.byAmountIn?st:vr,c=0;for(let l=0;l<r.length;l+=1)if(!r[l].parsedJson.data.is_exceed)if(e.byAmountIn){const d=new y(r[l].parsedJson.data.amount_out);d.gt(a)&&(c=l,a=d)}else{const d=new y(r[l].parsedJson.data.amount_out);d.lt(a)&&(c=l,a=d)}return this.transformSwapWithMultiPoolData({poolAddress:e.poolAddresses[c],a2b:e.a2b,byAmountIn:e.byAmountIn,amount:e.amount,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB},r[c].parsedJson)}async preswap(e){var c;const{integrate:t,simulationAccount:n}=this.sdk.sdkOptions,i=new ye,s=[e.coinTypeA,e.coinTypeB],o=[i.pure(e.pool.poolAddress),i.pure(e.a2b),i.pure(e.byAmountIn),i.pure(e.amount)];if(i.moveCall({target:`${t.published_at}::${qi}::calculate_swap_result`,arguments:o,typeArguments:s}),!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const r=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address});if(r.error!=null)throw new Me(`preswap error code: ${r.error??"unknown error"}, please check config and params`,"InvalidConfig");const a=(c=r.events)==null?void 0:c.filter(u=>he(u.type).name==="CalculatedSwapResultEvent");return a.length===0?null:this.transformSwapData(e,a[0].parsedJson.data)}transformSwapData(e,t){const n=t.amount_in&&t.fee_amount?new y(t.amount_in).add(new y(t.fee_amount)).toString():"";return{poolAddress:e.pool.poolAddress,currentSqrtPrice:e.currentSqrtPrice,estimatedAmountIn:n,estimatedAmountOut:t.amount_out,estimatedEndSqrtPrice:t.after_sqrt_price,estimatedFeeAmount:t.fee_amount,isExceed:t.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn}}transformSwapWithMultiPoolData(e,t){const{data:n}=t;console.log("json data. ",n);const i=n.amount_in&&n.fee_amount?new y(n.amount_in).add(new y(n.fee_amount)).toString():"";return{poolAddress:e.poolAddress,estimatedAmountIn:i,estimatedAmountOut:n.amount_out,estimatedEndSqrtPrice:n.after_sqrt_price,estimatedStartSqrtPrice:n.step_results[0].current_sqrt_price,estimatedFeeAmount:n.fee_amount,isExceed:n.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn}}calculateRates(e){const{currentPool:t}=e,n=tE(t);let i;e.a2b?i=e.swapTicks.sort((d,h)=>h.index-d.index):i=e.swapTicks.sort((d,h)=>d.index-h.index);const s=bE(e.a2b,e.byAmountIn,e.amount,n,i);let o=!1;e.byAmountIn?o=s.amountIn.lt(e.amount):o=s.amountOut.lt(e.amount);const r=ns.getDefaultSqrtPriceLimit(e.a2b);e.a2b&&s.nextSqrtPrice.lt(r)&&(o=!0),!e.a2b&&s.nextSqrtPrice.gt(r)&&(o=!0);let a=0;s.crossTickNum>6&&s.crossTickNum<40&&(a=22e3*(s.crossTickNum-6)),s.crossTickNum>40&&(o=!0);const c=qe.sqrtPriceX64ToPrice(n.currentSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),u=qe.sqrtPriceX64ToPrice(s.nextSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),l=Math.abs(c-u)/c*100;return{estimatedAmountIn:s.amountIn,estimatedAmountOut:s.amountOut,estimatedEndSqrtPrice:s.nextSqrtPrice,estimatedFeeAmount:s.feeAmount,isExceed:o,extraComputeLimit:a,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn,priceImpactPct:l}}async createSwapTransactionPayload(e,t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:s}=jc(e);if(e.a2b&&i||!e.a2b&&s)return await Je.buildSwapTransactionForGas(this._sdk,e,n,t)}return Je.buildSwapTransaction(this.sdk,e,n)}async createSwapTransactionWithoutTransferCoinsPayload(e,t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(t){const{isAdjustCoinA:i,isAdjustCoinB:s}=jc(e);if(e.a2b&&i||!e.a2b&&s)return await Je.buildSwapTransactionWithoutTransferCoinsForGas(this._sdk,e,n,t)}return Je.buildSwapTransactionWithoutTransferCoins(this.sdk,e,n)}},WE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getAllRegisteredTokenList(e=!1){return await this.factchTokenList("",e)}async getOwnerTokenList(e="",t=!1){return await this.factchTokenList(e,t)}async getAllRegisteredPoolList(e=!1){return await this.factchPoolList("",e)}async getOwnerPoolList(e="",t=!1){return await this.factchPoolList(e,t)}async getWarpPoolList(e=!1){return await this.factchWarpPoolList("","",e)}async getOwnerWarpPoolList(e="",t="",n=!1){return await this.factchWarpPoolList(e,t,n)}async getTokenListByCoinTypes(e){const t={},n="getAllRegisteredTokenList",i=this.getCache(n);if(i!==void 0){const o=i;for(const r of e)for(const a of o)if(bn(r)===bn(a.address)){t[r]=a;continue}}const s=e.filter(o=>t[o]===void 0);for(const o of s){const r=`${o}_metadata`,a=this.getCache(r);if(a!==void 0)t[o]=a;else{const c=await this._sdk.fullClient.getCoinMetadata({coinType:o});if(c){const u={id:c.id,name:c.name,symbol:c.symbol,official_symbol:c.symbol,coingecko_id:"",decimals:c.decimals,project_url:"",logo_url:c.iconUrl,address:o};t[o]=u,this.updateCache(r,u,We)}}}return t}async factchTokenList(e="",t=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredTokenList",o=this.getCache(s,t);if(o!==void 0)return o;const r=e.length>0,a=512;let c=0,u=[];if(i===void 0)throw Error("please config token ofsdkOptions");const l=G(i);for(;;){const h=new ye;h.moveCall({target:`${i.published_at}::coin_list::${r?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:r?[h.pure(l.coin_registry_id),h.pure(e),h.pure(c),h.pure(a)]:[h.pure(l.coin_registry_id),h.pure(c),h.pure(a)]});const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(v=>{he(v.type).full_address===`${i.published_at}::coin_list::FetchCoinListEvent`&&v.parsedJson.full_list.value_list.forEach(E=>{b.push(this.transformData(E,!1))})}),u=[...u,...b],b.length<a)break;c=u.length}return u}async factchPoolList(e="",t=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredPoolList",o=this.getCache(s,t);if(o!==void 0)return o;let r=[];const a=512;let c=0;const u=e.length>0;if(i===void 0)throw Error("please config token ofsdkOptions");const l=G(i);for(;;){const h=new ye;if(h.moveCall({target:`${i.published_at}::lp_list::${u?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:u?[h.pure(l.pool_registry_id),h.pure(e),h.pure(c),h.pure(a)]:[h.pure(l.pool_registry_id),h.pure(c),h.pure(a)]}),!Mn(n.address))throw new Me("this config simulationAccount is not set right","InvalidSimulateAccount");const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(v=>{he(v.type).full_address===`${i.published_at}::lp_list::FetchPoolListEvent`&&v.parsedJson.full_list.value_list.forEach(E=>{b.push(this.transformData(E,!0))})}),r=[...r,...b],b.length<a)break;c=r.length}return r}async factchWarpPoolList(e="",t="",n=!1){const i=await this.factchPoolList(e,n);if(i.length===0)return[];const s=await this.factchTokenList(t,n),o=[];for(const r of i){for(const a of s)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}async getTokenConfigEvent(e=!1){const t=this._sdk.sdkOptions.token.package_id,n=`${t}_getTokenConfigEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),o=qa(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o}),a={coin_registry_id:"",pool_registry_id:"",coin_list_owner:"",pool_list_owner:""};return r.data.length>0&&r.data.forEach(c=>{const u=he(c.type);if(c.transactionModule==="coin_list")switch(u.name){case"InitListEvent":a.coin_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent":a.coin_registry_id=c.parsedJson.registry_id;break}else if(c.transactionModule==="lp_list")switch(u.name){case"InitListEvent<address>":a.pool_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent<address>":a.pool_registry_id=c.parsedJson.registry_id;break}}),a.coin_registry_id.length>0&&this.updateCache(n,a,We),a}transformData(e,t){const n={...e};if(t)try{n.coin_a_address=he(n.coin_a_address).full_address,n.coin_b_address=he(n.coin_b_address).full_address}catch{}else n.address=he(n.address).full_address;if(e.extensions){const i=e.extensions.contents;for(const s of i){const{key:o}=s;let{value:r}=s;if(o==="labels")try{r=JSON.parse(decodeURIComponent(er.decode(r)))}catch{}o==="pyth_id"&&(r=vn(r)),n[o]=r}delete n.extensions}return n}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},VE=class{constructor(e){ze(this,"_sdk");this._sdk=e}get sdk(){return this._sdk}calculatePrice(e,t,n,i,s){const o=i?t:n,r=i?n:t;return s==="Cetus"?qe.sqrtPriceX64ToPrice(e,o,r):new ie(e.toString()).div(new ie(10).pow(new ie(r+9-o)))}parseJsonResult(e){return{isExceed:e.is_exceed,isTimeout:e.is_timeout,inputAmount:e.input_amount,outputAmount:e.output_amount,fromCoin:e.from_coin,toCoin:e.to_coin,byAmountIn:e.by_amount_in,splitPaths:e.split_paths.map(n=>({pathIndex:n.path_index,lastQuoteOutput:n.last_quote_output,percent:n.percent,basePaths:n.best_path.map(s=>({direction:s.direction,label:s.label,poolAddress:s.provider,fromCoin:s.from_coin,toCoin:s.to_coin,outputAmount:s.output_amount,inputAmount:s.input_amount,feeRate:s.fee_rate,currentSqrtPrice:new y(s.current_sqrt_price.toString()),afterSqrtPrice:s.label==="Cetus"?new y(s.after_sqrt_price.toString()):st,fromDecimal:s.from_decimal,toDecimal:s.to_decimal,currentPrice:this.calculatePrice(new y(s.current_sqrt_price.toString()),s.from_decimal,s.to_decimal,s.direction,s.label)})),inputAmount:n.input_amount,outputAmount:n.output_amount}))}}async fetchDataWithAxios(e,t,n){try{const i={...t,timeout:n},s=await JP(e,i);return s.status===200?this.parseJsonResult(s.data):null}catch(i){return console.error(i),null}}async getBestRouter(e,t,n,i,s,o,r,a,c=!1,u=!1,l=[]){let d=null,h="v2",g=this.sdk.sdkOptions.aggregatorUrl;if(l.length>0){const b=new URL(g);g=`${b.protocol}//${b.hostname}/router_with_lp_changes`,JSON.stringify({from:e,to:t,amount:n,by_amount_in:i,order_split:c,external_router:u,sender_address:"None",request_id:encodeURIComponent(Gl()),lp_changes:l})}else g=`
      ${g}?from=${encodeURIComponent(e)}&to=${encodeURIComponent(t)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(i)}&order_split=${encodeURIComponent(c)}&external_router=${encodeURIComponent(u)}&sender_address=''&request_id=${encodeURIComponent(Gl())}
      `;if(d=await this.fetchDataWithAxios(g,{method:"get"},6e3),d==null){const b=await this.sdk.Router.priceUseV1(e,t,new y(n),i,s,o,a),v=[];for(const E of b.paths){const N=[];if(E.poolAddress.length>1){const P=this.sdk.Router.tokenInfo(E.coinType[0]).decimals,B=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,W=E.a2b[0]?qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[0]),P,B):qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[0]),B,P),Q={direction:E.a2b[0],label:"Cetus",poolAddress:E.poolAddress[0],fromCoin:E.coinType[0],toCoin:E.coinType[1],feeRate:this.sdk.Router.getFeeRate(E.coinType[0],E.coinType[1],E.poolAddress[0]),outputAmount:b.byAmountIn?E.rawAmountLimit[0].toString():E.rawAmountLimit[1].toString(),inputAmount:E.amountIn.toString(),currentSqrtPrice:b.currentSqrtPrice[0],currentPrice:W,fromDecimal:P,toDecimal:B},V=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,ee=this.sdk.Router.tokenInfo(E.coinType[2]).decimals,j=E.a2b[1]?qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[1]),V,ee):qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[1]),ee,V),R={direction:E.a2b[1],label:"Cetus",poolAddress:E.poolAddress[1],fromCoin:E.coinType[1],toCoin:E.coinType[2],feeRate:this.sdk.Router.getFeeRate(E.coinType[1],E.coinType[2],E.poolAddress[1]),outputAmount:E.amountOut.toString(),inputAmount:b.byAmountIn?E.rawAmountLimit[0].toString():E.rawAmountLimit[1].toString(),currentSqrtPrice:b.currentSqrtPrice[1],currentPrice:j,fromDecimal:V,toDecimal:ee};N.push(Q,R)}else{const P=this.sdk.Router.tokenInfo(E.coinType[0]).decimals,B=this.sdk.Router.tokenInfo(E.coinType[1]).decimals,W=E.a2b[0]?qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[0]),P,B):qe.sqrtPriceX64ToPrice(new y(b.currentSqrtPrice[0]),B,P),Q={direction:E.a2b[0],label:"Cetus",poolAddress:E.poolAddress[0],fromCoin:E.coinType[0],toCoin:E.coinType[1],feeRate:this.sdk.Router.getFeeRate(E.coinType[0],E.coinType[1],E.poolAddress[0]),outputAmount:E.amountOut.toString(),inputAmount:E.amountIn.toString(),currentSqrtPrice:b.currentSqrtPrice[0],currentPrice:W,fromDecimal:P,toDecimal:B};N.push(Q)}const A={percent:Number(E.amountIn)/Number(b.amountIn)*100,inputAmount:Number(E.amountIn.toString()),outputAmount:Number(E.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:N};v.push(A)}const k={isExceed:b.isExceed,isTimeout:!0,inputAmount:Number(b.amountIn.toString()),outputAmount:Number(b.amountOut.toString()),fromCoin:b.coinTypeA,toCoin:b.coinTypeC!=null?b.coinTypeC:b.coinTypeB,byAmountIn:b.byAmountIn,splitPaths:v};h="v1",d=k}return{result:d,version:h}}async getBestRouterByServer(e,t,n,i,s,o=!1,r=!1,a=[]){let c=null,u=this.sdk.sdkOptions.aggregatorUrl;if(a.length>0){const l=new URL(u);u=`${l.protocol}//${l.hostname}/router_with_lp_changes`}else u=`
      ${u}?from=${encodeURIComponent(e)}&to=${encodeURIComponent(t)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(i)}&order_split=${encodeURIComponent(o)}&external_router=${encodeURIComponent(r)}&sender_address=''&request_id=${encodeURIComponent(Gl())}
      `;if(c=await this.fetchDataWithAxios(u,{method:"get"},6e3),c==null)throw new Me("Invalid server response","InvalidServerResponse");return c}async getBestRouterByRpc(e,t,n,i,s,o,r){const a=await this.sdk.Router.priceUseV1(e,t,new y(n),i,s,o,r),c=[];for(const l of a.paths){const d=[];if(l.poolAddress.length>1){const g=this.sdk.Router.tokenInfo(l.coinType[0]).decimals,b=this.sdk.Router.tokenInfo(l.coinType[1]).decimals,v=l.a2b[0]?qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[0]),g,b):qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[0]),b,g),k={direction:l.a2b[0],label:"Cetus",poolAddress:l.poolAddress[0],fromCoin:l.coinType[0],toCoin:l.coinType[1],feeRate:this.sdk.Router.getFeeRate(l.coinType[0],l.coinType[1],l.poolAddress[0]),outputAmount:a.byAmountIn?l.rawAmountLimit[0].toString():l.rawAmountLimit[1].toString(),inputAmount:l.amountIn.toString(),currentSqrtPrice:a.currentSqrtPrice[0],currentPrice:v,fromDecimal:g,toDecimal:b},E=this.sdk.Router.tokenInfo(l.coinType[1]).decimals,N=this.sdk.Router.tokenInfo(l.coinType[2]).decimals,A=l.a2b[1]?qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[1]),E,N):qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[1]),N,E),P={direction:l.a2b[1],label:"Cetus",poolAddress:l.poolAddress[1],fromCoin:l.coinType[1],toCoin:l.coinType[2],feeRate:this.sdk.Router.getFeeRate(l.coinType[1],l.coinType[2],l.poolAddress[1]),outputAmount:l.amountOut.toString(),inputAmount:a.byAmountIn?l.rawAmountLimit[0].toString():l.rawAmountLimit[1].toString(),currentSqrtPrice:a.currentSqrtPrice[1],currentPrice:A,fromDecimal:E,toDecimal:N};d.push(k,P)}else{const g=this.sdk.Router.tokenInfo(l.coinType[0]).decimals,b=this.sdk.Router.tokenInfo(l.coinType[1]).decimals,v=l.a2b[0]?qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[0]),g,b):qe.sqrtPriceX64ToPrice(new y(a.currentSqrtPrice[0]),b,g),k={direction:l.a2b[0],label:"Cetus",poolAddress:l.poolAddress[0],fromCoin:l.coinType[0],toCoin:l.coinType[1],feeRate:this.sdk.Router.getFeeRate(l.coinType[0],l.coinType[1],l.poolAddress[0]),outputAmount:l.amountOut.toString(),inputAmount:l.amountIn.toString(),currentSqrtPrice:a.currentSqrtPrice[0],currentPrice:v,fromDecimal:g,toDecimal:b};d.push(k)}const h={percent:Number(l.amountIn)/Number(a.amountIn)*100,inputAmount:Number(l.amountIn.toString()),outputAmount:Number(l.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:d};c.push(h)}return{isExceed:a.isExceed,isTimeout:!0,inputAmount:Number(a.amountIn.toString()),outputAmount:Number(a.amountOut.toString()),fromCoin:a.coinTypeA,toCoin:a.coinTypeC!=null?a.coinTypeC:a.coinTypeB,byAmountIn:a.byAmountIn,splitPaths:c}}},XE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}setTokenListCache(e){const{coin_list_handle:t}=G(this.sdk.sdkOptions.cetus_config),n=`${t}_getCoinConfigs`,i=this.getCache(n),s=i?[...i,...e]:e;this.updateCache(n,s,We)}async getTokenListByCoinTypes(e){const t={},{coin_list_handle:n}=G(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i);if(s!==void 0){const r=s;for(const a of e)for(const c of r)if(bn(a)===bn(c.address)){t[a]=c;continue}}const o=e.filter(r=>t[r]===void 0);for(const r of o){const a=`${r}_metadata`,c=this.getCache(a);if(c!==void 0)t[r]=c;else{const u=await this._sdk.fullClient.getCoinMetadata({coinType:r});if(u){const l={id:u.id,pyth_id:"",name:u.name,symbol:u.symbol,official_symbol:u.symbol,coingecko_id:"",decimals:u.decimals,project_url:"",logo_url:u.iconUrl,address:r};t[r]=l,this.updateCache(a,l,We)}else console.log(`not found ${r}`)}}return t}async getCoinConfigs(e=!1,t=!0){const{coin_list_handle:n}=G(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i,e);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Me(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildCoinConfig(u,t);this.updateCache(`${n}_${l.address}_getCoinConfig`,l,We),c.push({...l})}),this.updateCache(i,c,We),c}async getCoinConfig(e,t=!1,n=!0){var c,u;const{coin_list_handle:i}=G(this.sdk.sdkOptions.cetus_config),s=`${i}_${e}_getCoinConfig`,o=this.getCache(s,t);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"0x1::type_name::TypeName",value:{name:kE(e)}}});if(r.error!=null||((u=(c=r.data)==null?void 0:c.content)==null?void 0:u.dataType)!=="moveObject")throw new Me(`when getCoinConfig get object error: ${r.error}, please check the rpc and contracts address config.`,"InvalidConfig");const a=this.buildCoinConfig(r,n);return this.updateCache(s,a,We),a}buildCoinConfig(e,t=!0){let n=ft(e);n=n.value.fields;const i={...n};return i.id=Hi(e),i.address=he(n.coin_type.fields.name).full_address,n.pyth_id&&(i.pyth_id=vn(n.pyth_id)),this.transformExtensions(i,n.extension_fields.fields.contents,t),delete i.coin_type,i}async getClmmPoolConfigs(e=!1,t=!0){const{clmm_pools_handle:n}=G(this.sdk.sdkOptions.cetus_config),i=`${n}_getClmmPoolConfigs`,s=this.getCache(i,e);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Me(`when getClmmPoolsConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildClmmPoolConfig(u,t);this.updateCache(`${l.pool_address}_getClmmPoolConfig`,l,We),c.push({...l})}),this.updateCache(i,c,We),c}async getClmmPoolConfig(e,t=!1,n=!0){const{clmm_pools_handle:i}=G(this.sdk.sdkOptions.cetus_config),s=`${e}_getClmmPoolConfig`,o=this.getCache(s,t);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:e}}),a=this.buildClmmPoolConfig(r,n);return this.updateCache(s,a,We),a}buildClmmPoolConfig(e,t=!0){let n=ft(e);n=n.value.fields;const i={...n};return i.id=Hi(e),i.pool_address=vn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,t),i}async getLaunchpadPoolConfigs(e=!1,t=!0){const{launchpad_pools_handle:n}=G(this.sdk.sdkOptions.cetus_config),i=`${n}_getLaunchpadPoolConfigs`,s=this.getCache(i,e);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{var d,h;if(u.error!=null||((h=(d=u.data)==null?void 0:d.content)==null?void 0:h.dataType)!=="moveObject")throw new Me(`when getCoinConfigs get objects error: ${u.error}, please check the rpc and contracts address config.`,"InvalidConfig");const l=this.buildLaunchpadPoolConfig(u,t);this.updateCache(`${l.pool_address}_getLaunchpadPoolConfig`,l,We),c.push({...l})}),this.updateCache(i,c,We),c}async getLaunchpadPoolConfig(e,t=!1,n=!0){const{launchpad_pools_handle:i}=G(this.sdk.sdkOptions.cetus_config),s=`${e}_getLaunchpadPoolConfig`,o=this.getCache(s,t);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:e}}),a=this.buildLaunchpadPoolConfig(r,n);return this.updateCache(s,a,We),a}buildLaunchpadPoolConfig(e,t=!0){let n=ft(e);n=n.value.fields;const i={...n};i.id=Hi(e),i.pool_address=vn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,t);const s=[];n.social_media.fields.contents.forEach(o=>{s.push({name:o.fields.value.fields.name,link:o.fields.value.fields.link})}),i.social_media=s;try{i.regulation=decodeURIComponent(er.decode(i.regulation).replace(/%/g,"%25"))}catch{i.regulation=er.decode(i.regulation)}return i}transformExtensions(e,t,n=!0){const i=[];for(const s of t){const{key:o}=s.fields;let{value:r}=s.fields;if(o==="labels")try{r=JSON.parse(decodeURIComponent(er.decode(r)))}catch{}n&&(e[o]=r),i.push({key:o,value:r})}delete e.extension_fields,n||(e.extensions=i)}async getCetusConfig(e=!1){const t=this._sdk.sdkOptions.cetus_config.package_id,n=`${t}_getCetusConfig`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),o=qa(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o});let a={coin_list_id:"",launchpad_pools_id:"",clmm_pools_id:"",admin_cap_id:"",global_config_id:"",coin_list_handle:"",launchpad_pools_handle:"",clmm_pools_handle:""};if(r.data.length>0)for(const c of r.data)switch(he(c.type).name){case"InitCoinListEvent":a.coin_list_id=c.parsedJson.coin_list_id;break;case"InitLaunchpadPoolsEvent":a.launchpad_pools_id=c.parsedJson.launchpad_pools_id;break;case"InitClmmPoolsEvent":a.clmm_pools_id=c.parsedJson.pools_id;break;case"InitConfigEvent":a.global_config_id=c.parsedJson.global_config_id,a.admin_cap_id=c.parsedJson.admin_cap_id;break}return a=await this.getCetusConfigHandle(a),a.clmm_pools_id.length>0&&this.updateCache(n,a,We),a}async getCetusConfigHandle(e){const t=[e.clmm_pools_id,e.coin_list_id,e.launchpad_pools_id];return(await this._sdk.fullClient.multiGetObjects({ids:t,options:{showContent:!0}})).forEach(i=>{var r,a;if(i.error!=null||((a=(r=i.data)==null?void 0:r.content)==null?void 0:a.dataType)!=="moveObject")throw new Me(`when getCetusConfigHandle get objects error: ${i.error}, please check the rpc and contracts address config.`,"InvalidConfigHandle");const s=ft(i),o=co(i);switch(he(o).name){case"ClmmPools":e.clmm_pools_handle=s.pools.fields.id.id;break;case"CoinList":e.coin_list_handle=s.coins.fields.id.id;break;case"LaunchpadPools":e.launchpad_pools_handle=s.pools.fields.id.id;break}}),e}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){try{const n=this._cache[e];if(!n)return;if(t||!n.isValid()){delete this._cache[e];return}return n.value}catch(n){console.error(`Error accessing cache for key ${e}:`,n);return}}},JE=class extends Aw{async queryEventsByPage(e,t="all"){let n=[],i=!0;const s=t==="all";let o=s?null:t.cursor;do{const r=await this.queryEvents({query:e,cursor:o,limit:s?null:t.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async getOwnedObjectsByPage(e,t,n="all"){let i=[],s=!0;const o=n==="all";let r=o?null:n.cursor;do{const a=await this.getOwnedObjects({owner:e,...t,cursor:r,limit:o?null:n.limit});a.data?(i=[...i,...a.data],s=a.hasNextPage,r=a.nextCursor):s=!1}while(o&&s);return{data:i,nextCursor:r,hasNextPage:s}}async getDynamicFieldsByPage(e,t="all"){let n=[],i=!0;const s=t==="all";let o=s?null:t.cursor;do{const r=await this.getDynamicFields({parentId:e,cursor:o,limit:s?null:t.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async batchGetObjects(e,t,n=50){let i=[];try{for(let s=0;s<Math.ceil(e.length/n);s++){const o=await this.multiGetObjects({ids:e.slice(s*n,n*(s+1)),options:t});i=[...i,...o]}}catch(s){console.log(s)}return i}async calculationTxGas(e){const{sender:t}=e.blockData;if(t===void 0)throw Error("sdk sender is empty");const n=await this.devInspectTransactionBlock({transactionBlock:e,sender:t}),{gasUsed:i}=n.effects;return Number(i.computationCost)+Number(i.storageCost)-Number(i.storageRebate)}async sendTransaction(e,t){try{return await this.signAndExecuteTransactionBlock({transactionBlock:t,signer:e,options:{showEffects:!0,showEvents:!0}})}catch(n){console.log("error: ",n)}}async sendSimulationTransaction(e,t,n=!0){try{if(n)return await this.devInspectTransactionBlock({transactionBlock:e,sender:t});const s={ProgrammableTransaction:{inputs:e.blockData.inputs.map(c=>{const{type:u,value:l}=c;return u==="object"?kw.SharedObjectRef({objectId:l,initialSharedVersion:0,mutable:!0}):l}),transactions:e.blockData.transactions}},o=ta.TransactionKind.serialize(s,{maxSize:131072}).toBytes(),r=Sw(o);return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[t,r,null,null]})}catch(i){console.log("devInspectTransactionBlock error",i)}}},Fi=class{constructor(e){ze(this,"_cache",{});ze(this,"_rpcModule");ze(this,"_pool");ze(this,"_position");ze(this,"_swap");ze(this,"_rewarder");ze(this,"_router");ze(this,"_router_v2");ze(this,"_token");ze(this,"_config");ze(this,"_sdkOptions");ze(this,"_senderAddress","");this._sdkOptions=e,this._rpcModule=new JE({url:e.fullRpcUrl}),this._swap=new GE(this),this._pool=new jE(this),this._position=new zE(this),this._rewarder=new HE(this),this._router=new KE(this),this._router_v2=new VE(this),this._token=new WE(this),this._config=new XE(this),ef(this._sdkOptions)}get senderAddress(){return this._senderAddress}set senderAddress(e){this._senderAddress=e}get Swap(){return this._swap}get fullClient(){return this._rpcModule}get sdkOptions(){return this._sdkOptions}get Pool(){return this._pool}get Position(){return this._position}get Rewarder(){return this._rewarder}get Router(){return this._router}get RouterV2(){return this._router_v2}get CetusConfig(){return this._config}get Token(){return this._token}async getOwnerCoinAssets(e,t,n=!0){const i=[];let s=null;const o=`${this.sdkOptions.fullRpcUrl}_${e}_${t}_getOwnerCoinAssets`,r=this.getCache(o,n);if(r)return r;for(;;){const a=await(t?this.fullClient.getCoins({owner:e,coinType:t,cursor:s}):this.fullClient.getAllCoins({owner:e,cursor:s}));if(a.data.forEach(c=>{BigInt(c.balance)>0&&i.push({coinAddress:he(c.coinType).source_address,coinObjectId:c.coinObjectId,balance:BigInt(c.balance)})}),s=a.nextCursor,!a.hasNextPage)break}return this.updateCache(o,i,30*1e3),i}async getOwnerCoinBalances(e,t){let n=[];return t?n=[await this.fullClient.getBalance({owner:e,coinType:t})]:n=[...await this.fullClient.getAllBalances({owner:e})],n}updateCache(e,t,n=We){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},ZE=Fi,nd="router",Go=1e4,Bs=class{static buildPoolImmutables(e){const{fields:t}=e.value.fields.value;return{clmm_pool_id:he(t.clmm_pool_id).address,booster_type:he(t.booster_type.fields.name).source_address,pool_id:he(t.pool_id).address,coinTypeA:he(t.coin_type_a.fields.name).source_address,coinTypeB:he(t.coin_type_b.fields.name).source_address}}static buildPoolState(e){const t=ft(e),n=[];return t.config.fields.contents.forEach(s=>{n.push({lock_day:Number(s.fields.key),multiplier:Number(L(s.fields.value).div(Go))})}),{basic_percent:Number(L(t.basic_percent).div(Go)),balances:{balances_handle:t.balances.fields.id.id,size:t.balances.fields.size},config:n,lock_positions:{lock_positions_handle:t.lock_positions.fields.id.id,size:t.lock_positions.fields.size},is_open:t.is_open,index:Number(t.index),pool_id:Hi(e)}}static buildLockNFT(e){const t=he(Hi(e)).address;return{lock_clmm_position:io(e),locked_nft_id:t}}static buildLockPositionInfo(e){const t=ft(e),{value:n}=t.value.fields;return{type:n.type,position_id:n.fields.position_id,start_time:Number(n.fields.start_time),lock_period:Number(n.fields.lock_period),end_time:Number(n.fields.end_time),growth_rewarder:n.fields.growth_rewarder,rewarder_owned:n.fields.rewarder_owned,is_settled:n.fields.is_settled}}static isLocked(e){return e.end_time>Date.parse(new Date().toString())/1e3}},YE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var o;const{booster:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n,e),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(G(t).booster_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=ft(u);if(l){const d=Bs.buildPoolImmutables(l);this.updateCache(`${d.pool_id}_getPoolImmutable`,d,We),s.push(d)}}}return this.updateCache(n,s,We),s}async getPoolImmutable(e){const{booster:t}=this._sdk.sdkOptions,n=`${e}_getPoolImmutable`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:G(t).booster_pool_handle,name:{type:"0x2::object::ID",value:e}}),o=ft(s),r=Bs.buildPoolImmutables(o);return this.updateCache(n,r,We),r}async getPools(){const e=[],n=(await this.getPoolImmutables()).map(s=>s.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});for(const s of i){const o=Bs.buildPoolState(s);if(o){const r={...await this.getPoolImmutable(o.pool_id),...o};e.push(r);const a=`${r.pool_id}_getPoolObject`;this.updateCache(a,r,We)}}return e}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t),s=await this.getPoolImmutable(e);if(i!==void 0)return{...s,...i};const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),r=Bs.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,We),a}async getPoolHandleId(e){const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),n=ft(t);return n?n.list.fields.id.id:""}async getBoosterInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.booster,t=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,n={booster_config_id:"",booster_pool_handle:""};return t.length>0&&t.forEach(s=>{const o=s.parsedJson;o&&(n.booster_config_id=o.config_id)}),n.booster_pool_handle=await this.getPoolHandleId(n.booster_config_id),n}async getOwnerBoosterPositions(e,t,n){const{booster:i}=this.sdk.sdkOptions,s=[],o=[],r=`${i.package_id}::lock_nft::LockNFT<${this._sdk.ClmmSDK.Position.buildPositionType()}>`,a=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{StructType:r}});for(const u of a.data)if(he(Wi(u)).source_address===r&&u.data){const d=Bs.buildLockNFT(u);this.updateCache(`${d.locked_nft_id}_getBoosterPositionById`,d,We),d&&(t===void 0||t===d.lock_clmm_position.pool)&&s.push(d)}const c=await this.getLockPositionInfos(n,s.map(u=>u.locked_nft_id));for(const u of s)for(const l of c)if(u.lock_clmm_position.pos_object_id===l.position_id){o.push({...u,...l});break}return o}async getBoosterPosition(e,t){const n=`${t}_getBoosterPositionById`,i=this.getCache(n);let s;if(i!==void 0)s=i;else{const r=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showOwner:!0}});s=Bs.buildLockNFT(r),this.updateCache(n,s,We)}const o=await this.getLockPositionInfo(e,t);return{...s,...o}}async getLockPositionInfos(e,t=[]){var o;const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(e),i=[],s=[];return(o=n.data)==null||o.forEach(r=>{t.length>0?t.includes(r.name.value)&&i.push(r.objectId):i.push(r.objectId)}),i.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showContent:!0})).forEach(a=>{const c=Bs.buildLockPositionInfo(a);c&&s.push(c)}),s}async getLockPositionInfo(e,t){const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}});return Bs.buildLockPositionInfo(n)}calculateXCetusRewarder(e,t,n){let i=t.basic_percent,s="0";e.forEach(a=>{a.coin_address===t.booster_type&&(console.log("find ",t.booster_type),s=a.amount_owed.toString())}),n.is_settled||t.config.forEach(a=>{a.lock_day===n.lock_period&&(i=a.multiplier)});const o=L(s).sub(n.growth_rewarder).mul(i);return L(n.rewarder_owned).add(o).toString()}lockPositionPayload(e){const{booster:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new ye;return i.moveCall({target:`${t.published_at}::${nd}::lock_position`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[i.pure(G(t).booster_config_id),i.pure(G(n).global_config_id),i.pure(e.booster_pool_id),i.pure(e.clmm_pool_id),i.pure(e.clmm_position_id),i.pure(e.lock_day),i.pure(Ce)]}),i}canceLockPositionPayload(e){const{booster:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${nd}::cancel_lock`,typeArguments:[e.booster_type],arguments:[n.pure(G(t).booster_config_id),n.pure(e.booster_pool_id),n.pure(e.lock_nft_id),n.pure(Ce)]}),n}redeemPayload(e){const{booster:t,xcetus:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new ye,o=G(n);return s.moveCall({target:`${t.published_at}::${nd}::redeem`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[s.pure(G(t).booster_config_id),s.pure(G(i).global_config_id),s.pure(e.booster_pool_id),s.pure(e.lock_nft_id),s.pure(e.clmm_pool_id),s.pure(o.lock_manager_id),s.pure(o.xcetus_manager_id),s.pure(e.ve_nft_id),s.pure(Ce)]}),s}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},ui="router",gw=1e9,ii=class{static priceRealToFix(e,t,n){const i=L(t-n).toNumber();return Number(L(e).div(L(10).pow(L(i))).toString())}static priceFixToReal(e,t,n){const i=L(t-n).toNumber();return Number(L(e).mul(L(10).pow(L(i))).toString())}static raiseTotalAmount(e,t,n){const i=L(t-n).abs().toNumber();return t>n?Number(L(e.total_supply).mul(e.current_price).div(L(10).pow(L(i))).toString()):Number(L(e.total_supply).mul(e.current_price).mul(L(10).pow(L(i))).toString())}static buildLaunchPadPool(e){const t=Wi(e),n=he(t),i=ft(e),s={coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],pool_address:vn(Hi(e)),is_settle:i.is_settle,current_price:L(i.initialize_price).div(L(gw)).toString(),price:i.initialize_price,min_price:"0",max_price:"0",sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,total_purchase_amount:i.reality_raise_total,total_supply:i.sale_total,min_purchase:i.min_purchase,max_purchase:i.max_purchase,complete_raise_limit:i.least_raise_amount,softcap:i.softcap,max_raise_amount:i.hardcap,sale_decimals:0,raise_decimals:0,liquidity_injection_ratio:Number(i.liquidity_rate)/1e4,is_cancel:i.is_cancel,duration_summary:{start_time:Number(i.duration_manager.fields.start_time),end_time:0,settle_end_time:0,purchase_duration:Number(i.duration_manager.fields.activity_duration),settle_duration:Number(i.duration_manager.fields.settle_duration),lock_up_duration:Number(i.duration_manager.fields.locked_duration)},white_summary:{white_handle:i.white_list.fields.users.fields.id.id,protection_hard_cap:i.white_list.fields.hard_cap_total,protection_limit_used:i.white_list.fields.purchase_total,size:Number(i.white_list.fields.users.fields.size)},unused_sale:i.unused_sale,harvest_raise:i.harvest_raise,tick_spacing:Number(i.tick_spacing),owner:i.recipient,purchase_summary:{purchase_handle:i.purchase_list.fields.id.id,size:Number(i.purchase_list.fields.size)},pool_status:"Failed"};return ii.updatePoolStatus(s),s}static updatePoolStatus(e){const t=Number(L(Date.now()/1e3).toFixed(0)),{duration_summary:n}=e,i=n.start_time+n.purchase_duration,s=i+n.settle_duration;if(n.end_time=i,n.settle_end_time=s,e.is_settle)e.pool_status="Ended";else if(e.is_cancel)e.pool_status="Canceled";else if(t<n.start_time)e.pool_status="Upcoming";else if(t>n.start_time&&t<i)e.pool_status="Live";else if(t>i&&t<s){const o=e.raise_coin_amount;Number(o)<Number(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Settle"}return e}static async calculatePoolPrice(e,t){const n=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([t.coin_type_sale,t.coin_type_raise]),i=n[t.coin_type_sale].decimals,s=n[t.coin_type_raise].decimals;t.min_price=this.priceFixToReal(Number(L(t.softcap).div(L(t.total_supply))),i,s).toString(),t.max_price=this.priceFixToReal(Number(L(t.max_raise_amount).div(L(t.total_supply))),i,s).toString(),t.current_price=this.priceFixToReal(Number(t.current_price),i,s).toString(),t.sale_decimals=i,t.raise_decimals=s}static async getWithdrawRaise(e){return e.pool_status==="Ended"?e.harvest_raise:"0"}static async getWithdrawSale(e){return e.pool_status==="Ended"?e.unused_sale:e.sale_coin_amount}static async getHistoryWithdrawRaise(e,t){if(t.pool_status==="Ended"){if(L(t.harvest_raise).equals(L(0))){const i=await e.Launchpad.getSettleEvent(t.pool_address);i&&(t.harvest_raise=i.unused_raise)}const n=y.min(new y(t.total_purchase_amount),new y(t.max_raise_amount));return L(n.toString()).mul(1-t.liquidity_injection_ratio).toString()}return"0"}static async getHistoryWithdrawSale(e,t){if(t.pool_status==="Ended"){const n=await e.Launchpad.getSettleEvent(t.pool_address);return n&&(t.unused_sale=n.unused_sale),t.unused_sale}return"0"}static async getOverrecruitReverseAmount(e,t){const n=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[t.pool_address],!1);if(n.length>0){const i=n[0].purchased_raise_amount,s=(await e.Launchpad.getPurchaseAmount(t.white_summary.white_handle,e.ClmmSDK.senderAddress)).safe_purchased_amount,{protection_limit_used:o}=t.white_summary;return L(i).sub(s).div(L(t.total_purchase_amount).sub(o)).mul(L(t.total_purchase_amount).sub(t.max_raise_amount)).toString()}return"0"}static async getCanPurchaseAmount(e,t){const n=await ii.getOverrecruitReverseAmount(e,t),i=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[t.pool_address],!1);if(i){const s=i[0].purchased_raise_amount;L(s).sub(n).div(t.current_price)}return"0"}},QE=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=[],t=0,n=100,i=!1){var l;const{package_id:s}=this._sdk.sdkOptions.launchpad;if(s===void 0)throw Error("sdk.sdkOptions.launchpad is undefined");const o=`${s}_getPoolImmutables`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{((l=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`}))==null?void 0:l.data).forEach(h=>{const g=h.parsedJson;g&&a.push({pool_address:g.pool_id,coin_type_sale:he(g.sale_coin.name).full_address,coin_type_raise:he(g.raise_coin.name).full_address})}),this.updateCache(o,a,We)}catch(d){console.log("getPoolImmutables",d)}const u=e.length>0;for(let d=0;d<a.length;d+=1){const h=a[d];if(!(u&&!e.includes(h.pool_address))){if(!u){const g=d;if(g<t||g>=t+n)continue}c.push(h)}}return c}async getPoolImmutablesWithPage(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.launchpad,i=`${n}_getPoolImmutables`,s=[],o={data:[],hasNextPage:!1},r=e==="all";if(r){const a=this.getCache(i,t);a&&s.push(...a)}if(s.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::factory::CreatePoolEvent`},e);o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,a.data.forEach(c=>{const u=c.parsedJson;u&&s.push({pool_address:u.pool_id,coin_type_sale:he(u.sale_coin.name).full_address,coin_type_raise:he(u.raise_coin.name).full_address})})}catch(a){console.log("getPoolImmutables",a)}return o.data=s,r&&this.updateCache(i,s,We),o}async getPools(e=[],t=0,n=100){const i=[];let s=[];e.length>0?s=[...e]:(await this.getPoolImmutables([],t,n,!1)).forEach(a=>{s.push(a.pool_address)});const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=ii.buildLaunchPadPool(r);await ii.calculatePoolPrice(this._sdk,a),i.push(a);const c=`${a.pool_address}_getPoolObject`;this.updateCache(c,a,We)}return i}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0){const r=i;return ii.updatePoolStatus(r),r}const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=ii.buildLaunchPadPool(s);return await ii.calculatePoolPrice(this._sdk,o),this.updateCache(n,o),o}async getInitConfig(e=!1){var c;const t=this._sdk.sdkOptions.launchpad.package_id,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),o=qa(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",config_cap_id:""};return r.length>0&&(r.forEach(u=>{const l=u.parsedJson;if(l)switch(he(u.type).full_address){case`${t}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.config_cap_id=l.config_cap_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,We)),a}async getLockNFT(e,t=!1){const n=`${e}_getLockNFT`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return io(s)}async getLockNFTList(e){var s;const{package_id:t}=this._sdk.ClmmSDK.sdkOptions.clmm_pool,{sdkOptions:n}=this._sdk,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n.launchpad.package_id}::lock::LockNFTEvent`}))==null?void 0:s.data;for(const r of o){const a=r.parsedJson;if(a){const c={locked_time:Number(a.locked_time),end_lock_time:Number(a.end_lock_time),nft_type:a.nft_type_name.name,lock_nft_id:a.lock_nft_id,recipient:a.recipient};if(e===c.recipient&&`${t}`===he(c.nft_type).address){const u=await this.getLockNFT(c.lock_nft_id);if(u){const l=he(u.coin_type_a).full_address,d=he(u.coin_type_b).full_address;i.push({...u,coin_type_a:l,coin_type_b:d,...c})}}}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPoolTransactionPayload(e){const{launchpad:t}=this.sdk.sdkOptions,n=G(t);if(this.assertLuanchpadConfig(),this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=ii.priceRealToFix(Number(e.initialize_price),e.sale_decimals,e.raise_decimals),s=new ye,o=L(e.total_supply).add(L(e.total_supply).mul(L(e.liquidity_rate))).toNumber(),r=await Je.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,s,BigInt(o),e.coin_type_sale),a=[s.pure(n.admin_cap_id),s.pure(n.config_cap_id),s.pure(n.pools_id),s.pure(ni(e.recipient)),s.pure((i*gw).toString()),r,s.pure(e.total_supply.toString()),s.pure(e.min_purchase.toString()),s.pure(e.max_purchase.toString()),s.pure(e.least_raise_amount.toString()),s.pure(e.hardcap.toString()),s.pure((e.liquidity_rate*1e3).toString()),s.pure(e.start_time.toString()),s.pure(e.activity_duration.toString()),s.pure(e.settle_duration.toString()),s.pure(e.locked_duration.toString()),s.pure(e.tick_spacing.toString()),s.pure(Ce)],c=[e.coin_type_sale,e.coin_type_raise];return s.moveCall({target:`${t.published_at}::${ui}::create_launch_pool`,typeArguments:c,arguments:a}),s}async creatPurchasePayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=new ye,i=await Je.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.purchase_amount),e.coin_type_raise),s=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],o=[e.coin_type_sale,e.coin_type_raise];let r;return s?r=[n.pure(e.pool_address),n.pure(G(t).config_cap_id),n.pure(s.id),i,n.pure(e.purchase_amount.toString()),n.pure(Ce)]:r=[n.pure(e.pool_address),n.pure(G(t).config_cap_id),i,n.pure(e.purchase_amount.toString()),n.pure(Ce)],n.moveCall({target:`${t.published_at}::${ui}::${s===void 0?"create_and_purchase":"purchase"}`,typeArguments:o,arguments:r}),n}async creatClaimPayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],i=new ye,s=[e.coin_type_sale,e.coin_type_raise],o=[i.pure(e.pool_address),i.pure(G(t).config_cap_id),i.pure(n==null?void 0:n.id),i.pure(Ce)];return i.moveCall({target:`${t.published_at}::${ui}::claim`,typeArguments:s,arguments:o}),i}async creatSettlePayload(e){const{launchpad:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");this.assertLuanchpadConfig();const i=G(n),{clmm_args:s}=e,o=new ye;o.setSender(this.sdk.ClmmSDK.senderAddress);const r=[e.coin_type_sale,e.coin_type_raise];if(s){const a=s.opposite?qe.priceToSqrtPriceX64(L(1).div(s.current_price),s.raise_decimals,s.sale_decimals).toString():qe.priceToSqrtPriceX64(L(s.current_price),s.sale_decimals,s.raise_decimals).toString(),c=BigInt(a)<BigInt(s.clmm_sqrt_price),u=s.opposite?c?e.coin_type_raise:e.coin_type_sale:c?e.coin_type_sale:e.coin_type_raise,l=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,u);let d=Zt.calculateTotalBalance(l);Zt.isSuiCoin(u)&&(d-=BigInt(2e8));const g=Je.buildCoinForAmount(o,l,d,u).targetCoin,b=s.opposite?c?"settle_with_reverse_clmm_only_with_a":"settle_with_reverse_clmm_only_with_b":c?"settle_only_with_a":"settle_only_with_b",v=[o.pure(e.pool_address),o.pure(G(t).config_cap_id),o.pure(s.clmm_pool_address),o.pure(i.global_config_id),o.pure(a),g,o.pure(Ce)];o.moveCall({target:`${t.published_at}::${ui}::${b}`,typeArguments:r,arguments:v})}else o.moveCall({target:`${t.published_at}::${ui}::settle`,typeArguments:r,arguments:[o.pure(e.pool_address),o.pure(G(t).config_cap_id),o.pure(Ce)]});return o}creatWithdrawPayload(e){const{launchpad:t}=this.sdk.sdkOptions,n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.object(e.pool_address),n.object(G(t).config_cap_id),n.object(Ce)];return e.sale_amount>BigInt(0)&&n.moveCall({target:`${t.published_at}::${ui}::withdraw_sale`,typeArguments:i,arguments:s}),e.raise_amount>BigInt(0)&&n.moveCall({target:`${t.published_at}::${ui}::withdraw_raise`,typeArguments:i,arguments:s}),n}addUserToWhitelisPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(s=>{const o=[n.object(G(t).admin_cap_id),n.object(G(t).config_cap_id),n.object(e.pool_address),n.object(s),n.pure(e.safe_limit_amount),n.object(Ce)];n.moveCall({target:`${t.published_at}::${ui}::add_user_to_whitelist`,typeArguments:i,arguments:o})}),n}updateWhitelistCapPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise];return e.safe_limit_amount>0&&n.moveCall({target:`${t.published_at}::${ui}::update_whitelist_member_safe_limit_amount`,typeArguments:i,arguments:[n.object(G(t).admin_cap_id),n.object(G(t).config_cap_id),n.object(e.pool_address),n.pure(e.white_list_member),n.pure(e.safe_limit_amount),n.object(Ce)]}),e.hard_cap_total>0&&n.moveCall({target:`${t.published_at}::${ui}::update_whitelist_hard_cap_total`,typeArguments:i,arguments:[n.object(G(t).admin_cap_id),n.object(G(t).config_cap_id),n.object(e.pool_address),n.pure(e.hard_cap_total),n.object(Ce)]}),n}creatRemoveWhitelistPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(s=>{const o=[n.object(G(t).admin_cap_id),n.object(G(t).config_cap_id),n.object(e.pool_address),n.object(s),n.object(Ce)];n.moveCall({target:`${t.published_at}::${ui}::remove_user_from_whitelist`,typeArguments:i,arguments:o})}),n}creatCancelPoolPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.pure(G(t).admin_cap_id),n.pure(G(t).config_cap_id),n.pure(e.pool_address),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::${ui}::cancel`,typeArguments:i,arguments:s}),n}updateRecipientPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.pure(G(t).admin_cap_id),n.pure(G(t).config_cap_id),n.pure(e.pool_address),n.pure(e.new_recipient),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::${ui}::update_recipient_address`,typeArguments:i,arguments:s}),n}updatePoolDuractionPayload(e){const{launchpad:t}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.pure(G(t).admin_cap_id),n.pure(G(t).config_cap_id),n.pure(e.pool_address),n.pure(e.activity_duration),n.pure(e.settle_duration),n.pure(e.lock_duration),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::${ui}::update_pool_duration`,typeArguments:i,arguments:s}),n}creatUnlockNftPayload(e){const{launchpad:t}=this.sdk.sdkOptions;if(G(t)===void 0)throw Error("getPackagerConfigs(launchpad)  is null");const n=new ye,i=[e.nft_type],s=[n.pure(e.lock_nft),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(e){const{launchpad:t}=this._sdk.sdkOptions;if(G(t)===void 0)throw Error("launchpad config is empty");const n=`${e}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:G(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=co(s),r=Fc(s);let a=!1;return r&&o&&he(o).source_address===`${t.package_id}::config::AdminCap`&&(a=ni(r.AddressOwner)===ni(e)),this.updateCache(n,a,We),a}async isWhiteListUser(e,t){const n={type:"address",value:t};try{const i=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n});return!!(i&&i.data)}catch{return!1}}async getPurchaseAmount(e,t){var i;const n={type:"address",value:t};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n}),o=ft(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getPurchaseMarks(e,t=[],n=!0){const{launchpad:i}=this._sdk.sdkOptions,s=`${t}_getPurchaseMark`,o=this.getCache(s,n);if(!n&&o!==void 0)return o;let r=null;const a=[];for(;;){const c=await this._sdk.ClmmSDK.fullClient.getOwnedObjects({owner:e,options:{showType:!0,showContent:!0,showDisplay:!0},cursor:r});for(const u of c.data){const{fields:l}=u.data.content;if(he(Wi(u)).source_address===`${i.package_id}::pool::PurchaseMark`){console.log("fields: ",l);const h={id:l.id.id,pool_id:he(l.pool_id).address,purchased_raise_amount:l.purchase_total,obtain_sale_amount:l.obtain_sale_amount,used_raise_amount:l.used_raise_amount};t.length>0?t.includes(h.pool_id)&&a.push(h):a.push(h)}}if(c.hasNextPage)r=c.nextCursor;else break}return this.updateCache(s,a,We),a}async getSettleEvent(e){const{launchpad:t}=this._sdk.sdkOptions,n=`${e}_getPurchaseMark`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t.package_id}::pool::SettleEvent`});for(const o of s.data){const r=o.parsedJson;if(e===vn(r.pool_id)){const a={pool_id:r.pool_id,settle_price:r.settle_price,unused_sale:r.unused_sale,unused_raise:r.unused_raise,white_purchase_total:r.white_purchase_total};return this.updateCache(n,a,We),a}}}buildLaunchpadCoinType(e,t){return Mc(this._sdk.sdkOptions.launchpad.package_id,"pool","PoolLiquidityCoin",[e,t])}assertLuanchpadConfig(){const{launchpad:e}=this.sdk.sdkOptions;if(G(e)===void 0)throw Error("sdk getPackagerConfigs(launchpad) is null")}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},Is=class{static buildPoolImmutables(e){const{fields:t}=e.value.fields.value;return{clmm_pool_id:he(t.clmm_pool_id).address,bonus_type:he(t.bonus_type.fields.name).source_address,pool_id:he(t.pool_id).address,coinTypeA:he(t.coin_type_a.fields.name).source_address,coinTypeB:he(t.coin_type_b.fields.name).source_address}}static buildPoolState(e){const t=ft(e),n=[];return t.config.fields.contents.forEach(s=>{n.push({rate:Number(L(s.fields.key).div(Go)),multiplier:Number(L(s.fields.value).div(Go))})}),{balance:t.balance,config:n,is_open:t.is_open,index:Number(t.index),start_time:Number(t.start_time),interval_day:Number(t.interval_day),minimum_percent_to_reward:Number(L(t.minimum_percent_to_reward).div(Go)),rewarders:{rewarder_handle:t.rewarders.fields.id.id,size:Number(t.rewarders.fields.size)},whale_nfts:{whale_nfts_handle:t.whale_nfts.fields.id.id,size:Number(t.whale_nfts.fields.size)},points:{point_handle:t.points.fields.id.id,size:Number(t.points.fields.size)}}}static buildMarkerPositions(e){const{contents:t}=e.value.fields.value.fields,n=[],i=e.id.id;return t.forEach(s=>{const{key:o,value:r}=s.fields,a={id:o,period_id:i,bonus_num:r.fields.bonus_num,point:r.fields.point,is_burn:r.fields.is_burn,point_after_multiplier:r.fields.point_after_multiplier,percent:Number(L(r.fields.percent).div(Go)),fee_share_rate:0,is_redeemed:r.fields.is_redeemed};n.push(a)}),n}static buildPoolBonusInfo(e){const{fields:t,type:n}=e.value.fields.value;return{type:n,time:Number(t.time),settle_time:Number(t.settle_time),settled_num:t.settled_num,is_settled:t.is_settled,basis_bonus:t.basis_bonus,total_bonus:t.total_bonus,is_vacant:t.is_vacant,redeemed_num:t.redeemed_num}}static getBonusPercent(e,t){let n=0;for(const i of e)t>=i.rate&&i.rate>n&&(n=i.multiplier);return n}},Z0="router",e4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var o;const{maker_bonus:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n,e),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(G(t).maker_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=ft(u);l&&s.push(Is.buildPoolImmutables(l))}}return s}async getPoolImmutable(e){const{maker_bonus:t}=this._sdk.sdkOptions,n=`${t.package_id}_getPoolImmutables`,i=this.getCache(n);if(i!==void 0){const r=i.filter(a=>e===a.pool_id);if(r.length>0)return r[0]}const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:G(t).maker_pool_handle,name:{type:"0x2::object::ID",value:e}}),o=ft(s);return Is.buildPoolImmutables(o)}async getPools(){const e=[],t=await this.getPoolImmutables(),n=t.map(o=>o.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});let s=0;for(const o of i){const r=Is.buildPoolState(o);if(r){const a={...t[s],...r};e.push(a);const c=`${a.pool_id}_getPoolObject`;this.updateCache(c,a,We)}s+=1}return e}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t),s=await this.getPoolImmutable(e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),r=Is.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,We),a}async getPoolHandleId(e){const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),n=ft(t);return n?n.list.fields.id.id:""}async getMakerPoolPeriods(e,t=!1){const n=[],i=`${e.pool_id}_getMakerPoolPeriods`,s=this.getCache(i,t);return s!==void 0?s:((await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(e.whale_nfts.whale_nfts_handle)).data.forEach(r=>{const a={id:r.objectId,start_time:0,end_time:0,period:Number(r.name.value)};a.start_time=Number(L(e.start_time).add(L(e.interval_day).mul(24*3600).mul(a.period)).toFixed(0,ie.ROUND_DOWN)),a.end_time=Number(L(a.start_time).add(L(e.interval_day).mul(24*3600)).toFixed(0,ie.ROUND_DOWN)),n.push(a)}),this.updateCache(i,n,We),n)}async getMakerBonusInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.maker_bonus,t=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,n={maker_config_id:"",maker_pool_handle:""};return t.length>0&&t.forEach(s=>{const o=s.parsedJson;o&&(n.maker_config_id=o.config_id)}),n.maker_pool_handle=await this.getPoolHandleId(n.maker_config_id),n}async getPoolMarkerPositionList(e,t,n=!1){const i={},s=[];n||t.forEach(o=>{const r=`${e}_${o.period}_getPoolMarkerPositionList`,a=this.getCache(r);a!==void 0?i[o.period]=a:(i[o.period]=[],s.push(o))});try{s.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(s.map(a=>a.id),{showContent:!0})).forEach(a=>{const c=ft(a),u=Is.buildMarkerPositions(c);if(u.length>0){const{period_id:l}=u[0],d=t.filter(h=>h.id===l)[0];i[d.period]=u}});const o=[];for(const r in i)i[r].forEach(c=>{o.push(c)});if(o.length>0){const r=await this._sdk.ClmmSDK.Position.getSipmlePositionList(o.map(a=>a.id));for(const a of o)for(const c of r)if(a.id===c.pos_object_id){a.clmm_position=c;break}}}catch(o){console.log(o)}for(const o in i){const r=`${e}_${o}_getPoolMarkerPositionList`;this.updateCache(r,i[o],We)}return i}async updateXCetusRewarderAndFee(e,t,n){const i=await this.calculateTotalPointsAfterMultiper(e,n);for(const s of t)await this.calculateXCetusRewarder(e,s,n.period,i);return t}async calculateXCetusRewarder(e,t,n,i){const s=await this.getPoolBonusInfo(e.rewarders.rewarder_handle,n),{fee_share_rate:o}=this.calculateFeeShareRate(e,t,i),r=L(o).mul(s.total_bonus);return t.is_redeemed?t.bonus_num="0":t.bonus_num=r.toString(),t.bonus_num}calculateFeeShareRate(e,t,n){const i=Is.getBonusPercent(e.config,t.percent),s=L(t.point).mul(i),o=L(s).div(n);return t.point_after_multiplier=s.toString(),t.fee_share_rate=Number(o),{fee_share_rate:Number(o),points_after_multiper:s.toString()}}async calculateTotalPointsAfterMultiper(e,t){const n=await this.getPoolMarkerPositionList(e.whale_nfts.whale_nfts_handle,[t]);let i=L(0);const s=n[t.period];for(const o of s){const r=Is.getBonusPercent(e.config,o.percent),a=L(o.point).mul(r);i=i.add(a)}return i.toString()}async calculateAllXCetusRewarder(e){const t=this._sdk.ClmmSDK.senderAddress;let n=L(0);const i=[];for(const s of e){const o=await this._sdk.MakerModule.getMakerPoolPeriods(s),r=await this._sdk.MakerModule.getPoolMarkerPositionList(s.whale_nfts.whale_nfts_handle,o),a=[];for(const c of o){const u=r[c.period].filter(l=>{var d;return t.length===0?!1:((d=l.clmm_position)==null?void 0:d.owner)===t});u.length>0&&(await this._sdk.MakerModule.updateXCetusRewarderAndFee(s,u,c),u.forEach(l=>{var d;((d=l.clmm_position)==null?void 0:d.position_status)===rw.Exists&&L(l.bonus_num).greaterThan(0)&&(n=n.add(l.bonus_num),a.includes(l.clmm_position.pos_object_id)||a.push(l.clmm_position.pos_object_id))}))}i.push({bonus_type:s.bonus_type,pool_id:s.pool_id,nft_ids:a})}return{claimtotal:n,claimRecord:i}}async getPoolBonusInfo(e,t,n=!1){const i=`${e}_${t}_getPoolBonusInfo`,s=this.getCache(i,n);if(s!==void 0)return s;const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"u64",value:t.toString()}}),r=ft(o),a=Is.buildPoolBonusInfo(r);return this.updateCache(i,a,Ti),a}claimPayload(e){const{maker_bonus:t,xcetus:n}=this.sdk.sdkOptions,i=new ye;return i.moveCall({target:`${t.published_at}::${Z0}::claim`,typeArguments:[e.bonus_type],arguments:[i.pure(G(t).maker_config_id),i.pure(e.market_pool_id),i.pure(e.position_nft_id),i.pure(e.phase),i.pure(G(n).lock_manager_id),i.pure(G(n).xcetus_manager_id),i.pure(e.ve_nft_id)]}),i}claimAllPayload(e){const{maker_bonus:t,xcetus:n}=this.sdk.sdkOptions,i=new ye;return e.whale_nfts.forEach(s=>{s.nft_ids.forEach(o=>{i.moveCall({target:`${t.published_at}::${Z0}::claim_all`,typeArguments:[s.bonus_type],arguments:[i.object(G(t).maker_config_id),i.object(s.pool_id),i.object(o),i.object(G(n).lock_manager_id),i.object(G(n).xcetus_manager_id),i.object(e.ve_nft_id)]})})}),i}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},Ro="router",id="router",ea=24*3600,zc=1e3,Oi=1e11,Ws=class{static buildVeNFTDividendInfo(e){const t={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:he(s.fields.key.fields.name).source_address,amount:s.fields.value})}),t.rewards.push({period:Number(n.fields.key),rewards:i})}),t}static buildDividendManager(e){const t={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(n=>{t.bonus_types.push(he(n.fields.name).source_address)}),t}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:bn(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockCetus(e){const t=e.fields,n={id:t.id.id,type:he(e.type).source_address,locked_start_time:Number(t.locked_start_time),locked_until_time:Number(t.locked_until_time),cetus_amount:t.balance,xcetus_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ea,n}static getAvailableXCetus(e,t){let n=L(0);return t.forEach(i=>{n=n.add(i.xcetus_amount)}),L(e.xcetus_balance).sub(n).toString()}static getWaitUnLockCetuss(e){return e.filter(t=>!Ws.isLocked(t))}static getLockingCetuss(e){return e.filter(t=>Ws.isLocked(t))}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static buildDividendRewardTypeList(e){const t=new Set;return e.forEach(n=>{n.rewards.forEach(i=>{t.add(i.coin_type)})}),Array.from(t)}static getNextStartTime(e){const t=Date.now()/1e3,{start_time:n,interval_day:i}=e,s=Math.ceil((t-n)/(i*ea));return n+s*i*ea}},t4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,t=!0){const{xcetus:n}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,s=this.getCache(i,t);if(s!==void 0)return s;let o;const r=`${n.package_id}::xcetus::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=he(Wi(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...al(c),id:l.id.id,index:l.index,type:u,xcetus_balance:l.xcetus_balance},this.updateCache(i,o,We)}}),o}async getOwnerLockCetuss(e){const{xcetus:t}=this.sdk.sdkOptions,n=[],i=`${t.package_id}::lock_coin::LockedCoin<${this.buileCetusCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(he(Wi(o)).source_address===i&&o.data){const a=Ws.buildLockCetus(o.data.content);a.xcetus_amount=await this.getXCetusAmount(a.id),n.push(a)}return n}async getLockCetus(e){var n;const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((n=t.data)!=null&&n.content){const i=Ws.buildLockCetus(t.data.content);return i.xcetus_amount=await this.getXCetusAmount(i.id),i}}async getOwnerCetusCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileCetusCoinType())}mintVeNFTPayload(){const{xcetus:e}=this.sdk.sdkOptions,t=new ye;return t.moveCall({target:`${e.published_at}::${Ro}::mint_venft`,typeArguments:[],arguments:[t.pure(G(e).xcetus_manager_id)]}),t}async convertPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new ye,i=this.buileCetusCoinType(),s=await Je.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.amount),i);return e.venft_id===void 0?n.moveCall({target:`${t.published_at}::${Ro}::mint_and_convert`,typeArguments:[],arguments:[n.object(G(t).lock_manager_id),n.object(G(t).xcetus_manager_id),s,n.pure(e.amount)]}):n.moveCall({target:`${t.published_at}::${Ro}::convert`,typeArguments:[],arguments:[n.object(G(t).lock_manager_id),n.object(G(t).xcetus_manager_id),s,n.pure(e.amount),n.pure(e.venft_id)]}),n}redeemLockPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${Ro}::redeem_lock`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.amount),n.pure(e.lock_day),n.pure(Ce)]}),n}redeemPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${Ro}::redeem`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ce)]}),n}redeemDividendPayload(e,t){const{xcetus:n,xcetus_dividends:i}=this.sdk.sdkOptions,s=new ye;return t.forEach(o=>{s.moveCall({target:`${n.published_at}::${id}::redeem`,typeArguments:[o],arguments:[s.object(G(i).dividend_manager_id),s.object(e)]})}),s}redeemDividendV2Payload(e,t,n){const{xcetus_dividends:i}=this.sdk.sdkOptions;let s=new ye;return t.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(e,s)),t.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${id}::redeem_v2`,typeArguments:[r],arguments:[s.object(G(i).dividend_manager_id),s.object(e),s.object(Ce)]})}),s}redeemDividendXTokenPayload(e,t){const{xcetus_dividends:n,xcetus:i}=this.sdk.sdkOptions,{xcetus_manager_id:s,lock_manager_id:o}=G(i),{dividend_manager_id:r}=G(n);return t=t===void 0?new ye:t,t.moveCall({target:`${n.published_at}::${id}::redeem_xtoken`,typeArguments:[],arguments:[t.object(o),t.object(s),t.object(r),t.object(e),t.object(Ce)]}),t}buileCetusCoinType(){return`${this.sdk.sdkOptions.cetus_faucet.package_id}::cetus::CETUS`}buileXTokenCoinType(e=this._sdk.sdkOptions.xcetus.package_id,t="xcetus",n="XCETUS"){return`${e}::${t}::${n}`}cancelRedeemPayload(e){const{xcetus:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${Ro}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xcetus_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ce)]}),n}async getInitConfigs(){var r,a;const{package_id:e}=this.sdk.sdkOptions.xcetus,t=`${e}_getInitFactoryEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::xcetus::InitEvent`}))==null?void 0:r.data,s={xcetus_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xcetus_manager_id=u.xcetus_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_manager_id.length>0&&(s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id),this.updateCache(t,s,We),s}async getLockUpManager(e=G(this.sdk.sdkOptions.xcetus).lock_manager_id,t=!1){const n=`${e}_getLockUpManager`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=Ws.buildLockUpManager(ft(s));return this.updateCache(n,o,We),o}async getDividendConfigs(){var o;const{package_id:e}=this.sdk.sdkOptions.xcetus_dividends,t=`${e}_getDividendManagerEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(t,s,We))}),s}async getDividendManager(e=!1){const{dividend_manager_id:t}=G(this._sdk.sdkOptions.xcetus_dividends),n=`${t}_getDividendManager`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=ft(s),r=Ws.buildDividendManager(o);return this.updateCache(n,r,We),r}async getXcetusManager(e=!0){const{xcetus_manager_id:t}=G(this._sdk.sdkOptions.xcetus),n=`${t}_getXcetusManager`,i=this.getCache(n,e);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=ft(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(e,t){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=ft(n);return Ws.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(G(this._sdk.sdkOptions.xcetus).lock_manager_id),i=L(Oi).mul(L(n.max_lock_day).sub(L(t))).mul(L(n.max_percent_numerator).sub(L(n.min_percent_numerator))).div(L(n.max_lock_day).sub(L(n.min_lock_day))),s=L(Oi).mul(L(n.max_percent_numerator)).sub(i).div(L(zc)).div(Oi);return{amountOut:L(s).mul(L(e)).round().toString(),percent:s.toString()}}async reverseRedeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(G(this._sdk.sdkOptions.xcetus).lock_manager_id),i=L(Oi).mul(L(n.max_lock_day).sub(L(t))).mul(L(n.max_percent_numerator).sub(L(n.min_percent_numerator))).div(L(n.max_lock_day).sub(L(n.min_lock_day))),s=L(Oi).mul(L(n.max_percent_numerator)).sub(i).div(L(zc)).div(Oi);return{amountOut:L(e).div(s).toFixed(0,ie.ROUND_UP),percent:s.toString()}}async getXCetusAmount(e){const{lock_handle_id:t}=G(this._sdk.sdkOptions.xcetus),n=`${e}_getXCetusAmount`,i=this.getCache(n);if(i!==void 0)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),o=ft(s);if(o){const{xcetus_amount:r}=o.value.fields.value.fields;return this.updateCache(n,r,We),r}}catch{}return"0"}async getVeNftAmount(e,t){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=ft(n);if(i){const{lock_amount:s,xcetus_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xcetus_amount:o}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(e,t=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${e}_getPhaseDividendInfo`,o=this._sdk.getCache(s,t);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),a=ft(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),h={id:Hi(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,h),h}catch{}}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},n4="factory",Ai="oversubscribe_pool",_w=1e6,Mo=1e18,$o="router",sd="router",Za="router",Y0={curve:{strategy:3,both_side:{div_width:10,ratios:[.333333,.266666,.2,.133333,.066666]},one_side:{div_width:5,ratios:[.333333,.266666,.2,.133333,.066666]}},bidAsk:{strategy:4,both_side:{div_width:10,ratios:[.172413793,.137931034,.103448276,.068965517,.034482759,.068965517,.103448276,.137931034,.172413793]},one_side:{div_width:5,ratios:[.066666667,.13333333,.2,.266666667,.333333333]}}};function i4(e){return"master_address"in e}var s4="router",o4="vaults",r4=1e4,Dn=class{static buildIdoPoolImmutables(e){return{pool_address:vn(e.pool_id),coin_type_sale:he(e.sale_coin_type.name).full_address,coin_type_raise:he(e.raise_coin_type.name).full_address,tick_spacing:Number(e.tick_spacing),total_supply:e.total_supply,min_purchase:e.min_purchase_amount,max_purchase:e.max_purchase_amount}}static buildIdoPool(e){const t=Wi(e),n=he(t),i=ft(e);console.log("fields:",i);const s={pool_address:vn(i.id.id),coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],tick_spacing:Number(i.tick_spacing),total_supply:i.total_supply,min_purchase:i.min_purchase_amount,max_purchase:i.max_purchase_amount},o={start_time:Number(i.duration_manager.fields.start_time),lock_up_duration:Number(i.duration_manager.fields.lock_up_duration),purchase_duration:Number(i.duration_manager.fields.purchase_duration),end_time:0};o.end_time=o.start_time+o.purchase_duration;const r={complete_raise_limit:i.complete_raise_limit,liquidity_injection_ratio:L(i.liquidity_injection_ratio).div(_w).toNumber(),current_sqrt_price_min:i.current_sqrt_price_min,current_sqrt_price_max:i.current_sqrt_price_max,owner:i.owner,sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,price:i.price,current_price:i.price,duration_summary:o,is_cancelled:i.is_cancelled,is_liquidity_injected:i.is_liquidity_injected,liquidity_used_raise_amount:i.liquidity_used_raise_amount,liquidity_used_sale_amount:i.liquidity_used_sale_amount,purchase_summary:{size:Number(i.purchase_manager.fields.purchases.fields.size),purchase_handle:i.purchase_manager.fields.purchases.fields.id.id},total_purchase_amount:i.total_purchase_amount,white_summary:{white_list_id:i.white_list.fields.id.id,protection_limit_used:i.white_list.fields.protection_limit_used,protection_hard_cap:i.white_list.fields.protection_hard_cap,white_handle:i.white_list.fields.addresses.fields.id.id,size:Number(i.white_list.fields.addresses.fields.size)},pool_status:"Upcoming",max_raise_amount:"",sale_decimals:0,raise_decimals:0,is_withdrawn:i.is_withdrawn};return Dn.updatePoolStatus(r),{...s,...r}}static is_init_period(e){return Number(L(Date.now()/1e3).toFixed(0))<e.start_time}static is_purchase_period(e){const t=Number(L(Date.now()/1e3).toFixed(0));return t>=e.start_time&&t<=e.start_time+e.purchase_duration}static is_claim_period(e){const t=Number(L(Date.now()/1e3).toFixed(0)),n=e.start_time+e.purchase_duration;return t>n}static is_can_inject_liquidity(e){return!e.is_cancelled&&e.liquidity_injection_ratio!==0&&Dn.is_claim_period(e.duration_summary)&&!e.is_liquidity_injected}static is_can_withdraw(e){return e.is_withdrawn?!1:Dn.is_sale_failed(e)?!0:(e.liquidity_injection_ratio===0||e.is_liquidity_injected)&&Dn.is_claim_period(e.duration_summary)}static is_sale_failed(e){return!!(e.is_cancelled||Dn.is_claim_period(e.duration_summary)&&L(e.total_purchase_amount).lessThan(e.complete_raise_limit))}static buildPurchaseInfo(e){return{...e.value.fields.value.fields,owner:e.name}}static calculateRedeemAmount(e,t){let n,i;if(Dn.is_sale_failed(e))n="0",i="0";else if(t.is_redeemed)n=t.obtained_sale_amount,i=t.used_raise_amount;else if(L(e.total_purchase_amount).lessThanOrEqualTo(e.max_raise_amount))n=L(t.purchased_raise_amount).mul(Mo).div(e.price).toString(),i=t.purchased_raise_amount;else{const o=Dn.redeemForSaleOversubcribeV2(e,t);n=o.user_obtained_sale_amount,i=o.user_used_raise_amount_ceil}n=ie.floor(n);const s=ie.floor(L(t.purchased_raise_amount).sub(i).toString());return{obtained_sale_amount:n,refunded_raise_amount:s}}static calculateWithdrawAmount(e){let t,n;const i=L(e.total_supply).mul(e.liquidity_injection_ratio);if(Dn.is_sale_failed(e))t="0",n=L(i).add(e.total_supply);else{const{max_raise_amount:s}=e;L(e.total_purchase_amount).greaterThanOrEqualTo(s)?(t=L(s).sub(e.liquidity_used_raise_amount).toString(),n="0"):(t=L(e.total_purchase_amount).sub(e.liquidity_used_raise_amount),n=L(e.total_supply).add(i).sub(e.liquidity_used_sale_amount).sub(Dn.get_sold_amount(e)))}return{obtained_raise_amount:ie.floor(t).toString(),refunded_sale_amount:ie.ceil(n).toString()}}static get_sold_amount(e){return L(e.total_purchase_amount).greaterThanOrEqualTo(e.max_raise_amount)?e.total_supply:L(e.total_purchase_amount).mul(Mo).div(e.price)}static redeemForSaleOversubcribe(e,t){const n=t.protection_raise_amount,i=L(t.purchased_raise_amount).sub(n),s=e.max_raise_amount,{protection_limit_used:o}=e.white_summary,r=L(s).sub(o),a=L(e.total_purchase_amount).sub(o),c=ie.ceil(i.mul(r).div(a).add(n)),u=ie.floor(i.mul(r).div(a).add(n));return{user_obtained_sale_amount:ie.floor(L(e.total_supply).mul(u).div(s)),user_used_raise_amount_ceil:c}}static redeemForSaleOversubcribeV2(e,t){const n=t.protection_raise_amount,i=L(t.purchased_raise_amount).sub(n),s=e.max_raise_amount,{protection_limit_used:o}=e.white_summary,r=L(s).sub(o),a=L(e.total_purchase_amount).sub(o),c=L(n).mul(a).add(L(i).mul(r)).mul(Mo).div(L(a).mul(e.price)),u=ie.ceil(c.mul(e.price).div(Mo));return{user_obtained_sale_amount:c,user_used_raise_amount_ceil:u}}static raiseTotalAmount(e){const t=L(e.sale_decimals-e.raise_decimals).abs().toNumber();return e.sale_decimals>e.raise_decimals?L(e.total_supply).mul(e.current_price).div(L(10).pow(L(t))).toString():L(e.total_supply).mul(e.current_price).mul(L(10).pow(L(t))).toString()}static updatePoolStatus(e){const t=Number(L(Date.now()/1e3).toFixed(0)),n=e.duration_summary,i=n.start_time+n.purchase_duration;e.is_cancelled?e.pool_status="Canceled":t<n.start_time?e.pool_status="Upcoming":t>n.start_time&&t<i?e.pool_status="Live":L(e.total_purchase_amount).lessThan(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Ended"}static async calculatePoolUiPrice(e,t){const n=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([t.coin_type_sale,t.coin_type_raise]),i=n[t.coin_type_sale].decimals,s=n[t.coin_type_raise].decimals;t.current_price=ii.priceFixToReal(Number(L(t.price).div(L(Mo)).toString()),i,s).toString(),t.sale_decimals=i,t.raise_decimals=s,t.max_raise_amount=this.raiseTotalAmount(t)}},N5=class{constructor(e){ze(this,"_sdk");this._sdk=e}async getPools(e=[],t=!1){const n=[];if(e.length>0){if(e.filter(s=>{const o=`${s}_getPool`,r=this._sdk.getCache(o,t);return r?(n.push(r),!1):!0}).length>0){const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(e,{showType:!0,showContent:!0});for(const o of s){const r=await this.buildIdoWarpPool(o);r&&n.push(r)}}}else(await this._sdk.Ido.getPools()).forEach(s=>{n.push({...s,version:"2"})});return n.forEach(i=>{const s=`${i.pool_address}_getPool`;this._sdk.updateCache(s,i)}),n}async getPool(e,t=!0){const n=`${e}_getPool`,i=this._sdk.getCache(n,t);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=await this.buildIdoWarpPool(s);return this._sdk.updateCache(n,o),o}async getJoinPools(e,t){const n=[],i=t.filter(o=>o.version==="1"),s=t.filter(o=>o.version==="2");if(i.length>0){const o=await this._sdk.Launchpad.getPurchaseMarks(e,i.map(r=>r.pool_address),!1);i.forEach(r=>{for(const a of o)if(a.pool_id===r.pool_address){n.push(r);break}})}for(const o of s)await this._sdk.Ido.getPurchaseInfo(o.purchase_summary.purchase_handle,e,!1)&&n.push(o);return n}async getOwnerPools(e,t){return t.filter(n=>n.owner===ni(e))}async creatPurchasePayload(e,t){return e.version==="1"?await this._sdk.Launchpad.creatPurchasePayload({pool_address:e.pool_address,purchase_amount:t,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.creatPurchasePayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle,raise_amount:t.toString()})}async creatRedeemPayload(e){return e.version==="1"?await this._sdk.Launchpad.creatClaimPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.redeemPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle})}async creatWithdrawPayload(e){if(e.version==="1"){const n=await ii.getWithdrawSale(e),i=await ii.getWithdrawRaise(e);return this._sdk.Launchpad.creatWithdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,sale_amount:BigInt(n),raise_amount:BigInt(i)})}return this._sdk.Ido.withdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise})}unlockNftPayload(e,t){return e.version==="1"?this._sdk.Launchpad.creatUnlockNftPayload(t):this._sdk.Ido.unlockNftPayload({lock_nft_id:t.lock_nft,nft_type:t.nft_type})}async getLockNFTList(e){let t=[];return e.version==="1"&&(t=await this._sdk.Launchpad.getLockNFTList(e.owner)),t=await this._sdk.Ido.getLockNFTList(e.owner),t.filter(i=>{const s=he(i.coin_type_a).full_address,o=he(i.coin_type_b).full_address,r=he(e.coin_type_sale).full_address,a=he(e.coin_type_raise).full_address;return s===r&&o===a||s===a&&o===r})}async isWhiteListUser(e,t){return t.version==="1"?await this._sdk.Launchpad.isWhiteListUser(t.white_summary.white_handle,e):!!await this._sdk.Ido.getWhiteProtectionLimit(t.white_summary.white_handle,e)}async getPurchaseInfo(e,t){if(t.version==="1"){const i=await this._sdk.Launchpad.getPurchaseMarks(e,[t.pool_address]);return i.length>0?i[0]:void 0}return await this._sdk.Ido.getPurchaseInfo(t.purchase_summary.purchase_handle,e)}async getwhiteProtectionInfo(e,t,n=!1){if(t.version==="1")return await this._sdk.Launchpad.getPurchaseAmount(t.white_summary.white_handle,e);const i=await this._sdk.Ido.getPurchaseInfo(t.purchase_summary.purchase_handle,e,n);if(i)return{safe_limit_amount:i.protection_raise_limit,safe_purchased_amount:i.protection_raise_amount};const s=await this._sdk.Ido.getWhiteProtectionLimit(t.white_summary.white_handle,e,!1);return s?{safe_limit_amount:s,safe_purchased_amount:"0"}:{safe_limit_amount:"0",safe_purchased_amount:"0"}}async calculateWithdrawAmount(e){if(e.version==="1"){const t=await ii.getHistoryWithdrawRaise(this._sdk,e),n=await ii.getHistoryWithdrawSale(this._sdk,e);return{obtained_raise_amount:t,refunded_sale_amount:n}}return Dn.calculateWithdrawAmount(e)}async buildIdoWarpPool(e){const t=co(e);if(console.log(this._sdk.sdkOptions.ido.package_id,he(t).address,"buildIdoWarpPool"),he(t).address===this._sdk.sdkOptions.ido.package_id){const n=Dn.buildIdoPool(e);return await Dn.calculatePoolUiPrice(this._sdk,n),{...n,version:"2"}}if(he(t).address===this._sdk.sdkOptions.launchpad.package_id){const n=ii.buildLaunchPadPool(e);return await ii.calculatePoolPrice(this._sdk,n),{...n,version:"1"}}}},Vs=class{static buildVeNFTDividendInfo(e){const t={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:he(s.fields.key.fields.name).source_address,amount:s.fields.value})}),t.rewards.push({period:Number(n.fields.key),rewards:i})}),t}static buildDividendManager(e){const t={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(n=>{t.bonus_types.push(he(n.fields.name).source_address)}),t}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:bn(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockToken(e){const t=e.fields,n={id:t.id.id,type:he(e.type).source_address,locked_start_time:Number(t.locked_start_time),locked_until_time:Number(t.locked_until_time),token_amount:t.balance,xtoken_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ea,n}static getAvailableXToken(e,t){let n=L(0);return t.forEach(i=>{n=n.add(i.xtoken_amount)}),L(e.xtoken_balance).sub(n).toString()}static getWaitUnLockTokens(e){return e.filter(t=>!Vs.isLocked(t))}static getLockingTokens(e){return e.filter(t=>Vs.isLocked(t))}static buildDividendRewardTypeList(e){const t=new Set;return e.forEach(n=>{n.rewards.forEach(i=>{t.add(i.coin_type)})}),Array.from(t)}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(e,t=ea){const n=Date.now()/1e3,{start_time:i,interval_day:s}=e,o=Math.ceil((n-i)/(s*t));return i+o*s*t}},cs=class{static getDefaultStrategyConfig(e){let t;switch(e){case 4:t=Y0.bidAsk;break;default:t=Y0.curve;break}return t}static geTickIndexRange(e,t,n,i){let s,o;switch(e=qe.getInitializableTickIndex(e,t),i){case"left":e>0?(o=L(e).sub(t).toNumber(),s=L(e).mul(L(1).add(n)).toDecimalPlaces(0).toNumber()):(o=L(e).sub(t).toNumber(),s=L(e).mul(L(1).sub(n)).toDecimalPlaces(0).toNumber());break;case"right":e>0?(o=L(e).mul(L(1).add(n)).toDecimalPlaces(0).toNumber(),s=L(e).add(t).toNumber()):(o=L(e).mul(L(1).sub(n)).toDecimalPlaces(0).toNumber(),s=L(e).add(t).toNumber());break;default:e>0?(s=L(e).mul(L(1).sub(n)).toDecimalPlaces(0).toNumber(),o=L(e).mul(L(1).add(n)).toDecimalPlaces(0).toNumber()):(s=L(e).mul(L(1).add(n)).toDecimalPlaces(0).toNumber(),o=L(e).mul(L(1).sub(n)).toDecimalPlaces(0).toNumber());break}if(s=qe.getInitializableTickIndex(s,t),o=qe.getInitializableTickIndex(o,t),s<Md)throw Error("Tick lower value is below the minimum allowed value.");if(o>Dd)throw Error("Tick upper value is above the maximum allowed value.");return{tick_lower:s,tick_upper:o}}static getCreateLiquidityBins(e,t){let n=[];switch(t){case 4:n=cs.getCreateBidAskLiquidityBins(e);break;default:n=cs.getCreateCurveLiquidityBins(e);break}return n}static getCreateBidAskLiquidityBins(e){const t=L(Math.floor(L(e.tick_upper).sub(e.tick_lower).div(e.div_width).toNumber())).abs(),n=[],i=e.ratios;let s,o;for(let r=0;r<i.length;r++){let a,c;e.tick_upper<=e.curr_tick?(c=L(e.tick_upper).sub(t.mul(r)).toNumber(),a=L(c).sub(t).toNumber()):e.tick_lower>=e.curr_tick?(a=L(e.tick_lower).add(t.mul(r)).toNumber(),c=L(e.tick_lower).add(t.mul(r+1)).toNumber()):r===4?(a=L(e.tick_lower).add(t.mul(r)).toNumber(),c=L(a).add(t.mul(2)).toNumber()):r>4?(a=L(e.tick_lower).add(t.mul(r+1)).toNumber(),c=L(a).add(t).toNumber()):(a=L(e.tick_lower).add(t.mul(r)).toNumber(),c=L(a).add(t).toNumber()),s=qe.getInitializableTickIndex(a,e.tick_spacing),o=qe.getInitializableTickIndex(c,e.tick_spacing),n.push({tick_lower:s,tick_upper:o,ratio:i[r],liquidity:"0"})}return n}static getCreateCurveLiquidityBins(e){const t=L(Math.floor(L(e.tick_upper).sub(e.tick_lower).div(e.div_width).toNumber())).abs(),n=[],i=e.ratios;for(let s=0;s<i.length;s++){let o,r;e.tick_upper<=e.curr_tick?(r=e.tick_upper,o=L(e.tick_upper).sub(t.mul(s+1)).toNumber()):e.tick_lower>=e.curr_tick?(o=e.tick_lower,r=L(o).add(t.mul(s+1)).toNumber()):(o=L(e.curr_tick).sub(t.mul(s+1)).toNumber(),r=L(e.curr_tick).add(t.mul(s+1)).toNumber()),n.push({tick_lower:qe.getInitializableTickIndex(o,e.tick_spacing),tick_upper:qe.getInitializableTickIndex(r,e.tick_spacing),ratio:i[s],liquidity:"0"})}return n}static calculateAddLiquidityInputs(e){const t=new y(qe.tickIndexToSqrtPriceX64(e.curr_tick)),n=cs.calculateCoinRatios(e.curr_tick,e.liquidity_bins),i=e.liquidity_bins.map((s,o)=>{const r=n[o],a=L(e.coin_amount).mul(e.fix_amount_a?r.coinRatioA:r.coinRatioB).toFixed(0).toString();try{return{...pn.estLiquidityAndcoinAmountFromOneAmounts(s.tick_lower,s.tick_upper,new y(a),e.fix_amount_a,!0,e.slippage,t),...s}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!e.fix_amount_a,...s}}});return cs.fixLiquidityInputs(t,e.slippage,i,!0)}static fixLiquidityInputs(e,t,n,i){const s=n.filter(r=>r.liquidityAmount.gt(st));if(s.length===0)return[];const o=s[0];return n.map(r=>{if(r.liquidityAmount.eq(st)){const a=L(o.liquidityAmount.toString()).mul(r.ratio).div(o.ratio).toFixed(0),c=qe.tickIndexToSqrtPriceX64(r.tick_lower),u=qe.tickIndexToSqrtPriceX64(r.tick_upper),l=pn.getCoinAmountFromLiquidity(new y(a.toString()),e,c,u,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,liquidityAmount:new y(a.toString()),fix_amount_a:r.fix_amount_a,...Ql(l,Qr.fromDecimal(L(t).mul(100)),i)}}return r})}static calculateCoinRatios(e,t){const n=new y(qe.tickIndexToSqrtPriceX64(e)),i=[];let s=L(0),o=L(0);const r=t.map(u=>{const l=L(LE(100,6).toString()).mul(u.ratio).toFixed(0).toString(),d=qe.tickIndexToSqrtPriceX64(u.tick_lower),h=qe.tickIndexToSqrtPriceX64(u.tick_upper),g=pn.getCoinAmountFromLiquidity(new y(l),n,d,h,!0);return s=s.add(g.coinA.toString()),o=o.add(g.coinB.toString()),{...g,liquidity:l}}),a=[],c=[];return r.forEach((u,l)=>{const d={coinRatioA:s.eq(L(0))?0:L(u.coinA.toString()).div(s).toNumber(),coinRatioB:o.eq(L(0))?0:L(u.coinB.toString()).div(o).toNumber(),liquiditys:u.liquidity,tick_lower:t[l].tick_lower,tick_upper:t[l].tick_upper};i.push(d),a.push(s.eq(L(0))?0:L(u.coinA.toString()).div(s).toNumber()),c.push(o.eq(L(0))?0:L(u.coinB.toString()).div(o).toNumber())}),i}static calculateCloseMasterLiquidityInputs(e){const t=new y(qe.tickIndexToSqrtPriceX64(e.curr_tick));return e.positions.map(i=>{const s=new y(i.liquidity),o=qe.tickIndexToSqrtPriceX64(i.tick_lower_index),r=qe.tickIndexToSqrtPriceX64(i.tick_upper_index),a=pn.getCoinAmountFromLiquidity(s,t,o,r,!1),c=Qr.fromDecimal(L(e.slippage).mul(100)),{tokenMaxA:u,tokenMaxB:l}=Ql(a,c,!1);return{coinAmountA:a.coinA,coinAmountB:a.coinB,tokenMaxA:u,tokenMaxB:l,liquidityAmount:s,fix_amount_a:!1}})}static calculateRemoveMasterLiquidityInputs(e){const t=new y(qe.tickIndexToSqrtPriceX64(e.curr_tick)),{fix_token:n}=e;if(n){const s=e.positions.map((a,c)=>({tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,ratio:e.ratios[c]})),o=cs.calculateCoinRatios(e.curr_tick,s),r=e.positions.map((a,c)=>{const u=o[c],l=L(n.coin_amount).mul(n.fix_amount_a?u.coinRatioA:u.coinRatioB).toFixed(0).toString();try{const d=pn.estLiquidityAndcoinAmountFromOneAmounts(a.tick_lower_index,a.tick_upper_index,new y(l),n.fix_amount_a,!1,e.slippage,t);return{...d,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:d.liquidityAmount.toString(),ratio:e.ratios[c]}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!n.fix_amount_a,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:"0",ratio:e.ratios[c]}}});return cs.fixLiquidityInputs(t,e.slippage,r,!1)}return e.positions.map((s,o)=>{const r=e.ratios[o];let a=L(e.liquidity).mul(r).toFixed(0);L(a).greaterThan(s.liquidity)&&(a=s.liquidity);const c=qe.tickIndexToSqrtPriceX64(s.tick_lower_index),u=qe.tickIndexToSqrtPriceX64(s.tick_upper_index),l=pn.getCoinAmountFromLiquidity(new y(a),t,c,u,!1),d=Qr.fromDecimal(L(e.slippage).mul(100)),{tokenMaxA:h,tokenMaxB:g}=Ql(l,d,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,tokenMaxA:h,tokenMaxB:g,liquidityAmount:new y(a),fix_amount_a:!1}})}static buildMasterPosition(e){return{coin_type_a:he(e.coin_type_a.fields.name).full_address,coin_type_b:he(e.coin_type_b.fields.name).full_address,description:e.description,id:e.id.id,index:e.index,liquidity:e.liquidity,name:e.name,pool:e.pool,tick_lower_index:Bn(BigInt(e.tick_lower_index.fields.bits)),tick_upper_index:Bn(BigInt(e.tick_upper_index.fields.bits)),url:e.url}}static buildMasterNFT(e){const t=ft(e);if(t){const n={id:t.id.id,pool_id:t.pool_id,index:Number(t.index),strategy:Number(t.strategy),tick_lower_index:Bn(BigInt(t.tick_lower_index)),tick_upper_index:Bn(BigInt(t.tick_upper_index)),positions:[],...al(e)};return n.positions=t.positions.map(i=>cs.buildMasterPosition(i.fields)),n}}},mi=class{static generateNextTickRange(e,t,n){const i=e-t/2,s=e+t/2;return{new_tick_lower:mi.getValidTickIndex(i,n),new_tick_upper:mi.getValidTickIndex(s,n)}}static calculateDepositRatio(e,t,n){const i=qe.sqrtPriceX64ToTickIndex(n);if(i<e)return{ratioA:new ie(1),ratioB:new ie(0)};if(i>t)return{ratioA:new ie(0),ratioB:new ie(1)};const s=new y(1e8),{coinAmountB:o}=pn.estLiquidityAndcoinAmountFromOneAmounts(e,t,s,!0,!0,0,n),r=qe.sqrtPriceX64ToPrice(n,0,0),a=L(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=L(o.toString()).div(c);return{ratioA:u,ratioB:l}}static getValidTickIndex(e,t){if(e%t===0)return e;let n;if(e>0?n=e-e%t+t:e<0?n=e+Math.abs(e)%t-t:n=e,n%t!==0)throw new Error("Assertion failed: res % tickSpacing == 0");if(Math.abs(n)<Math.abs(e))throw new Error("Assertion failed: res.abs() >= tickIndex");return n}static get_lp_amount_by_liquidity(e,t){return e.total_supply==="0"?"0":L(e.total_supply).mul(t).div(e.liquidity).toFixed(0,ie.ROUND_DOWN).toString()}static get_share_liquidity_by_amount(e,t){return e.total_supply==="0"?"0":L(t).mul(e.liquidity).div(e.total_supply).toFixed(0,ie.ROUND_DOWN).toString()}static get_protocol_fee_amount(e,t){return L(t).mul(e.protocol_fee_rate).div(r4).toFixed(0,ie.ROUND_CEIL)}static buildFramsPositionNFT(e){const t=e.clmm_postion.fields;return{id:e.id.id,url:t.url,pool_id:e.pool_id,coinTypeA:he(t.coin_type_a.fields.name).full_address,coinTypeB:he(t.coin_type_b.fields.name).full_address,description:t.description,name:t.name,liquidity:t.liquidity,clmm_position_id:t.id.id,clmm_pool_id:t.pool,tick_lower_index:Bn(BigInt(t.tick_lower_index.fields.bits)),tick_upper_index:Bn(BigInt(t.tick_upper_index.fields.bits)),rewards:[]}}static buildPool(e){const t=ft(e),n=co(e),{positions:i}=t;if(t&&i.length>0){const s=mi.buildFramsPositionNFT(i[0].fields);return{id:t.id.id,pool_id:t.pool,protocol_fee_rate:t.protocol_fee_rate,is_pause:t.is_pause,harvest_assets:{harvest_assets_handle:t.harvest_assets.fields.id.id,size:Number(t.harvest_assets.fields.size)},lp_token_type:he(n).type_arguments[0],total_supply:t.lp_token_treasury.fields.total_supply.fields.value,liquidity:t.liquidity,max_quota:t.max_quota,status:t.status===1?"STATUS_RUNNING":"STATUS_REBALANCING",quota_based_type:t.quota_based_type.fields.name,position:s}}}static async getSuiCoin(e,t,n){const i=await e.ClmmSDK.getOwnerCoinAssets(e.getVerifySenderAddress(),Nc);n=n||new ye;let s;if(t>95e10){const[o,...r]=i;r.length>0&&n.mergeCoins(n.object(o.coinObjectId),r.map(a=>n.object(a.coinObjectId))),s=n.splitCoins(n.object(o.coinObjectId),[t])}else s=Je.buildCoinForAmount(n,i,BigInt(t),Nc,!1,!0).targetCoin;return s}},Wo=class{static calculatePositionShare(e,t,n,i,s,o,r){if(t<=s||e>=o)return"0";let a=0;e<s?a=s:a=e;let c=0;t<o?c=t:c=o;const u=qe.tickIndexToSqrtPriceX64(a),l=qe.tickIndexToSqrtPriceX64(c),{coinA:d,coinB:h}=pn.getCoinAmountFromLiquidity(new y(n),new y(r),u,l,!0);return L(d.toString()).mul(i).div(1e12).add(h.toString()).toString()}static buildFramsPool(e){const t=ft(e);if(t)try{const n=[];return t.rewarders.forEach(s=>{n.push({reward_coin:he(s.fields.name).full_address,last_reward_time:"",emission_per_second:"",total_allocate_point:"",allocate_point:""})}),{id:t.id.id,clmm_pool_id:t.clmm_pool_id,effective_tick_lower:Bn(BigInt(t.effective_tick_lower.fields.bits)),effective_tick_upper:Bn(BigInt(t.effective_tick_upper.fields.bits)),total_share:t.total_share,rewarders:n,positions:{positions_handle:t.positions.fields.id.id,size:t.positions.fields.size},sqrt_price:t.sqrt_price}}catch(n){console.log(n)}}static buildFramsPositionNFT(e){const t=ft(e);if(t){const n=t.clmm_postion.fields;return{id:t.id.id,url:n.url,pool_id:t.pool_id,coinTypeA:he(n.coin_type_a.fields.name).full_address,coinTypeB:he(n.coin_type_b.fields.name).full_address,description:n.description,name:n.name,liquidity:n.liquidity,clmm_position_id:n.id.id,clmm_pool_id:n.pool,tick_lower_index:Bn(BigInt(n.tick_lower_index.fields.bits)),tick_upper_index:Bn(BigInt(n.tick_upper_index.fields.bits)),rewards:[]}}}},zr=class{static buildOrderLimitEvent(e,t){const{events:n}=e,i=[];return n&&n.forEach(s=>{const o=he(s.type).name;if(t.includes(o)){const r={digest:e.digest,type:o,timestampMs:e.timestampMs,parsedJson:s.parsedJson};i.push(r)}}),i}static buildLimitOrderInfo(e){const t=ft(e),n=co(e);if(t&&n)try{const i=he(n),s={pay_coin_type:i.type_arguments[0],target_coin_type:i.type_arguments[1],canceled_ts:t.canceled_ts==="18446744073709551615"?0:Number(t.canceled_ts),id:t.id.id,obtained_amount:t.obtained_amount,owner:t.owner,rate:t.rate,rate_order_indexer_id:t.rate_order_indexer_id,expire_ts:Number(t.expire_ts),total_pay_amount:t.total_pay_amount,pay_balance:t.pay_balance,target_balance:t.target_balance,claimed_amount:t.claimed_amount,status:"Running",created_ts:Number(t.created_ts)};return s.canceled_ts===0?(s.status="Running",L(s.pay_balance).eq(0)?s.status="Completed":L(s.pay_balance).lessThan(s.total_pay_amount)&&(s.status="PartialCompleted")):s.status="Cancelled",s}catch(i){console.log(i)}}static rateToPrice(e,t,n){const i=18+t-n;return L(10**i).div(e).toString()}static priceToRate(e,t,n){const i=18+t-n;return L(10).pow(i).div(L(e)).toFixed(0).toString()}},od=class{static async getExchangeRateForStake(e,t,n){const{vaults:i}=e.sdkOptions,{haedal:s}=G(i);if(s===void 0)throw Error("the haedal config is undefined");const{simulationAccount:o}=e.ClmmSDK.sdkOptions,{staking_id:r}=G(s);try{const a=new ye;t?await this.requestStake(e,n||1e9,a):a.moveCall({target:`${s.published_at}::staking::get_exchange_rate`,typeArguments:[],arguments:[a.object(r)]});const c=await e.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:t?e.ClmmSDK.senderAddress:o.address});if(console.log("getExchangeRateForStake res: ",c),t){const d=c.events.find(v=>v.type.includes("UserStaked")),{sui_amount:h,st_amount:g}=d.parsedJson,b=L(h).div(g).toString();return console.log({st_amount:g,sui_amount:h,rate:b}),b}const u=c.results[0].returnValues[0][0],l=ta.de("u64",Uint8Array.from(u))/1e6;return console.log("rate ",ta.de("u64",Uint8Array.from(u))),l.toString()}catch(a){console.log("getExchangeRateForHaedal",a)}return"0"}static async requestStake(e,t,n){var o,r;const{vaults:i}=e.sdkOptions;n=n||new ye;const s=await mi.getSuiCoin(e,t,n);return n.moveCall({target:`${(r=(o=i.config)==null?void 0:o.haedal)==null?void 0:r.published_at}::interface::request_stake`,typeArguments:[],arguments:[n.object(vn("0x5")),n.object(i.config.haedal.config.staking_id),s,n.pure(vn("0x0"))]}),n}static requestStakeCoin(e,t,n){const{haedal:i}=e.sdkOptions.vaults.config;return t.moveCall({target:`${i.published_at}::staking::request_stake_coin`,typeArguments:[],arguments:[t.object(vn("0x5")),t.object(i.config.staking_id),n,t.pure(vn("0x0"))]})}},rd=class{static async getExchangeRateForStake(e,t,n){const{vaults:i}=e.sdkOptions,{volo:s}=G(i);if(s===void 0)throw Error("the volo config is undefined");const{simulationAccount:o}=e.ClmmSDK.sdkOptions,{native_pool:r,vsui_metadata:a}=G(s);try{const c=new ye;t?await this.requestStake(e,n||1e9,c):c.moveCall({target:`${s.published_at}::native_pool::get_ratio`,typeArguments:[],arguments:[c.object(r),c.object(a)]});const u=await e.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:t?e.ClmmSDK.senderAddress:o.address});if(t){const h=u.events.find(v=>v.type.includes("StakedEvent")),{cert_amount:g,sui_amount:b}=h.parsedJson;return L(b).div(g).toString()}const l=u.results[0].returnValues[0][0];console.log({returnValues:l});const d=ta.de("u256",Uint8Array.from(l))/1e18;return L(1).div(d).toString()}catch(c){console.log("getExchangeRateForHaedal",c)}return"0"}static async requestStake(e,t,n){const{vaults:i}=e.sdkOptions,{volo:s}=G(i);if(s===void 0)throw Error("the volo config is undefined");n=n||new ye;const{native_pool:o,vsui_metadata:r}=G(s),a=await mi.getSuiCoin(e,t,n);return n.moveCall({target:`${s.published_at}::native_pool::stake`,typeArguments:[],arguments:[n.object(o),n.object(r),n.object(vn("0x5")),a]}),n}static requestStakeCoin(e,t,n){const{vaults:i}=e.sdkOptions,{volo:s}=G(i);if(s===void 0)throw Error("the volo config is undefined");t=t||new ye;const{native_pool:o,vsui_metadata:r}=G(s);return t.moveCall({target:`${s.published_at}::native_pool::stake_non_entry`,typeArguments:[],arguments:[t.object(o),t.object(r),t.object(vn("0x5")),n]})}},ad=class{static async getExchangeRateForStake(e,t,n){const{vaults:i}=e.sdkOptions,{aftermath:s}=G(i);if(s===void 0)throw Error("the aftermath config is undefined");const{simulationAccount:o}=e.ClmmSDK.sdkOptions,{staked_sui_vault:r,safe:a}=G(s);try{const c=new ye;t?await this.requestStake(e,n||1e9,c):c.moveCall({target:`${s.published_at}::staked_sui_vault::afsui_to_sui_exchange_rate`,typeArguments:[],arguments:[c.object(r),c.object(a)]});const u=await e.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:t?e.ClmmSDK.senderAddress:o.address});if(t){const h=u.events.find(v=>v.type.includes("StakedEvent")),{afsui_amount:g,sui_amount:b}=h.parsedJson;return L(b).div(g).toString()}const l=u.results[0].returnValues[0][0];return(ta.de("u128",Uint8Array.from(l))/1e18).toString()}catch(c){console.log("getExchangeRateForHaedal",c)}return"0"}static async requestStake(e,t,n){const{vaults:i}=e.sdkOptions,{aftermath:s}=G(i);if(s===void 0)throw Error("the aftermath config is undefined");n=n||new ye;const{staked_sui_vault:o,referral_vault:r,safe:a,validator_address:c}=G(s),u=await mi.getSuiCoin(e,t,n);return n.moveCall({target:`${s.published_at}::staked_sui_vault::request_stake_and_keep`,typeArguments:[],arguments:[n.object(o),n.object(a),n.object(vn("0x5")),n.object(r),u,n.pure(vn(c))]}),n}static requestStakeCoin(e,t,n){const{vaults:i}=e.sdkOptions,{aftermath:s}=G(i);if(s===void 0)throw Error("the aftermath config is undefined");t=t||new ye;const{staked_sui_vault:o,referral_vault:r,safe:a,validator_address:c}=G(s);return t.moveCall({target:`${s.published_at}::staked_sui_vault::request_stake`,typeArguments:[],arguments:[t.object(o),t.object(a),t.object(vn("0x5")),t.object(r),n,t.pure(vn(c))]})}},a4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e="all",t=!1){const{package_id:n}=this._sdk.sdkOptions.ido,i=`${n}_getPoolImmutables`,s=this.getCache(i,t),o={data:[],hasNextPage:!1},r=[];if(s!==void 0&&r.push(...s),r.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::oversubscribe_pool::CreatePoolEvent`},e);a.data.forEach(c=>{const u=c.parsedJson;if(u){const l=Dn.buildIdoPoolImmutables(u);r.push(l)}}),o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,this.updateCache(i,r,We)}catch(a){console.log("getPoolImmutables",a)}return o.data=r,o}async getPools(e=[],t=!1){const n=[];let i=[];e.length>0?i=[...e]:(await this.getPoolImmutables("all",t)).data.forEach(r=>{i.push(r.pool_address)});const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0});for(const o of s){const r=Dn.buildIdoPool(o);await Dn.calculatePoolUiPrice(this._sdk,r),n.push(r);const a=`${r.pool_address}_getPoolObject`;this.updateCache(a,r,We)}return n}async getPool(e,t=!0){const n=`${e}_getPoolObject`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=Dn.buildIdoPool(s);return await Dn.calculatePoolUiPrice(this._sdk,o),this.updateCache(n,o),o}async getIdoConfigs(e=!1){var c;const{package_id:t}=this._sdk.sdkOptions.ido,n=`${t}_getInitEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showPreviousTransaction:!0}}),o=qa(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",package_version_id:""};return r.length>0&&(r.forEach(u=>{console.log("item: ",u);const l=u.parsedJson;if(l)switch(he(u.type).full_address){case`${t}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.package_version_id=l.package_version_id;break;case`${t}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,We)),a}async getPurchaseInfo(e,t,n=!0){const i=`${e}_${t}_getPurchaseInfo`,s=this.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:t}}),r=Dn.buildPurchaseInfo(ft(o));return this.updateCache(i,r,Ti),r}catch{return}}async getLockNFT(e,t=!1){const n=`${e}_getLockNFT`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return io(s)}async getLockNFTList(e){var s;const{clmm_pool:t}=this._sdk.ClmmSDK.sdkOptions,{ido:n}=this._sdk.sdkOptions,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{filter:{StructType:`${n.package_id}::lock::LockedNFT<${t.package_id}::position::Position>`},options:{showContent:!0}}))==null?void 0:s.data;for(const r of o){const a=ft(r);if(a){const c=a.nft.fields,u={locked_at:Number(a.locked_at),lock_duration:Number(a.lock_duration),lock_nft_id:a.id.id,type:a.nft.type,...c};u.end_lock_time=u.locked_at+u.lock_duration,u.coin_type_a=he(c.coin_type_a.fields.name).full_address,u.coin_type_b=he(c.coin_type_b.fields.name).full_address,u.id=c.id.id,u.tick_lower_index=Bn(BigInt(c.tick_lower_index.fields.bits)),u.tick_upper_index=Bn(BigInt(c.tick_upper_index.fields.bits)),i.push(u)}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPool(e){const{ido:t}=this.sdk.sdkOptions;Dc(ni(e.coin_type_sale),ni(e.coin_type_raise))&&(e.price_min=L(1).div(e.price_max).toNumber(),e.price_max=L(1).div(e.price_min).toNumber());const i=ii.priceRealToFix(Number(e.price),e.sale_decimals,e.raise_decimals),s=qe.priceToSqrtPriceX64(L(e.price_min),e.sale_decimals,e.raise_decimals).toString(),o=qe.priceToSqrtPriceX64(L(e.price_max),e.sale_decimals,e.raise_decimals).toString(),r=new ye,a=L(e.total_supply).add(L(e.total_supply).mul(L(e.liquidity_injection_ratio))).toNumber(),c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_sale),u=Je.buildCoinForAmount(r,c,BigInt(a),e.coin_type_sale,!1),l=[r.pure(G(t).admin_cap_id),r.pure(G(t).package_version_id),r.pure(G(t).pools_id),r.pure(ni(e.owner)),r.pure(L(i).mul(Mo).toString()),r.pure(e.total_supply),r.pure(e.complete_raise_limit),r.pure(e.min_purchase_amount),r.pure(e.max_purchase_amount),r.pure(e.start_time),r.pure(e.purchase_duration),r.pure(e.lock_up_duration),r.pure((e.liquidity_injection_ratio*_w).toString()),r.pure(s),r.pure(o),r.pure(e.tick_spacing.toString()),u.targetCoin,r.pure(e.protection_hard_cap.toString()),r.pure(Ce)],d=[e.coin_type_sale,e.coin_type_raise];return r.moveCall({target:`${t.published_at}::${n4}::create_oversubscribe_pool`,typeArguments:d,arguments:l}),r}async creatPurchasePayload(e){const{ido:t}=this.sdk.sdkOptions,n=new ye,i=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1),s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_raise),o=Je.buildCoinForAmount(n,s,BigInt(e.raise_amount),e.coin_type_raise,!1),r=[e.coin_type_sale,e.coin_type_raise];let a,c;return i?(c="purchase",a=[n.object(G(t).package_version_id),n.object(e.pool_address),n.object(i.purchase_certificate_id),n.pure(e.raise_amount.toString()),o.targetCoin,n.pure(Ce)]):(c="create_certificate_and_purchase",a=[n.object(G(t).package_version_id),n.object(e.pool_address),n.pure(e.raise_amount.toString()),o.targetCoin,n.pure(Ce)]),n.moveCall({target:`${t.published_at}::${Ai}::${c}`,typeArguments:r,arguments:a}),n}async redeemPayload(e){const{ido:t}=this.sdk.sdkOptions,n=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1);if(n===void 0)throw Error("get purchase certificate fail");const i=new ye,s=[e.coin_type_sale,e.coin_type_raise],o=[i.pure(G(t).package_version_id),i.pure(e.pool_address),i.pure(n.purchase_certificate_id),i.pure(Ce)];return i.moveCall({target:`${t.published_at}::${Ai}::redeem`,typeArguments:s,arguments:o}),i}injectLiquidityPayload(e){const{ido:t}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new ye,s=[e.coin_type_sale,e.coin_type_raise],o=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",r=[i.pure(G(t).package_version_id),i.pure(e.pool_address),i.pure(G(n).global_config_id),i.pure(e.clmm_pool_address),i.pure(Ce)];return i.moveCall({target:`${t.published_at}::${Ai}::${o}`,typeArguments:s,arguments:r}),i}unPauseInjectLiquidity(e){const{ido:t}=this.sdk.sdkOptions,{integrate:n,clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new ye;s.moveCall({target:`${n.published_at}::${Yr}::unpause_pool`,typeArguments:[e.coin_type_a,e.coin_type_b],arguments:[s.object(G(i).global_config_id),s.object(e.clmm_pool_address)]});const o=[e.coin_type_sale,e.coin_type_raise],r=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",a=[s.object(G(t).package_version_id),s.object(e.pool_address),s.object(G(i).global_config_id),s.object(e.clmm_pool_address),s.object(Ce)];return s.moveCall({target:`${t.published_at}::${Ai}::${r}`,typeArguments:o,arguments:a}),s}async findClmmPoolForLiquidity(e){let t=null,n=!1;const i=await this.sdk.ClmmSDK.Pool.getPoolImmutables();for(const s of i){if(s.coinTypeA===e.coin_type_sale&&s.coinTypeB===e.coin_type_raise&&Number(s.tickSpacing)===e.tick_spacing){t=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress);break}if(s.coinTypeA===e.coin_type_raise&&s.coinTypeB===e.coin_type_sale&&Number(s.tickSpacing)===e.tick_spacing){t=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress),n=!0;break}}return t&&(L(t.current_sqrt_price).lessThanOrEqualTo(e.current_sqrt_price_min)||L(t.current_sqrt_price).greaterThanOrEqualTo(e.current_sqrt_price_max))?(console.log("clmmPool: ",t.poolAddress),{is_reverse:n,clmmPool:null}):{is_reverse:n,clmmPool:t}}withdrawPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.object(G(t).package_version_id),n.object(e.pool_address),n.object(Ce)];return n.moveCall({target:`${t.published_at}::${Ai}::withdraw`,typeArguments:i,arguments:s}),n}updateWhitelistCapPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new ye,i=[e.coin_type_sale,e.coin_type_raise];return e.add_whites&&e.add_whites.addresses.length>0&&n.moveCall({target:`${t.published_at}::${Ai}::add_white_listed_addresses`,typeArguments:i,arguments:[n.object(G(t).admin_cap_id),n.object(G(t).package_version_id),n.object(e.pool_address),n.makeMoveVec({type:"address",objects:e.add_whites.addresses.map(s=>n.object(vn(s)))}),n.pure(e.add_whites.protection_limit),n.object(Ce)]}),e.remove_whites&&e.remove_whites.length>0&&n.moveCall({target:`${t.published_at}::${Ai}::remove_white_listed_addresses`,typeArguments:i,arguments:[n.object(G(t).admin_cap_id),n.object(G(t).package_version_id),n.object(e.pool_address),n.makeMoveVec({type:"address",objects:e.remove_whites.map(s=>n.object(vn(s)))}),n.object(Ce)]}),e.update_whites&&e.update_whites.forEach(s=>{n.moveCall({target:`${t.published_at}::${Ai}::update_white_listed_address`,typeArguments:i,arguments:[n.object(G(t).admin_cap_id),n.object(G(t).package_version_id),n.object(e.pool_address),n.object(s.address),n.pure(s.protection_limit),n.object(Ce)]})}),n}creatCancelPoolPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new ye,i=[e.coin_type_sale,e.coin_type_raise],s=[n.pure(G(t).admin_cap_id),n.pure(G(t).package_version_id),n.pure(e.pool_address),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::${Ai}::cancel`,typeArguments:i,arguments:s}),n}updatePoolOwnerPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new ye:t;const i=[e.coin_type_sale,e.coin_type_raise],s=[t.object(G(n).admin_cap_id),t.object(G(n).package_version_id),t.object(e.pool_address),t.object(e.new_owner),t.object(Ce)];return t.moveCall({target:`${n.published_at}::${Ai}::update_pool_owner`,typeArguments:i,arguments:s}),t}updatePoolDuractionPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new ye:t;const i=[e.coin_type_sale,e.coin_type_raise],s=[t.object(G(n).admin_cap_id),t.object(G(n).package_version_id),t.object(e.pool_address),t.pure(e.start_time),t.pure(e.purchase_duration),t.pure(e.lock_duration),t.object(Ce)];return t.moveCall({target:`${n.published_at}::${Ai}::update_pool_duration`,typeArguments:i,arguments:s}),t}updateProtectionHardCapPayload(e,t){const{ido:n}=this.sdk.sdkOptions;t=t===void 0?new ye:t;const i=[e.coin_type_sale,e.coin_type_raise],s=[t.object(G(n).admin_cap_id),t.object(G(n).package_version_id),t.object(e.pool_address),t.pure(e.protection_hard_cap),t.object(Ce)];return t.moveCall({target:`${n.published_at}::${Ai}::update_protection_hard_cap`,typeArguments:i,arguments:s}),t}unlockNftPayload(e){const{ido:t}=this.sdk.sdkOptions,n=new ye,i=[e.nft_type],s=[n.pure(e.lock_nft_id),n.pure(Ce)];return n.moveCall({target:`${t.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(e){const{ido:t}=this._sdk.sdkOptions,n=`${t.package_id}_${e}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:G(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=co(s),r=Fc(s);let a=!1;return r&&o&&he(o).source_address===`${t.package_id}::config::AdminCap`&&(a=ni(r.AddressOwner)===ni(e)),this.updateCache(n,a,We),a}async getWhiteProtectionLimit(e,t,n=!0){const i=`${e}_${t}_getWhiteProtectionLimit`,s=this._sdk.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:t}});if(o&&o.data){const r=ft(o);return this._sdk.updateCache(i,r.value),r.value}return}catch{return}}async getWhiteList(e,t){var i;const n={type:"address",value:t};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:n}),o=ft(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getAdminAddress(){const{ido:e}=this._sdk.sdkOptions,t=`${G(e).admin_cap_id}_getAdminAddress`,n=this.getCache(t);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:G(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(i);const s=co(i),o=Fc(i);if(o&&s&&he(s).source_address===`${e.package_id}::config::AdminCap`){const a=ni(o.AddressOwner);return this.updateCache(t,a,We),a}return""}updateCache(e,t,n=We){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},c4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,t=!0){const{xtoken:n}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,s=this.getCache(i,t);if(s!==void 0)return s;let o;const r=`${n.package_id}::xtoken::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=he(Wi(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...al(c),id:l.id.id,index:l.index,type:u,xtoken_balance:l.xtoken_balance},this.updateCache(i,o,We)}}),o}async getOwnerLockTokens(e){const{xtoken:t}=this.sdk.sdkOptions,n=[],i=`${t.package_id}::lock_coin::LockedCoin<${this.buileTokenCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(he(Wi(o)).source_address===i&&o.data){const a=Vs.buildLockToken(o.data.content),c=await this.getLockXToken(a.id);c&&(a.xtoken_amount=c.xtoken_amount),n.push(a)}return n}async getLockToken(e){var n;const t=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((n=t.data)!=null&&n.content){const i=Vs.buildLockToken(t.data.content),s=await this.getLockXToken(i.id);return s&&(i.xtoken_amount=s.xtoken_amount),i}}async getOwnerTokenCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileTokenCoinType())}mintVeNFTPayload(){const{xtoken:e}=this.sdk.sdkOptions,t=new ye;return t.moveCall({target:`${e.published_at}::${$o}::mint_venft`,typeArguments:[],arguments:[t.pure(G(e).xtoken_manager_id)]}),t}async convertPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new ye,i=this.buileTokenCoinType(),s=await Je.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(e.amount),i);return e.venft_id===void 0?n.moveCall({target:`${t.published_at}::${$o}::mint_and_convert`,typeArguments:[],arguments:[n.object(G(t).lock_manager_id),n.object(G(t).xtoken_manager_id),s,n.pure(e.amount)]}):n.moveCall({target:`${t.published_at}::${$o}::convert`,typeArguments:[],arguments:[n.object(G(t).lock_manager_id),n.object(G(t).xtoken_manager_id),s,n.pure(e.amount),n.pure(e.venft_id)]}),n}redeemLockPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${$o}::redeem_lock`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.amount),n.pure(e.lock_day),n.pure(Ce)]}),n}redeemPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${$o}::redeem`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ce)]}),n}redeemDividendPayload(e,t){const{xtoken_dividends:n}=this.sdk.sdkOptions,i=new ye;return t.forEach(s=>{i.moveCall({target:`${n.published_at}::${sd}::redeem`,typeArguments:[s],arguments:[i.object(G(n).dividend_manager_id),i.object(e)]})}),i}redeemDividendV2Payload(e,t,n){const{xtoken_dividends:i}=this.sdk.sdkOptions;let s=new ye;return t.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(e,s)),t.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${sd}::redeem_v2`,typeArguments:[r],arguments:[s.object(G(i).dividend_manager_id),s.object(e),s.object(Ce)]})}),s}redeemDividendXTokenPayload(e,t){const{xtoken_dividends:n,xtoken:i}=this.sdk.sdkOptions,{xtoken_manager_id:s,lock_manager_id:o}=G(i),{dividend_manager_id:r}=G(n);return t=t===void 0?new ye:t,t.moveCall({target:`${n.published_at}::${sd}::redeem_xtoken`,typeArguments:[],arguments:[t.object(o),t.object(s),t.object(r),t.object(e),t.object(Ce)]}),t}buileTokenCoinType(){return`${this.sdk.sdkOptions.token_faucet.package_id}::token::TOKEN`}buileXTokenCoinType(e=this._sdk.sdkOptions.xtoken.package_id,t="xtoken",n="XTOKEN"){return`${e}::${t}::${n}`}cancelRedeemPayload(e){const{xtoken:t}=this.sdk.sdkOptions,n=new ye;return n.moveCall({target:`${t.published_at}::${$o}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(G(t).lock_manager_id),n.pure(G(t).xtoken_manager_id),n.pure(e.venft_id),n.pure(e.lock_id),n.pure(Ce)]}),n}async getInitConfigs(){var r,a;const{package_id:e}=this.sdk.sdkOptions.xtoken,t=`${e}_getInitFactoryEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::xtoken::InitEvent`}))==null?void 0:r.data,s={xtoken_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xtoken_manager_id=u.xtoken_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id,this.updateCache(t,s,We),s}async getLockUpManager(e=G(this.sdk.sdkOptions.xtoken).lock_manager_id,t=!1){const n=`${e}_getLockUpManagerEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=Vs.buildLockUpManager(ft(s));return this.updateCache(n,o,We),o}async getLockInfoHandle(e){const t=`${e}_getLockInfoHandle`,n=this.getCache(t);if(n!==void 0)return n;let i="";const s=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=ft(s);return o&&(i=o.lock_infos.fields.id.id,this.updateCache(t,i,We)),i}async getDividendConfigs(){var o;const{package_id:e}=this.sdk.sdkOptions.xtoken_dividends,t=`${e}_getDividendManagerEvent`,n=this.getCache(t);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(t,s,We))}),s}async getDividendManager(e=!1){const{dividend_manager_id:t}=G(this.sdk.sdkOptions.xtoken_dividends),n=`${t}_getDividendManager`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=ft(s),r=Vs.buildDividendManager(o);return this.updateCache(n,r,We),r}async getXcetusManager(e=!0){const{xtoken_manager_id:t}=G(this.sdk.sdkOptions.xtoken),n=`${t}_getXcetusManager`,i=this.getCache(n,e);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=ft(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(e,t){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=ft(n);return Vs.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=L(Oi).mul(L(n.max_lock_day).sub(L(t))).mul(L(n.max_percent_numerator).sub(L(n.min_percent_numerator))).div(L(n.max_lock_day).sub(L(n.min_lock_day))),s=L(Oi).mul(L(n.max_percent_numerator)).sub(i).div(L(zc)).div(Oi);return{amountOut:L(s).mul(L(e)).round().toString(),percent:s.toString()}}async reverseRedeemNum(e,t){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=L(Oi).mul(L(n.max_lock_day).sub(L(t))).mul(L(n.max_percent_numerator).sub(L(n.min_percent_numerator))).div(L(n.max_lock_day).sub(L(n.min_lock_day))),s=L(Oi).mul(L(n.max_percent_numerator)).sub(i).div(L(zc)).div(Oi);return{amountOut:L(e).div(s).toFixed(0,ie.ROUND_UP),percent:s.toString()}}async getLockXToken(e){const{lock_handle_id:t}=G(this._sdk.sdkOptions.xtoken),n=`${e}_getXTokenAmount`,i=this.getCache(n);if(i)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),o=ft(s);if(o){const r=o.value.fields.value.fields;return this.updateCache(n,r,We),r}}catch{}}async getVeNftAmount(e,t){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),i=ft(n);if(i){const{lock_amount:s,xtoken_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xtoken_amount:o}}}catch{}return{lock_amount:"0",xtoken_amount:"0"}}async getPhaseDividendInfo(e,t=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${e}_getPhaseDividendInfo`,o=this._sdk.getCache(s,t);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),a=ft(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),h={id:Hi(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,h),h}catch{}}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},u4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async addMasterLiquidity(e){var v,k;const{liquidity_stratefy:t}=this._sdk.sdkOptions,{clmm_pool:n}=this._sdk.ClmmSDK.sdkOptions,i=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);let s=L(0),o=L(0);const r=[],a=[],c=[],u=[],l=[];e.liquidity_bins.forEach((E,N)=>{const A=e.amounts_a[N],P=e.amounts_b[N],B=e.bins_fix_amount_a[N];s=s.add(A),o=o.add(P),r.push(A),a.push(P),c.push(Gn(BigInt(E.tick_lower)).toString()),u.push(Gn(BigInt(E.tick_upper)).toString()),l.push(B)});const d=[e.coinTypeA,e.coinTypeB],h=new ye,g=(v=Je.buildAddLiquidityFixTokenCoinInput(h,!e.fix_amount_a,s.toString(),e.slippage,e.coinTypeA,i,!1))==null?void 0:v.targetCoin,b=(k=Je.buildAddLiquidityFixTokenCoinInput(h,e.fix_amount_a,o.toString(),e.slippage,e.coinTypeB,i,!1))==null?void 0:k.targetCoin;return i4(e)?h.moveCall({target:`${t.published_at}::router::increase_liquidity`,typeArguments:d,arguments:[h.object(G(t).master_manger_id),h.object(e.master_address),h.object(G(n).global_config_id),h.object(e.pool_address),g,b,h.pure(r.map(E=>h.pure(E,"u64"))),h.pure(a.map(E=>h.pure(E,"u64"))),h.pure(l.map(E=>h.pure(E,"bool"))),h.object(Ce)]}):h.moveCall({target:`${t.published_at}::router::create_master_liquidity`,typeArguments:d,arguments:[h.object(G(t).master_manger_id),h.object(G(n).global_config_id),h.object(e.pool_address),g,b,h.pure(c.map(E=>h.pure(E,"u32"))),h.pure(u.map(E=>h.pure(E,"u32"))),h.pure(r.map(E=>h.pure(E,"u64"))),h.pure(a.map(E=>h.pure(E,"u64"))),h.pure(l.map(E=>h.pure(E,"bool"))),h.pure(e.strategy),h.pure(Gn(BigInt(e.tick_lower)).toString()),h.pure(Gn(BigInt(e.tick_upper)).toString()),h.object(Ce)]}),h}buildMasterNFTType(){return`${this._sdk.sdkOptions.liquidity_stratefy.package_id}::master_liquidity::MasterLiquidity`}async getMasterNFTList(e,t=[]){const n=[],i=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.liquidity_stratefy.package_id}}),s=t.length>0;for(const o of i.data)if(he(o.data.type).full_address===this.buildMasterNFTType()){const a=cs.buildMasterNFT(o);if(a){const c=`${a.id}_masterNFT`;this.updateCache(c,a,We),s?t.includes(a.pool_id)&&n.push(a):n.push(a)}}return n}async getMasterNFT(e,t=!1){const n="$masterId}_masterNFT",i=this.getCache(n,t);if(i)return i;try{const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(he(s.data.type).full_address===this.buildMasterNFTType()){const r=cs.buildMasterNFT(s);return r&&this.updateCache(n,r,We),r}}catch(s){console.log(s)}}async fetchMasterPositionInfos(e){var a;const t={},{clmm_pool:n,integrate:i,simulationAccount:s}=this.sdk.ClmmSDK.sdkOptions,o=new ye;return e.forEach(c=>{c.position_ids.forEach(u=>{const l=[c.coinTypeA,c.coinTypeB],d=[o.object(G(n).global_config_id),o.object(c.pool_id),o.object(u)];o.moveCall({target:`${i.published_at}::${qi}::fetch_position_fees`,arguments:d,typeArguments:l}),o.moveCall({target:`${i.published_at}::${qi}::fetch_position_rewards`,arguments:[...d,o.object(Ce)],typeArguments:l})})}),(a=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:s.address})).events)==null||a.forEach(c=>{const{parsedJson:u}=c,{position_id:l}=u;let d=t[l];switch(d===void 0&&(d={position_id:l,feeOwedA:"0",feeOwedB:"0",rewarders:[]},t[l]=d),he(c.type).name){case"FetchPositionFeesEvent":d.feeOwedA=u.fee_owned_a,d.feeOwedB=u.fee_owned_b;break;case"FetchPositionRewardsEvent":d.rewarders=u.data;break}}),t}async getLiquidityStrategyConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.liquidity_stratefy,n=`${t}_getLiquidityStrategyConfigst`,i=this.getCache(n,e);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::master_liquidity::MasterLiquidityManagerCreatedEvent`})).data,o={master_manger_id:"",master_liquidity_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.master_manger_id=a.id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:a.id,options:{showContent:!0}}),u=ft(c);o.master_liquidity_handle=u.position_maps.fields.id.id;break}this.updateCache(n,o,We)}return o}removeMasterLiquidity(e){const{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new ye,s=[e.coinTypeA,e.coinTypeB];this.collectReward({coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collect_fee:!1,rewarder_coin_types:e.rewarder_coin_types,master_address:e.master_address,pool_address:e.pool_address},i);const o=[i.object(G(n).master_manger_id),i.object(e.pool_address),i.object(e.master_address),i.object(G(t).global_config_id),i.pure(e.delta_liquidities.map(r=>i.pure(r,"u128"))),i.pure(e.min_amounts_a.map(r=>i.pure(r,"u64"))),i.pure(e.min_amounts_b.map(r=>i.pure(r,"u64"))),i.object(Ce)];return i.moveCall({target:`${n.published_at}::${Za}::remove_liquidity`,typeArguments:s,arguments:o}),i}closeMasterLiquidity(e){const{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new ye,s=[e.coinTypeA,e.coinTypeB];return this.collectReward({coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collect_fee:!1,rewarder_coin_types:e.rewarder_coin_types,master_address:e.master_address,pool_address:e.pool_address},i),i.moveCall({target:`${n.published_at}::${Za}::close_master_liquidity`,typeArguments:s,arguments:[i.object(G(n).master_manger_id),i.object(e.master_address),i.object(G(t).global_config_id),i.object(e.pool_address),i.pure(e.min_amounts_a.map(o=>i.pure(o,"u64"))),i.pure(e.min_amounts_b.map(o=>i.pure(o,"u64"))),i.object(Ce)]}),i}collectFee(e,t){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;t=t===void 0?new ye:t;const s=[e.coinTypeA,e.coinTypeB],o=[t.object(G(i).master_manger_id),t.object(e.master_address),t.object(G(n).global_config_id),t.object(e.pool_address)];return t.moveCall({target:`${i.published_at}::${Za}::collect_fee`,typeArguments:s,arguments:o}),t}collectReward(e,t){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;return t=t===void 0?new ye:t,e.collect_fee&&this.collectFee({...e},t),e.rewarder_coin_types.forEach(s=>{const o=[e.coinTypeA,e.coinTypeB,s];if(t){const r=[t.object(G(i).master_manger_id),t.object(e.master_address),t.object(G(n).global_config_id),t.object(e.pool_address),t.object(G(n).global_vault_id),t.object(Ce)];t.moveCall({target:`${i.published_at}::${Za}::collect_reward`,typeArguments:o,arguments:r})}}),t}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},l4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}buildCoinInput(e,t,n,i,s){const{selectedCoins:o,remainingCoins:r}=Zt.selectCoinAssetGreaterThanOrEqual(t,BigInt(i)),a=Zt.calculateTotalBalance(o);if(a<BigInt(i))throw new Error(`The amount(${a}) is Insufficient balance for ${n} , expect ${i} `);const c=a-BigInt(i);let u;if(Zt.isSuiCoin(n))u=e.splitCoins(e.gas,[e.pure(i)]);else{const[l,...d]=o.map(h=>h.coinObjectId);u=e.object(l),d.length>0?s?e.mergeCoins(u,[...d.map(h=>e.object(h)),s]):e.mergeCoins(u,[...d.map(h=>e.object(h))]):s&&e.mergeCoins(u,[s])}return{selectedUnusedAmount:c,coinInput:u,remainingCoins:r}}async deposit(e){var d,h;console.log("1110 deposit : ",{params:e});const{vaults:t,frams:n}=this._sdk.sdkOptions,{clmm_pool:i}=this._sdk.ClmmSDK.sdkOptions,s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress()),o=new ye;let r,a;if(e.swapParams){const g=await this.handleDepositSwap(e,o,s);r=g.primaryCoinAInputs,a=g.primaryCoinBInputs}else r=(d=Je.buildAddLiquidityFixTokenCoinInput(o,!e.fix_amount_a,e.amount_a,e.slippage,e.coinTypeA,s,!1))==null?void 0:d.targetCoin,a=(h=Je.buildAddLiquidityFixTokenCoinInput(o,e.fix_amount_a,e.amount_b,e.slippage,e.coinTypeB,s,!1))==null?void 0:h.targetCoin;const c=G(t),u=G(n),l=G(i);return o.moveCall({target:`${t.published_at}::${s4}::deposit`,typeArguments:[e.coinTypeA,e.coinTypeB,e.lp_token_type],arguments:[o.object(c.vaults_manager_id),o.object(e.vault_id),o.object(u.rewarder_manager_id),o.object(u.global_config_id),o.object(e.farming_pool),o.object(l.global_config_id),o.object(e.clmm_pool),r,a,o.pure(e.amount_a),o.pure(e.amount_b),o.pure(e.fix_amount_a),o.object(Ce)]}),o}async handleDepositSwap(e,t,n){const{clmm_pool:i,integrate:s}=this._sdk.ClmmSDK.sdkOptions,{swap_amount:o,a2b:r,route_obj:a,stakeProtocol:c}=e.swapParams,u=r?e.coinTypeA:e.coinTypeB,l=Je.buildCoinForAmount(t,n,BigInt(o),u,!1),d=BigInt(l.tragetCoinAmount)-BigInt(o);let h=[];if(c){const E=this.requestStakeCoin(c,t,l.targetCoin),N=Je.buildCoinForAmount(t,l.remainCoins,BigInt(0),u,!1).targetCoin;h=r?[N,E]:[E,N]}else if(a){const E=Je.buildCoinForAmount(t,n,0n,r?e.coinTypeB:e.coinTypeA,!1),N=await Je.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,a,l,E,"",e.slippage,t);h=r?[N.fromCoin,N.toCoin]:[N.toCoin,N.fromCoin],console.log("swapCoinInputTo.isMintZeroCoin: ",E),!E.isMintZeroCoin&&E.originalSplitedCoin===void 0&&t.transferObjects([E.targetCoin],t.pure(this._sdk.getVerifySenderAddress()))}else{const E=Je.buildCoinForAmount(t,n,0n,r?e.coinTypeB:e.coinTypeA,!1),N=ns.getDefaultSqrtPriceLimit(r).toString();h=t.moveCall({target:`${s.published_at}::${Zs}::swap`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(G(i).global_config_id),t.object(e.clmm_pool),r?l.targetCoin:E.targetCoin,r?E.targetCoin:l.targetCoin,t.pure(r),t.pure(!0),t.pure(o),t.pure(N),t.pure(!1),t.object(Ce)]})}let g,b;const v=h[0],k=h[1];if(r){const E=BigInt(e.amount_a)-d;Zt.isSuiCoin(u)?(t.transferObjects([v],t.pure(this._sdk.getVerifySenderAddress())),g=t.splitCoins(t.gas,[t.pure(e.amount_a)])):E>0n?g=this.buildCoinInput(t,l.remainCoins,u,E,v).coinInput:g=v,b=k}else{g=v;const E=BigInt(e.amount_b)-d;Zt.isSuiCoin(u)?(t.transferObjects([k],t.pure(this._sdk.getVerifySenderAddress())),b=t.splitCoins(t.gas,[t.pure(e.amount_b)])):E>0n?b=this.buildCoinInput(t,l.remainCoins,u,E,k).coinInput:b=k}return{primaryCoinAInputs:g,primaryCoinBInputs:b}}async remove(e){console.log({params:e});const{vaults:t,frams:n}=this.sdk.sdkOptions,{clmm_pool:i,integrate:s}=this._sdk.ClmmSDK.sdkOptions,o=new ye,r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),e.lp_token_type),a=Je.buildCoinForAmount(o,r,BigInt(e.lp_token_amount),e.lp_token_type,!1).targetCoin,c=G(t),u=G(n),l=G(i),d=[e.coinTypeA,e.coinTypeB,e.lp_token_type],h=o.moveCall({target:`${t.published_at}::${o4}::remove`,typeArguments:d,arguments:[o.object(c.vaults_manager_id),o.object(e.vault_id),o.object(u.rewarder_manager_id),o.object(u.global_config_id),o.object(e.farming_pool),o.object(l.global_config_id),o.object(e.clmm_pool),a,o.pure(e.lp_token_amount),o.pure(e.min_amount_a),o.pure(e.min_amount_b),o.object(Ce)]}),g=h[0],b=h[1];if(e.swapParams){const{a2b:v,swap_amount:k,route_obj:E}=e.swapParams;if(E){const N={targetCoin:v?g:b,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},A={targetCoin:v?b:g,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},P=await Je.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,E,N,A,"",e.slippage,o),B=v?[P.fromCoin,P.toCoin]:[P.toCoin,P.fromCoin];v?o.mergeCoins(B[1],[b]):o.mergeCoins(B[0],[g]),o.transferObjects([...B],o.pure(this._sdk.getVerifySenderAddress()))}else{const N=ns.getDefaultSqrtPriceLimit(v).toString(),A=o.moveCall({target:`${s.published_at}::${Zs}::swap`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[o.object(G(i).global_config_id),o.object(e.clmm_pool),g,b,o.pure(v),o.pure(!0),o.pure(k),o.pure(N),o.pure(!0),o.object(Ce)]});o.transferObjects([A[0],A[1]],o.pure(this._sdk.getVerifySenderAddress()))}}else o.transferObjects([g,b],o.pure(this._sdk.getVerifySenderAddress()));return o}async getVaultList(e="all"){const{vaults:t}=this._sdk.sdkOptions,n=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t.package_id}::vaults::CreateEvent`},e),i=n.data.map(r=>r.parsedJson.id),s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}),o=[];return s.forEach(r=>{const a=mi.buildPool(r);a&&(a.stake_protocol=this.findStakeProtocol(a.position.coinTypeA,a.position.coinTypeB),this.savePoolToCache(a),o.push(a))}),n.data=o,n}findStakeProtocol(e,t){const{haedal:n,volo:i,aftermath:s}=G(this._sdk.sdkOptions.vaults),o=he(e).full_address,r=he(t).full_address;if(Zt.isSuiCoin(o)||Zt.isSuiCoin(r)){if(n){const a=he(G(n).coin_type).full_address;if(o===a||r===a)return"Haedal"}if(i){const a=he(G(i).coin_type).full_address;if(o===a||r===a)return"Volo"}if(s){const a=he(G(s).coin_type).full_address;if(o===a||r===a)return"aftermath"}}}savePoolToCache(e){const t=`${e.id}_mirrorPool`;this.updateCache(t,e,We)}readPoolFromCache(e,t=!1){const n=`${e}_mirrorPool`;return this.getCache(n,t)}async calculateMaxAvailable(e){var v;const{integrate:t,simulationAccount:n}=this.sdk.ClmmSDK.sdkOptions,i=new ye,s=qe.tickIndexToSqrtPriceX64(e.lowerTick),o=qe.tickIndexToSqrtPriceX64(e.upperTick),r=new y(e.curSqrtPrice),a=pn.getCoinAmountFromLiquidity(new y(e.input_amount),r,s,o,!1),c=[e.coinTypeA,e.coinTypeB];i.moveCall({target:`${t.published_at}::${qi}::calculate_swap_result`,arguments:[i.object(e.clmm_pool),i.pure(!0),i.pure(!0),i.pure(a.coinA.toString())],typeArguments:c}),i.moveCall({target:`${t.published_at}::${qi}::calculate_swap_result`,arguments:[i.object(e.clmm_pool),i.pure(!1),i.pure(!0),i.pure(a.coinB.toString())],typeArguments:c});const l=(v=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:v.filter(k=>he(k.type).name==="CalculatedSwapResultEvent");if(l.length===0)return null;const d=l[0].parsedJson.data,h=l[1].parsedJson.data,g=L(a.coinB.toString()).add(d.amount_out),b=L(a.coinA.toString()).add(h.amount_out);return{maxAmountB:g,maxAmountA:b}}async calculateRemoveSwapAmount(e,t){const n=mi.calculateDepositRatio(e.lowerTick,e.upperTick,new y(e.curSqrtPrice)),i=e.fix_amount_a?n.ratioA:n.ratioB;console.log({fixRatio:i});let s=L(e.receive_amount).mul(i),o,r;if(e.removeLiquidity){const v=qe.tickIndexToSqrtPriceX64(e.lowerTick),k=qe.tickIndexToSqrtPriceX64(e.upperTick),E=pn.getCoinAmountFromLiquidity(new y(e.removeLiquidity),new y(e.curSqrtPrice),v,k,!1);r=e.removeLiquidity,o=e.fix_amount_a?E.coinB.toString():E.coinA.toString(),s=e.fix_amount_a?L(E.coinA.toString()):L(E.coinB.toString())}else{const v=pn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,new y(s.toFixed(0)),e.fix_amount_a,!1,.2,new y(e.curSqrtPrice));r=v.liquidityAmount.toString(),o=e.fix_amount_a?v.coinAmountB.toString():v.coinAmountA.toString()}console.log({fixAmount:s,otherSideAmount:o});const a=!e.fix_amount_a,c=await this.clmmPreSwap(e.clmm_pool,e.curSqrtPrice,a,L(o),e.coinTypeA,e.coinTypeB,!0,e.priceSplitPoint,e.use_route,[{pool_id:e.clmm_pool,tick_lower:e.lowerTick,tick_upper:e.upperTick,delta_liquidity:Number(r),is_increase:!1}]);console.log({data:c,range:t});const u=s.add(c.amount_out),l=L(e.receive_amount),d=l.sub(u);if(console.log(`: ${u.toString()} , : ${e.receive_amount}, : ${d.toString()} `),(!e.removeLiquidity||e.removeLiquidity&&t)&&d.abs().greaterThan(l.mul(.01))){const v=u.lessThan(l);let k,E;t?v?(k=L(r),E=t.right):(k=t.left,E=L(r)):(k=L(v?r:0),E=L(v?e.maxLiquidity:r));const N=L(k).add(E).div(2).toFixed(0);if(console.log({left:k.toString(),right:E.toString(),midLiquidity:N.toString()}),!t||t&&t.count<15&&k<E)return await this.calculateRemoveSwapAmount({...e,removeLiquidity:N},{left:k,right:E,count:t?t.count+1:0})}const h=c.amount_in&&c.fee_amount?new y(c.amount_in).add(new y(c.fee_amount)).toString():c.amount_in,g=c.amount_out,{is_exceed:b}=c;return{swapInAmount:h,swapOutAmount:g,liquidity:r,is_exceed:b,routeObj:c.route_obj,request_id:e.request_id}}async calculateStakeDepositFixSui(e){const t=e.inputSuiAmount.mul(e.remainRate),n=e.inputSuiAmount.sub(e.swapSuiAmount),i=e.exchangeRate?e.exchangeRate:await this.getExchangeRateForStake(e.stakeProtocol,e.shouldRequestStake,Number(e.swapSuiAmount.toFixed(0))),s=e.swapSuiAmount.div(i).toFixed(0);console.log({swapAmount:e.swapSuiAmount.toString(),hasuiAmount:s.toString(),leftSuiAmount:e.leftSuiAmount.toString(),rightSuiAmount:e.rightSuiAmount.toString(),exchangeRate:i});const o=pn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,new y(s.toString()),!e.fixCoinA,!0,0,new y(e.curSqrtPrice)),r=e.fixCoinA?o.coinAmountA.toString():o.coinAmountB.toString(),a=L(n).sub(r);return console.log({useSuiAmount:r.toString(),hasuiAmount:s.toString(),remainSui:n.toString(),remainSuiLimit:t.toString(),actRemainSui:a.toString(),rebalanceCount:e.rebalanceCount}),a.greaterThanOrEqualTo(0)&&a.lessThanOrEqualTo(t)||e.rebalanceCount>12||e.leftSuiAmount.greaterThanOrEqualTo(e.rightSuiAmount)?{swapInAmount:e.swapSuiAmount.toFixed(0),swapOutAmount:s,afterSqrtPrice:e.curSqrtPrice,fixAmountA:!e.fixCoinA,is_exceed:!0,request_id:"",stake_protocol:e.stakeProtocol}:a.lessThan(0)?await this.calculateStakeDepositFixSui({...e,rightSuiAmount:e.swapSuiAmount,swapSuiAmount:e.swapSuiAmount.add(e.leftSuiAmount).div(2),exchangeRate:i,rebalanceCount:e.rebalanceCount+1}):a.greaterThan(t)?await this.calculateStakeDepositFixSui({...e,leftSuiAmount:e.swapSuiAmount,swapSuiAmount:e.swapSuiAmount.add(e.rightSuiAmount).div(2),exchangeRate:i,rebalanceCount:e.rebalanceCount+1}):null}async calculateDepositSwapAmount(e,t=!1){const n=qe.sqrtPriceX64ToTickIndex(new y(e.curSqrtPrice)),{ratioA:i,ratioB:s}=mi.calculateDepositRatio(e.lowerTick,e.upperTick,new y(e.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...e,currentTick:n,adjustBestAmount:t});const o=L(e.input_amount).mul(e.fix_amount_a?i:s);let r=L(e.input_amount).sub(o);console.log("1110 ",{fixAmount:o.toString(),swapAmount:r.toString()});const a=e.fix_amount_a;if(r.toFixed(0)==="0")return null;if(e.stakeProtocol){if(Zt.isSuiCoin(e.coinTypeA)&&e.fix_amount_a||Zt.isSuiCoin(e.coinTypeB)&&!e.fix_amount_a){const W=await this.calculateStakeDepositFixSui({inputSuiAmount:L(e.input_amount),swapSuiAmount:r,lowerTick:e.lowerTick,upperTick:e.upperTick,curSqrtPrice:e.curSqrtPrice,remainRate:e.remainRate?e.remainRate:.01,fixCoinA:e.fix_amount_a,rebalanceCount:0,shouldRequestStake:e.shouldRequestStake,leftSuiAmount:a?new ie(r.toFixed(0)):new ie(0),rightSuiAmount:a?new ie(e.input_amount):new ie(r.toFixed(0)),stakeProtocol:e.stakeProtocol});return W?{...W,request_id:e.request_id}:null}throw Error("Only support fix sui")}const c=n<e.lowerTick||n>e.upperTick,u={clmm_pool:e.clmm_pool,curSqrtPrice:e.curSqrtPrice,a2b:a,amount_a:a?new ie(e.input_amount):new ie(0),amount_b:a?new ie(0):new ie(e.input_amount),amount_left:a?new ie(r.toFixed(0)):new ie(0),amount_right:a?new ie(e.input_amount):new ie(r.toFixed(0)),lowerTick:e.lowerTick,upperTick:e.upperTick,tick_spacing:2,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,useRoute:e.use_route,remainRate:e.remainRate?e.remainRate:.01,priceSplitPoint:e.priceSplitPoint},l=t&&n<=e.upperTick;let d=l?await this.calculateRebalance(u):await this.clmmPreSwap(e.clmm_pool,e.curSqrtPrice,a,r,e.coinTypeA,e.coinTypeB,!0,e.priceSplitPoint,e.use_route),h=d.after_sqrt_price;const g=qe.sqrtPriceX64ToTickIndex(new y(h));console.log("1110  : ",{...d,currentTick:g},null,2);const b=g<e.lowerTick||g>e.upperTick;if(c!==b&&!l&&g<=e.upperTick){console.log("1110 , swap: ");const{ratioA:W,ratioB:Q}=mi.calculateDepositRatio(e.lowerTick,e.upperTick,new y(h));console.log("1110 ",{newAfterRatioA:W,newAfterRatioB:Q}),r=L(e.input_amount).sub(L(e.input_amount).mul(e.fix_amount_a?W:Q)),u.amount_left=a?new ie(r.toFixed(0)):new ie(0),u.amount_right=a?new ie(e.input_amount):new ie(r.toFixed(0)),d=await this.calculateRebalance(u),h=d.after_sqrt_price;const V=qe.sqrtPriceX64ToTickIndex(new y(h));console.log("1110 : ",{lowerTick:e.lowerTick,upperTick:e.upperTick,currentTick:V,afterSqrtPrice:h})}const{ratioA:v,ratioB:k}=mi.calculateDepositRatio(e.lowerTick,e.upperTick,new y(h));console.log("1110 1",{afterRatioA:v,afterRatioB:k,data:d});let E=k.div(v).sub(s.div(i)).greaterThan("0");const N=d.amount_in&&d.fee_amount?new y(d.amount_in).add(new y(d.fee_amount)).toString():d.amount_in,A=d.amount_out,{is_exceed:P}=d;if(g<e.lowerTick)E=!0;else if(g>e.upperTick)E=!1;else{const W=E===a?new y(L(e.input_amount).sub(N).toString()):new y(A),Q=pn.estLiquidityAndcoinAmountFromOneAmounts(e.lowerTick,e.upperTick,W,E,!0,0,new y(h)),V=Q.coinAmountA,ee=Q.coinAmountB,j=L(e.fix_amount_a?V.toString():ee.toString()).add(N);console.log("1110 :",{preAmountTotal:j.toString(),fixAmountA:E}),j.greaterThanOrEqualTo(e.input_amount)&&(E=!E)}const B={swapInAmount:N,swapOutAmount:A,afterSqrtPrice:h,is_exceed:P,fixAmountA:E,routeObj:d.route_obj,request_id:e.request_id,use_Haedal_stake:!1};return console.log(B),B}async calculateHaedalDepositSwapAmount(e){const t=qe.sqrtPriceX64ToTickIndex(new y(e.curSqrtPrice)),{ratioA:n,ratioB:i}=mi.calculateDepositRatio(e.lowerTick,e.upperTick,new y(e.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...e,currentTick:t});const s=L(e.input_amount).mul(e.fix_amount_a?n:i),o=L(e.input_amount).sub(s);console.log("1110 ",{fixAmount:s.toString(),swapAmount:o.toString()});const r=e.fix_amount_a;if(o.toFixed(0)==="0")return null;if(e.stakeProtocol){if(Zt.isSuiCoin(e.coinTypeA)&&e.fix_amount_a||Zt.isSuiCoin(e.coinTypeB)&&!e.fix_amount_a){const a=await this.calculateStakeDepositFixSui({inputSuiAmount:L(e.input_amount),swapSuiAmount:o,lowerTick:e.lowerTick,upperTick:e.upperTick,curSqrtPrice:e.curSqrtPrice,remainRate:e.remainRate?e.remainRate:.01,fixCoinA:e.fix_amount_a,rebalanceCount:0,shouldRequestStake:e.shouldRequestStake,leftSuiAmount:r?new ie(o.toFixed(0)):new ie(0),rightSuiAmount:r?new ie(e.input_amount):new ie(o.toFixed(0)),stakeProtocol:e.stakeProtocol});return a?{...a,request_id:e.request_id}:null}throw Error("Only support fix sui")}return null}async calculateRebalance(e){const{clmm_pool:t,a2b:n,curSqrtPrice:i,amount_a:s,amount_b:o,lowerTick:r,upperTick:a,amount_left:c,amount_right:u,coinTypeA:l,coinTypeB:d,useRoute:h,priceSplitPoint:g,remainRate:b}=e,v=async(k,E,N)=>{const A=k.plus(E).div(2),P=await this.clmmPreSwap(t,i,n,A,l,d,!0,g,h);if(P.amount_out==="0")return P;if(P.after_sqrt_price||(P.after_sqrt_price=e.curSqrtPrice),P.is_exceed)return E=A,v(k,E,N+1);const B=n?s.sub(P.amount_in):s.add(P.amount_out),W=n?o.add(P.amount_out):o.sub(P.amount_in),Q=qe.sqrtPriceX64ToTickIndex(new y(P.after_sqrt_price)),V=pn.estLiquidityAndcoinAmountFromOneAmounts(r,a,new y(B.toString()),!0,!0,1,new y(P.after_sqrt_price)),ee=new ie(V.coinAmountA.toString()),j=new ie(V.coinAmountB.toString());if(console.log("1110 swap ",{preRes:P,left:k.toString(),right:E.toString(),mid:A.toString(),afterPoolTickIndex:Q,afterA:B.toString(),afterB:W.toString(),usedA:ee.toString(),usedB:toString(),count:N}),ee.toString()!==B.toString())throw new Error("usedA does not match afterA");if(W.lessThan(j))n?k=A:E=A;else{n?E=A:k=A;const R=W.sub(j),U=W.mul(b);if(console.log("1110 amount ",{remainingB:R.toString(),maxRemainingB:U.toString(),remainRate:b,count:N}),U.sub(R).greaterThanOrEqualTo(0))return console.log("break"),{...P,remainingB:R}}return k.greaterThan(E)||E.sub(k).lessThan(10)?P:v(k,E,N+1)};return c.greaterThanOrEqualTo(u)?v(new ie(0),c,0):v(c,u,0)}async clmmPreSwap(e,t,n,i,s,o,r,a,c,u){var E;if(c)try{const N=await this._sdk.ClmmSDK.RouterV2.getBestRouter(n?s:o,n?o:s,Number(i.toFixed(0)),r,a,"",void 0,void 0,!0,!1,u);if(!N.result)throw new Error("route unavailable");const{result:A}=N;let P=t;return A.splitPaths.forEach(B=>{const W=B.basePaths.find(Q=>Q.poolAddress.toLowerCase()===e.toLowerCase());W&&(P=W.afterSqrtPrice.toString())}),{amount_in:A.inputAmount.toString(),amount_out:A.outputAmount.toString(),after_sqrt_price:P,is_exceed:A.isExceed,route_obj:A}}catch{throw new Error("route unavailable")}const{integrate:l,simulationAccount:d}=this.sdk.ClmmSDK.sdkOptions,h=new ye,g=[s,o],b=[h.pure(e),h.pure(n),h.pure(r),h.pure(i.toFixed(0))];h.moveCall({target:`${l.published_at}::${qi}::calculate_swap_result`,arguments:b,typeArguments:g});const k=(E=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:h,sender:d.address})).events)==null?void 0:E.filter(N=>he(N.type).name==="CalculatedSwapResultEvent");return k.length===0?null:k[0].parsedJson.data}async getVault(e,t=!1){const n=this.readPoolFromCache(e,t);if(n)return n;try{const i=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}}),s=mi.buildPool(i);if(s)return s.stake_protocol=this.findStakeProtocol(s.position.coinTypeA,s.position.coinTypeB),this.savePoolToCache(s),s}catch(i){console.log(i)}}async getVaultsConfigs(e=!1){const{package_id:t}=this._sdk.sdkOptions.vaults,n=`${t}_getMirrorPoolConfigs`,i=this.getCache(n,e);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::vaults::InitEvent`})).data,o={admin_cap_id:"",vaults_manager_id:"",vaults_pool_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.admin_cap_id=a.admin_cap_id,o.vaults_manager_id=a.manager_id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:o.vaults_manager_id,options:{showContent:!0}}),u=ft(c);o.vaults_pool_handle=u.vault_to_pool_maps.fields.id.id;break}this.updateCache(n,o,We)}return o}async getExchangeRateForStake(e,t,n){return e==="Haedal"?await od.getExchangeRateForStake(this._sdk,t,n):e==="Volo"?await rd.getExchangeRateForStake(this._sdk,t,n):e==="aftermath"?await ad.getExchangeRateForStake(this._sdk,t,n):"0"}requestStakeCoin(e,t,n){if(e==="Haedal")return od.requestStakeCoin(this._sdk,t,n);if(e==="Volo")return rd.requestStakeCoin(this._sdk,t,n);if(e==="aftermath")return ad.requestStakeCoin(this._sdk,t,n)}async requestStake(e,t,n){if(e==="Haedal")return await od.requestStake(this._sdk,t,n);if(e==="Volo")return await rd.requestStake(this._sdk,t,n);if(e==="aftermath")return await ad.requestStake(this._sdk,t,n)}updateCache(e,t,n=Ti){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},d4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getLimitOrderTokenList(){const{limit_order:e}=this._sdk.sdkOptions,{token_list_handle:t}=G(e),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(t)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content;return{coin_type:he(a.name.fields.name).full_address,min_trade_amount:Number(a.value)}})}async getLimitOrderPoolList(){const{limit_order:e}=this._sdk.sdkOptions,{rate_orders_indexer_handle:t}=G(e),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(t)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content.fields.value,c={pay_coin_type:he(a.pay_coin.fields.name).full_address,target_coin_type:he(a.target_coin.fields.name).full_address,indexer_id:a.indexer_id};return this._sdk.updateCache(`${c.pay_coin_type}_${c.target_coin_type}`,c.indexer_id),c})}async getPoolIndexerId(e,t){const n=this._sdk.getCache(`${e}_${t}`);try{if(n===void 0){const s=(await this.getLimitOrderPoolList()).filter(o=>he(o.pay_coin_type).full_address===he(e).full_address&&he(o.target_coin_type).full_address===he(t).full_address);if(s.length>0)return s[0].indexer_id}}catch{}return n}async getOwnerLimitOrderList(e,t){const{fullClient:n}=this._sdk.ClmmSDK,i={data:[],hasNextPage:!1};try{const s=await this.getUserIndexerHandle(e);if(!s)return i;const o=await n.getDynamicFieldsByPage(s,t);i.hasNextPage=o.hasNextPage,i.nextCursor=o.nextCursor;const r=o.data.map(u=>u.name.value),c=(await n.batchGetObjects(r,{showContent:!0})).map(u=>zr.buildLimitOrderInfo(u)).filter(u=>u!==void 0);i.data=c}catch(s){console.error("Error in getOwnerLimitOrderList:",s)}return i}async getLimitOrderConfigs(){const{package_id:e}=this._sdk.sdkOptions.limit_order,t={rate_orders_indexer_id:"",rate_orders_indexer_handle:"",global_config_id:"",token_list_handle:"",user_orders_indexer_id:"",user_orders_indexer_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::limit_order::InitEvent`})).data;if(n.length>0){const s=n[0].parsedJson;t.rate_orders_indexer_id=s.rate_orders_indexer_id,t.user_orders_indexer_id=s.user_orders_indexer_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t.rate_orders_indexer_id,options:{showContent:!0}});t.rate_orders_indexer_handle=ft(o).list.fields.id.id;const r=await this._sdk.ClmmSDK.fullClient.getObject({id:t.user_orders_indexer_id,options:{showContent:!0}});t.user_orders_indexer_handle=ft(r).indexer.fields.id.id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitFactoryEvent`})).data;if(i.length>0){const s=i[0].parsedJson;t.global_config_id=s.global_config_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t.global_config_id,options:{showContent:!0}}),r=ft(o);t.token_list_handle=r.token_white_list.fields.id.id}return t}async getLimitOrder(e){const{fullClient:t}=this._sdk.ClmmSDK;try{const n=await t.getObject({id:e,options:{showContent:!0}});return zr.buildLimitOrderInfo(n)}catch(n){console.error("Error in getLimitOrder:",n);return}}async getLimitOrderLogs(e){const{fullClient:t}=this._sdk.ClmmSDK;try{const n=await t.queryTransactionBlocks({filter:{ChangedObject:e},options:{showEvents:!0}}),i=[];return n.data.forEach(s=>{i.push(...zr.buildOrderLimitEvent(s,["OrderPlacedEvent","OrderCanceledEvent","FlashLoanEvent"]))}),i}catch(n){return console.error("Error in getLimitOrderLogs:",n),[]}}async getLimitOrderClaimLogs(e){const{fullClient:t}=this._sdk.ClmmSDK;try{const n=await t.queryTransactionBlocks({filter:{ChangedObject:e},options:{showEvents:!0}}),i=[];return n.data.forEach(s=>{i.push(...zr.buildOrderLimitEvent(s,["ClaimTargetCoinEvent"]))}),i}catch(n){return console.error("Error in getLimitOrderLogs:",n),[]}}buildRateOrdersIndexerType(e){const{limit_order:t}=this._sdk.sdkOptions;return Mc(`${t.package_id}::limit_order::RateOrdersIndexer`,[e.pay_coin_type,e.target_coin_type])}async placeLimitOrder(e){const{limit_order:t}=this._sdk.sdkOptions,{user_orders_indexer_id:n,global_config_id:i,rate_orders_indexer_id:s}=G(t),o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.pay_coin_type),r=new ye,a=await this.getPoolIndexerId(e.pay_coin_type,e.target_coin_type),c=Je.buildCoinForAmount(r,o,BigInt(e.pay_coin_amount),e.pay_coin_type,!1,!0);return r.moveCall({target:`${t.published_at}::limit_order::${a===void 0?"create_indexer_and_place_limit_order":"place_limit_order"}`,typeArguments:[e.pay_coin_type,e.target_coin_type],arguments:[r.object(i),a===void 0?r.object(s):r.object(a),r.object(n),c.targetCoin,r.pure(zr.priceToRate(e.price,e.pay_decimal,e.target_decimal)),r.pure(e.expired_ts),r.object(Ce)]}),r}async claimTargetCoin(e){const{limit_order:t}=this._sdk.sdkOptions,{global_config_id:n}=G(t),i=new ye;return i.moveCall({target:`${t.published_at}::limit_order::claim_target_coin`,typeArguments:[e.pay_coin_type,e.target_coin_type],arguments:[i.object(n),i.pure(e.order_id)]}),i}async cancelOrdersByOwner(e){const{limit_order:t}=this._sdk.sdkOptions,{global_config_id:n}=G(t),i=new ye,s={};for(let o=0;o<e.length;o++){const r=e[o],a=await this.getPoolIndexerId(r.pay_coin_type,r.target_coin_type);if(a===void 0)throw Error("not found indexerId");s[r.order_id]=a}return e.forEach(o=>{i.moveCall({target:`${t.published_at}::limit_order::cancel_order_by_owner`,typeArguments:[o.pay_coin_type,o.target_coin_type],arguments:[i.object(n),i.object(s[o.order_id]),i.object(o.order_id),i.object(Ce)]})}),i}async getUserIndexerHandle(e){const{fullClient:t}=this._sdk.ClmmSDK,{limit_order:n}=this._sdk.sdkOptions;let i=this.getUserIndexerHandleByCache(e);if(i===void 0){const s=new ye;s.moveCall({target:`${n.published_at}::limit_order::get_orders_indexer_by_owner`,typeArguments:[],arguments:[s.pure(e),s.object(G(n).user_orders_indexer_id)]}),i=(await t.devInspectTransactionBlock({transactionBlock:s,sender:this._sdk.ClmmSDK.sdkOptions.simulationAccount.address})).events[0].parsedJson.orders_table_id,i&&this.saveUserIndexerHandleByCache(e,i)}return i}getUserIndexerHandleByCache(e){const t=`getUserIndexerHandleByCache_${e}`;return this.getCache(t)}saveUserIndexerHandleByCache(e,t){const n=`getUserIndexerHandleByCache_${e}`;return this.updateCache(n,t)}updateCache(e,t,n=We){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e],i=n==null?void 0:n.isValid();if(!t&&i)return n.value;i||delete this._cache[e]}},h4=class{constructor(e){ze(this,"_sdk");ze(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getFramsPoolList(e="all"){const{package_id:t}=this._sdk.sdkOptions.frams,n={data:[],hasNextPage:!1};try{const i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::pool::CreatePoolEvent`},e),s=i.data.map(o=>o.parsedJson.pool_id);if(n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor,s.length>0){const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=Wo.buildFramsPool(r);a&&(a.rewarders=await this.getFramsRewarderConfig(a.clmm_pool_id,a.rewarders.map(c=>c.reward_coin)),n.data.push(a),this.updateCache(a.id,a))}}}catch(i){console.log("getFramsPoolList error ",i)}return n}async getFramsPool(e,t=!1){const n=this.getCache(e,t);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}}),s=Wo.buildFramsPool(i.data);return s&&(s.rewarders=await this.getFramsRewarderConfig(s.clmm_pool_id,s.rewarders.map(o=>o.reward_coin)),this.updateCache(s.id,s)),s}async getFramsRewarderConfig(e,t,n=!1){const{frams:i}=this._sdk.sdkOptions,s=[];for(const o of t){const r=`getFramsRewarderConfig_${o}_${e}`,a=this.getCache(r,n);if(a)s.push(a);else try{const c=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:G(i).rewarder_manager_handle,name:{type:"0x1::type_name::TypeName",value:uw(o)}}),{fields:u}=c.data.content.fields.value.fields.value,l={reward_coin:o,last_reward_time:u.last_reward_time,emission_per_second:u.emission_per_second,total_allocate_point:u.total_allocate_point,allocate_point:""},d=u.pools.fields.id.id,h=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d,name:{type:"0x2::object::ID",value:e}}),{allocate_point:g}=h.data.content.fields.value.fields.value.fields;l.allocate_point=g,this.updateCache(r,l),s.push(l)}catch(c){console.log(c)}}return s}async getOwnedFramsPositionNFTList(e,t=[],n=!1,i=!0,s="all"){const{package_id:o}=this._sdk.sdkOptions.frams,r={data:[],hasNextPage:!1};let a={};const c=[],u=t.length>0,l=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(e,{filter:{StructType:`${o}::pool::WrappedPositionNFT`},options:{showContent:!0}},s);r.hasNextPage=l.hasNextPage,r.nextCursor=l.nextCursor;for(const d of l.data){const h=Wo.buildFramsPositionNFT(d);if(h)if(u){if(t.includes(h.pool_id)){c.push(h);let g=a[h.pool_id];g?g.push(h):g=[h],a[h.pool_id]=g}}else c.push(h)}if(n&&c.length>0){const d=await this.calculateFarmingRewards(c.map(h=>({pool_id:h.pool_id,position_nft_id:h.id,clmm_pool_id:h.clmm_pool_id})),i);u?(a={},c.forEach(h=>{d[h.id]&&(h.rewards=d[h.id]);let b=a[h.pool_id];b?b.push(h):b=[h],a[h.pool_id]=b})):c.forEach(h=>{d[h.id]&&(h.rewards=d[h.id])})}return u?a:(r.data=c,r)}async getFramsPositionNFT(e,t=!0){const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),i=Wo.buildFramsPositionNFT(n);if(t&&i){const s=await this.calculateFarmingRewards([{pool_id:i.pool_id,position_nft_id:i.id}]);s[i.id]&&(i.rewards=s[i.id])}return i}async calculateFarmingRewards(e,t=!0){var a;const{frams:n}=this._sdk.sdkOptions,i=new ye,{rewarder_manager_id:s,global_config_id:o}=G(n);e.forEach(c=>{i.moveCall({target:`${n.published_at}::router::accumulated_position_rewards`,typeArguments:[],arguments:[i.object(o),i.object(s),i.object(c.pool_id),i.pure(c.position_nft_id,"address"),i.object(Ce)]})});const r={};try{const c=await this._sdk.ClmmSDK.fullClient.sendSimulationTransaction(i,this._sdk.ClmmSDK.senderAddress,t);console.log({simulateRes:c});const u=(a=c==null?void 0:c.events)==null?void 0:a.filter(l=>he(l.type).name==="AccumulatedPositionRewardsEvent");if(u&&u.length>0)for(let l=0;l<u.length;l+=1){const{parsedJson:d}=u[l],h=[];d.rewards.contents.forEach(g=>{h.push({rewarder_type:he(g.key.name).full_address,rewarder_amount:g.value})}),r[d.wrapped_position_id]=h}}catch(c){console.log(c)}return r}depositPayload(e,t){const{frams:n}=this.sdk.sdkOptions;t=t||new ye;const{global_config_id:i,rewarder_manager_id:s}=G(n);return t.moveCall({target:`${n.published_at}::router::deposit`,typeArguments:[],arguments:[t.object(i),t.object(s),t.object(e.pool_id),t.object(e.clmm_position_id),t.object(Ce)]}),t}async withdrawPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{global_config_id:i,rewarder_manager_id:s}=G(n);return t=t||new ye,t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id},t),t.moveCall({target:`${n.published_at}::router::withdraw`,typeArguments:[],arguments:[t.object(i),t.object(s),t.object(e.pool_id),t.object(e.position_nft_id),t.object(Ce)]}),t}async batchHarvestPayload(e,t){t=t||new ye;for(const n of e)await this.harvestPayload(n,t);return t}async batchHarvestAndClmmFeePayload(e,t){if(!Mn(this._sdk.ClmmSDK.senderAddress))throw new Error("this config sdk senderAddress is not set right");const n=new ye,i={},s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,null);for(const c of t)this.collectClmmFeeInternal(c,i,n,s),this.collectClmmRewardInternal(c,i,n,s);const{frams:o}=this.sdk.sdkOptions,{global_config_id:r,rewarder_manager_id:a}=G(o);for(const c of e){const u=await this.getFramsPool(c.pool_id,!1);if(u===void 0)throw Error(`not found ${c.pool_id}`);c.collect_fee&&this.collectFeeInternal(c,i,n,s),c.clmm_rewarder_types.length>0&&await this.collectRewardInternal(c,i,n,s),c.collect_frams_rewarder&&u.rewarders.forEach(l=>{n&&n.moveCall({target:`${o.published_at}::router::harvest`,typeArguments:[l.reward_coin],arguments:[n.object(r),n.object(a),n.object(c.pool_id),n.object(c.position_nft_id),n.object(Ce)]})})}return Object.keys(i).forEach(c=>{const u=i[c];(u.isMintZeroCoin||u.originalSplitedCoin&&u.originalSplitedCoin.kind==="GasCoin")&&Je.buildTransferCoin(this._sdk.ClmmSDK,n,u.targetCoin,c,this._sdk.ClmmSDK.senderAddress)}),n}async collectRewardInternal(e,t,n,i){const s=[];e.clmm_rewarder_types.forEach(o=>{const r=bn(o);let a=t[o];a===void 0&&(a=Je.buildCoinForAmount(n,i,BigInt(0),r,!1),t[r]=a),s.push(a.targetCoin)}),await this.collectClmmRewardNoSendPayload(e,n)}collectFeeInternal(e,t,n,i){const{frams:s}=this.sdk.sdkOptions,{global_config_id:o}=G(s),{clmm_pool:r,integrate:a}=this.sdk.ClmmSDK.sdkOptions,c=G(r),u=bn(e.coinTypeA),l=bn(e.coinTypeB);let d=t[u];d===void 0&&(d=Je.buildCoinForAmount(n,i,BigInt(0),u,!1),t[u]=d);let h=t[l];h===void 0&&(h=Je.buildCoinForAmount(n,i,BigInt(0),l,!1),t[l]=h),n.moveCall({target:`${a.published_at}::stable_farming::collect_fee`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[n.object(o),n.object(c.global_config_id),n.object(e.clmm_pool_id),n.object(e.position_nft_id),d.targetCoin,h.targetCoin]})}collectClmmRewardInternal(e,t,n,i){const s=[];e.rewarder_coin_types.forEach(o=>{const r=bn(o);let a=t[o];a===void 0&&(a=Je.buildCoinForAmount(n,i,BigInt(0),r,!1),t[r]=a),s.push(a.targetCoin)}),this._sdk.ClmmSDK.Rewarder.createCollectRewarderNoSendPaylod(e,n,s)}collectClmmFeeInternal(e,t,n,i){if(e.collect_fee){const s=bn(e.coinTypeA),o=bn(e.coinTypeB);let r=t[s];r===void 0&&(r=Je.buildCoinForAmount(n,i,BigInt(0),s,!1),t[s]=r);let a=t[o];a===void 0&&(a=Je.buildCoinForAmount(n,i,BigInt(0),o,!1),t[o]=a),this._sdk.ClmmSDK.Position.createCollectFeeNoSendPaylod({pool_id:e.pool_id,pos_id:e.pos_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB},n,r.targetCoin,a.targetCoin)}}async harvestPayload(e,t){const{frams:n}=this.sdk.sdkOptions;t=t||new ye;const i=await this.getFramsPool(e.pool_id,!1);if(i===void 0)throw Error(`not found ${e.pool_id}`);const{global_config_id:s,rewarder_manager_id:o}=G(n);if("collect_fee"in e&&(e.collect_fee||e.clmm_rewarder_types.length>0)){const a=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,a)}return i.rewarders.forEach(a=>{t&&t.moveCall({target:`${n.published_at}::router::harvest`,typeArguments:[a.reward_coin],arguments:[t.object(s),t.object(o),t.object(e.pool_id),t.object(e.position_nft_id),t.object(Ce)]})}),t}async claimFeeAndClmmReward(e){const t=new ye,n=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);return await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,n),t}async openPositionAddLiquidityStakePaylod(e){const t=new ye,{clmm_pool:n,integrate:i}=this._sdk.ClmmSDK.sdkOptions,s=G(n),o=t.moveCall({target:`${n.published_at}::pool::open_position`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(e.clmm_pool_id),t.pure(Gn(BigInt(e.tick_lower)).toString()),t.pure(Gn(BigInt(e.tick_upper)).toString())]}),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=Je.buildCoinForAmount(t,r,BigInt(e.amount_a),e.coinTypeA,!1),c=Je.buildCoinForAmount(t,r,BigInt(e.amount_b),e.coinTypeB,!1);t.moveCall({target:`${i.published_at}::${Ms}::add_liquidity_by_fix_coin`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(e.clmm_pool_id),o,a.targetCoin,c.targetCoin,t.pure(e.amount_a.toString()),t.pure(e.amount_b.toString()),t.pure(e.fix_amount_a),t.object(Ce)]});const{frams:u}=this.sdk.sdkOptions,{global_config_id:l,rewarder_manager_id:d}=G(u);return t.moveCall({target:`${u.published_at}::router::deposit`,typeArguments:[],arguments:[t.object(l),t.object(d),t.object(e.pool_id),o,t.object(Ce)]}),t}async addLiquidityPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new ye;const s=G(n),o=G(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=Je.buildCoinForAmount(t,r,BigInt(e.amount_limit_a),e.coinTypeA,!1),c=Je.buildCoinForAmount(t,r,BigInt(e.amount_limit_b),e.coinTypeB,!1);if(e.collect_rewarder&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.collect_fee||e.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,u,a.remainCoins,c.remainCoins)}return t.moveCall({target:`${n.published_at}::router::add_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(o.global_config_id),t.object(s.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),a.targetCoin,c.targetCoin,t.pure(e.amount_limit_a),t.pure(e.amount_limit_b),t.pure(e.delta_liquidity),t.object(Ce)]}),t}async addLiquidityFixCoinPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new ye;const s=G(n),o=G(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=Je.buildCoinForAmount(t,r,BigInt(e.amount_a),e.coinTypeA,!1),c=Je.buildCoinForAmount(t,r,BigInt(e.amount_b),e.coinTypeB,!1);if(e.collect_rewarder&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.collect_fee||e.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:e.collect_fee,clmm_rewarder_types:e.clmm_rewarder_types},t,u,a.remainCoins,c.remainCoins)}return t.moveCall({target:`${n.published_at}::router::add_liquidity_fix_coin`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(o.global_config_id),t.object(s.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),a.targetCoin,c.targetCoin,t.pure(e.amount_a.toString()),t.pure(e.amount_b.toString()),t.pure(e.fix_amount_a),t.object(Ce)]}),t}async removeLiquidityPayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new ye;const s=G(n),o=G(i);if(e.collect_rewarder&&(!e.unstake||e.close_position)&&(t=await this.harvestPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id,clmm_pool_id:e.clmm_pool_id},t)),e.clmm_rewarder_types.length>0){const r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,collectFee:!1,clmm_rewarder_types:e.clmm_rewarder_types},t,r)}if(e.close_position){if(e.clmm_position_id===void 0)throw Error("close_position need clmm_position_id");t.moveCall({target:`${n.published_at}::router::close_position`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(s.rewarder_manager_id),t.object(e.pool_id),t.object(o.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.pure(e.min_amount_a),t.pure(e.min_amount_b),t.object(Ce)]})}else t.moveCall({target:`${n.published_at}::router::remove_liquidity`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(o.global_config_id),t.object(s.rewarder_manager_id),t.object(e.pool_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.pure(e.delta_liquidity),t.pure(e.min_amount_a),t.pure(e.min_amount_b),t.object(Ce)]}),e.unstake&&this.withdrawPayload({pool_id:e.pool_id,position_nft_id:e.position_nft_id});return t}async buildCollectRewarderAndFeeParams(e,t,n,i,s){i===void 0&&(i=[...n]),s===void 0&&(s=[...n]);const o=bn(e.coinTypeA),r=bn(e.coinTypeB);e.collectFee&&this.collectFeePayload({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB},t);const a=[];return e.clmm_rewarder_types.forEach(c=>{switch(bn(c)){case o:a.push(Je.buildCoinForAmount(t,i,BigInt(0),c,!1).targetCoin);break;case r:a.push(Je.buildCoinForAmount(t,s,BigInt(0),c,!1).targetCoin);break;default:a.push(Je.buildCoinForAmount(t,n,BigInt(0),c,!1).targetCoin);break}}),this.collectClmmRewardPayload({clmm_pool_id:e.clmm_pool_id,position_nft_id:e.position_nft_id,clmm_rewarder_types:e.clmm_rewarder_types,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,reward_coins:a},t),t}collectFeePayload(e,t){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new ye;const s=G(n),o=G(i);return t.moveCall({target:`${n.published_at}::router::collect_fee`,typeArguments:[e.coinTypeA,e.coinTypeB],arguments:[t.object(s.global_config_id),t.object(o.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id)]}),t}async collectClmmRewardPayload(e,t){var a;const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;t=t||new ye;let s=e.reward_coins;if(e.clmm_rewarder_types.length>0&&s===void 0){s=[];const c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e.clmm_rewarder_types.forEach(u=>{s.push(Je.buildCoinForAmount(t,c,BigInt(0),u,!1).targetCoin)})}const o=G(n),r=G(i);return(a=e.clmm_rewarder_types)==null||a.forEach((c,u)=>{t&&t.moveCall({target:`${n.published_at}::router::collect_clmm_reward`,typeArguments:[c,e.coinTypeA,e.coinTypeB],arguments:[t.object(o.global_config_id),t.object(r.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.object(r.global_vault_id),s[u],t.object(Ce)]})}),t}async collectClmmRewardNoSendPayload(e,t){var c;const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i,integrate:s}=this.sdk.ClmmSDK.sdkOptions;let o=e.reward_coins;if(e.clmm_rewarder_types.length>0&&o===void 0){o=[];const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e.clmm_rewarder_types.forEach(l=>{o.push(Je.buildCoinForAmount(t,u,BigInt(0),l,!1).targetCoin)})}const r=G(n),a=G(i);return(c=e.clmm_rewarder_types)==null||c.forEach((u,l)=>{t&&t.moveCall({target:`${s.published_at}::stable_farming::collect_clmm_reward`,typeArguments:[u,e.coinTypeA,e.coinTypeB],arguments:[t.object(r.global_config_id),t.object(a.global_config_id),t.object(e.clmm_pool_id),t.object(e.position_nft_id),t.object(a.global_vault_id),o[l],t.object(Ce)]})}),t}async getFrarmsConfigs(){const{package_id:e}=this._sdk.sdkOptions.frams,t={global_config_id:"",rewarder_manager_id:"",rewarder_manager_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::config::InitConfigEvent`})).data;if(n.length>0){const s=n[0].parsedJson;t.global_config_id=s.global_config_id,t.admin_cap_id=s.admin_cap_id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::rewarder::InitRewarderManagerEvent`})).data;if(i.length>0){const s=i[0].parsedJson;t.rewarder_manager_id=s.id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t.rewarder_manager_id,options:{showContent:!0}});t.rewarder_manager_handle=o.data.content.fields.rewarders.fields.id.id}return t}updateCache(e,t,n=We){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},f4=class{constructor(e,t){ze(this,"_cache",{});ze(this,"_sdkOptions");ze(this,"_launchpad");ze(this,"_ido");ze(this,"_xcetusModule");ze(this,"_xtokenModule");ze(this,"_boosterModule");ze(this,"_makerModule");ze(this,"_clmmSDK");ze(this,"_liquidityStrategy");ze(this,"_vaults");ze(this,"_limitOrder");ze(this,"_farmsModule");this._sdkOptions=e,this._clmmSDK=t,this._launchpad=new QE(this),this._ido=new a4(this),this._xcetusModule=new t4(this),this._xtokenModule=new c4(this),this._boosterModule=new YE(this),this._makerModule=new e4(this),this._vaults=new l4(this),this._limitOrder=new d4(this),this._farmsModule=new h4(this),this._liquidityStrategy=new u4(this),ef(this._sdkOptions)}get ClmmSDK(){return this._clmmSDK}get sdkOptions(){return this._sdkOptions}get Launchpad(){return this._launchpad}get Ido(){return this._ido}get XToken(){return this._xtokenModule}get XCetusModule(){return this._xcetusModule}get BoosterModule(){return this._boosterModule}get MakerModule(){return this._makerModule}get LiquidityStrategy(){return this._liquidityStrategy}get Vaults(){return this._vaults}get LimitOrder(){return this._limitOrder}get Farms(){return this._farmsModule}getVerifySenderAddress(){const{senderAddress:e}=this.ClmmSDK;if(e.length===0||!Pw(e))throw Error("this clmm config sdk senderAddess is illegal");return e}updateCache(e,t,n=We){let i=this._cache[e];i?(i.overdueTime=an(n),i.value=t):i=new si(t,an(n)),this._cache[e]=i}getCache(e,t=!1){const n=this._cache[e];if(!t&&(n!=null&&n.isValid()))return n.value;delete this._cache[e]}},mw=f4;const p4=ep("swapRouter",{state:()=>({swapRouterContract:{},isInitRouter:!0}),actions:{initSwapRouter(e,t,n){this.swapRouterContract=li(e),this.swapRouterContract.initSwapRouter(t,n),this.isInitRouter=!1,console.log(new Date().getTime(),""),console.log(this.swapRouterContract,"===>this.swapRouterContract")}}});function g4(e){const t={fullRpcUrl:localStorage.getItem(`${e}-currentRpclocal4`)||De[e||"Sui"].fullRpcUrl,simulationAccount:De[e||"Sui"].simulationAccount,cetus_config:De[e||"Sui"].cetus_config,clmm_pool:De[e||"Sui"].clmm_pool,integrate:De[e||"Sui"].integrate,deepbook:De[e||"Sui"].deepbook,deepbook_endpoint_v2:De[e||"Sui"].deepbook_endpoint_v2,aggregatorUrl:De[e||"Sui"].aggregatorUrl,swapCountUrl:De[e||"Sui"].swapCountUrl},n={launchpad:De[e||"Sui"].launchpad,ido:De[e||"Sui"].ido,xcetus:De[e||"Sui"].xcetus,xcetus_dividends:De[e||"Sui"].xcetus_dividends,cetus_faucet:De[e||"Sui"].cetus_faucet,xtoken:De[e||"Sui"].xtoken,xtoken_dividends:De[e||"Sui"].xtoken_dividends,token_faucet:De[e||"Sui"].token_faucet,booster:De[e||"Sui"].booster,maker_bonus:De[e||"Sui"].maker_bonus,liquidity_stratefy:De[e||"Sui"].liquidity_stratefy,vaults:De[e||"Sui"].vaults,frams:De[e||"Sui"].frams};console.log("defaultNetworkOptions####",t);let i=new Fi(t);const s=new mw(n,i),o=jd(),r=Ls(()=>o),a=ip(),c=Ls(()=>a),u=m4();Ls(()=>u),tp(()=>{r.value.address&&(i.senderAddress=r.value.address)});const l=Ls(()=>r.value.walletName),{$notify:d}=Gs(),h=D=>{const{$notify:K}=Gs();K.success({key:D.hash+"loading",icon:St("img",{class:{"notify-icon":!0,"loading-animate":!0},src:c.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:St("div",{class:"notification-title"},[St("span",{innerHTML:D.title},null)]),description:St("div",{class:"notification-title"},[St("div",{class:"notification-text",innerHTML:hi.global.t("newAdd.confirmingTransaction")},null),St("a",{href:Uc(c.value.currentExplorer,"tx",window.encodeURIComponent(D.hash)),target:"_blank",innerHTML:hi.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},g=D=>{const{$notify:K}=Gs();K.success({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-icon-change1"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:`${D.title} `+hi.global.t("newAdd.success")},null)]),description:St("div",{class:"notification-title"},[St("div",{class:"notification-text",innerHTML:D.desc},null),St("a",{href:Uc(c.value.currentExplorer,"tx",window.encodeURIComponent(D.hash)),target:"_blank",innerHTML:hi.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},b=D=>{const{$notify:K}=Gs();K.error({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:`${D} `+hi.global.t("newAdd.failed")},null)]),description:hi.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},v=async(D,K=!1)=>{var te,oe,se,we,Be,Ae;const{$notify:X}=Gs();try{let fe={};if(console.log("watchTransaction params: ",D),!D.res||!((te=D==null?void 0:D.res)!=null&&te.digest)||!((oe=D==null?void 0:D.res)!=null&&oe.effects)||K&&!((se=D==null?void 0:D.res)!=null&&se.events)){const pe=await Fo(2e3);fe=await i.Pool.getSuiTransactionResponse(D.hash),console.log("0503###watchTransaction###res###",fe)}else fe=D.res;if(console.log("0411###watchTransaction###res###",fe),console.log(D,"====>params"),((Be=(we=fe==null?void 0:fe.effects)==null?void 0:we.status)==null?void 0:Be.status)==="success"){X.close(D.hash+"loading"),D.isOnlyToken?fe.balanceChanges.forEach(Te=>{var it,Re,Ne;Te.coinType==((it=D==null?void 0:D.isOnlyTokenInfo)==null?void 0:it.address)&&g({...D,desc:`Deposit ${new ie(Te.amount.replace("-","")).div(new ie(Math.pow(10,(Re=D==null?void 0:D.isOnlyTokenInfo)==null?void 0:Re.decimals)))} ${(Ne=D==null?void 0:D.isOnlyTokenInfo)==null?void 0:Ne.symbol}`})}):g(D);const pe={walletAddress:o.address,chainName:"Sui",...D,...fe,date:new Date().getTime()+6048e5};if(K)if(console.log("0222###watchTransaction###isGetNftInfo true###res####",fe),fe.events){const it=fe.events.filter(Re=>Re.type.includes("OpenPositionEvent"));return{status:!0,nftInfo:it[0]&&((Ae=it[0])==null?void 0:Ae.parsedJson),res:fe}}else return{status:!0,nftInfo:fe.effects.events,res:fe};return!0}else{if(fe&&fe.effects&&fe.effects.status&&fe.effects.status.status!=="success")return X.close(D.hash+"loading"),b(D.title),!1;setTimeout(()=>v(D),3e3)}}catch(fe){return console.log("watchTransaction###error###",fe),X.close(D.hash+"loading"),X.error({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:`${D.title} Failed`},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),!0}},k=async D=>{var te,oe,se,we,Be,Ae;D.setSenderIfNotSet(r.value.address);const K=await D.build({client:i.fullClient}),X=await i.fullClient.dryRunTransactionBlock({transactionBlock:K});if(console.log("0503###simulate###simulateRes###",X),((oe=(te=X==null?void 0:X.effects)==null?void 0:te.status)==null?void 0:oe.status)==="failure"){console.log("0424###simulateRes###error###",(we=(se=X==null?void 0:X.effects)==null?void 0:se.status)==null?void 0:we.error);const fe=(Ae=(Be=X==null?void 0:X.effects)==null?void 0:Be.status)==null?void 0:Ae.error,pe=/\("(.+?)"\)/g,Te=fe.match(pe),it=Te&&Te[0]&&Te[0].match(/\w+/g)||"",Re=Te&&Te[1]&&Te[1].match(/\w+/g)||"",Ne=fe.substr(fe.lastIndexOf("}, ")+3),qt=Ne&&Ne.split(")"),Ye=qt&&qt[0]||"";throw it&&it[0]==="factory"&&Re&&Re[0]=="create_pool_internal"&&Ye==="1"?(d.error({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:"Transaction "+hi.global.t("newAdd.failed")},null)]),description:"Pool is existed",duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error("pool is existed")):(d.error({icon:St("svg",{class:{icon:!0},"aria-hidden":!0},[St("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:St("div",{class:"notification-title"},[St("span",{innerHTML:"Transaction "+hi.global.t("newAdd.failed")},null)]),description:fe,duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error(fe))}else return X},E=D=>({transactionBlock:D,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),N=async(D,K=!1)=>{var te,oe;await Fo(2e3);const X=await i.Pool.getSuiTransactionResponse(D.hash);if(((oe=(te=X==null?void 0:X.effects)==null?void 0:te.status)==null?void 0:oe.status)==="success"){d.close(D.hash+"loading"),g(D);const se={walletAddress:o.address,chainName:"Sui",...D,...X,date:new Date().getTime()+6048e5};a.setTransactionList(se)}},A=async D=>{try{o.setLoading(!0);const K=await i.getOwnerCoinAssets(D),X={};return K.forEach(te=>{var oe,se;if(te&&te.coinAddress){const we=te?te.balance.toString():"0",Be={...te,balance:we};X[te.coinAddress]={...te,balance:(oe=X[te.coinAddress])!=null&&oe.balance?L(we).plus(X[te.coinAddress].balance).toString():we,objects:(se=X[te.coinAddress])!=null&&se.objects?[...X[te.coinAddress].objects,Be]:[Be]}}}),console.log("0411###assets###",X),o.setAssets(X),o.setLoading(!1),X}catch{o.setLoading(!1)}},P=async()=>{try{console.log("getTokenList sdk: ",i);const D=await i.CetusConfig.getCoinConfigs();console.log("0907###tokenList###",D);let K=[],X=[],te=[];return D.forEach(oe=>{let se=oe;if(oe.address.includes("::sui::SUI")){const we=he(oe.address).full_address;se={...se,address:we}}se.coin_priority?X.push(se):te.push({...se,coin_priority:"0"})}),X=X.sort((oe,se)=>Number(oe==null?void 0:oe.coin_priority)<Number(se==null?void 0:se.coin_priority)?1:-1),te=te.sort((oe,se)=>oe.symbol.charCodeAt(0)-se.symbol.charCodeAt(0)),K=[...X,...te],console.log("0517###haveCoinPriority###",X),console.log("0517###notHaveCoinPriority###",te),console.log("0517###tokenList###",K),K}catch(D){return console.log("0517###getTokenList###error###",D),[]}},B=async(D,K=!1)=>{var te;const X=[];console.log("useSui getLpListFromContract"),console.log(" ~ file: useSui.ts:439 ~ getLpListFromContract ~ chainName:",e),e=="Sui"&&(t.fullRpcUrl=De.Sui.officialRpcUrl,i=new Fi(t),console.log(" ~ file: useSui.ts:422 ~ getLpListFromContract ~ sdk:",i),console.log(" ~ file: useSui.ts:422 ~ getLpListFromContract ~ sdk.sdkOptions:",i.sdkOptions));try{const oe=await i.Pool.getPools([],0,9999);console.log(" ~ file: useSui.ts:421 ~ getLpListFromContract ~ poolImmutables:",oe);const se=await P(),we={};se.forEach(pe=>{we[pe.address]=pe});const Be=await i.CetusConfig.getClmmPoolConfigs(),Ae={};Be.forEach(pe=>{Ae[pe.address]=pe});let fe={};try{const Te=(e=="Aptos"?await fetch(`${De.Aptos.api}/v2/sui/swap/count`).then(it=>it.json()):await fetch(`${De.Sui.api}/v2/sui/swap/count`).then(it=>it.json())).data;fe=Object.fromEntries(Te.pools.map(it=>[it.swap_account,{...it,apr_7day:e=="Aptos"?it.apr_7day:it.apr_24h}]))}catch{}console.log("0426###getLpListFromContract###poolImmutables###",oe),console.log("0426###getLpListFromContract###tokenObj###",we),console.log("0426###getLpListFromContract###lpObj###",Ae),console.log("0426###getLpListFromContract###addressLpTokens###",fe);for(let pe=0;pe<oe.length;pe++){const Te=oe[pe];if(Ae[Te.poolAddress]||!Ae[Te.poolAddress]){let it=we[Te.coinTypeA],Re=we[Te.coinTypeB];it||(it=(await i.CetusConfig.getTokenListByCoinTypes([Te.coinTypeA]))[Te.coinTypeA]),Re||(Re=(await i.CetusConfig.getTokenListByCoinTypes([Te.coinTypeB]))[Te.coinTypeB]);let Ne=!1;rt(it.address,Re.address)&&(Ne=!0);const qt=fe[Te.poolAddress]?((te=fe[Te.poolAddress])==null?void 0:te.is_forward)===!1:Ne;let Ye={};Ae[Te.poolAddress]&&(Ye={...Ye,...Ae[Te.poolAddress]}),Ye={...Ye,address:Te.poolAddress,coinA:it,coinB:Re,coin_a_address:Te.coinTypeA,coin_b_address:Te.coinTypeB,decimals:6,fee:Number(Te.fee_rate)/1e6,tickSpacing:Te.tickSpacing,symbol:`${it==null?void 0:it.symbol}-${Re==null?void 0:Re.symbol}`,name:`${it==null?void 0:it.symbol}-${Re==null?void 0:Re.symbol}`,needReverse:qt,is_pause:Te.is_pause,isPoolsInfoError:!0},(!D||!D[Te.coinTypeA]&&!D[Te.coinTypeB])&&X.push(Ye)}}return console.log("0426###getLpListFromContract###result###",X),X}catch(oe){console.log("getLpListFromContract###err##",oe)}},W=async(D,K)=>{var X,te,oe;try{if(!K){const fe=localStorage.getItem("SuiLpList"),pe=new Date().getTime(),Te=fe?JSON.parse(fe):null;if(Te&&Number(Te==null?void 0:Te.expiration)>pe&&(Te!=null&&Te.data)&&((X=Te==null?void 0:Te.data)==null?void 0:X.length)>0)return Te==null?void 0:Te.data}const se=[],we=await fetch(`${De[e||"Sui"].api}/v2/sui/pools_info`).then(fe=>fe.json());if(!((te=we==null?void 0:we.data)!=null&&te.lp_list)){const fe=await B(D);if(fe)return fe}console.log(D,"===>newFilterCoinsObj");const Be=((oe=we==null?void 0:we.data)==null?void 0:oe.lp_list)||[];console.log("0420getLpList###lpList###",Be),console.log("0420getLpList###res###",we);const Ae=["0xabf2af71ab3ed7c6c3bb557b984a9158f500fc8cebce2572239d1f7690930be8","0x473ab0306ff8952d473b10bb4c3516c632edeb0725f6bb3cda6c474d0ffc883f","0xd40feebfcf7935d40c9e82c9cb437442fee6b70a4be84d94764d0d89bb28ab07"];Be.forEach(fe=>{var Re,Ne,qt,Ye;const pe=(fe==null?void 0:fe.is_forward)===!1,Te=[],it=Ae.includes(fe.address);if(fe.is_display_rewarder){const Et=(qt=(Ne=(Re=fe==null?void 0:fe.object)==null?void 0:Re.rewarder_manager)==null?void 0:Ne.fields)==null?void 0:qt.rewarders;Et&&Et.forEach(Lt=>{var wt,Cn,w,S,C,p,I,Z,Y;const Ct=new ie((wt=Lt==null?void 0:Lt.fields)==null?void 0:wt.emissions_per_second).mul(ie.pow(2,-64));console.log("extractStructTagFromType###",he((S=(w=(Cn=Lt==null?void 0:Lt.fields)==null?void 0:Cn.reward_coin)==null?void 0:w.fields)==null?void 0:S.name).source_address),Te.push({coinAddress:he((I=(p=(C=Lt==null?void 0:Lt.fields)==null?void 0:C.reward_coin)==null?void 0:p.fields)==null?void 0:I.name).source_address,emissionsEveryDay:Math.floor(Ct.toNumber()*60*60*24),emissions_per_second:(Z=Lt==null?void 0:Lt.fields)==null?void 0:Z.emissions_per_second,growth_global:(Y=Lt==null?void 0:Lt.fields)==null?void 0:Y.growth_global})}),console.log("0426###rewarders###item###",fe),console.log("0426###rewarders###",Et,"###rewarderInfo###",Te)}(!D||!D[fe.coin_a.address]&&!D[fe.coin_b.address]&&!D[he(fe.coin_a.address).full_address]&&!D[he(fe.coin_b.address).full_address])&&se.push({...fe,coinA:{...fe.coin_a,address:he(fe.coin_a.address).full_address},coinB:{...fe.coin_b,address:he(fe.coin_b.address).full_address},rewarderInfo:Te,needReverse:pe,is_pause:(Ye=fe==null?void 0:fe.object)==null?void 0:Ye.is_pause,isStableFarming:it})}),console.log("0420getLpList result: ",se);try{const fe={expiration:new Date().getTime()+3e5,data:se};localStorage.setItem("SuiLpList",JSON.stringify(fe))}catch(fe){console.log("0420getLpList localStorage setItem Error: ",fe)}return console.log("0420getLpList return result: ",se),se}catch(se){console.log("0420getLpList Error: ",se);const we=await B(D);if(console.log(we,"result===>"),we)return we}},Q=async(D=[])=>{console.log(D,"getPoolslist##");const X=await new Fi(t).Pool.getPools(D,0,1e3);if(console.log("0330###getPools###pools###",X),D.length===0){const te={};return X.forEach(oe=>{te[oe.poolAddress]={...oe,rate:L(oe.fee_rate).div(Math.pow(10,6)).toString()}}),te}else return X},V=async(D=[])=>{console.log(D,"getPoolslist##");const X=await new Fi(t).Pool.getPools(D,0,1e3);console.log("0330###getPools###pools###",X);const te={};return X.forEach(oe=>{te[oe.poolAddress]={...oe,rate:L(oe.fee_rate).div(Math.pow(10,6)).toString()}}),te},ee=async D=>await new Fi(t).Pool.getPool(D),j=D=>{const K=new ye;return K.moveCall({target:`${De[e||"Sui"].faucet.faucet_display}::${D.transactionModule}::faucet`,typeArguments:[],arguments:[K.pure(D.suplyID)]}),E(K)},R=D=>{var X,te,oe,se,we;let K;return D!=null&&D.digest?K={hash:D==null?void 0:D.digest,status:(te=(X=D==null?void 0:D.effects)==null?void 0:X.status)==null?void 0:te.status,res:D}:D!=null&&D.effects&&(K={hash:(oe=D==null?void 0:D.effects)==null?void 0:oe.transactionDigest,status:(we=(se=D==null?void 0:D.effects)==null?void 0:se.status)==null?void 0:we.status,res:D}),K},U=async D=>{try{const{data:K}=await fetch(`${De.Sui.api}/v2/sui/ticks?address=${D.poolAddress}&limit=512&orderBy=index`).then(X=>X.json());if(K&&K.list&&K.list.length>0)return{list:K.list.map(te=>({objectId:te.object_id,index:te.index,sqrtPrice:new y(te.sqrt_price),liquidityNet:new y(te.liquidity_net),liquidityGross:new y(te.liquidity_gross),feeGrowthOutsideA:new y(te.fee_growth_outside_a),feeGrowthOutsideB:new y(te.fee_growth_outside_b),rewardersGrowthOutside:te.rewards_growth_outside})),address:K.address};{const X=await i.Pool.fetchTicks({pool_id:D.poolAddress,coinTypeA:D.coinTypeA,coinTypeB:D.coinTypeB});return console.log("0330###getTicks####sui####",X),{list:X,address:D.poolAddress}}}catch(K){console.log("0330###getTicks Error###",K);const X=await i.Pool.fetchTicks({pool_id:D.poolAddress,coinTypeA:D.coinTypeA,coinTypeB:D.coinTypeB});return console.log("0330###getTicks####sui####",X),{list:X,address:D.poolAddress}}},x=async(D,K,X,te)=>await _E(D,K,X,te),f=D=>{var Te,it;const{pool:K,position:X,roundUp:te}=D,oe=Number(X.tick_lower_index),se=Number(X.tick_upper_index),we=qe.tickIndexToSqrtPriceX64(oe),Be=qe.tickIndexToSqrtPriceX64(se),Ae=pn.getCoinAmountFromLiquidity(new y(X.liquidity),new y(K.current_sqrt_price),we,Be,te),fe=fn(Ae.coinA.toString(),(Te=K==null?void 0:K.coinA)==null?void 0:Te.decimals),pe=fn(Ae.coinB.toString(),(it=K==null?void 0:K.coinB)==null?void 0:it.decimals);return{coinaAmount:fe,coinbAmount:pe}},m=D=>{const{tokenA:K,tokenB:X,lowerTick:te,upperTick:oe,coinAmount:se,iscoinA:we,roundUp:Be,slippage:Ae,curSqrtPrice:fe}=D;console.log(fe.toString(),D,"==>params");const pe=pn.estLiquidityAndcoinAmountFromOneAmounts(te,oe,se,we,Be,Ae,fe),Te=K.decimals,it=X.decimals,{tokenMaxA:Re,tokenMaxB:Ne,liquidityAmount:qt,coinAmountA:Ye,coinAmountB:Et}=pe;return console.log(Re.toString(),"===>tokenMaxA.toString()"),console.log(Ne.toString(),"===>tokenMaxB.toString()"),console.log(Ye.toString(),"===>coinAmountA.toString()"),console.log(Et.toString(),"===>coinAmountB.toString()"),console.log(pe,"result===>"),console.log(pe.liquidityAmount.toString(),"liquidityAmount===>"),console.log(Te,"===>coinaDecimals"),{tokenMaxAOrigin:Re.toString(),tokenMaxBOrigin:Ne.toString(),tokenMaxA:fn(Ye.toString(),Te),tokenMaxB:fn(Et.toString(),it),liquidityAmount:qt}},T=async D=>{var w,S,C,p;const{pool:K,amount:X,fix_amount_a:te,roundUp:oe,tick_lower:se,tick_upper:we,index:Be,slippage:Ae,coinTypeC:fe,coinTypeD:pe,coinTypeE:Te,curSqrtPrice:it,positionInfo:Re,farmPoolInfo:Ne}=D,qt=await ee(K.poolAddress);console.log(D.curSqrtPrice.toString(),"###getAddLiquidityTransactionPayload 732 params"),console.log(qt,"###newPool");const Ye=te?Ln(X,K.token_a.decimals):Ln(X,K.token_b.decimals),Et=qe.sqrtPriceX64ToTickIndex(new y(qt.current_sqrt_price));console.log(qt.current_sqrt_price.toString(),D.curSqrtPrice.toString(),"curSqrtPrice##610");let Lt,Ct;if(Et>=se&&Et<=we){const I=pn.estLiquidityAndcoinAmountFromOneAmounts(se,we,new y(Ye.toString()),te,oe,Ae,new y(qt.current_sqrt_price));console.log(I,I.tokenMaxA.toNumber(),I.tokenMaxB.toNumber(),"===>preAddResult.coinAmountA.toNumber()"),Lt=te?Ye.toNumber():I.tokenMaxA.toNumber(),Ct=te?I.tokenMaxB.toNumber():Ye.toNumber()}else Et>we?(Lt=0,Ct=Ye.toNumber()):Et<se&&(Lt=Ye.toNumber(),Ct=0);console.log(D,"===>params742"),console.log("0330###createAddLiquidityTransactionPayload###params###",{coinTypeA:K.token_a.address,coinTypeB:K.token_b.address,pool_id:K.poolAddress,tick_lower:se<-443636?-443636:se,tick_upper:we>443636?443636:we,fix_amount_a:te,amount_a:Lt,amount_b:Ct,is_open:!Be,pos_id:Be});let wt,Cn;if(((w=Re==null?void 0:Re.value)==null?void 0:w.positionSource)==="farming"){console.log("0103 getAddLiquidityTransactionPayload positionInfo: ",Re);const I=[];fe&&I.push(fe),pe&&I.push(pe),Te&&I.push(Te);const Z={pool_id:(S=Re==null?void 0:Re.value)==null?void 0:S.pool_id,coinTypeA:K.token_a.address,coinTypeB:K.token_b.address,position_nft_id:(C=Re==null?void 0:Re.value)==null?void 0:C.id,clmm_pool_id:(p=Re==null?void 0:Re.value)==null?void 0:p.clmm_pool_id,amount_a:Lt,amount_b:Ct,collect_fee:!0,collect_rewarder:!1,fix_amount_a:te,clmm_rewarder_types:I};wt=await s.Farms.addLiquidityFixCoinPayload(Z),Cn={action:"FarmingIncreaseLiquidity",txbParams:Z}}else if(Be){const I=[];fe&&I.push(fe),pe&&I.push(pe),Te&&I.push(Te);const Z={coinTypeA:K.token_a.address,coinTypeB:K.token_b.address,pool_id:K.poolAddress,tick_lower:se<-443636?-443636:se,tick_upper:we>443636?443636:we,fix_amount_a:te,amount_a:Lt,amount_b:Ct,is_open:!Be,pos_id:Be,collect_fee:D.collect_fee,rewarder_coin_types:[...I],slippage:Ae},Y={slippage:Ae,curSqrtPrice:it};wt=await i.Position.createAddLiquidityFixTokenPayload(Z,Y),Cn={action:"IncreaseLiquidity",txbParams:{parameter:Z,gasEstimateArg:Y}}}else if(console.log(Ne,"farmPoolInfo##"),Ne){const I={pool_id:Ne.id,coinTypeA:K.token_a.address,coinTypeB:K.token_b.address,clmm_pool_id:Ne.clmm_pool_id,amount_a:Lt.toString(),amount_b:Ct.toString(),fix_amount_a:te,tick_lower:se,tick_upper:we};wt=await s.Farms.openPositionAddLiquidityStakePaylod(I),Cn={action:"FarmingOpenAndAddLiquidity",txbParams:I}}else{const I={coinTypeA:K.token_a.address,coinTypeB:K.token_b.address,pool_id:K.poolAddress,tick_lower:se<-443636?-443636:se,tick_upper:we>443636?443636:we,fix_amount_a:te,amount_a:Lt,amount_b:Ct,is_open:!Be,pos_id:"",collect_fee:!1,rewarder_coin_types:[],slippage:Ae},Z={slippage:Ae,curSqrtPrice:it};wt=await i.Position.createAddLiquidityFixTokenPayload(I,Z),Cn={action:"OpenAndAddLiquidity",txbParams:{parameter:I,gasEstimateArg:Z}}}return console.log("0330###sui##getAddLiquidityTransactionPayload###",wt),{txb:E(wt),payloadParams:Cn}},$=(D,K,X)=>{const te=qe.sqrtPriceX64ToPrice(new y(D.current_sqrt_price),D.coinA.decimals,D.coinB.decimals).toNumber(),oe=X?te:1/te,se=L(oe).minus(L(K)).div(L(oe)).mul(100);return se.gt(100)?100:(console.log(se.toString(),"1143"),Number(yn(se.abs().toString(),2)))},M=async D=>{const{pool:K,a2b:X,byAmountIn:te,amount:oe}=D;console.log("0221###sui###preSwap###",D);const se=K.coinA.decimals,we=K.coinB.decimals,Be=K!=null&&K.current_sqrt_price?K:await ee(K.address);let Ae;X&&te||!X&&!te?Ae=Ln(oe,se):Ae=Ln(oe,we);const fe=await i.Swap.preswap({pool:Be,current_sqrt_price:Be.current_sqrt_price,coinTypeA:Be.coinTypeA,coinTypeB:Be.coinTypeB,decimalsA:se,decimalsB:we,a2b:X,byAmountIn:te,amount:Ae.toString()});return console.log("0221###sui###preSwap###result###",fe),{...fe,estimatedAmountIn:No(fn(fe.estimatedAmountIn.toString(),X?se:we),X?se:we),estimatedAmountOut:No(fn(fe.estimatedAmountOut.toString(),X?we:se),X?we:se),priceImpactPct:yn(fe.priceImpactPct,2)}},z=async D=>{console.log("0412###getSwapTransactionPayload###params###",D);const{pool:K,a2b:X,byAmountIn:te,amount:oe,slippage:se}=D,we=K.poolAddress,Be=K.token_a.decimals,Ae=K.token_b.decimals;let fe;X&&te||!X&&!te?fe=Ln(oe,Be):fe=Ln(oe,Ae);const pe=await i.Swap.preswap({pool:K,current_sqrt_price:K.current_sqrt_price,coinTypeA:K.coinTypeA,coinTypeB:K.coinTypeB,decimalsA:Be,decimalsB:Ae,a2b:X,by_amount_in:te,amount:fe.toString()}),Te=L(pe.estimatedAmountOut.toString()),it=L(pe.estimatedAmountIn.toString()),Re=te?Te.sub(Te.mul(se)):it.add(it.mul(se));console.log("0221###sui###swap##params123456###",{pool_id:we,a2b:pe.aToB,by_amount_in:pe.byAmountIn,amount:pe.amount.toString(),amount_limit:yn(Re.toString(),0)||"",coinTypeA:K.token_a.address,coinTypeB:K.token_b.address});const Ne=await i.Swap.createSwapTransactionPayload({pool_id:we,a2b:pe.aToB,by_amount_in:pe.byAmountIn,amount:pe.amount.toString(),amount_limit:yn(Re.toString(),0)||"",coinTypeA:K.token_a.address,coinTypeB:K.token_b.address});return console.log("0221###sui###swap##tx###",Ne),E(Ne)},J=async(D,K)=>{const X=new Fi(t);console.log(K,"pools982");const te=Object.values(K).map(se=>se.address);return console.log(te,"#poolList"),await X.Position.getPositionList(D,te)},O=async(D,K,X,te="")=>{var se;console.log(" ~ file: useSui.ts:1141 ~ getPositionInfo ~ pool:",D);let oe;try{return oe=await new Fi(t).Position.getPosition((se=D==null?void 0:D.position_manager)==null?void 0:se.positions_handle,te),{...oe,tokenName:X,collectionName:K}}catch(we){String(we).indexOf("Position not exists. Get Position error")>-1&&setTimeout(()=>{console.log(" ~ file: useSui.ts:1158 ~ setTimeout ~ pool:",D),O(D,K,X,te)},5e3)}},_=async D=>{const X=await new Fi(t).Position.getPositionById(D);return console.log("0503###getPositionById###result###",X),X},q=async(D,K)=>(console.log(D,K,"getTickDataByIndex"),await i.Pool.getTickDataByIndex(D,K)),ve=async D=>{const{pool:K,position:X,tickLowerData:te,tickUpperData:oe}=D,se=await ee(K.poolAddress),we=IE({clmmpool:se,position:X,tickLower:te,tickUpper:oe}),Be=fn(we.feeOwedA.toString(),K.token_a.decimals),Ae=fn(we.feeOwedB.toString(),K.token_b.decimals);return{feeOwedA:Number(Be)>99999999999||Number(Be)<0?"0":Be,feeOwedB:Number(Ae)>99999999999||Number(Ae)<0?"0":Ae}},ue=async D=>{const{poolAddress:K,pos:X,positionHandle:te}=D;return await i.Rewarder.posRewardersAmount(K,te,X)},xe=D=>D.pos_object_id,lt=async D=>{const{pool:K,coinTypeA:X,coinTypeB:te,coinTypeC:oe,coinTypeD:se,coinTypeE:we,position:Be,delta_liquidity:Ae,rewards_num:fe,positionInfo:pe}=D;console.log("getRemoveLiquidityTransactionPayload params##",D);const Te=await ee(K.poolAddress),it={...K,...Te},Re=Number(Be.tick_lower_index),Ne=Number(Be.tick_upper_index),qt=qe.tickIndexToSqrtPriceX64(Re),Ye=qe.tickIndexToSqrtPriceX64(Ne),Et=pn.getCoinAmountFromLiquidity(Ae,new y(it.current_sqrt_price),qt,Ye,!0),Lt=L(Et.coinA.toString()).mul(L(1-D.slippage)),Ct=L(Et.coinB.toString()).mul(L(1-D.slippage)),Cn=[X,te,oe,se,we].filter(p=>!!p);let w;console.log("0331###remove###params###",{coin_types:Cn,min_amount_a:yn(Lt.toString(),0),min_amount_b:yn(Ct.toString(),0),pool_id:K.poolAddress,pos_id:D.position.pos_object_id}),console.log("0331###delta_liquidity.toString()###",Ae.toString()),console.log("0331###position.liquidity###",Be.liquidity);const S=[];oe&&S.push(oe),se&&S.push(se),we&&S.push(we);let C;if((pe==null?void 0:pe.positionSource)==="farming")if(Ae.toString()===Be.liquidity){const p={pool_id:pe==null?void 0:pe.pool_id,coinTypeA:X,coinTypeB:te,position_nft_id:pe==null?void 0:pe.id,clmm_pool_id:pe==null?void 0:pe.clmm_pool_id,min_amount_a:yn(Lt.toString(),0)||"",min_amount_b:yn(Ct.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...S],delta_liquidity:pe==null?void 0:pe.liquidity,unstake:!0,close_position:!0,clmm_position_id:D.position.clmm_position_id};console.log("getRemoveLiquidityTransactionPayload FarmingRemoveLiquidity parameter: ",p),w=await s.Farms.removeLiquidityPayload(p),C={action:"FarmingRemoveLiquidity",txbParams:p},console.log("getRemoveLiquidityTransactionPayload FarmingRemoveLiquidity result: ",w)}else{const p={pool_id:pe==null?void 0:pe.pool_id,coinTypeA:X,coinTypeB:te,position_nft_id:pe==null?void 0:pe.id,clmm_pool_id:pe==null?void 0:pe.clmm_pool_id,min_amount_a:yn(Lt.toString(),0)||"",min_amount_b:yn(Ct.toString(),0)||"",collect_rewarder:!1,clmm_rewarder_types:[...S],delta_liquidity:Ae.toString(),unstake:!1,close_position:!1};console.log("getRemoveLiquidityTransactionPayload FarmingDecreaseLiquidity parameter: ",p),w=await s.Farms.removeLiquidityPayload(p),C={action:"FarmingDecreaseLiquidity",txbParams:p},console.log("getRemoveLiquidityTransactionPayload FarmingDecreaseLiquidity result: ",w)}else if(Ae.toString()===Be.liquidity){const p={coinTypeA:X,coinTypeB:te,min_amount_a:yn(Lt.toString(),0)||"",min_amount_b:yn(Ct.toString(),0)||"",rewarder_coin_types:[...S],pool_id:K.poolAddress,pos_id:D.position.pos_object_id,collect_fee:!0};console.log("getRemoveLiquidityTransactionPayload RemoveLiquidity parameter: ",p),w=await i.Position.closePositionTransactionPayload(p),C={action:"RemoveLiquidity",txbParams:p},console.log("getRemoveLiquidityTransactionPayload RemoveLiquidity result: ",w)}else{console.log(S,"==>rewarder_coin_types");const p={coinTypeA:X,coinTypeB:te,delta_liquidity:Ae.toString(),min_amount_a:yn(Lt.toString(),0)||"",min_amount_b:yn(Ct.toString(),0)||"",pool_id:K.poolAddress,pos_id:D.position.pos_object_id,collect_fee:!0,rewarder_coin_types:[...S]};console.log("getRemoveLiquidityTransactionPayload DecreaseLiquidity parameter: ",p),w=await i.Position.removeLiquidityTransactionPayload(p),C={action:"DecreaseLiquidity",txbParams:p},console.log("getRemoveLiquidityTransactionPayload DecreaseLiquidity result: ",w)}return console.log("0331###remove###result####",w),{txb:E(w),payloadParams:C}},Qe=async(D,K)=>{const X=[];D.coinTypeC&&X.push(D.coinTypeC),D.coinTypeD&&X.push(D.coinTypeD),D.coinTypeE&&X.push(D.coinTypeE),console.log("0423###getCollectRewarderTransactionPayload###params###",{pool_id:D.pool_address,pos_id:D.pos_index,rewarder_coin_types:[...X],coinTypeA:D.coinTypeA,coinTypeB:D.coinTypeB,collect_fee:!1}),console.log(K,"##getCollectRewarderTransactionPayload");let te,oe;if(K.positionSource=="farming"){const se={coinTypeA:K.coinTypeA,coinTypeB:K.coinTypeB,clmm_pool_id:K.clmm_pool_id,position_nft_id:K.id,clmm_rewarder_types:X,collect_fee:!0};te=await s.Farms.claimFeeAndClmmReward(se),oe={action:"FarmingClaimFeeAndReward",txbParams:se}}else{const se={pool_id:D.pool_address,pos_id:D.pos_index,rewarder_coin_types:[...X],coinTypeA:D.coinTypeA,coinTypeB:D.coinTypeB,collect_fee:D.collect_fee};te=await i.Rewarder.collectRewarderTransactionPayload(se),oe={action:"ClaimFeeAndMining",txbParams:se}}return{txb:E(te),payloadParams:oe}},yt=async D=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:D.pool.poolAddress,coinTypeA:D.pool.token_a.address,coinTypeB:D.pool.token_b.address,pos_index:D.position.index});const K=await i.Position.collectFeeTransactionPayload({coinTypeA:D.pool.token_a.address,coinTypeB:D.pool.token_b.address,pool_id:D.pool.poolAddress,pos_id:D.position.pos_object_id});return console.log("1130###getCollectFeeTransactionPayload###result##",K),E(K)},ot=async()=>await i.Pool.getPoolImmutables(),rt=(D,K)=>!!Dc(ni(D),ni(K)),vt=async D=>{const{coinTypeA:K,coinTypeB:X,decimalsA:te,decimalsB:oe,amountA:se,amountB:we,minPrice:Be,maxPrice:Ae,fix_amount_a:fe,tick_spacing:pe,slippage:Te,price:it}=D;console.log(D,"###getCreatPoolTransactionPayload 1201");const Re=qe.priceToSqrtPriceX64(L(it),te,oe);console.log("0407###getCreatPoolTransactionPayload###currentSqrtPrice###",Re);const Ne=qe.priceToTickIndex(L(it),te,oe);console.log("0407###getCreatPoolTransactionPayload###currentTickIndex###",Ne);let qt,Ye;if(Be==="0"&&Ae==="")qt=jr.getMinIndex(Number(pe)),Ye=jr.getMaxIndex(Number(pe));else{const S=Number(Be)==0?-443636:qe.priceToTickIndex(L(Be),te,oe),C=qe.priceToTickIndex(L(Ae),te,oe);qt=pc(S,Number(pe)),Ye=pc(C,Number(pe))}console.log("0407###getCreatPoolTransactionPayload###tick_lower###",qt),console.log("0407###getCreatPoolTransactionPayload###tick_upper###",Ye);const Et=fe?Ln(se,te):Ln(we,oe);let Lt,Ct;qe.tickIndexToSqrtPriceX64(qt),qe.tickIndexToSqrtPriceX64(Ye);let wt;Ne>=qt&&Ne<=Ye?(wt=pn.estLiquidityAndcoinAmountFromOneAmounts(qt,Ye,new y(Et.toString()),fe,!0,Te,Re),Lt=fe?Et.toString():wt.tokenMaxA.toString(),Ct=fe?wt.tokenMaxB.toString():Et.toString()):Ne>Ye?(Lt="0",Ct=L(we).mul(L(Math.pow(10,oe))).toString()):Ne<qt&&(Lt=L(se).mul(L(Math.pow(10,te))).toString(),Ct="0"),qt<-443636&&(qt=jr.getMinIndex(Number(pe))),Ye>443636&&(Ye=qt=jr.getMaxIndex(Number(pe))),console.log("0407####create pool params###",JSON.stringify({tick_spacing:pe,initialize_sqrt_price:Re.toString(),uri:"",fix_amount_a:fe,amount_a:Lt,amount_b:Ct,tick_lower:qt,tick_upper:Ye,coinTypeA:K,coinTypeB:X}));const Cn=await i.Pool.creatPoolTransactionPayload({tick_spacing:pe,initialize_sqrt_price:Re.toString(),uri:"",fix_amount_a:fe,amount_a:Lt,amount_b:Ct,slippage:Te,tick_lower:qt,tick_upper:Ye,coinTypeA:K,coinTypeB:X});console.log("0412####result###",Cn);const w=await k(Cn);return console.log("0412####simulateRes###",w),E(Cn)},Pn=D=>{const K=D.split("0x");return"0x"+(K[1][0]==="0"?K[1].substring(1):K[1])},ne=async D=>{const K=localStorage.getItem("coinMatedataLocal"),X=K?JSON.parse(K):{};try{let te=[];const oe=[];if(D&&typeof D=="string"){if(X[Pn(D)])return[X[Pn(D)]];te=[Pn(D)]}else{const Ae=[];if(D.forEach(fe=>{X[Pn(fe)]?oe.push(X[Pn(fe)]):Ae.push(Pn(fe))}),Ae.length===0)return oe;te=[...Ae]}const se=await i.CetusConfig.getTokenListByCoinTypes(te);console.log("0714###getTokenListByCoinType###result###",se);const we=[],Be={};return Object.values(se).forEach(Ae=>{const fe={...Ae,address:he(Ae.address).full_address};we.push(fe),Be[Ae.address]=fe}),console.log("0714###getTokenListByCoinType###formatResult###",we),localStorage.setItem("coinMatedataLocal",JSON.stringify({...X,...Be})),[...we,...oe]}catch{return[]}},de=async(D,K)=>{if(!K||K=="undefined")return null;let X=null;console.log("getTokenBySymbol###tokensObj###",D);for(const te in D){const oe=D[te];if(oe.address.toUpperCase()===he(K).full_address.toUpperCase()){X=oe;break}}if(!X){const te=K.split("0x");console.log(" ~ getTokenBySymbol ~ address:",K);const oe="0x"+(te[1][0]==="0"?te[1].substring(1):te[1]),se=await i.CetusConfig.getTokenListByCoinTypes([oe]);se&&se[oe]&&(X={...se[oe],isSelfBuilt:!0,address:he(K).full_address})}return X},Oe=async D=>{const{a2b:K,byAmountIn:X,amount:te,decimalsA:oe,decimalsB:se}=D;let we;K&&X||!K&&!X?we=Ln(te,oe):we=Ln(te,se);const Be=await i.Swap.preSwapWithMultiPool({poolAddresses:D.poolAddresses,coinTypeA:D.coinTypeA,coinTypeB:D.coinTypeB,a2b:K,byAmountIn:X,amount:we});return{...Be,estimatedAmountIn:No(fn(Be.estimatedAmountIn.toString(),K?oe:se),K?oe:se),estimatedAmountOut:No(fn(Be.estimatedAmountOut.toString(),K?se:oe),K?se:oe)}},ke=async(D,K)=>{console.log(D,"===>paths"),console.log(K,"===>coins"),i.Router.loadGraph(K,D),console.log(i,"sdk===>1826")},Le=async(D,K)=>{const X=new Fi(t);X.senderAddress=r.value.address,console.log(D,"===>createTxParams");const te=await X.getOwnerCoinAssets((X==null?void 0:X.senderAddress)||r.value.address);console.log(te,"===>allCoinAsset");const oe=await Je.buildAggregatorSwapTransaction(X,D,te,"",K),se={action:"Swap",txbParams:{createTxParams:D,slippage:K}};return{txb:E(oe),payloadParams:se}},tt=async D=>{const K=await i.Rewarder.fetchPosRewardersAmount([D]),X=K&&K[0];return X&&X.rewarderAmountOwed},Ke=p4(),et=Ls(()=>Ke);return{setTransations:N,showTransitionPending:h,showTransitionSuccess:g,showTransitionError:b,watchTransaction:v,getAccount:A,getTokenList:P,getLpList:W,getPools:Q,getPool:ee,mintCoin:j,handleTx:R,TickUtil:jr,TickMath:qe,getNearestTickByTick:pc,getTicks:U,getEstPositionAPRWithMulti:x,getCoinAmountFromLiquidity:f,estLiquidityAndcoinAmountFromOneAmounts:m,getAddLiquidityTransactionPayload:T,getTickDataFromUrlData:pE,getPriceImpactPct:$,preSwap:M,getSwapTransactionPayload:z,getPositionList:J,getTickDataByIndex:q,getCollectFeesQuote:ve,getPosRewardersAmount:ue,getNftHash:xe,getPositionInfo:O,getRemoveLiquidityTransactionPayload:lt,getCollectRewarderTransactionPayload:Qe,getCollectFeeTransactionPayload:yt,getPoolImmutables:ot,estimateLiquidityForCoinA:Xr,estimateLiquidityForCoinB:Jr,getCreatPoolTransactionPayload:vt,getTokenListByCoinType:ne,getIsSortedSymbols:rt,getPositionById:_,d:L,getTokenBySymbol:de,preSwapWithMultiPool:Oe,initSwapRouter:ke,getSwapRouter:async(D,K,X,te,oe,se="",we,Be)=>{const Ae=D.value.decimals;console.log(" ~ file: useSui.ts:1847 ~ getLpListFromContract ~ fromCoin:",D.value.decimals);const fe=K.value.decimals,pe=localStorage.getItem("swapOrderSplit"),Te=localStorage.getItem("includeRoutes"),it=pe=="open"||!pe,Re=Te=="open";let Ne;try{if(Ne=await i.RouterV2.getBestRouterByServer(D.value.address,K.value.address,X,te,i.senderAddress,it,Re,Be),console.log(" ~ file: useSui.ts:1878 ~ getLpListFromContract ~ res:",Ne.isTimeout),Ne!=null&&Ne.isTimeout)throw console.log(" ~ file: useSui.ts:1881 ~ getLpListFromContract ~ res?.isTimeout:",Ne==null?void 0:Ne.isTimeout),new Error("router timeout")}catch(qt){console.log(" ~ file: useSui.ts:1885 ~ getLpListFromContract ~ error:",qt);try{Ne=await et.value.swapRouterContract.getBestRouterByRpc(D,K,X,te,oe,se,we)}catch(Ye){console.log(" ~ file: useSui.ts:1864 ~ getLpListFromContract ~ error:",Ye)}}return{amountIn:fn(Ne.inputAmount.toString(),Ae),amountOut:fn(Ne.outputAmount.toString(),fe),...Ne}},getSwapRouterPayload:Le,fetchPosRewardersAmount:tt,estCoinAmountsFromTotalAmount:D=>{const{lowerTick:K,upperTick:X,decimalsA:te,decimalsB:oe,curSqrtPrice:se,totalAmount:we,tokenPriceA:Be,tokenPriceB:Ae}=D;console.log(JSON.stringify({...D,curSqrtPrice:se.toString()}),"params===>");const fe=pn.estCoinAmountsFromTotalAmount(K,X,se,we,Be,Ae);console.log("coinAmounts: ",fe);const pe=qc(fe.amountA.toFixed(te,ie.ROUND_UP).toString(),te),Te=qc(fe.amountB.toFixed(oe,ie.ROUND_UP).toString(),oe),it={coinA:new y(pe),coinB:new y(Te)};return{amountA:fn(pe.toString(),te),amountB:fn(Te.toString(),oe),tokenAmountsInfo:it}},getCreateAddLiquidityPayload:async D=>{const{curSqrtPrice:K,tickLower:X,tickUpper:te,tokenAmounts:oe,pool:se,slippage:we}=D;console.log(JSON.stringify(D),"####getCreateAddLiquidityPayload 1593");const Be=pn.estimateLiquidityFromcoinAmounts(K,X,te,oe),Ae=new ie(oe.coinA.toString()).mul(1+we),fe=new ie(oe.coinB.toString()).mul(1+we),pe={coinTypeA:se.coinTypeA,coinTypeB:se.coinTypeB,pool_id:se.address,tick_lower:X,tick_upper:te,delta_liquidity:Be.toString(),max_amount_a:ie.ceil(Ae).toString(),max_amount_b:ie.ceil(fe).toString(),pos_id:"",rewarder_coin_types:[],collect_fee:!1};console.log(JSON.stringify(pe),"==>addLiquidityPayloadParams");const Te=await i.Position.createAddLiquidityPayload(pe);return E(Te)},calculateDepositRatioFixTokenA:(D,K,X)=>pn.calculateDepositRatioFixTokenA(D,K,X),signAndExecuteTransactionBlock:async(D,K,X)=>{var oe;if(((D==null?void 0:D.name)==="MSafe Wallet"||l.value==="MSafe Wallet")&&!X)throw a.setIsNotSupportMsafeError(!0),Error("The current operation does not support msafe wallet");a.setIsNotSupportMsafeError(!1),console.log("0319 signAndExecuteTransactionBlock###wallet###",D),console.log("0327 signAndExecuteTransactionBlock###payload###",K),console.log("0327 signAndExecuteTransactionBlock###payloadParams###",X),console.log("0319 signAndExecuteTransactionBlock###sdk.senderAddress###",i.senderAddress);let te;try{K.transactionBlock.setSender(i.senderAddress),console.log("0321 signAndExecuteTransactionBlock start build: ",new Date().getTime());const we=await K.transactionBlock.build({client:i.fullClient});console.log("0321 signAndExecuteTransactionBlock buildTxb: ",we),te=ye.from(we),console.log("0321 signAndExecuteTransactionBlock start end: ",new Date().getTime()),console.log("0327 signAndExecuteTransactionBlock###newTxb###",te)}catch(se){console.log("0319 signAndExecuteTransactionBlock error: ",se)}if(console.log("signAndExecuteTransactionBlock wallet?.name: ",D==null?void 0:D.name),console.log("signAndExecuteTransactionBlock currentWalletName.value: ",l.value),(D==null?void 0:D.name)==="MSafe Wallet"||l.value==="MSafe Wallet"){console.log("signAndExecuteTransactionBlock MSafe Wallet Start");const se=(oe=D.getState())==null?void 0:oe.currentAccount;console.log("signAndExecuteTransactionBlock MSafe Wallet account: ",se);const we=K.transactionBlock;return we.setSender(i.senderAddress),console.log("signAndExecuteTransactionBlock MSafe Wallet txb: ",we),await D.signAndExecuteTransactionBlock({transactionBlock:we,account:se,chain:"sui:mainnet",action:X==null?void 0:X.action,txbParams:X==null?void 0:X.txbParams})}else return await D.signAndExecuteTransactionBlock({transactionBlock:te||K.transactionBlock,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}})},getAllPosition:async(D,K=[])=>{const X=await i.fullClient.getOwnedObjectsByPage(D,{options:{showType:!0,showContent:!0,showOwner:!0,showDisplay:!0},filter:{MatchAny:[{Package:i.sdkOptions.clmm_pool.package_id},{StructType:`${De[e||"Sui"].frams.package_id}::pool::WrappedPositionNFT`}]}});console.log(X,"ownerRes:");const te=()=>`${i.sdkOptions.clmm_pool.package_id}::position::Position`,oe=()=>`${De[e||"Sui"].frams.package_id}::pool::WrappedPositionNFT`,se=[],we=[],Be=K.length>0;for(const Ae of X.data){const fe=he(Ae.data.type);if(fe.full_address===te()){const pe=io(Ae);Be?K.includes(pe.pool)&&se.push(pe):se.push(pe)}if(fe.full_address===oe()){const pe=Wo.buildFramsPositionNFT(Ae);Be?K.includes(pe.clmm_pool_id)&&we.push(pe):we.push(pe)}}return console.log("farmsPosition",we),console.log("clmmPosition:",JSON.stringify(se)),{clmmPosition:se,farmsPosition:we}},getFullClient:()=>{const D=new Fi(t);return console.log("getFullClient defaultNetworkOptions: ",t),console.log("getFullClient sdk: ",D),D.fullClient},getPoolsObj:V,getBestRouterByServer:async(D,K,X,te,oe,se="",we,Be)=>{const Ae=D.value.decimals,fe=K.value.decimals,pe=localStorage.getItem("swapOrderSplit"),Te=localStorage.getItem("includeRoutes"),it=pe=="open"||!pe,Re=Te=="open";let Ne;try{return Ne=await i.RouterV2.getBestRouterByServer(D.value.address,K.value.address,X,te,i.senderAddress,it,Re,Be),{amountIn:fn(Ne.result.inputAmount.toString(),Ae),amountOut:fn(Ne.result.outputAmount.toString(),fe),...Ne.result}}catch(qt){console.log(qt)}},getBestRouterByRpc:async(D,K,X,te,oe,se="",we,Be)=>{D.value.decimals,K.value.decimals;let Ae;try{return Ae=await i.RouterV2.getBestRouterByRpc(D.value.address,K.value.address,X,te,oe,se,we),Ae}catch(fe){console.log(fe)}}}}function li(e){let t={};return!e||e==="Aptos"?t=E3():t=g4(e),{...t}}const us="0x26b3bc67befc214058ca78ea9a2690298d731a2d4309485ec3d40198063c4abc",_4=[{base_symbol:`${us}::btc::BTC`,price:"175181.584616",quote_symbol:"USD"},{base_symbol:`${us}::eth::ETH`,price:"1471.343485",quote_symbol:"USD"},{base_symbol:`${us}::usdc::USDC`,price:"0.998772",quote_symbol:"USD"},{base_symbol:`${us}::usdt::USDT`,price:"0.949513",quote_symbol:"USD"},{base_symbol:`${us}::busd::BUSD`,price:"1",quote_symbol:"USD"},{base_symbol:"0x2::sui::SUI",price:"1",quote_symbol:"USD"}],F5=[{symbol:"USDT",name:"CetusUSDT",num:"200",amount:"200000000",transactionModule:"usdt",address:`${us}::usdt::USDT`,suplyID:"0x0a842204e4a64afe0da14749443754714343d1d9d246d71080bde331fc22de55",decimals:6},{symbol:"USDC",name:"CetusUSDC",num:"200",amount:"200000000",transactionModule:"usdc",address:`${us}::usdc::USDC`,suplyID:"0xdf6cb5a605e6f91120ac2fe925b897ca44a393b53ad33d52634263774adc9db3",decimals:6},{symbol:"ETH",name:"CetusETH",num:"0.1",amount:"100000000",transactionModule:"eth",address:`${us}::eth::ETH`,suplyID:"0x093839657619586c99aa4ab883df94919be0a03eff6ee8206c0d546b2853e158",decimals:8},{symbol:"BTC",name:"CetusBTC",num:"0.01",amount:"10000000",transactionModule:"btc",address:`${us}::btc::BTC`,suplyID:"0x9742b5d1812263e1d9fea29467c39cf860ad1aed0993867485aa1c04c720f670",decimals:8}];ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});function Q0(e){const t={launchpad:De[e||"Sui"].launchpad,ido:De[e||"Sui"].ido,xcetus:De[e||"Sui"].xcetus,xcetus_dividends:De[e||"Sui"].xcetus_dividends,cetus_faucet:De[e||"Sui"].cetus_faucet,xtoken:De[e||"Sui"].xtoken,xtoken_dividends:De[e||"Sui"].xtoken_dividends,token_faucet:De[e||"Sui"].token_faucet,booster:De[e||"Sui"].booster,maker_bonus:De[e||"Sui"].maker_bonus,liquidity_stratefy:De[e||"Sui"].liquidity_stratefy,vaults:De[e||"Sui"].vaults,frams:De[e||"Sui"].frams},n={fullRpcUrl:localStorage.getItem(`${e}-currentRpclocal4`)||De[e||"Sui"].fullRpcUrl,simulationAccount:De[e||"Sui"].simulationAccount,cetus_config:De[e||"Sui"].cetus_config,clmm_pool:De[e||"Sui"].clmm_pool,integrate:De[e||"Sui"].integrate,deepbook:De[e||"Sui"].deepbook,deepbook_endpoint_v2:De[e||"Sui"].deepbook_endpoint_v2,aggregatorUrl:De[e||"Sui"].aggregatorUrl},i=new ZE(n),s=new mw(t,i),o=jd(),r=Ls(()=>o);tp(()=>{r.value.address&&(i.senderAddress=r.value.address)});const a=A=>({transactionBlock:A,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),c=async()=>{try{return(await s.Farms.getFramsPoolList()).data}catch(A){console.log(" ~ file: useFarms.ts:70 ~ getFramsPoolList ~ error:",A)}},u=async(A,P)=>{const B=await s.Farms.getOwnedFramsPositionNFTList(s.ClmmSDK.senderAddress,A,P);return B&&!Ew(B)?B.data?B.data:Object.values(B)[0]:[]},l=async(A,P)=>{const B={pool_id:P,clmm_position_id:A.clmm_position_id},W=await s.Farms.depositPayload(B),Q={action:"FarmingStake",txbParams:B};return{txb:a(W),payloadParams:Q}},d=async(A,P)=>{const B={pool_id:A,position_nft_id:P},W=await s.Farms.withdrawPayload(B),Q={action:"FarmingUnstake",txbParams:B};return{txb:a(W),payloadParams:Q}},h=async A=>await s.Farms.calculateFarmingRewards(A,!1),g=async A=>{const P=await s.Farms.harvestPayload(A),B={action:"FarmingHarvest",txbParams:A};return{txb:a(P),payloadParams:B}},b=async A=>{const P=await s.Farms.batchHarvestPayload(A),B={action:"FarmingBatchHarvest",txbParams:A};return{txb:a(P),payloadParams:B}},v=(A,P,B)=>{const W=A.tick_lower_index,Q=A.tick_upper_index,{liquidity:V}=A,{price:ee,effective_tick_lower:j,effective_tick_upper:R,total_wrapped_amount:U}=P,x=Wo.calculatePositionShare(W,Q,V,ee,j,R,B);return new ie(x).div(new ie(U)).mul(100).toString()},k=async A=>{const P=await i.Position.fetchPosFeeAmount(A);return[{feeOwedA:new ie(P[0].feeOwedA.toString()).div(Math.pow(10,A[0].decimalA)).toString(),feeOwedB:new ie(P[0].feeOwedB.toString()).div(Math.pow(10,A[0].decimalB)).toString()}]},E=async A=>{const P=await s.Farms.getFramsPositionNFT(A,!0);if(P===void 0)setTimeout(()=>{E(A)},5e3);else return P};return{getFramsPoolList:c,getOwnedFramsPositionNFTList:u,farmsDeposit:l,farmsWithdraw:d,calculateFarmingRewards:h,harvestFarms:g,batchHarvest:b,calculatePositionShare:v,fetchPosFeeAmount:k,getFramsPositionNFT:E,batchHarvestAndClmmFee:async(A,P)=>{const B={action:"batchHarvestAndClmmFee",txbParams:{framsListParams:A,clmmListParams:P}},W=await s.Farms.batchHarvestAndClmmFeePayload(A,P);return{txb:a(W),payloadParams:B}}}}const m4=ep("pool",{state:()=>({tokens:[],tokensObj:{},pools:[],poolsObj:{},myPositions:[],addressLpTokens:{},addressTokens:{},currentPositionLoading:!1,myPositionsLoading:!0,poolsLoading:!0,RATES:{},currentPositionInfo:{},poolConfigList:[],feeOwedObj:{},rewarderObj:{},chinaTokens:[],chinaTokensObj:{},getPoolInfoSuccess:!1,recommendRangesObj:{},allTokenObj:{},isTokenLoading:!0,poolPriceConfigObj:{},defaultPoolInfo:{},poolConfigObj:{},openPool:[],routerPoolConfigObj:{},tokensWarningObj:{},currentChain:"",liquidityCurrentPoolInfo:{},positionDetailCurrentTab:"increase",positionActionAmount:{fromCoinAmount:"",toCoinAmount:""},currentPoolTab:"All",currentPoolMoreInfo:{},poolPositions:[],autoPoolNum:"--",tokenExternalPriceObj:{},positionShowList:[],getPendingFeeSuccess:!1,getRewardSuccess:!1}),actions:{async setLiquidityCurrentPoolInfo(e){this.liquidityCurrentPoolInfo=e},async setCurrentPoolMoreInfo(e){this.currentPoolMoreInfo=e},async setChainPoolConfigList(e){this.poolConfigList=e,this.pools=e},async setCurrentPoolTab(e){this.currentPoolTab=e},async setPoolConfigList(e,t,n=!0){const s=await li(e).getLpList(t,n);console.log(" ~ file: pool.ts:77 ~ setPoolConfigList ~ res:",s);const o=[],r=[],a=[];s.forEach(u=>{var d,h,g;const l={...u,token_a:{...u==null?void 0:u.coinA,logoURI:(d=u==null?void 0:u.coinA)==null?void 0:d.logo_url},token_b:{...u==null?void 0:u.coinB,logoURI:(h=u==null?void 0:u.coinB)==null?void 0:h.logo_url},isFarming:u.is_display_rewarder&&(u.rewarder_display1||u.rewarder_display2||u.rewarder_display3),chain:e==="Aptos"?"aptos":"sui",fee_rate:u.fee*1e4,routerSymbol:[u.coin_a_address,u.coin_b_address].sort(function(b,v){return v.localeCompare(b)}).join("-")};u.is_closed||o.push(l),e=="Sui"&&(!((g=u.object)!=null&&g.is_pause)||!u.is_pause)&&r.push(l),a.push(l)}),console.log("0509###setPoolConfigList###",r),this.poolConfigList=e=="Aptos"?o:r,this.poolConfigObj=e=="Aptos"?Object.fromEntries(o.map((u,l)=>[u.address,u])):Object.fromEntries(r.map((u,l)=>[u.address,u]));const c=a.filter(u=>!u.is_pause);this.openPool=c,this.routerPoolConfigObj=Object.fromEntries(c.map((u,l)=>[u.address,u]))},async getRecommendRanges(e){var n;let t=null;if(e&&e.includes("Sui")?t=await $fetch(`${De[e].api}/v2/sui/liquidity/recommend_ranges`):t=await $fetch(`${De.Aptos.api}/v2/liquidity/recommend_ranges`),(n=t==null?void 0:t.data)!=null&&n.list){const i=Object.fromEntries(t.data.list.map((s,o)=>[s.address,s]));this.recommendRangesObj=i,this.poolPriceConfigObj=i}else this.recommendRangesObj={},this.poolPriceConfigObj={}},async setPools(e,t){this.poolsLoading=!0,this.getPoolInfoSuccess=!1,this.currentChain=t;const n=li(t);if((t==null?void 0:t.toLowerCase())==="aptos"){if(e&&e.length>0){for(let i=0;i<e.length&&t===this.currentChain;i++){const s=e[i],o=await n.getPools([s.address]);this.defaultPoolInfo[o[0].poolAddress]=o[0],this.poolsObj[o[0].poolAddress]={...s,...o[0],fee:Number(o[0].fee_rate)/1e6},this.addressLpTokens=this.poolsObj,this.poolsLoading=!1,await Fo(500)}this.getPoolInfoSuccess=!0}}else if(e&&e.length>0){console.log(e,"###poolConfigList");const i=e.map(r=>r.address),s=t=="Aptos"?await n.getPools([]):await n.getPoolsObj(i);console.log(s,"##newPoolsObj");const o={};for(let r=0;r<e.length;r++){const a=e[r];console.log(a,"==>data");const c=s[a.address];c?o[a.address]={...a,...c,fee:Number(c==null?void 0:c.fee_rate)/1e6}:o[a.address]={...a}}console.log("0605###setPools###result###",o),this.poolsObj=o,this.addressLpTokens=o,this.poolsLoading=!1,this.getPoolInfoSuccess=!0}},async setSinglePool(e,t,n){const s=await li(n).getPool(e.address);console.log(t,"recommendRangesInfo");const o={...e,...s,fee:s.fee_rate/1e6,type:(t==null?void 0:t.type)||""};console.log("0506###setSinglePool###result###",o),this.poolsObj[e.address]=o,console.log(this.poolsObj,"===>173"),this.addressLpTokens[e.address]=o},async updateCurrentPools(e,t){const n=li(t),i=this.poolsObj[e];if(console.log(i,"===>currentPool"),i){let s={};t&&t.includes("Sui")?s=await n.getPool((i==null?void 0:i.poolAddress)||(i==null?void 0:i.address)):s=await n.getPoolState(i.poolAddress,i.poolType,!1),console.log("0411###debug###newInfo####",s);const o={...this.poolsObj},r={...o[e],...s};console.log("0411###debug###newCurrentInfo####",r),o[e]={...r},console.log("0411###debug###newPoolsObj####",o),this.poolsObj=o}},async setTokens(e){const t=[];console.log("0613###setTokens####111111###",e);const n=li(e);console.log("0613###setTokens####22222###contract###",n);const i=await n.getTokenList();console.log("0613###setTokens####22222###res###",i),i.forEach(o=>{t.push({...o,logoURI:o.logo_url,chain:e.toLowerCase()})}),console.log(t,"result===>237"),this.tokens=t;const s=Object.fromEntries(t.map((o,r)=>[o.address,o]));s["0x2::sui::SUI"]&&!s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]&&(s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]=s["0x2::sui::SUI"]),this.tokensObj=s,this.tokensWarningObj={"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":{},...Object.fromEntries(t.map((o,r)=>[o.address,o]))},this.isTokenLoading=!1,console.log(this.tokensWarningObj,"===>this.tokensWarningObj ")},async setChinaTokens(e){const n=await li(e).getTokenListByCoinType();console.log(n,"chinares===>");const i=[];n.forEach(s=>{i.push({...s,logoURI:e=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png",logo_url:e=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png"})}),this.chinaTokens=i,this.chinaTokensObj=Object.fromEntries(i.map((s,o)=>[s.address,s]))},setCurrentPositionLoading(e){this.currentPositionLoading=e},setMyPositionsLoading(e){this.myPositionsLoading=e},async setRates(e){let t={};if(e&&e.includes("Sui"))try{t=await $fetch(`${De.Sui.api}/v2/sui/price`)}catch(s){console.log("sui pric api error ###",s),t={data:{prices:_4}}}else t=await $fetch(`${De.Aptos.api}/v2/price`);const n=t.data.prices||[],i=[];n.forEach(s=>{s.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?i.push({...s},{...s,base_symbol:"0x2::sui::SUI"}):i.push(s)}),this.RATES=Object.fromEntries(i.map(s=>[s.base_symbol,s])),console.log(this.RATES,"===>this.RATES")},async getMyPositons(e,t,n){console.log("0507###getMyPositons###start###",t),this.setMyPositionsLoading(!0);const i=li(n);let s=[],o=[];if(this.getRewardSuccess=!1,this.getPendingFeeSuccess=!1,n=="Sui"){const{clmmPosition:l,farmsPosition:d}=await i.getAllPosition(e,t);s=l,o=d}else s=await i.getPositionList(e,t)||[];let r=[];n=="Sui"&&(r=o.map(l=>{const d=[];let h=new ie(0);return l.rewards.forEach(g=>{var A;const b=g.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":g.rewarder_type,v=this.tokensObj[b],k=((A=this.RATES[b])==null?void 0:A.price)||0,E=new ie(g.rewarder_amount).div(new ie(Math.pow(10,v.decimals))),N=E.mul(new ie(k));h=h.add(N),E.toNumber()>0&&d.push({...g,amount:E,rewarderAmountUsd:N.toString(),address:b,symbol:v.symbol})}),{...l,rewards:d,farmingRewardTotalUsd:h.toNumber(),positionSource:"farming"}}),console.log("farmingPositionList:",r)),console.log("0507###getMyPositons###positionList###",s),s.length<1&&(this.setMyPositionsLoading(!1),this.getRewardSuccess=!0,this.getPendingFeeSuccess=!0);const a=r.concat(s);console.log(a,"##allPositionList");const c=[];a.forEach(l=>{var B,W,Q,V;const d=t[l.pool||l.clmm_pool_id];let h,g,b,v,k="",E,N,A,P;if(console.log("allPositionList item:",l),l.liquidity&&l.liquidity!=="0"&&d){const ee={creator:l.creator,collection:l.collection,name:l.name};n==="Aptos"?P=i.getNftHash(ee):P=i.getNftHash(l);const j=d.token_a.decimals,R=d.token_b.decimals;console.log(d,"poolInf=====>"),d!=null&&d.current_sqrt_price&&(b=i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,j,R).toString(),v=new ie(1).div(i.TickMath.sqrtPriceX64ToPrice(d==null?void 0:d.current_sqrt_price,j,R)).toString()),l.tick_lower_index==i.TickUtil.getMinIndex(Number(d.tickSpacing))?h="0":h=i.TickMath.tickIndexToPrice(Number(l.tick_lower_index),j,R).toString(),l.tick_upper_index==i.TickUtil.getMaxIndex(Number(d.tickSpacing))?g="":(g=i.TickMath.tickIndexToPrice(Number(l.tick_upper_index),j,R).toString(),console.log("0523###maxPrice###2222###",g));let U,x;g!==""?x=new ie(1).div(new ie(g)).toString():x="",h!==0?U=new ie(1).div(new ie(h)).toString():U="0";const f=d.needReverse?((W=this.tokensObj[d.coinB.address])==null?void 0:W.labels)||[]:((B=this.tokensObj[d.coinA.address])==null?void 0:B.labels)||[],m=d.needReverse?((Q=this.tokensObj[d.coinA.address])==null?void 0:Q.labels)||[]:((V=this.tokensObj[d.coinB.address])==null?void 0:V.labels)||[],T=[...new Set(f.concat(m))],$=i.getCoinAmountFromLiquidity({pool:d,position:l,roundUp:n!="Sui"}),M=$.coinaAmount,z=$.coinbAmount;console.log(b,"===>currentPrice");const J=Number(z)+Number(M)*Number(b);let O=(Number(M)*Number(b)/J*100).toFixed(0),_=(z/J*100).toFixed(0);h=="0"&&g==""&&(O="50",_="50"),d.isPause?k="Closed":Number(b)>=Number(h)&&(g===""||Number(b)<=Number(g))?k="Active":(Number(b)>Number(g)||Number(b)<Number(h))&&(k="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[d.token_a.address]),console.log("0323###poolInfo.token_a.address####",d.token_a.address),console.log("0323###poolInfo.token_b.address####",d.token_b.address);let q={},ve={};n==="Aptos"?(q={...d.token_a,...this.tokensObj[d.token_a.address],logoURI:this.tokensObj[d.token_a.address].logo_url},ve={...d.token_b,...this.tokensObj[d.token_b.address],logoURI:this.tokensObj[d.token_b.address].logo_url}):(q=d==null?void 0:d.token_a,ve=d==null?void 0:d.token_b),c.push({...d,...l,labels:T,totalAmount:J,token_a:q,token_b:ve,tokenARates:E,tokenBRates:N,amountA:M,amountB:z,fromPercent:O,toPercent:_,amountUSD:A,tokenName:l.tokenName||l.name,currentStatus:k,positionLiquidity:l.liquidity,nftHash:P,currentPrice:b,currentPriceReverse:v,minPrice:So(h,12),maxPrice:So(g,12),positionSource:l.id?"farming":"clmm",farmingRewardTotalUsd:l.id?l.farmingRewardTotalUsd:0,minPriceResever:U,maxPriceResever:x})}});const u=c.sort((l,d)=>d.amountUSD-l.amountUSD);this.myPositions=u,this.setMyPositionsLoading(!1),this.getPendingFees(u,n),this.getRewarderV2(u,n),console.log(u,"===>this.myPositions")},setMyPositions(){this.myPositions=[],this.feeOwedObj={},this.rewarderObj={}},async setCurrentPositionInfo(e,t,n,i,s="",o=""){var g,b,v,k,E,N;const r=li(i);let a;i=="Sui"&&(a=Q0(i));let c=null,u=null,l=null,d=null,h=null;if(e&&s||i==="Aptos"?(c=this.addressLpTokens&&this.addressLpTokens[e],u=await r.getPool(e),h=this.poolConfigObj[e],console.log(h,"===>poolConfig"),l={...c,...u,...h},console.log(l,"423"),d=await r.getPositionInfo(l,t,n,s)):i!=="Aptos"&&(console.log("0414###setCurrentPositionInfo###",s),d=o=="farming"?await a.getFramsPositionNFT(s):await r.getPositionById(s),console.log(" ~ file: pool.ts:562 ~ setCurrentPositionInfo ~ positionInfo:",d),console.log(d,"setCurrentPositionInfo:positionInfo"),u=o=="farming"?await r.getPool(d.clmm_pool_id):await r.getPool(d.pool),c=this.addressLpTokens&&this.addressLpTokens[d.pool||this.addressLpTokens.poolAddress],h=this.poolConfigObj[d.clmm_pool_id||d.pool],console.log(this.poolConfigObj[d.clmm_pool_id],"##this.poolConfigObj[poolAddress]"),l={...c,...u,...h},console.log("poolInfoNew:",c,u),console.log("0414###setCurrentPositionInfo###positionInfo###",d),console.log("0414###setCurrentPositionInfo###poolInfo###",l)),console.log("setCurrentPositionInfo:",l),d&&l){let A,P,B,W,Q="",V,ee,j,R,U,x=0,f=0,m;const T={creator:d.pool,collection:d.collectionName,name:d.name};i==="Aptos"?m=r.getNftHash(T):m=r.getNftHash(d),console.log("0329###setCurrentPositionInfo###poolInfo###",l),console.log("0329###setCurrentPositionInfo###positionInfo###",d);let $=0,M=0;if(l!=null&&l.token_a&&(l!=null&&l.token_b))$=(g=l==null?void 0:l.token_a)==null?void 0:g.decimals,M=(b=l==null?void 0:l.token_b)==null?void 0:b.decimals;else{const z=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeA))[0],J=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeB))[0];$=z==null?void 0:z.decimals,M=J==null?void 0:J.decimals,l.coinA=z,l.coinB=J,l.token_a=z,l.token_b=J}if(console.log("fee"),l){try{let Qe;if(o!=="farming"){const yt=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_lower_index)),ot=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_upper_index));Qe=await r.getCollectFeesQuote({pool:l,position:d,tickLowerData:yt,tickUpperData:ot})}else{console.log(l,l.token_a,"setCurrentPositionInfo:poolInfo");const yt=[{poolAddress:l.poolAddress,positionId:d.clmm_position_id,coinTypeA:l.coinTypeA,coinTypeB:l.coinTypeB,decimalA:l.token_a.decimals,decimalB:l.token_b.decimals}];console.log(yt,"params###");const ot=await a.fetchPosFeeAmount(yt);console.log(ot,"##farmingPositionFee"),Qe=ot[0]}console.log(Qe,"setCurrentPositionInfo feeOwn:"),Qe&&(x=Number(Qe.feeOwedA),f=Number(Qe.feeOwedB))}catch(Qe){console.log("0314###getCollectFeesQuote###error####",Qe)}console.log("0413####setCurrentPositionInfo###poolInfo###",l),B=r.TickMath.sqrtPriceX64ToPrice(l.current_sqrt_price,$,M).toString(),W=new ie(1).div(r.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,$,M)).toString(),d.tick_lower_index==r.TickUtil.getMinIndex(Number(l.tickSpacing))?A="0":A=r.TickMath.tickIndexToPrice(Number(d.tick_lower_index),$,M).toString(),d.tick_upper_index==r.TickUtil.getMaxIndex(Number(l.tickSpacing))?P="":P=r.TickMath.tickIndexToPrice(Number(d.tick_upper_index),$,M).toString();let z,J;P!==""?J=new ie(1).div(new ie(P)).toString():J="",A!==0?z=new ie(1).div(new ie(A)).toString():z="0",V=d.tick_lower_index,ee=d.tick_upper_index;const O=r.getCoinAmountFromLiquidity({pool:l,position:d,roundUp:i!="Sui"});let _,q,ve;console.log(B,"===>currentPrice522"),B&&B>0&&(R=O==null?void 0:O.coinaAmount,U=O==null?void 0:O.coinbAmount,console.log(O,"===>amountInfo"),console.log(B,"===>currentPrice"),ve=Number(U)+Number(R)*Number(B),console.log(ve,"===>totalAmount"),_=(Number(R)*Number(B)/ve*100).toFixed(0),console.log(_,"===>fromPercent"),q=(Number(U/Number(ve))*100).toFixed(0),console.log(q,"==>toPercent"));let ue;const xe=O.coinaAmount*((v=this.RATES[l==null?void 0:l.token_a.address])==null?void 0:v.price),lt=O.coinbAmount*((k=this.RATES[l==null?void 0:l.token_b.address])==null?void 0:k.price);(E=this.RATES[l==null?void 0:l.token_a.address])!=null&&E.price&&((N=this.RATES[l==null?void 0:l.token_b.address])!=null&&N.price)&&(ue=xe+lt),console.log(ue,"==>totalAmountUSD"),l.isPause?Q="Closed":Number(B)>=Number(A)&&(P===""||Number(B)<=Number(P))?Q="Active":(Number(B)>Number(P)||Number(B)<Number(A))&&(Q="Inactive"),this.currentPositionInfo={...d,poolInfo:l,token_a:{...l.token_a,...this.tokensObj[l.token_a.address]},token_b:{...l.token_b,...this.tokensObj[l.token_b.address]},current_tick_index:l.current_tick_index,current_sqrt_price:l.current_sqrt_price,tickSpacing:l.tickSpacing,fee:l.fee,poolAddress:l.poolAddress,address:l.address,is_display_rewarder:l.is_display_rewarder,nftHash:m,feeOwedA:x,feeOwedB:f,currentStatus:Q,amountA:R,amountB:U,tokenARates:xe,tokenBRates:lt,amountUSD:j,totalAmount:ve,totalAmountUSD:ue,currentPrice:B,currentPriceReverse:W,minPrice:So(A,12),minTick:V,maxTick:ee,maxPrice:So(P,12),fromPercent:_||"--",toPercent:q||"--",tokenName:d.tokenName||d.name,positionSource:d.id?"farming":"clmm",minPriceResever:z,maxPriceResever:J},this.currentPositionLoading=!1,console.log("positionInfo.value",this.currentPositionInfo)}}},async getPendingFees(e,t){var o,r;const n=this.RATES,i=li(t);let s;t=="Sui"&&(s=Q0("Sui")),console.log("0302###getPendingFees####result###",e);for(let a=0;a<e.length;a++){const c=e[a],u=await i.getPool(c.poolAddress),l={...u,token_a:(c==null?void 0:c.token_a)||this.tokensObj&&this.tokensObj[u.coinTypeA]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeA],token_b:(c==null?void 0:c.token_b)||this.tokensObj&&this.tokensObj[u.coinTypeB]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeB]};let d;if(e[a].positionSource=="farming"){console.log("result[i]:",e[a]);const A=[{poolAddress:c.poolAddress,positionId:c.clmm_position_id,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB,decimalA:c.token_a.decimals,decimalB:c.token_b.decimals}];let P;try{P=await s.fetchPosFeeAmount(A),console.log(P,"##farmingPositionFee"),d=P[0]}catch(B){console.log(" ~ file: pool.ts:831 ~ getPendingFees ~ error:",B)}}else if(u){const A=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_lower_index)),P=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_upper_index));console.log("0323####getPendingFees###pool###",u),console.log("0323####getPendingFees###positionItem.collection###",c.collection),console.log("0323####getPendingFees###positionItem.tokenName###",c.tokenName),console.log("0323####getPendingFees###positionItem###",c);const B=t==="Aptos"?"":c.pos_object_id,W=await i.getPositionInfo(u,c.collection,c.tokenName,B);console.log("0302###positionInfo",W),console.log("0302###resultPool###",l),console.log(u,"pool====>654");try{d=await i.getCollectFeesQuote({pool:l,position:W,tickLowerData:A,tickUpperData:P})}catch(Q){console.log(" ~ file: pool.ts:852 ~ getPendingFees ~ error:",Q)}}console.log("0330###getPendingFees###feeOwn###",d);const h=[],g=Number(d.feeOwedA),b=Number(d.feeOwedB);let v,k,E;n&&n[l.token_a.address]&&n[l.token_b.address]?(k=g*((o=n[l.token_a.address])==null?void 0:o.price),E=b*((r=n[l.token_b.address])==null?void 0:r.price),v=k+E):v="--",h.push({amount:g,amountUSD:k,...l.token_a,logoURI:l.token_a.logo_url},{amount:b,amountUSD:E,...l.token_b,logoURI:l.token_b.logo_url});const N=this.poolConfigObj&&this.poolConfigObj[u.poolAddress];console.log(N,"poolConfigInfo===>710"),this.feeOwedObj[c.tokenName]={feesResult:N!=null&&N.needReverse?h.reverse():h,feeOwed:v},console.log(this.feeOwedObj,"===>this.feeOwedObj"),await Fo(1e3)}this.getPendingFeeSuccess=!0},async getRewarder(e,t){const n=li(t),i=this;console.log(e,"===>results");for(let s=0;s<e.length;s++)if(e[s].rewarder_infos&&e[s].rewarder_infos.length>0){const o=e[s];console.log(s,"i===>"),console.log(o,"===>positionItem"),console.log(o.ticks_handle,"===>positionItem.ticks_handle"),console.log(o.tick_lower_index,"===>positionItem.tick_lower_index"),console.log(o.tick_upper_index,"===>positionItem.tick_upper_index");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];t==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,pos:o.pos_object_id,positionHandle:o.position_manager.positions_handle}),console.log(c,"rewarderInfo===>");const u=[];let l=0;c.forEach((d,h)=>{var k;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),v=yn(new ie(b).div(Math.pow(10,g)).toString(),g);if(o[`rewarder_display${h+1}`]||Number(v)>0){const E=i.tokensObj[d.coin_address];console.log(d.amount_owed.toString(),"===>element.amount_owed.toString()");const N=(k=i.RATES[d.coin_address])==null?void 0:k.price;console.log(N,"price===>"),console.log(v,"==>amount");const A=Number(v)*N;l+=A,u.push({...d,...E,amount:v,amountUSD:A,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(yn(l,2)),pendingRewarder:l}}}),console.log(i.rewarderObj,"===>_this.rewarderObj"),await Fo(1e3)}},async getRewarderV2(e,t){const n=li(t),i=this;console.log(e,"===>results");for(let s=0;s<e.length;s++){const o=e[s];if(e[s].rewarder_infos&&e[s].rewarder_infos.length>0){console.log(o,"===>positionItem");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];t==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):(console.log("###fetchPosRewardersAmount"),console.log({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos},"955##"),c=await n.fetchPosRewardersAmount({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos}),console.log(c,"###rewarderInfo"));const u=[];let l=0;c.forEach((d,h)=>{var k;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),v=yn(new ie(b).div(Math.pow(10,g)).toString(),g);if(o[`rewarder_display${h+1}`]||Number(v)>0){const E=i.tokensObj[d.coin_address],N=((k=i.RATES[d.coin_address])==null?void 0:k.price)||0;console.log(N,"price===>"),console.log(v,"==>amount");const A=Number(v)*N;l+=A,u.push({...d,...E,amount:v,amountUSD:A,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(yn(l,2)),pendingRewarder:l}}}),await Fo(1e3)}console.log(i.rewarderObj,"===>_this.rewarderObj")}this.getRewardSuccess=!0},setAllTokenObj(e){console.log(e,"===>allTokenObj"),this.allTokenObj=e},async trappingTokenObj(e,t,n){const i={};e.forEach(r=>{!t[r.coinA.address]&&!i[r.coinA.address]&&(i[r.coinA.address]=r),!t[r.coinB.address]&&!i[r.coinB.address]&&(i[r.coinB.address]=r)}),console.log("trappingTokenObj###lackTokensObj####",i);const s=li(n),o=Object.keys(i);if(console.log("trappingTokenObj###params###",o),o.length>0){const r=await s.getTokenListByCoinType(o);console.log("trappingTokenObj###result###",r);const a={};r.forEach(c=>{a[c.address]={...c,isSelfBuilt:!0}}),this.tokensObj={...this.tokensObj,...a}}},setNewTokens(e){console.log("setNewTokens#######newTokenObj###",e),this.tokensObj={...this.tokensObj,...e},console.log("setNewTokens###this.tokensObj####",this.tokensObj)},setPositionDetailCurrentTab(e){e!=this.positionDetailCurrentTab&&(this.positionActionAmount={},this.positionDetailCurrentTab=e)},setPositionActionAmount(e){this.positionActionAmount=e},async getMyPositonsByPool(e,t,n){console.log("0507###getMyPositons###start###",t),this.myPositionsLoading=!0;let i={};const s=li(n);if(!t.current_sqrt_price){const h=await s.getPool(t.address)||{};i={...t,...h}}let o=[],r=[],a=[],c=[];if(n=="Sui"){const{clmmPosition:h,farmsPosition:g}=await s.getAllPosition(e,[t.address]);a=h,c=g,r=c.filter(b=>{if(b.clmm_pool_id==i.address)return b}),o=r.map(b=>{const v=[];let k=new ie(0);return b.rewards.forEach(E=>{var Q;const N=E.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":E.rewarder_type,A=this.tokensObj[N],P=((Q=this.RATES[N])==null?void 0:Q.price)||0,B=new ie(E.rewarder_amount).div(new ie(Math.pow(10,A.decimals))),W=B.mul(new ie(P));k=k.add(W),B.toNumber()>0&&v.push({...E,amount:B,rewarderAmountUsd:W.toString(),address:N,symbol:A.symbol})}),{...b,rewards:v,farmingRewardTotalUsd:k.toNumber()}}),console.log("farmingPositionList:",o)}else a=await s.getPositionList(e,{[t.address]:i})||[];console.log(o,"###farmingPositionList"),console.log("0507###getMyPositons###positionList###",a),console.log("###poolInfo",i),a.length<1&&this.setMyPositionsLoading(!1);const u=o.concat(a);console.log("allPositionList:",u);const l=[];u.forEach(h=>{let g,b,v,k="",E,N,A,P;if(h.liquidity&&h.liquidity!=="0"&&i){const B={creator:h.creator,collection:h.collection,name:h.name};n==="Aptos"?P=s.getNftHash(B):P=s.getNftHash(h);const W=i.token_a.decimals,Q=i.token_b.decimals;console.log(i,"poolInf=====>"),v=s.TickMath.sqrtPriceX64ToPrice(i.current_sqrt_price,W,Q).toString(),h.tick_lower_index==s.TickUtil.getMinIndex(Number(i.tickSpacing))?g="0":g=s.TickMath.tickIndexToPrice(Number(h.tick_lower_index),W,Q).toString(),h.tick_upper_index==s.TickUtil.getMaxIndex(Number(i.tickSpacing))?b="":(b=s.TickMath.tickIndexToPrice(Number(h.tick_upper_index),W,Q).toString(),console.log("0523###maxPrice###2222###",b));const V=s.getCoinAmountFromLiquidity({pool:i,position:h,roundUp:n!="Sui"}),ee=V.coinaAmount,j=V.coinbAmount;console.log(v,"===>currentPrice");const R=Number(j)+Number(ee)*Number(v);let U=(Number(ee)*Number(v)/R*100).toFixed(0),x=(j/R*100).toFixed(0);g=="0"&&b==""&&(U="50",x="50"),i.isPause?k="Closed":Number(v)>=Number(g)&&(b===""||Number(v)<=Number(b))?k="Active":(Number(v)>Number(b)||Number(v)<Number(g))&&(k="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[i.token_a.address]),console.log("0323###poolInfo.token_a.address####",i.token_a.address),console.log("0323###poolInfo.token_b.address####",i.token_b.address);let f={},m={};n==="Aptos"?(f={...i.token_a,...this.tokensObj[i.token_a.address],logoURI:this.tokensObj[i.token_a.address].logo_url},m={...i.token_b,...this.tokensObj[i.token_b.address],logoURI:this.tokensObj[i.token_b.address].logo_url}):(f=i==null?void 0:i.token_a,m=i==null?void 0:i.token_b),l.push({...i,...h,totalAmount:R,token_a:f,token_b:m,tokenARates:E,tokenBRates:N,amountA:ee,amountB:j,fromPercent:U,toPercent:x,amountUSD:A,tokenName:h.tokenName||h.name,currentStatus:k,positionLiquidity:h.liquidity,nftHash:P,currentPrice:v,minPrice:So(g,12),maxPrice:So(b,12),positionSource:h.id?"farming":"clmm",farmingRewardTotalUsd:h.id?h.farmingRewardTotalUsd:0})}});const d=l.sort((h,g)=>g.liquidity-h.liquidity);console.log(d,"==>myPositionsByPool"),this.poolPositions=d,this.setMyPositionsLoading(!1),this.getPendingFees(d,n),this.getRewarderV2(d,n),console.log(d,"===>this.myPositions")},setAutoPoolNum(e){this.autoPoolNum=e},setTokenExternalPrice(e,t){this.tokenExternalPriceObj[e]=t},clearCurrentPositionInfo(){this.currentPositionInfo={}},setPositionShowList(e){this.positionShowList=e}}});export{O5 as A,p4 as B,pn as C,jr as D,N5 as E,q5 as F,kE as G,Hd as H,Dn as I,is as J,d5 as K,$e as L,Je as M,F5 as S,qe as T,mi as V,Ws as X,li as a,y as b,U5 as c,L5 as d,Q0 as e,Ho as f,Uc as g,zo as h,E3 as i,mt as j,Ln as k,R5 as l,$5 as m,M5 as n,Fi as o,fn as p,f4 as q,Jr as r,Xr as s,D5 as t,m4 as u,Yt as v,Ci as w,ZE as x,he as y,L as z};
