import{_ as qe}from"./upgrade-select-input.20bd75ff.js";import{_ as Ve}from"./upgrade-loading.30a9b308.js";import{_ as Me}from"./upgrade-position-item.3844ac17.js";import{a as ae,q as Ce,o as n,f as d,F as Q,s as X,x as j,h as s,t as we,v as $,u as D,e as le,r as g,m as k,c as I,w as Z,i as B,j as ee,R as Ae,B as he,p as re,k as de,D as z,z as ye,O as be,a2 as We,P as xe,V as ze,G as He,N as Ze,l as Je,b as Ke,y as Qe,C as Xe,W as Ie,$ as es,T as ss}from"./entry.8f072e6e.js";import{R as G,b as Re,r as ts,c as os,a as Pe,u as ge,h as ke,e as as,d as ls}from"./pool.98cd8129.js";import{u as ns}from"./notifi.bf065504.js";import{i as $e}from"./import-icon.de3e6c66.js";import"./index.0d126e95.js";import{_ as is}from"./route-view.818cd631.js";/* empty css              *//* empty css              *//* empty css              */import{_ as De}from"./icon-selected_3x.09e9a6f0.js";import{_ as us}from"./coin-pair-name.5fd5da2c.js";import{D as S}from"./decimal.0bdeb344.js";import{N as rs}from"./no-data.65d0a1b2.js";import{_ as Oe}from"./icon_on_2x.5e96733d.js";import{_ as ds}from"./img-no-Positions_2x.91d036c8.js";import{_ as cs}from"./img-no-Positions_2x.b9fc7341.js";import{_ as vs}from"./img-connect-wallet_2x.bbd3f97f.js";import{_ as ms}from"./img-connect-wallet_2x.ceb7def4.js";import"./coin-select.8cfa76d2.js";/* empty css              */import"./token-warning_2x.90971ed9.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.105f3067.js";import"./farms-valid-range.acb88836.js";import"./farms.c38d3d0f.js";import"./icon_farms_2x.0ddcc1c4.js";import"./icon_rewards_2x.727a67fd.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./farms.f2efb0a1.js";import"./useWhale.7f60fbe4.js";import"./token-warning.f6756045.js";const _s={key:0,class:"claim-list"},ps={class:"left"},fs={alt:""},hs={class:"right"},gs=ae({__name:"claim-list",props:{myClaimList:{type:Object,default:()=>[]}},setup(e){return(h,L)=>{const N=Ce("image");return e.myClaimList&&e.myClaimList.length>0?(n(),d("div",_s,[(n(!0),d(Q,null,X(e.myClaimList,m=>(n(),d("div",{key:m,class:"claim-item"},[s("div",ps,[we(s("img",fs,null,512),[[N,m.logo_url]]),s("span",null,$(m.symbol),1)]),s("div",hs,[s("span",null,$(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",null,$(D(G)(m.amountUSD,2,!1,!1)),1)])]))),128))])):j("",!0)}}});const Te=le(gs,[["__scopeId","data-v-c3e2798b"]]),oe=g(!1),ue=g(!1),Ye=Re(),{setIsShowSuccess:ws,setIsShowRejected:Le,setIsShowWaiting:pe,setTransactionDesc:ys,setTransactionTxid:Ne}=Ye,bs=ts("Sui"),fe=os("Sui"),ks=Pe(),Ue=k(()=>ks),je=ge(),Ss=k(()=>je),$s=k(()=>Ye),Ls=async e=>{ue.value=!0;try{const h=[],L=[];e.forEach(v=>{const F=v.rewarderInfo.filter(b=>b.emissionsEveryDay>0).map(b=>b.coinAddress);v.positionSource=="clmm"?h.push({pool_id:v.pool,pos_id:v.pos_object_id,collect_fee:!0,rewarder_coin_types:F,coinTypeA:v.coin_type_a,coinTypeB:v.coin_type_b}):L.push({pool_id:v.pool_id,position_nft_id:v.id,clmm_pool_id:v.clmm_pool_id,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:F,coinTypeA:v.coinTypeA,coinTypeB:v.coinTypeB})}),Ne(""),ys("Claim Yield"),pe(!0);const N=await bs.batchHarvestAndClmmFee(L,h),m=await fe.signAndExecuteTransactionBlock(Ue.value.currentWallet,N.txb,N.payloadParams),T=fe.handleTx(m);if(T&&T.hash){Ne(T.hash),pe(!1),ws(!0);const v={title:"Claim",desc:"Claim Yield",hash:T.hash};v.res=T.res,fe.showTransitionPending(v),await fe.watchTransaction(v)&&setTimeout(()=>{je.getMyPositons(Ue.value.address,Ss.value.poolsObj,$s.value.chainName)},1e3)}else pe(!1),Le(!0);ue.value=!1,oe.value=!1}catch(h){ue.value=!1,pe(!1),Le(!0),oe.value=!1,console.log("batchHarvestAndClmmFee error:",h)}},Se=e=>(re("data-v-8e7a4ef5"),e=e(),de(),e),Ns={class:"claim-yield-content"},Us={class:"total-claim"},Cs=Se(()=>s("div",null,"Total Claim",-1)),As={class:"total-claim-usd"},Rs=Se(()=>s("svg",{"aria-hidden":"true",class:"back-icon"},[s("use",{"xlink:href":"#icon-icon-back"})],-1)),Ps=Se(()=>s("span",null,"Back",-1)),Ds=[Rs,Ps],Os=ae({__name:"claim-yield",props:{pendingYield:{type:Number,default:0},myClaimList:{type:Object,default:()=>[]},myClaimPositionList:{type:Object,default:()=>[]}},setup(e){return(h,L)=>{const N=he;return n(),I(D(Ae),{title:"Claim Yield",visible:!0,footer:null,width:"440px",onCancel:L[2]||(L[2]=m=>h.$emit("close"))},{default:Z(()=>[s("div",Ns,[s("div",Us,[Cs,s("div",As,$(e.pendingYield>0&&e.pendingYield<.01?"<$0.01":`$${D(ke)(e.pendingYield,2)}`),1)]),B(Te,{"my-claim-list":e.myClaimList},null,8,["my-claim-list"]),s("div",{class:"choose-amount",onClick:L[0]||(L[0]=m=>h.$emit("chooseAmount"))},Ds),B(N,{class:"confirm-btn",loading:D(ue),onClick:L[1]||(L[1]=m=>D(Ls)(e.myClaimPositionList))},{default:Z(()=>[ee("Confirm")]),_:1},8,["loading"])])]),_:1})}}});const Ts=le(Os,[["__scopeId","data-v-8e7a4ef5"]]),Ee=e=>(re("data-v-4237fa3c"),e=e(),de(),e),Ys={class:"fees-and-reward"},js={key:0,class:"fees"},Es={class:"fees-title"},Bs=Ee(()=>s("div",null,"Fees",-1)),Fs={alt:""},Gs={class:"symbol"},qs={class:"amount"},Vs={class:"amount-usd"},Ms={key:1,class:"fees"},Ws={class:"fees-title"},xs=Ee(()=>s("div",null,"Mining rewards",-1)),zs={alt:""},Hs={class:"symbol"},Zs={class:"amount"},Js={class:"amount-usd"},Ks=ae({__name:"fees-and-reward",props:{pendingRewarderList:{type:Object,default:()=>[]},pendingFeesList:{type:Object,default:()=>[]},rewarderUsd:{type:String,default:""},feeOwedUsd:{type:String,default:""}},setup(e){return(h,L)=>{const N=Ce("image");return n(),d("div",Ys,[e.feeOwedUsd&&e.feeOwedUsd>0?(n(),d("div",js,[s("div",Es,[Bs,s("div",null,$(D(G)(e.feeOwedUsd,2,!1,!1)),1)]),(n(!0),d(Q,null,X(e.pendingFeesList,m=>(n(),d("div",{key:m,class:"fees-details"},[s("div",null,[we(s("img",Fs,null,512),[[N,m.logo_url]]),s("span",Gs,$(m.symbol),1)]),s("div",null,[s("span",qs,$(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",Vs,"("+$(D(G)(m.amountUSD,2,!1,!1))+")",1)])]))),128))])):j("",!0),e.rewarderUsd&&e.rewarderUsd>0?(n(),d("div",Ms,[s("div",Ws,[xs,s("div",null,$(D(G)(e.rewarderUsd,2,!1,!1)),1)]),(n(!0),d(Q,null,X(e.pendingRewarderList,m=>(n(),d("div",{key:m,class:"fees-details"},[s("div",null,[we(s("img",zs,null,512),[[N,m.logo_url]]),s("span",Hs,$(m.symbol),1)]),s("div",null,[s("span",Zs,$(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",Js,"("+$(D(G)(m.amountUSD,2,!1,!1))+")",1)])]))),128))])):j("",!0)])}}});const Qs=le(Ks,[["__scopeId","data-v-4237fa3c"]]),ce=e=>(re("data-v-5c834a7c"),e=e(),de(),e),Xs={class:"yield-details-box"},Is={class:"yield-details"},et={class:"total-claim"},st=ce(()=>s("div",null,"Pending Yield",-1)),tt={class:"total-claim-usd"},ot={class:"position-detail"},at={class:"position-detail-top"},lt=ce(()=>s("div",{class:"left"},"Position",-1)),nt={class:"right"},it=ce(()=>s("span",null,"Hide yield < ",-1)),ut={class:"position-detail-bottom"},rt={class:"left"},dt={class:"top"},ct=["onClick"],vt={key:0,src:De},mt={class:"bottom"},_t={class:"right"},pt={key:0,class:"yield-amount"},ft={key:1,class:"yield-amount-zero"},ht={class:"select"},gt={class:"all"},wt=ce(()=>s("span",null,"Select all",-1)),yt={class:"amount-selected"},bt=ce(()=>s("div",null,"Amount selected",-1)),kt=ae({__name:"yield-details",props:{positionShowList:{type:Object,default:()=>[]},isShowYiedlDetails:{type:Boolean,default:!1}},emits:["showClaimYiedl"],setup(e,{emit:h}){const L=g(!0),N=g(!0),m=h,T=e,v=g(.01),F=g(),b=g([]),E=ge(),_=k(()=>E),w=k(()=>_.value.rewarderObj),R=k(()=>_.value.feeOwedObj),U=g([]),P=g("all"),M=g([]),W=u=>{const i=[];U.value=[];let a=new S(0);const l=[];u.forEach(f=>{var V,o,t,c,C,Y;const y=((V=w.value[f.tokenName])==null?void 0:V.pendingRewarder)||0,r=((o=R.value[f.tokenName])==null?void 0:o.feeOwed)||0,O=new S(isNaN(y)?0:y).add(new S(isNaN(r)?0:r)).toString();a=a.add(new S(isNaN(y)?0:y)).add(new S(isNaN(r)?0:r)),Number(O)>0&&l.push(f),L.value&&Number(O)>Number(v.value)&&i.push({...f,totalRewardUsd:O,pendingRewarderList:(t=w.value[f.tokenName])==null?void 0:t.pendingRewarderArr,pendingFeesList:(c=R.value[f.tokenName])==null?void 0:c.feesResult,rewarderUsd:y,feeOwedUsd:r}),L.value||i.push({...f,totalRewardUsd:O,pendingRewarderList:(C=w.value[f.tokenName])==null?void 0:C.pendingRewarderArr,pendingFeesList:(Y=R.value[f.tokenName])==null?void 0:Y.feesResult,rewarderUsd:y,feeOwedUsd:r})}),M.value=l,i.forEach(f=>{f.totalRewardUsd>0&&U.value.push(f.tokenName)}),L.value?U.value.length!==i.length?P.value="":P.value="all":U.value.length!==l.length?P.value="":P.value="all",N.value=!1,F.value=a,b.value=i.sort((f,y)=>y.totalRewardUsd-f.totalRewardUsd)},ne=k(()=>_.value.getPendingFeeSuccess),J=k(()=>_.value.getRewardSuccess);z(()=>[T.positionShowList,v.value,ne.value,J.value,L.value],([u,i,a,l])=>{u&&u.length>0&&a&&l&&W(u)},{immediate:!0});const se=u=>{const i=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");u.target.value=u.target.value.replace(i,"$1"),v.value=u.target.value},ie=()=>{(!v.value||v.value<.01)&&(v.value=.01)},H=u=>{const i=u.tokenName,a=U.value.indexOf(i);a>-1?U.value.splice(a,1):U.value.push(i),L.value?U.value.length!==b.value.length?P.value="":P.value="all":U.value.length!==M.value.length?P.value="":P.value="all"},K=()=>{P.value="all",b.value.forEach(u=>{!U.value.includes(u.tokenName)&&u.totalRewardUsd>0&&U.value.push(u.tokenName)})},A=k(()=>{let u=new S(0);return P.value=="all"?b.value.forEach(i=>{var f,y;const a=((f=w.value[i.tokenName])==null?void 0:f.pendingRewarder)||0,l=((y=R.value[i.tokenName])==null?void 0:y.feeOwed)||0;u=u.add(new S(isNaN(a)?0:a)).add(new S(isNaN(l)?0:l))}):U.value.forEach(i=>{var f,y;const a=((f=w.value[i])==null?void 0:f.pendingRewarder)||0,l=((y=R.value[i])==null?void 0:y.feeOwed)||0;u=u.add(new S(isNaN(a)?0:a)).add(new S(isNaN(l)?0:l))}),u.toString()}),p=()=>{const u=[];b.value.forEach(i=>{U.value.includes(i.tokenName)&&u.push(i)}),m("showClaimYiedl",u)};return(u,i)=>{const a=We,l=xe,f=ze,y=he;return n(),I(D(Ae),{title:"Details",footer:null,visible:e.isShowYiedlDetails,width:"440px","wrap-class-name":"details-modal",onCancel:i[2]||(i[2]=r=>u.$emit("close"))},{default:Z(()=>[s("div",Xs,[s("div",Is,[s("div",et,[st,s("div",tt,[s("span",null,$(D(G)(F.value,2,!1,!1)),1)])]),s("div",ot,[s("div",at,[lt,s("div",nt,[B(a,{class:"range-alerts-switch",checked:L.value,onClick:i[0]||(i[0]=()=>{L.value=!L.value,N.value=!1})},null,8,["checked"]),it,B(l,{value:`$${v.value}`,onChange:se,onBlur:ie},null,8,["value"])])]),s("div",ut,[b.value&&b.value.length>0?(n(!0),d(Q,{key:0},X(b.value,r=>(n(),d("div",{key:r,class:"position-item"},[s("div",rt,[s("div",dt,[s("div",{class:ye(["radio",r.totalRewardUsd<=0?"radio-disable":""]),onClick:O=>r.totalRewardUsd>0?H(r):""},[(P.value=="all"||U.value.includes(r.tokenName))&&r.totalRewardUsd>0?(n(),d("img",vt)):j("",!0)],10,ct),B(us,{"from-coin":r.needReverse?r.token_b:r.token_a,"to-coin":r.needReverse?r.token_a:r.token_b,"fee-tier":r.fee*1e3},null,8,["from-coin","to-coin","fee-tier"])]),s("div",mt,$(r.tokenName),1)]),s("div",_t,[r.totalRewardUsd>0?(n(),d("div",pt,[B(f,{placement:"bottomRight","overlay-class-name":"yield-amount-tooltip"},{title:Z(()=>[B(Qs,{"pending-fees-list":r.pendingFeesList,"pending-rewarder-list":r.pendingRewarderList,"rewarder-usd":r.rewarderUsd,"fee-owed-usd":r.feeOwedUsd},null,8,["pending-fees-list","pending-rewarder-list","rewarder-usd","fee-owed-usd"])]),default:Z(()=>[ee($(D(G)(r.totalRewardUsd,2,!1,!1))+" ",1)]),_:2},1024)])):(n(),d("div",ft,$(D(G)(r.totalRewardUsd,2,!1,!1)),1))])]))),128)):(n(),I(rs,{key:1,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found"}))])])]),s("div",ht,[s("div",gt,[s("div",{class:"radio",onClick:K},[P.value=="all"?(n(),d("img",{key:0,src:De,onClick:i[1]||(i[1]=be(()=>{U.value=[],P.value=""},["stop"]))})):j("",!0)]),wt]),s("div",yt,[bt,s("div",null,$(D(G)(A.value,2,!1,!1)),1)])]),B(y,{class:"claim-yield-btn",disabled:A.value=="0",onClick:p},{default:Z(()=>[ee("Claim Yield")]),_:1},8,["disabled"])])]),_:1},8,["visible"])}}});const St=le(kt,[["__scopeId","data-v-5c834a7c"]]),Be=e=>(re("data-v-826d7f95"),e=e(),de(),e),$t={class:"total-info"},Lt={class:"total-liquidity"},Nt=Be(()=>s("span",null,"Total Liquidity",-1)),Ut={key:0,class:"skeleton-box"},Ct={key:1,class:"total-liquidity-usd"},At={class:"pending-yield"},Rt=Be(()=>s("div",null,"Pending Yield",-1)),Pt={key:0,class:"skeleton-box"},Dt={key:1},Ot={key:0,class:"claim-list-box"},Tt={class:"claim-list-content"},Yt=ae({__name:"total-position",setup(e){const h=g(!1),L=ge(),N=k(()=>L),m=k(()=>N.value.rewarderObj),T=k(()=>N.value.feeOwedObj),v=k(()=>N.value.positionShowList),F=k(()=>N.value.myPositionsLoading),b=k(()=>N.value.getPendingFeeSuccess),E=k(()=>N.value.getRewardSuccess),_=g(0),w=g(0),R=g(!0),U=g([]),P=g([]),M=g([]),W=A=>{let p=new S(0);const u=[];A.forEach(i=>{p=p.add(new S(isNaN(i.amountUSD)?0:i.amountUSD)),u.push(i.tokenName)}),U.value=u,_.value=p.toNumber()},ne=(A,p)=>{let u=new S(0);const i=[];U.value.forEach(l=>{var r,O,V,o;const f=((r=A[l])==null?void 0:r.pendingRewarder)||0,y=((O=p[l])==null?void 0:O.feeOwed)||0;u=u.add(new S(isNaN(f)?0:f)).add(new S(isNaN(y)?0:y)),(V=A[l])!=null&&V.pendingRewarderArr&&i.push(...A[l].pendingRewarderArr),(o=p[l])!=null&&o.feesResult&&i.push(...p[l].feesResult)});const a={};i.forEach(l=>{a[l.address]?a[l.address]={...l,amountUSD:new S(a[l.address].amountUSD).add(isNaN(l.amountUSD)?0:l.amountUSD).toString(),amount:new S(a[l.address].amount).add(isNaN(l.amountUSD)?0:l.amountUSD).toString()}:(a[l.address]={},a[l.address]={...l,amountUSD:new S(0).add(isNaN(l.amountUSD)?0:l.amountUSD).toString(),amount:new S(0).add(l.amount).toString()})}),M.value=Object.values(a).filter(l=>l.amount>0).sort((l,f)=>f.amountUSD-l.amountUSD),w.value=u.toNumber(),R.value=!1};z(()=>v.value,A=>{A&&A.length>0?W(A):W([])},{immediate:!0}),z(()=>[b.value,E.value,U.value,m.value,T.value],([A,p,u,i,a])=>{A&&p?ne(i,a):R.value=!0},{immediate:!0,deep:!0});const J=g(),se=g(),ie=A=>{h.value=!1,oe.value=!0;let p=new S(0);const u=[],i={};A.forEach(a=>{var r,O,V,o;const l=a.tokenName,f=((r=m.value[l])==null?void 0:r.pendingRewarder)||0,y=((O=T.value[l])==null?void 0:O.feeOwed)||0;p=p.add(new S(f)).add(new S(y)),(V=m.value[l])!=null&&V.pendingRewarderArr&&u.push(...m.value[l].pendingRewarderArr),(o=T.value[l])!=null&&o.feesResult&&u.push(...T.value[l].feesResult)}),u.forEach(a=>{i[a.address]?i[a.address]={...a,amountUSD:new S(i[a.address].amountUSD).add(isNaN(a.amountUSD)?0:a.amountUSD).toString(),amount:new S(i[a.address].amount).add(isNaN(a.amountUSD)?0:a.amountUSD).toString()}:(i[a.address]={},i[a.address]={...a,amountUSD:new S(0).add(isNaN(a.amountUSD)?0:a.amountUSD).toString(),amount:new S(0).add(a.amount).toString()})}),J.value=p.toNumber(),P.value=Object.values(i).filter(a=>a.amount>0).sort((a,l)=>l.amountUSD-a.amountUSD),se.value=A},H=g(1),K=()=>{w.value>0&&(h.value=!0,H.value=H.value==1?2:1)};return(A,p)=>{const u=Ze,i=he;return n(),d("div",$t,[s("div",Lt,[Nt,!_.value&&F.value?(n(),d("div",Ut,[B(u,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(n(),d("span",Ct,$(_.value>0&&_.value<.01?"<$0.01":`$${D(ke)(_.value,2)}`),1))]),s("div",At,[Rt,R.value?(n(),d("div",Pt,[B(u,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(n(),d("div",Dt,[s("span",{class:"pending-yield-usd",style:He(w.value<=0?{border:"none"}:{}),onClick:K},[ee($(w.value>0&&w.value<.01?"<$0.01":`$${D(ke)(w.value,2)}`)+" ",1),w.value>0?(n(),d("div",Ot,[s("div",Tt,[B(Te,{"my-claim-list":M.value},null,8,["my-claim-list"])])])):j("",!0)],4),w.value>0?(n(),d("img",{key:0,src:is,alt:"",onClick:K})):j("",!0),B(i,{class:"claim-all-btn",disabled:w.value<=0,loading:D(ue),onClick:K},{default:Z(()=>[ee("Claim All")]),_:1},8,["disabled","loading"])]))]),D(oe)?(n(),I(Ts,{key:0,"pending-yield":J.value,"my-claim-list":P.value,"my-claim-position-list":se.value,onClose:p[0]||(p[0]=a=>oe.value=!1),onChooseAmount:p[1]||(p[1]=()=>{oe.value=!1,h.value=!0})},null,8,["pending-yield","my-claim-list","my-claim-position-list"])):j("",!0),(n(),I(St,{key:H.value,"position-show-list":v.value,"is-show-yiedl-details":h.value,onClose:p[2]||(p[2]=()=>{h.value=!1}),onShowClaimYiedl:ie},null,8,["position-show-list","is-show-yiedl-details"]))])}}});const jt=le(Yt,[["__scopeId","data-v-826d7f95"]]),Et=ae({components:{TotalPosition:jt},setup(){const e=g(!1),{t:h}=Je(),L=g(["position"]),N=Ke(),m=g(""),T=Re(),v=k(()=>T),F=k(()=>v.value.chainName?as[v.value.chainName]:{});let b=g([]);const E=ge(),_=k(()=>E),w=Pe(),R=k(()=>w),U=g(!1),P=g(h("tab.all")),M=g([h("tab.layerZero"),h("tab.wormhole"),h("tab.celer")]),W=g(!0),ne=g("TVL"),J=()=>{e.value=!0,b.value=[],R.value.address&&(E.setPools(u.value.poolConfigList,v.value.chainName),E.getMyPositons(R.value.address,_.value.poolsObj,v.value.chainName)),setTimeout(()=>{e.value=!1},1e3)},se=k(()=>{const o=Array.from(new Set(_.value.poolConfigList.flatMap(t=>!(t!=null&&t.category)||(t==null?void 0:t.category)==""?"All":t==null?void 0:t.category)));return console.log(o,"newArr"),o.length<=1?[]:o}),ie=o=>{_.value.setCurrentPoolTab(o)};z(()=>v.value.isRefresh,o=>{var t,c,C,Y;o&&((Y=(C=(c=(t=N==null?void 0:N.currentRoute)==null?void 0:t.value)==null?void 0:c.name)==null?void 0:C.split("-"))==null?void 0:Y[1])=="position"&&J()}),Qe(()=>{b.value=[],document.addEventListener("click",()=>{U.value=!1}),E.setMyPositionsLoading(!0)}),Xe(()=>{document.addEventListener("click",()=>{U.value=!1})}),Ie(()=>{R.value.connected||(b.value=[])});const H=()=>{e.value=!0;let o=[];_.value.myPositions.forEach(t=>{var te,ve,me,_e;v.value.addressLpTokens[t.address];let c=t.positionSource=="farming",C,Y;const q=t.amountA*((te=_.value.RATES[t.token_a.address])==null?void 0:te.price),x=t.amountB*((ve=_.value.RATES[t.token_b.address])==null?void 0:ve.price);(me=_.value.RATES[t.token_a.address])!=null&&me.price&&((_e=_.value.RATES[t.token_b.address])!=null&&_e.price)?(C=q+x,Y=q+x):(C=" --",Y=0),console.log(_.value.currentPoolTab,"##pools.value.currentPoolTab"),(_.value.currentPoolTab=="All"||_.value.currentPoolTab!=="All"&&t.category==_.value.currentPoolTab)&&o.push({...t,amountUSD:C,amountUSDOrigin:Y,tokenARates:q,tokenBRates:x,isStableFarming:c})}),P.value!="All"?W.value?(b.value=o.sort((t,c)=>Number(c.amountUSDOrigin)-Number(t.amountUSDOrigin)),e.value=!1):(b.value=o.sort((t,c)=>Number(t.amountUSDOrigin)-Number(c.amountUSDOrigin)),e.value=!1):W.value?(b.value=o.sort((t,c)=>c.amountUSDOrigin-t.amountUSDOrigin),e.value=!1):(b.value=o.sort((t,c)=>t.amountUSDOrigin-c.amountUSDOrigin),e.value=!1),console.log(b.value,"list.value========>")};z(()=>[_.value.myPositions,_.value.RATES],([o,t])=>{o&&t&&(console.log("0605==>updateLpList9099999"),H())},{immediate:!0}),z(()=>[R.value.address,_.value.poolConfigList,_.value.poolsObj,v.value.chainName],([o,t,c,C])=>{var Y,q,x;o&&t&&t.length>0&&C&&(C!=null&&C.toLowerCase().includes((Y=t[0])==null?void 0:Y.chain))&&!ls(c)&&(C==="Aptos"?t.length===Object.values(c).length:(x=(q=Object.values(c)[0])==null?void 0:q.chain)!=null&&x.includes("sui"))&&(console.log(c,t,"0605==>getMyPositons9099999"),E.getMyPositons(R.value.address,c,C))},{immediate:!0,deep:!0}),z(()=>R.value.address,o=>{o||E.setMyPositions()},{immediate:!0}),z(()=>[P.value,W.value,_.value.currentPoolTab],([o])=>{H()});const K=o=>{const t=[];M.value.forEach((c,C)=>{c==o?t[C]=P.value:t[C]=c}),M.value=t,P.value=o},A=ns(),p=k(()=>A),u=k(()=>E),i=async o=>{await A.getSourceGroups();const t=p.value.sourceGroups&&p.value.sourceGroups.length>0&&p.value.sourceGroups[0]&&p.value.sourceGroups[0].sources||[];console.log(t,"####source"),console.log(o,"###myPositions");for(let c=0;c<t.length;c++){const{pool_address:C,position_index:Y}=JSON.parse(t[c].blockchainAddress);let q=!1,x;for(let te=0;te<o.length;te++){const{poolAddress:ve,index:me,positionSource:_e,name:Ge}=o[te];C==ve&&Number(_e=="clmm"?me:Ge.split("-")[1])==Number(Y)&&(q=!0),x={pool_address:C,position_index:Y}}q||await A.subscribePosition(x,"",!1,!1)}},a=async()=>{await A.getSourceGroups();const o=p.value.sourceGroups&&p.value.sourceGroups.length>0&&p.value.sourceGroups[0]&&p.value.sourceGroups[0].sources||[];for(let t=0;t<o.length;t++){const{pool_address:c,position_index:C}=JSON.parse(o[t].blockchainAddress),{name:Y}=o[t],q={pool_address:c,position_index:C};await A.subscribePosition(q,Y,!1,!1)}},l=k(()=>u.value.myPositionsLoading);z(()=>u.value.myPositions,(o,t)=>{F.value.hasNotifi&&(o&&o.length>0&&t&&t.length!==o.length?i(o):o&&o.length==0&&!l.value&&a())},{immediate:!0});const f=o=>{var t;return(o==null?void 0:o.logoURI)||(o==null?void 0:o.logo_url)||((t=_.value.tokensObj[o==null?void 0:o.address])==null?void 0:t.logo_url)||(v.value.theme==="default"?$e("/image/coins/unknown.png"):$e("/image/coins/sui-unknown.png"))},y=g(null),r=k(()=>y.value&&y.value.firstToken?y.value.firstToken:null),O=k(()=>y.value&&y.value.lastToken?y.value.lastToken:null),V=k(()=>{let o=[];o=b.value;const t=o.filter((c,C)=>r.value&&O.value?c.coinA.symbol==r.value.symbol&&c.coinB.symbol==O.value.symbol||c.coinA.symbol==O.value.symbol&&c.coinB.symbol==r.value.symbol:r.value?c.coinA.symbol.toLowerCase().includes(r.value.symbol.toLowerCase())||c.coinB.symbol.toLowerCase().includes(r.value.symbol.toLowerCase()):O.value?c.coinA.symbol.toLowerCase().includes(O.value.symbol.toLowerCase())||c.coinB.symbol.toLowerCase().includes(O.value.symbol.toLowerCase()):o);return _.value.myPositionsLoading||(T.setPositiomAmount(t.length),E.setPositionShowList(t)),t});return es(()=>{T.setPositiomAmount("--"),E.setPositionShowList([])}),{tabArr:se,changeTab:ie,showList:V,childTokenSelectRef:y,firstToken:r,lastToken:O,getCoinIcon:f,changeSortLabel:K,label:U,labelList:M,labelValue:P,select:W,selectValue:ne,t:h,pools:_,store:v,wallet:R,list:b,clickRefresh:J,refresh:e,current:L,router:N,searchKey:m}}});const Fe=e=>(re("data-v-0eb16e50"),e=e(),de(),e),Bt={class:"upgrade-position-list-container"},Ft={class:"position-card-top"},Gt={class:"content-top"},qt={class:"content-top-left"},Vt={key:0,class:"tag-list"},Mt=["onClick"],Wt={class:"content-top-right"},xt={class:"value"},zt=Fe(()=>s("use",{"xlink:href":"#icon-icon_on"},null,-1)),Ht=[zt],Zt={key:0,class:"select-item"},Jt=["onClick"],Kt={class:"search-select-box"},Qt=Fe(()=>s("span",null,"TVL",-1)),Xt={key:0,src:Oe,alt:""},It={key:1,class:"fan-img",src:Oe,alt:""},eo={key:0,class:"upgrade-loading"},so={key:1,class:"position-list"},to={key:2,class:"no-data"},oo={key:0,src:ds,alt:""},ao={key:1,src:cs,alt:""},lo={key:3,class:"no-data"},no={key:0,src:vs,alt:""},io={key:1,src:ms,alt:""};function uo(e,h,L,N,m,T){const v=ss("TotalPosition"),F=qe,b=Ve,E=Me,_=he;return n(),d("div",Bt,[s("div",Ft,[e.wallet&&e.wallet.address?(n(),I(v,{key:0})):j("",!0),s("div",Gt,[s("div",qt,[e.tabArr.length>1?(n(),d("div",Vt,[(n(!0),d(Q,null,X(e.tabArr,(w,R)=>(n(),d("div",{key:R,class:ye(["tag-item",w==e.pools.currentPoolTab?`tag-active tab-num-${e.tabArr.length}`:`tab-num-${e.tabArr.length}`]),onClick:U=>e.changeTab(w)},$(w),11,Mt))),128))])):j("",!0),B(F,{ref:"childTokenSelectRef"},null,512)]),s("div",Wt,[e.store.theme=="default"?(n(),d("div",{key:0,class:"search-label",onClick:h[0]||(h[0]=be(w=>e.label=!e.label,["stop"]))},[s("span",null,$(e.$t("newAdd.label")),1),s("div",xt,$(e.labelValue),1),(n(),d("svg",{"aria-hidden":"true",class:ye(e.label?"show-icon icon":"icon")},Ht,2)),e.label?(n(),d("div",Zt,[(n(!0),d(Q,null,X(e.labelList,(w,R)=>(n(),d("div",{key:R,class:"select-menu-item",onClick:U=>e.changeSortLabel(w)},$(w),9,Jt))),128))])):j("",!0)])):j("",!0),s("div",Kt,[s("div",{class:"search-select",onClick:h[1]||(h[1]=be(w=>e.select=!e.select,["stop"]))},[ee($(e.$t("newAdd.sortBy"))+" ",1),s("div",null,[Qt,e.select?(n(),d("img",Xt)):(n(),d("img",It))])])])])])]),e.pools.myPositionsLoading&&e.wallet.connected?(n(),d("div",eo,[B(b,{loading:e.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):j("",!0),e.showList&&e.showList.length>0&&e.wallet.connected&&!e.pools.myPositionsLoading?(n(),d("div",so,[(n(!0),d(Q,null,X(e.showList,(w,R)=>(n(),I(E,{key:R,"p-item":w},null,8,["p-item"]))),128))])):j("",!0),e.showList&&e.showList.length<=0&&!e.pools.myPositionsLoading&&e.wallet.connected?(n(),d("div",to,[e.store.theme=="default"?(n(),d("img",oo)):(n(),d("img",ao)),s("span",null,$(e.$t("common.noLiquidityPositions")),1)])):j("",!0),e.wallet.connected?j("",!0):(n(),d("div",lo,[e.store.theme=="default"?(n(),d("img",no)):(n(),d("img",io)),B(_,{class:"connect-wallet",onClick:h[2]||(h[2]=w=>e.wallet.setIsShowWalletModal(!0))},{default:Z(()=>[ee($(e.$t("button.connectWallet")),1)]),_:1})]))])}const zo=le(Et,[["render",uo],["__scopeId","data-v-0eb16e50"]]);export{zo as default};
