import{_ as Vo}from"./back.55d72f7a.js";import{_ as xo}from"./swap-setting.9acd7a47.js";import{b as Xe,u as xe,d as me,l as en,n as on,j as be,c as io,h as Z,f as bo,s as Ue,a as co,x as Se,o as qe,p as Ao,N as No,O as Ro,T as Co,F as nn,r as tn}from"./pool.76bc86a5.js";import{a as ze,r as q,m as w,e as Ye,o as _,f as $,h as n,v as F,c as Te,x as ue,p as so,k as ao,C as Oo,D as we,b as lo,i as ae,z as vo,y as qo,t as Pe,U as Lo,K as fo,q as wo,u as J,j as ce,w as Le,V as Bo,l as yo,a5 as sn,J as Ge,L as an,a7 as $o,G as So,F as Ve,s as no,B as mo,N as ln,a8 as rn,a9 as un,O as Mo,a2 as dn,S as cn}from"./entry.232b33e0.js";import{_ as po}from"./token-warning.12686c2d.js";import{_ as Uo}from"./status-block.8c2065d4.js";import{s as uo,m as mn,l as vn,b as fn,a as pn}from"./transform.c672907f.js";import{D as k}from"./decimal.0bdeb344.js";/* empty css              */import{i as to}from"./import-icon.de3e6c66.js";import"./index.3c48799d.js";import{_ as ho}from"./assets-card.7835b458.js";import{_ as hn}from"./coin-lock.c6364904.js";import{a as gn}from"./new-add-or-create.e1a46e2f.js";import{_ as bn,a as kn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              */import{u as jo}from"./notifi.9afc6fea.js";import{_ as _n}from"./apr-tips.3cac35f2.js";import{u as Eo}from"./farms.b1f28f88.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-warning_2x.a2843296.js";import"./icon-error_2x.ad6d68b3.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.ec5c09a5.js";import"./useWhale.38443e1e.js";import"./icon_rewards_2x.5eefb6f0.js";const ko=Math.PI,_o=2*ko,Ke=1e-6,wn=_o-Ke;function Do(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function yn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const i=10**t;return function(s){this._+=s[0];for(let S=1,h=s.length;S<h;++S)this._+=Math.round(arguments[S]*i)/i+s[S]}}class In{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:yn(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,s,S){this._append`Q${+t},${+i},${this._x1=+s},${this._y1=+S}`}bezierCurveTo(t,i,s,S,h,P){this._append`C${+t},${+i},${+s},${+S},${this._x1=+h},${this._y1=+P}`}arcTo(t,i,s,S,h){if(t=+t,i=+i,s=+s,S=+S,h=+h,h<0)throw new Error(`negative radius: ${h}`);let P=this._x1,c=this._y1,o=s-t,l=S-i,b=P-t,r=c-i,g=b*b+r*r;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(g>Ke)if(!(Math.abs(r*o-l*b)>Ke)||!h)this._append`L${this._x1=t},${this._y1=i}`;else{let H=s-P,se=S-c,ee=o*o+l*l,G=H*H+se*se,u=Math.sqrt(ee),p=Math.sqrt(g),T=h*Math.tan((ko-Math.acos((ee+g-G)/(2*u*p)))/2),m=T/p,R=T/u;Math.abs(m-1)>Ke&&this._append`L${t+m*b},${i+m*r}`,this._append`A${h},${h},0,0,${+(r*H>b*se)},${this._x1=t+R*o},${this._y1=i+R*l}`}}arc(t,i,s,S,h,P){if(t=+t,i=+i,s=+s,P=!!P,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(S),o=s*Math.sin(S),l=t+c,b=i+o,r=1^P,g=P?S-h:h-S;this._x1===null?this._append`M${l},${b}`:(Math.abs(this._x1-l)>Ke||Math.abs(this._y1-b)>Ke)&&this._append`L${l},${b}`,s&&(g<0&&(g=g%_o+_o),g>wn?this._append`A${s},${s},0,1,${r},${t-c},${i-o}A${s},${s},0,1,${r},${this._x1=l},${this._y1=b}`:g>Ke&&this._append`A${s},${s},0,${+(g>=ko)},${r},${this._x1=t+s*Math.cos(h)},${this._y1=i+s*Math.sin(h)}`)}rect(t,i,s,S){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${s=+s}v${+S}h${-s}Z`}toString(){return this._}}function oo(e){return function(){return e}}function An(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);t=s}return e},()=>new In(t)}function Cn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $n(e){return new Fo(e)}function Sn(e){return e[0]}function Pn(e){return e[1]}function Tn(e,t){var i=oo(!0),s=null,S=$n,h=null,P=An(c);e=typeof e=="function"?e:e===void 0?Sn:oo(e),t=typeof t=="function"?t:t===void 0?Pn:oo(t);function c(o){var l,b=(o=Cn(o)).length,r,g=!1,H;for(s==null&&(h=S(H=P())),l=0;l<=b;++l)!(l<b&&i(r=o[l],l,o))===g&&((g=!g)?h.lineStart():h.lineEnd()),g&&h.point(+e(r,l,o),+t(r,l,o));if(H)return h=null,H+""||null}return c.x=function(o){return arguments.length?(e=typeof o=="function"?o:oo(+o),c):e},c.y=function(o){return arguments.length?(t=typeof o=="function"?o:oo(+o),c):t},c.defined=function(o){return arguments.length?(i=typeof o=="function"?o:oo(!!o),c):i},c.curve=function(o){return arguments.length?(S=o,s!=null&&(h=S(s)),c):S},c.context=function(o){return arguments.length?(o==null?s=h=null:h=S(s=o),c):s},c}function Po(){}function Wo(e){this._context=e}Wo.prototype={areaStart:Po,areaEnd:Po,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Nn(e){return new Wo(e)}const Rn=ze({setup(){const e=Xe(),t=q(!1),i=w(()=>e);return{slippage:w(()=>i.value.slippage),isShowSwapSetting:t}}});const On=e=>(so("data-v-82585f8b"),e=e(),ao(),e),qn=On(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Ln(e,t,i,s,S,h){const P=xo;return _(),$("div",{class:"slippage-icon",onClick:t[1]||(t[1]=c=>e.isShowSwapSetting=!0)},[qn,n("span",null,F(e.slippage)+"%",1),e.isShowSwapSetting?(_(),Te(P,{key:0,onOnClose:t[0]||(t[0]=c=>e.isShowSwapSetting=!1)})):ue("",!0)])}const Bn=Ye(Rn,[["render",Ln],["__scopeId","data-v-82585f8b"]]),Mn=ze({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const i=q(!1),s=q(null),S=q(0),h=q(20),P=xe(),c=Xe(),o=q(!1);Oo(()=>{clearInterval(s.value)});const l=()=>{s.value=setInterval(()=>{var G;o.value||S.value<h.value&&(S.value+=1,S.value===h.value&&((G=e==null?void 0:e.poolInfo)!=null&&G.poolAddress&&P.updateCurrentPools(e.poolInfo.poolAddress,c.chainName),S.value=0))},1e3)},b=w(()=>c.slippage),r=()=>{t.emit("clearAll")},g=q(!1),H=()=>{S.value=0,g.value=!0,t.emit("clickRefresh"),setTimeout(()=>{g.value=!1},1e3)};we(()=>e.poolInfo,G=>{G&&!s.value&&l()},{immediate:!0});const se=lo(),ee=w(()=>c.chainName);return{clickRefresh:H,isShowSwapSetting:i,countdown:S,autoRefreshTime:h,slippage:b,clearAll:r,checkNullObj:me,router:se,loading:o,chainName:ee,refresh:g}}});const Un=e=>(so("data-v-ca768f9b"),e=e(),ao(),e),jn={class:"new-position-title"},En={class:"left"},Dn={class:"right"},Fn=Un(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Wn=[Fn];function Hn(e,t,i,s,S,h){const P=Vo,c=Bn;return _(),$("div",jn,[n("div",En,[ae(P)]),n("div",Dn,[ae(c),(_(),$("svg",{"aria-hidden":"true",class:vo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Wn,2))])])}const Ho=Ye(Mn,[["render",Hn],["__scopeId","data-v-ca768f9b"]]);function To(e,t,i){const s=new k(10).pow(t-i);return new k(1.0001).pow(e).mul(s)}const Xn=ze({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const i=q(1),s=q(""),S=q(""),h=w(()=>{var m,R,f;return r.sqrtPriceX64ToPrice((m=e.poolInfo)==null?void 0:m.current_sqrt_price,(R=e.poolInfo)==null?void 0:R.coinA.decimals,(f=e.poolInfo)==null?void 0:f.coinB.decimals).toString()}),P=w(()=>{let m=0;return e.direction?m=(Number(e.minPrice)/Number(h.value)-1)*100:m=(Number(e.minPrice)/Number(1/Number(h.value))-1)*100,m=m>0&&m<.1?.1:m,m=m<0&&m>-.1?-.1:m,m}),c=w(()=>{let m=0;return e.direction?m=(Number(e.maxPrice)/Number(h.value)-1)*100:m=(Number(e.maxPrice)/Number(1/Number(h.value))-1)*100,m=m>0&&m<.1?.1:m,m=m<0&&m>-.1?-.1:m,m}),o=Xe(),l=w(()=>o),b=w(()=>l.value.chainName?io(l.value.chainName):{}),{TickMath:r,getNearestTickByTick:g}=b.value,H=()=>{const m=i.value/2;i.value=m,G(e.poolInfo,m)},se=()=>{const m=i.value*2;i.value=m,G(e.poolInfo,m)},ee=(m=[])=>{let R=6;const f=Math.abs(Number(m[0])-Number(m[m.length-1]));return f>=6?R=0:f>=1?R=1:f>=.1?R=2:f>=.01?R=3:f>=.001?R=4:f>=1e-4?R=5:f>=1e-5?R=6:f>=1e-6?R=7:f>=1e-7&&(R=8),R},G=(m,R=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",R),m&&m.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const f=Number(e.poolInfo.current_tick_index);let y=f+100*R,a=f-100*R,le,V;if(e.maxPrice==="âˆž")V=b.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=r.priceToTickIndex(new k(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=r.priceToTickIndex(new k(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=443636}if(e.minPrice==="0")le=b.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?le=r.priceToTickIndex(new k(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):le=r.priceToTickIndex(new k(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{le=-443636}let oe=0;if(e.currentPriceTab!=="full range"){if(f>=le&&f<=V){const M=f-le,he=V-f;oe=Math.max(Math.abs(M),Math.abs(he))}else f<le?oe=Math.abs(V-f):oe=Math.abs(f-le);y=f+oe+100*R,a=f-oe-100*R}else{const M=(Math.abs(f)>5e3,2e4);y=f+M*R,a=f-M*R}a<-443636&&(a=-443636),y>443636&&(y=443636);const X=new k(m.liquidity).div(Math.pow(10,8)).toString(),C=e.tickList,U=[],O=[];let Y={};for(let M=0;M<C.length;M++){if(Y=C[M],Y.index<=f&&Y.index>=a){if(U.length<1&&M!==0){const he=C[M-1];U.unshift({...he,index:a})}U.unshift(Y)}else if(Y.index>f&&Y.index<=y&&(O.push(Y),U.length<1&&M!==0)){const he=C[M-1];U.push({...he,index:a})}if(Y.index>y){const he=C[M];if(O.push({...he,index:y}),U.length<1&&M!==0){const _e=C[M-1];U.push({..._e,index:a})}break}}let x="0";for(let M=U.length-1;M>=0;M--)x=new k(x).plus(new k(U[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),U[M].liquityAmount=x;let Q=X;for(let M=0;M<O.length;M++)Q=new k(Q).plus(new k(O[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),O[M].liquityAmount=Q;let te=[];const K=C&&C.length>0?{index:f,liquityAmount:Number(X)}:{index:f,liquityAmount:0};(U.length>0||O.length>0)&&(te=[...U.reverse(),K,...O],e.direction||(te=te.reverse()));const pe=[];C.forEach(M=>{pe.push({...M,liquidityGross:M.liquidityGross.toString(),liquidityNet:M.liquidityNet.toString()})});for(let M=i.value;M<20;M++)if(y-a){i.value=i.value*4,G(e.poolInfo,i.value);break}console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",a,y,le,V,f),p(te,a,y,le,V,f)}};let u=q(!0);qo(()=>{document.body.clientWidth<750?u.value=!1:u.value=!0,window.onresize=()=>{document.body.clientWidth<750?u.value=!1:u.value=!0,G(e.poolInfo,i.value)}});const p=(m,R,f,y,a,le)=>{let V,oe;e.direction?(V=e.before7dContractPriceLowest?r.priceToTickIndex(new k(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",oe=e.before7dContractPriceHighest?r.priceToTickIndex(new k(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(V=e.before7dContractPriceLowest?r.priceToTickIndex(new k(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",oe=e.before7dContractPriceHighest?r.priceToTickIndex(new k(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const X={top:30,right:35,bottom:20,left:55};let C,U;u.value,C=340-X.left-X.right,U=205-X.top-X.bottom;const O=f-R,Y=parseInt(String(O/4));let x=[R+Y/4,R+Y,R+2*Y,f-Y,f-Y/4];const Q=R,te=f,K=C/(te-Q);e.currentPriceTab==="full range"&&(x=[R,R+2*Y,f]);const pe=x.map(L=>e.direction?To(L,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new k(1).div(To(L,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(pe),uo("#chart").selectAll("*").remove();const M=uo("#chart").attr("width",C+X.left+X.right).attr("height",U+X.top+X.bottom).append("g").attr("transform",`translate(${X.left},${X.right})`),he=mn(m,function(L){return Number(Math.abs(L.liquityAmount))})||0,_e=vn().range([0,U]).domain([he,0]);fn().rangeRound([0,C]).padding(.1);const Me=M.append("g").attr("id","barsBox").selectAll("rect").data(m).enter().append("rect");l.value.theme=="default"?Me.attr("x",function(L,B){return B===0?0:e.direction?Math.abs(L.index-Q)*K:Math.abs(te-L.index)*K}).attr("y",function(L,B){return e.direction?B===m.length-1?0:_e(L.liquityAmount):B===m.length-1?0:_e(m[B+1].liquityAmount)}).attr("width",function(L,B){return B===0&&m.length===1&&L.liquityAmount>0?C:(e.direction,B!==m.length-1?Math.abs(m[B+1].index-L.index)*K:0)}).attr("height",function(L,B){return B===0&&m.length===1&&L.liquityAmount>0?U:e.direction?B===m.length-1?0:U-_e(L.liquityAmount):B===m.length-1?0:U-_e(m[B+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(L,B){return B===0?0:e.direction?Math.abs(L.index-Q)*K:Math.abs(te-L.index)*K}).attr("y",function(L,B){return e.direction?B===m.length-1?0:_e(Math.abs(L.liquityAmount)):B===m.length-1?0:_e(Math.abs(m[B+1].liquityAmount))}).attr("width",function(L,B){return B===0&&m.length===1&&L.liquityAmount>0?C:(e.direction,B!==m.length-1?Math.abs(m[B+1].index-L.index)*K:0)}).attr("height",function(L,B){if(B===0&&m.length===1&&L.liquityAmount>0)return U;if(e.direction)return B===m.length-1?0:Number(L.liquityAmount)?U-_e(Math.abs(L.liquityAmount)):0;{if(B===m.length-1)return 0;const de=U-_e(Math.abs(m[B+1].liquityAmount));return Number(m[B+1].liquityAmount)?de:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const Ce=M.append("g");Ce.append("line").attr("x1",0).attr("y1",155).attr("x2",C).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),Ce.append("g");let d=0;e.direction?d=Math.abs(le-Q)*K:d=Math.abs(le-te)*K,(l.value.theme=="default"?M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+d+", 0)"),uo("#triangle").attr("width",8).attr("height",4);let I=[[0,0],[4,4],[8,0]],E=Tn().x(function(L){return L[0]}).y(function(L){return L[1]}).curve(Nn);const D=d-4;M.append("path").attr("d",E(I)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+D+", 0)");let j,z,ne,ie;e.direction?(j=y<Q?-100:parseInt(String(Math.abs(y-Q)*K)),z=a<Q?-100:parseInt(String(Math.abs(a-Q)*K)),ne=V<Q?-100:Math.abs(V-Q)*K,ie=oe<Q?-100:Math.abs(oe-Q)*K):(z=y<Q?-100:Math.abs(te-y)*K,j=a<Q?-100:Math.abs(te-a)*K,ie=V<Q?-100:Math.abs(te-V)*K,ne=oe<Q?-100:Math.abs(te-oe)*K),e.minPrice==="0"&&(j=0),e.maxPrice==="âˆž"&&(z=C),u.value?s.value=C-j+60+"px":s.value=C-j+52+"px",S.value=z+74+"px",V&&ne<C&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ne+", 0)"),oe&&ie<C&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ie+", 0)");const ve=pn().extent([[0,0],[C,U]]).handleSize(30).on("end",Ie);M.append("g").attr("class","brush").call(ve).call(ve.move,[j,z]);function Ie(L){if(!L.sourceEvent||!L.selection)return;u.value?s.value=C-L.selection[0]+60+"px":s.value=C-L.selection[0]+52+"px",S.value=L.selection[1]+74+"px";let B,de,ke=0,A=0;e.direction?(ke=g(parseInt(String(L.selection[0]/K+Q)),Number(e.poolInfo.tickSpacing)),B=r.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),A=g(parseInt(String(L.selection[1]/K+Q)),Number(e.poolInfo.tickSpacing)),de=r.tickIndexToPrice(A,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(A=g(te-L.selection[0]/K,Number(e.poolInfo.tickSpacing)),B=1/r.tickIndexToPrice(A,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ke=g(te-L.selection[1]/K,Number(e.poolInfo.tickSpacing)),de=1/r.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(be(String(B),6))),t.emit("onChangeMaxPrice",String(be(String(de),6)))}l.value.theme=="default"?uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};q(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([m,R,f,y,a])=>{m&&R&&f&&y&&a&&a.length>0&&G(m,i.value)},{immediate:!0});const T=q(!0);return we(()=>e.chartLoading,(m,R)=>{m!==R&&(T.value=m)},{immediate:!0,deep:!0}),{store:l,loading:T,zoomOut:H,zoomIn:se,rangeSizeLower:P,rangeSizeUpper:c,rangeSizeLowerPosition:s,rangeSizeUpperPosition:S,decimalFormat:en,numberformat:on}}});const zn=e=>(so("data-v-9f00649d"),e=e(),ao(),e),Yn={class:"chart-box"},Gn={class:"chart"},Jn=zn(()=>n("svg",{id:"chart"},null,-1)),Qn=[Jn];function Zn(e,t,i,s,S,h){return _(),$("div",Yn,[Pe(n("div",Gn,Qn,512),[[Lo,!e.loading]])])}const Xo=Ye(Xn,[["render",Zn],["__scopeId","data-v-9f00649d"]]),Kn=ze({components:{StatusBlock:Uo,NewPositionChart:Xo,TokenWarning:po},setup(e){const t=q(),i=q(),s=w(()=>{var f,y;return(y=(f=r.value)==null?void 0:f.poolInfo)==null?void 0:y.needReverse}),S=Xe(),h=w(()=>S),P=w(()=>h.value.currentExplorer),c=w(()=>h.value.theme),o=w(()=>h.value.chainName),l=xe(),b=w(()=>l),r=q({}),g=fo();we(()=>[b.value.currentPositionInfo,o.value],([f,y])=>{var a;(y=="Aptos"&&f||y=="Sui"&&f&&(f==null?void 0:f.nftHash)==((a=g==null?void 0:g.query)==null?void 0:a.pos))&&(r.value=f,t.value=r.value.token_a,i.value=r.value.token_b)},{immediate:!0});const H=f=>{var y;return(f==null?void 0:f.logoURI)||(f==null?void 0:f.logo_url)||((y=b.value.tokensObj[f==null?void 0:f.address])==null?void 0:y.logo_url)||(c.value==="default"?to("/image/coins/unknown.png"):to("/image/coins/sui-unknown.png"))},se=w(()=>o.value?io(o.value):{}),ee=q([]),G=async f=>{const{list:y}=await se.value.getTicks(f),a=y?se.value.getTickDataFromUrlData(y):[];ee.value=a};we(()=>[r.value,b.value.poolsObj],([f,y])=>{f&&!me(f)&&f.poolInfo&&y&&!me(y)&&G(y[f.poolAddress])},{immediate:!0});const u=q(!0),p=(f,y)=>f!=="0"&&y!=="âˆž"?Ue(1/(1-Number((f/y)**.25)),2)+"x":"1x",T=w(()=>r.value.minPrice&&r.value.maxPrice?p(r.value.minPrice,r.value.maxPrice):"--"),m=w(()=>r.value.maxPrice!=="âˆž"?new k(1).div(new k(r.value.maxPrice)).toString():"âˆž"),R=w(()=>r.value.minPrice>0?new k(1).div(new k(r.value.minPrice)).toString():"0");return{needReverse:s,getCoinIcon:H,theme:c,indexStore:S,direct:u,addCommom:Z,decimalUi:be,tickList:ee,positionInfo:r,fromCoin:t,toCoin:i,getExplorerUrl:bo,lever:T,currentExplorer:P,minPriceResever:m,maxPriceResever:R}}}),Vn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),xn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),et=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),ot=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Je=e=>(so("data-v-e3d7556c"),e=e(),ao(),e),nt={class:"new-position-info"},tt={class:"pool-info"},it={class:"left"},st={class:"coin-a"},at={alt:""},lt={class:"coin-b"},rt={alt:""},ut={class:"position-name"},dt=["href"],ct=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),mt=[ct],vt={key:0,class:"pool-fee"},ft=Je(()=>n("span",null,"Fee tier",-1)),pt={class:"right"},ht={class:"h5-pool-info"},gt={class:"coin-info"},bt={class:"coin-a"},kt={alt:""},_t={class:"coin-b"},wt={alt:""},yt={class:"position-name"},It=["href"],At=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Ct=[At],$t={key:0,class:"pool-fee"},St={class:"price-info"},Pt={class:"price-and-chart"},Tt={class:"left"},Nt={class:"current-price"},Rt=Je(()=>n("span",null,"Current Price",-1)),Ot={class:"coin-rate"},qt=Je(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Lt=Je(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Bt=[qt,Lt],Mt={key:0},Ut={key:1},jt={key:0,class:"position-range"},Et=Je(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Dt={key:0},Ft={key:1},Wt={key:2,src:Vn,alt:""},Ht={key:3,src:xn,alt:""},Xt={key:4},zt={key:5},Yt={key:1,class:"position-range position-range-warp"},Gt={key:0,class:"position-range-title"},Jt={key:1,class:"position-range-title"},Qt={key:2},Zt={key:3},Kt={class:"price-img"},Vt={key:0,src:et,alt:""},xt={key:1,src:ot,alt:""},ei={key:4},oi={key:5},ni={class:"lever"},ti={class:"lever-title"},ii=Je(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),si={class:"lever-text"},ai={class:"right"},li=Je(()=>n("div",{class:"chat-mask"},null,-1));function ri(e,t,i,s,S,h){var r,g,H,se,ee,G,u,p,T,m,R,f,y,a,le,V,oe,X,C,U,O,Y,x,Q,te,K,pe,M,he,_e;const P=po,c=Uo,o=Bo,l=Xo,b=wo("image");return _(),$("div",nt,[n("div",tt,[n("div",it,[n("div",st,[Pe(n("img",at,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(P,{address:e.needReverse?(se=(H=e.positionInfo)==null?void 0:H.token_b)==null?void 0:se.address:(g=(r=e.positionInfo)==null?void 0:r.token_a)==null?void 0:g.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",lt,[Pe(n("img",rt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(P,{address:e.needReverse?(p=(u=e.positionInfo)==null?void 0:u.token_a)==null?void 0:p.address:(G=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ut,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((m=(T=e.positionInfo)==null?void 0:T.name)==null?void 0:m.split("|")[1]),9,dt)]),(_(),$("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},mt)),e.positionInfo.fee?(_(),$("div",vt,[ft,ce(" "+F(e.positionInfo.fee*100)+"% ",1)])):ue("",!0)]),n("div",pt,[ae(c,{"current-status":(R=e.positionInfo)==null?void 0:R.currentStatus},null,8,["current-status"])])]),n("div",ht,[n("div",null,[n("div",gt,[n("div",bt,[Pe(n("img",kt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(P,{address:e.needReverse?(le=(a=e.positionInfo)==null?void 0:a.token_b)==null?void 0:le.address:(y=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:y.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",_t,[Pe(n("img",wt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(P,{address:e.needReverse?(C=(X=e.positionInfo)==null?void 0:X.token_a)==null?void 0:C.address:(oe=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:oe.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",yt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((O=(U=e.positionInfo)==null?void 0:U.name)==null?void 0:O.split("|")[1]),9,It),(_(),$("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Be=>e.indexStore.copy(e.positionInfo.nftHash))},Ct))]),e.positionInfo.fee?(_(),$("div",$t,F(e.positionInfo.fee*100)+"% ",1)):ue("",!0)])]),ae(c,{"current-status":(Y=e.positionInfo)==null?void 0:Y.currentStatus},null,8,["current-status"])]),n("div",St,[n("div",Pt,[n("div",Tt,[n("div",Nt,[n("div",null,[Rt,n("div",Ot,[n("div",{onClick:t[2]||(t[2]=Be=>e.direct=!e.direct)},Bt)])]),(e.needReverse?!e.direct:e.direct)?(_(),$("div",Mt,[ce(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,F((x=e.toCoin)==null?void 0:x.symbol)+" per "+F((Q=e.fromCoin)==null?void 0:Q.symbol),1)])):(_(),$("div",Ut,[ce(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,F((te=e.fromCoin)==null?void 0:te.symbol)+" per "+F((K=e.toCoin)==null?void 0:K.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(_(),$("div",jt,[Et,n("div",null,[(e.needReverse?!e.direct:e.direct)?(_(),$("div",Dt,[ce(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),$("div",Ft,[ce(F(((pe=e.positionInfo)==null?void 0:pe.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(_(),$("img",Wt)):(_(),$("img",Ht)),(e.needReverse?!e.direct:e.direct)?(_(),$("div",Xt,[ce(F(((M=e.positionInfo)==null?void 0:M.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),$("div",zt,[ce(F(((he=e.positionInfo)==null?void 0:he.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(_(),$("div",Yt,[(e.needReverse?!e.direct:e.direct)?(_(),$("span",Gt," Position Range ")):(_(),$("span",Jt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(_(),$("div",Qt,[ce(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),$("div",Zt,[ce(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Kt,[e.theme=="default"?(_(),$("img",Vt)):(_(),$("img",xt))]),(e.needReverse?!e.direct:e.direct)?(_(),$("div",ei,[ce(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),$("div",oi,[ce(F(((_e=e.positionInfo)==null?void 0:_e.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),ce(" Â  ")]))])),n("div",ni,[n("div",ti,[ae(o,{"overlay-class-name":"lever-tooltip"},{title:Le(()=>[ce("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Le(()=>[ii]),_:1})]),n("div",si,F(e.lever),1)])]),n("div",ai,[ae(l,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),li])])])])}const zo=Ye(Kn,[["render",ri],["__scopeId","data-v-e3d7556c"]]),ui=ze({components:{TokenWarning:po},setup(e,t){const{t:i}=yo(),{$notify:s}=sn(),S=Xe(),h=w(()=>S),P=xe(),c=w(()=>P),o=q({}),l=q({}),b=q({}),r=w(()=>h.value.chainName),g=w(()=>r.value?io(r.value):{}),H=fo(),se=q(!1),ee=async(d=null)=>{const v=d||o.value,I=c.value.addressLpTokens[v.poolAddress];if(I){const E=await g.value.getTickDataByIndex(I.ticks_handle,Number(v.tick_lower_index)),D=await g.value.getTickDataByIndex(I.ticks_handle,Number(v.tick_upper_index));let j={};r.value==="Aptos"?j=await g.value.getPosRewardersAmount({poolAddress:y.currentRoute.value.query.address,positionName:y.currentRoute.value.query.token,tickLowerData:E,tickUpperData:D}):j=await g.value.fetchPosRewardersAmount({poolAddress:v.poolAddress,positionId:v.pos_object_id||v.clmm_position_id,coinTypeA:v.coin_type_a||v.coinTypeA,coinTypeB:v.coin_type_b||v.coinTypeB,rewarderInfo:v.poolInfo.rewarder_infos});const z=[];let ne=new k(0);j.forEach((ie,ve)=>{var de,ke;const Ie=(de=c.value.tokensObj[ie.coin_address])==null?void 0:de.decimals,L=ie.amount_owed.toString();let B=new k(L).div(Math.pow(10,Ie)).toString();if(r.value=="Aptos"&&Number(B)>999999999&&(B="0"),v.poolInfo[`rewarder_display${ve+1}`]||Number(B)>0){const A=c.value.tokensObj[ie.coin_address],W=((ke=c.value.RATES[ie.coin_address])==null?void 0:ke.price)||0,N=new k(B).mul(W).toString();ne=new k(ne).plus(N),z.push({...ie,...A,amount:Number(B)>0?B:0,amountUSD:Number(N)>0?Se(N,2):0,amountUSDText:N})}}),a.value=z}};we(()=>[c.value.currentPositionInfo,r.value],([d,v])=>{var I;v=="Aptos"&&d?(o.value=d,l.value=d==null?void 0:d.token_a,b.value=d==null?void 0:d.token_b):v=="Sui"&&d&&(d==null?void 0:d.nftHash)==((I=H==null?void 0:H.query)==null?void 0:I.pos)&&(o.value=d,l.value=d==null?void 0:d.token_a,b.value=d==null?void 0:d.token_b,se.value=!1)},{immediate:!0}),we(()=>[o.value,c.value.addressLpTokens],([d,v])=>{!me(d)&&!me(v)&&ee(d)},{immediate:!0});const G=w(()=>{var d,v,I,E,D,j,z,ne;if(o.value&&!me(o.value)&&c.value.RATES){const ie=o.value.amountA*((v=c.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:v.price),ve=o.value.amountB*((E=c.value.RATES[(I=o.value)==null?void 0:I.token_b.address])==null?void 0:E.price);if((j=c.value.RATES[(D=o.value)==null?void 0:D.token_a.address])!=null&&j.price&&((ne=c.value.RATES[(z=o.value)==null?void 0:z.token_b.address])!=null&&ne.price)){const Ie=Number(ie+ve);return Ie>0&&Ie<.01?"<0.01":Z(Ue(ie+ve,2),2)}else return" --"}else return" --"}),u=w(()=>{var d,v;return(v=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:v.needReverse}),p=w(()=>c.value.RATES),T=w(()=>{var d,v;if(p.value&&l.value&&b.value&&!me(p.value)&&!me(l.value)&&!me(b.value)){const I=[],E=Number(o.value.feeOwedA)||0,D=Number(o.value.feeOwedB)||0,j=new k(E).mul(((d=p.value[l.value.address])==null?void 0:d.price)||0),z=new k(D).mul(((v=p.value[b.value.address])==null?void 0:v.price)||0);return I.push({amount:E,amountUSD:j.toString()},{amount:D,amountUSD:z.toString()}),I}return[]}),m=w(()=>{var v,I;let d=new k(0);return(v=T==null?void 0:T.value)==null||v.forEach(E=>{d=d.add(new k(E.amount))}),r.value=="Sui"&&((I=a==null?void 0:a.value)==null||I.forEach(E=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",E),d=d.add(new k(E.amount))})),d.toNumber()}),R=w(()=>{var v,I;let d=new k(0);return(v=T==null?void 0:T.value)==null||v.forEach(E=>{d=d.add(new k(E.amountUSD))}),r.value=="Sui"&&((I=a==null?void 0:a.value)==null||I.forEach(E=>{d=d.add(new k(E.amountUSDText))})),d.toNumber()}),f=w(()=>{var v;let d=new k(0);return(v=a.value)==null||v.forEach(I=>{d=d.add(new k(I.amountUSDText))}),d.toNumber()}),y=lo(),a=q([]),{setIsShowSuccess:le,setIsShowRejected:V,setIsShowWaiting:oe,setTransactionDesc:X,setTransactionTxid:C}=S,U=co(),O=w(()=>U),Y=async()=>{se.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:a.value.length,collect_fee:!0};d.coinTypeC=a.value[0]?a.value[0].coin_address:"",d.coinTypeD=a.value[1]?a.value[1].coin_address:"",d.coinTypeE=a.value[2]?a.value[2].coin_address:"",oe(!0),X();try{let v;if(r.value==="Aptos"){const I=await g.value.getCollectRewarderTransactionPayload(d);v=await O.value.currentWallet.signAndSubmitTransaction(I)}else{d.pos_index=o.value.pos_object_id;const I=await g.value.getCollectRewarderTransactionPayload(d,o.value),E=await g.value.signAndExecuteTransactionBlock(O.value.currentWallet,I.txb,I.payloadParams);v=g.value.handleTx(E)}if(v&&v.hash){C(v.hash),oe(!1),le(!0);const I={title:"Claim",desc:"",hash:v.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};r.value!=="Aptos"&&(I.res=v.res),g.value.showTransitionPending(I),await g.value.watchTransaction(I)&&t.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),oe(!1),V(!0),se.value=!1}catch(v){oe(!1),V(!0),se.value=!1,console.log(v,"error===>")}},x=q(!1),Q=async()=>{x.value=!0;const d=a.value;let v={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};v.coinTypeC=d[0]?d[0].coin_address:"",v.coinTypeD=d[1]?d[1].coin_address:"",v.coinTypeE=d[2]?d[2].coin_address:"";try{let I;if(r.value==="Aptos"){const E=await g.value.getCollectRewarderTransactionPayload(v);I=await O.value.currentWallet.signAndSubmitTransaction(E)}else{v.pos_index=o.value.pos_object_id;const E=await g.value.getCollectRewarderTransactionPayload(v),D=await g.value.signAndExecuteTransactionBlock(O.value.currentWallet,E.txb,E.payloadParams);I=g.value.handleTx(D)}if(I&&I.hash){C(I.hash),oe(!1),le(!0);const E=d[0].amount+d[0].symbol,D=v.coinTypeD?" and "+d[1].amount+d[1].symbol:"",j=v.coinTypeE?" and "+d[2].amount+d[2].symbol:"",z={title:"Claim",desc:"",hash:I.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:c.value.tokensObj&&d[0]&&d[0].address&&c.value.tokensObj[d[0].address]&&c.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:v.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:v.coinTypeD?c.value.tokensObj&&d[1]&&d[1].address&&c.value.tokensObj[d[1].address]&&c.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:v.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:v.coinTypeE?c.value.tokensObj&&d[2]&&d[2].address&&c.value.tokensObj[d[2].address]&&c.value.tokensObj[d[2].address].logoURI:""},text:E+D+j};r.value!=="Aptos"&&(z.res=I.res),g.value.showTransitionPending(z),await g.value.watchTransaction(z)&&setTimeout(()=>{t.emit("getDetails"),g.value.getAccount(O.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),oe(!1),V(!0);x.value=!1}catch(I){console.log("0310###collectRewarderParams Error###",I),x.value=!1,oe(!1),V(!0)}},te=w(()=>c.value.positionDetailCurrentTab),K=w(()=>{var I,E,D,j,z,ne;const d=be(u.value?(E=o.value)==null?void 0:E.amountB:(I=o.value)==null?void 0:I.amountA,u.value?(ne=(z=o.value)==null?void 0:z.token_b)==null?void 0:ne.decimals:(j=(D=o.value)==null?void 0:D.token_a)==null?void 0:j.decimals),v=u.value?c.value.positionActionAmount.toCoinAmount||0:c.value.positionActionAmount.fromCoinAmount||0;if(te.value=="increase")return v?new k(d).add(new k(v)).toString():"";if(v){const ie=new k(d).minus(new k(v)).toString();return ie<0?"0":String(ie)}else return""}),pe=w(()=>{var I,E,D,j,z,ne;const d=be(u.value?(E=o.value)==null?void 0:E.amountA:(I=o.value)==null?void 0:I.amountB,u.value?(ne=(z=o.value)==null?void 0:z.token_a)==null?void 0:ne.decimals:(j=(D=o.value)==null?void 0:D.token_b)==null?void 0:j.decimals),v=u.value?c.value.positionActionAmount.fromCoinAmount||0:c.value.positionActionAmount.toCoinAmount||0;if(te.value=="increase")return v?new k(d).add(new k(v)).toString():"";if(v){const ie=new k(d).minus(new k(v)).toString();return ie<0?"0":String(ie)}else return""}),M=w(()=>u.value?c.value.positionActionAmount.toCoinAmount:c.value.positionActionAmount.fromCoinAmount),he=w(()=>u.value?c.value.positionActionAmount.fromCoinAmount:c.value.positionActionAmount.toCoinAmount),_e=d=>{var v;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((v=c.value.tokensObj[d==null?void 0:d.address])==null?void 0:v.logo_url)||(h.value.theme==="default"?to("/image/coins/unknown.png"):to("/image/coins/sui-unknown.png"))},Be=w(()=>{var j,z,ne,ie,ve,Ie,L,B,de,ke,A,W;const{fromCoinAmount:d,toCoinAmount:v}=c.value.positionActionAmount,I=c.value.positionDetailCurrentTab,E=be(u.value?(z=o.value)==null?void 0:z.amountB:(j=o.value)==null?void 0:j.amountA,u.value?(Ie=(ve=o.value)==null?void 0:ve.token_b)==null?void 0:Ie.decimals:(ie=(ne=o.value)==null?void 0:ne.token_a)==null?void 0:ie.decimals),D=be(u.value?(B=o.value)==null?void 0:B.amountA:(L=o.value)==null?void 0:L.amountB,u.value?(W=(A=o.value)==null?void 0:A.token_a)==null?void 0:W.decimals:(ke=(de=o.value)==null?void 0:de.token_b)==null?void 0:ke.decimals);return r.value=="Sui"||I=="remove"&&r.value=="Aptos"&&d==E&&v==D}),Me=async()=>{se.value=!0;const d=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,v=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;X(i("newAdd.claimWaitingText",{from:u.value?v:d,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:u.value?d:v})),oe(!0);let I;const E={pool:o.value.poolInfo,position:o.value};try{const D=await g.value.getCollectFeeTransactionPayload(E);if(r.value==="Aptos")I=await O.value.currentWallet.signAndSubmitTransaction(D);else{const j=await g.value.signAndExecuteTransactionBlock(O.value.currentWallet,D);I=g.value.handleTx(j)}if(I){C(I.hash),oe(!1),le(!0);const j={title:"Claim",desc:"",hash:I.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_a.address&&c.value.tokensObj[o.value.token_a.address]&&c.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":c.value.tokensObj&&o.value&&o.value.token_b.address&&c.value.tokensObj[o.value.token_b.address]&&c.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};r.value!=="Aptos"&&(j.res=I.res),g.value.showTransitionPending(j);const z=await g.value.watchTransaction(j);console.log("0310##toClaim###transitionStatus####",z),z&&setTimeout(()=>{t.emit("getDetails")},1e3)}else oe(!1),V(!0),s.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});se.value=!1,console.log("claim####test###",I)}catch(D){console.log("claim###error####",D),se.value=!1,oe(!1),V(!0),s.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Ce=Ge(an,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:G,needReverse:u,decimalUi:be,pendingFees:T,positionInfo:o,pendingRewarderArr:a,pendingYieldAmount:R,toClaim:Me,claimAll:Y,fromCoin:l,toCoin:b,showNum:Se,claimLoading:se,addCommom:Z,afterBase:K,afterQuote:pe,fromCoinAmount:M,toCoinAmount:he,checkNullObj:me,getCoinIcon:_e,chainName:r,isShowAfterAmount:Be,pendingRewarderAmount:f,toClaimRewards:Q,rewarderLoading:x,indicator:Ce,canClaimYield:m}}});const di={class:"liquidity-card"},ci={class:"liquidity-title"},mi={class:"liquidity-usd"},vi=n("span",null,"Liquidity",-1),fi={class:"liquidity-ratio"},pi={class:"coin-ratio"},hi={class:"coin-a-ratio"},gi={class:"coin-b-ratio"},bi={class:"ratio-progress"},ki={class:"base-quote-num"},_i={class:"base-coin-num"},wi=n("span",null,"Base",-1),yi={alt:""},Ii={key:0,class:"after"},Ai={class:"quote-coin-num"},Ci=n("span",null,"Quote",-1),$i={alt:""},Si={key:0,class:"after"},Pi={class:"pending-yield"},Ti={class:"left"},Ni={class:"pending-yield-title"},Ri={key:0,class:"after"},Oi={class:"right"},qi={class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Fees",-1),Mi={key:0,class:"after"},Ui=n("span",null,"Fees",-1),ji={key:0,class:"after"},Ei=n("span",null,"Mining Rewards",-1),Di={style:{"margin-top":"5px"}},Fi={alt:""},Wi=n("span",null,"Mining Rewards",-1),Hi={alt:""},Xi={key:0,class:"after"},zi={key:0,class:"pending-yield"},Yi={class:"left"},Gi=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ji={key:0,class:"after"},Qi={class:"right"},Zi={key:1,class:"fees-rewards"},Ki={class:"fees-rewards-item"},Vi=n("span",null,"Mining Rewards",-1),xi={alt:""},es={key:0,class:"after"};function os(e,t,i,s,S,h){var b,r,g,H,se,ee,G,u,p,T,m,R,f,y,a,le,V,oe,X,C,U,O,Y,x,Q,te,K,pe,M,he,_e,Be,Me,Ce,d,v,I,E,D,j,z,ne,ie,ve,Ie,L,B,de,ke,A,W,N,re,ge,$e,Ne,Ae,Re,Ee,De,Qe,Oe,je,Fe,We,Ze,ye;const P=po,c=mo,o=ln,l=wo("image");return _(),$("div",di,[n("div",ci,[n("div",mi,[vi,n("div",null,"$"+F(e.amountUSD),1)]),n("div",fi,[n("div",pi,[n("div",hi,[n("span",null,F(e.needReverse?(r=e.toCoin)==null?void 0:r.symbol:(b=e.fromCoin)==null?void 0:b.symbol),1),ce(" "+F(e.needReverse?(H=e.positionInfo)==null?void 0:H.toPercent:(g=e.positionInfo)==null?void 0:g.fromPercent)+"% ",1)]),n("div",gi,[n("span",null,F(e.needReverse?(ee=e.fromCoin)==null?void 0:ee.symbol:(se=e.toCoin)==null?void 0:se.symbol),1),ce(" "+F(e.needReverse?(u=e.positionInfo)==null?void 0:u.fromPercent:(G=e.positionInfo)==null?void 0:G.toPercent)+"% ",1)])]),n("div",bi,[n("div",{class:"from-percent",style:So({width:e.needReverse?((T=e.positionInfo)==null?void 0:T.toPercent)+"%":((p=e.positionInfo)==null?void 0:p.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:So({width:e.needReverse?((R=e.positionInfo)==null?void 0:R.fromPercent)+"%":((m=e.positionInfo)==null?void 0:m.toPercent)+"%"})},null,4)])])]),n("div",ki,[n("div",_i,[wi,n("div",null,[Pe(n("img",yi,null,512),[[l,(e.needReverse?(y=e.toCoin)==null?void 0:y.logo_url:(f=e.fromCoin)==null?void 0:f.logo_url)||e.getCoinIcon(e.needReverse?(le=e.positionInfo)==null?void 0:le.token_b:(a=e.positionInfo)==null?void 0:a.token_a)]]),ae(P,{address:e.needReverse?(C=(X=e.positionInfo)==null?void 0:X.token_b)==null?void 0:C.address:(oe=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:oe.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.needReverse?(O=e.positionInfo)==null?void 0:O.amountB:(U=e.positionInfo)==null?void 0:U.amountA,e.needReverse?(te=(Q=e.positionInfo)==null?void 0:Q.token_b)==null?void 0:te.decimals:(x=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:x.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)?(_(),$("div",Ii,F(("addCommom"in e?e.addCommom:J(Z))(e.afterBase))+" after ",1)):ue("",!0)]),n("div",Ai,[Ci,n("div",null,[Pe(n("img",$i,null,512),[[l,(e.needReverse?(pe=e.fromCoin)==null?void 0:pe.logo_url:(K=e.toCoin)==null?void 0:K.logo_url)||e.getCoinIcon(e.needReverse?(he=e.positionInfo)==null?void 0:he.token_a:(M=e.positionInfo)==null?void 0:M.token_b)]]),ae(P,{address:e.needReverse?(Ce=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Ce.address:(Be=(_e=e.positionInfo)==null?void 0:_e.token_b)==null?void 0:Be.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(be))(e.needReverse?(v=e.positionInfo)==null?void 0:v.amountA:(d=e.positionInfo)==null?void 0:d.amountB,e.needReverse?(j=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:j.decimals:(E=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:E.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)?(_(),$("div",Si,F(("addCommom"in e?e.addCommom:J(Z))(e.afterQuote))+" after ",1)):ue("",!0)])]),n("div",Pi,[n("div",Ti,[n("div",Ni,F(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[ce(" $"+F(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(_(),$("span",Ri,"$0 after")):ue("",!0)])]),n("div",Oi,[ae(c,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=fe=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[ce("Claim")]),_:1},8,["loading","disabled"])])]),n("div",qi,[n("div",Li,[n("div",null,[Bi,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(ne=e.toCoin)==null?void 0:ne.logo_url:(z=e.fromCoin)==null?void 0:z.logo_url)||e.getCoinIcon(e.needReverse?(ve=e.positionInfo)==null?void 0:ve.token_b:(ie=e.positionInfo)==null?void 0:ie.token_a)]]),ae(P,{address:e.needReverse?(de=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:de.address:(L=(Ie=e.positionInfo)==null?void 0:Ie.token_a)==null?void 0:L.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(N=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:N.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(A=(ke=e.positionInfo)==null?void 0:ke.token_a)==null?void 0:A.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)&&e.isShowAfterAmount?(_(),$("div",Mi," 0 after ")):ue("",!0)]),n("div",null,[Ui,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(ge=e.fromCoin)==null?void 0:ge.logo_url:(re=e.toCoin)==null?void 0:re.logo_url)||e.getCoinIcon(e.needReverse?(Ne=e.positionInfo)==null?void 0:Ne.token_a:($e=e.positionInfo)==null?void 0:$e.token_b)]]),ae(P,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Re=(Ae=e.positionInfo)==null?void 0:Ae.token_b)==null?void 0:Re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(Fe=(je=e.positionInfo)==null?void 0:je.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(Oe=(Qe=e.positionInfo)==null?void 0:Qe.token_b)==null?void 0:Oe.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)&&e.isShowAfterAmount?(_(),$("div",ji," 0 after ")):ue("",!0)]),e.chainName=="Sui"?(_(),$(Ve,{key:0},[e.pendingRewarderArr.length==0&&((ye=(Ze=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ze.rewarderInfo)==null?void 0:ye.length)>0?(_(!0),$(Ve,{key:0},no(e.positionInfo.poolInfo.rewarderInfo,fe=>(_(),$("div",{key:fe.coinAddress},[Ei,n("div",Di,[Pe(n("img",Fi,null,512),[[l,e.getCoinIcon({address:fe.coinAddress})]]),ae(P,{address:fe.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),ae(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):ue("",!0),(_(!0),$(Ve,null,no(e.pendingRewarderArr,fe=>(_(),$("div",{key:fe},[Wi,n("div",null,[Pe(n("img",Hi,null,512),[[l,fe.logo_url]]),ae(P,{address:fe.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(fe.amount>0?("showNum"in e?e.showNum:J(Se))(fe.amount,fe.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)&&e.isShowAfterAmount?(_(),$("div",Xi," 0 after ")):ue("",!0)]))),128))],64)):ue("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),$("div",zi,[n("div",Yi,[Gi,n("div",null,[ce(" $"+F(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(_(),$("span",Ji,"$0 after")):ue("",!0)])]),n("div",Qi,[ae(c,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[ce("Claim")]),_:1},8,["loading","disabled","onClick"])])])):ue("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),$("div",Zi,[n("div",Ki,[(_(!0),$(Ve,null,no(e.pendingRewarderArr,fe=>(_(),$("div",{key:fe},[Vi,n("div",null,[Pe(n("img",xi,null,512),[[l,fe.logo_url]]),ae(P,{address:fe.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(fe.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(me))(e.positionInfo)&&e.isShowAfterAmount?(_(),$("div",es," 0 after ")):ue("",!0)]))),128))])])):ue("",!0)])}const Yo=Ye(ui,[["render",os]]),ns=ze({components:{AssetsCard:ho},setup(e,t){const i=q(""),s=q(""),S=Xe(),h=w(()=>S),P=w(()=>h.value.theme),c=xe(),o=w(()=>c),l=q(!1),b=q(!1),r=q(!0),g=w(()=>h.value.chainName),H=w(()=>g.value?io(g.value):{}),se=co(),ee=w(()=>se),G=w(()=>h.value.slippage),u=q(),p=q(),T=w(()=>ee.value.assets&&u.value&&ee.value.assets[u.value.address]?Ao(ee.value.assets[u.value.address].balance,u.value.decimals):0),m=w(()=>ee.value.assets&&p.value&&ee.value.assets[p.value.address]?Ao(ee.value.assets[p.value.address].balance,p.value.decimals):0),R=v=>{v==="fromCoin"?(r.value=!0,g.value==="Aptos"?i.value=T.value>0?u.value.symbol=="APT"?new k(Number(T.value)).sub(new k(.1)).lt(new k(0))?"0":new k(Number(T.value)).sub(new k(.1)).toString():String(T.value):"":i.value=T.value>0?u.value.symbol=="SUI"?new k(Number(T.value)).sub(new k(.05)).lt(new k(0))?"0":new k(Number(T.value)).sub(new k(.05)).toString():String(T.value):""):(r.value=!1,g.value==="Aptos"?s.value=m.value>0?p.value.symbol=="APT"?new k(Number(m.value)).sub(new k(.1)).lt(new k(0))?"0":new k(Number(m.value)).sub(new k(.1)).toString():String(m.value):"":s.value=m.value>0?p.value.symbol=="SUI"?new k(Number(m.value)).sub(new k(.05)).lt(new k(0))?"0":new k(Number(m.value)).sub(new k(.05)).toString():String(m.value):"")},f=v=>{v==="fromCoin"?(r.value=!0,i.value=Ue(new k(Number(T.value)).div(2).toString(),u.value.decimals).toString()):(r.value=!1,s.value=Ue(new k(Number(m.value)).div(2).toString(),p.value.decimals).toString())},y=q({}),a=q(!0),le=q({}),V=q(),oe=q(),X=()=>{var B;if(!y.value||!i.value&&!s.value)return;const{TickMath:v,TickUtil:I}=H.value;let E=y.value.minPrice,D=y.value.maxPrice.indexOf("+")>0?"âˆž":y.value.maxPrice,j=Number(y.value.tick_lower_index),z=Number(y.value.tick_upper_index);const ne=Number(y.value.current_tick_index);let ie,ve,Ie=Number(E).toString(),L=y.value.maxPrice.indexOf("+")>0||y.value.maxPrice==="âˆž"?"âˆž":Number(D);if(Ie=="0"&&L=="âˆž"?(j=Number(y.value.tick_lower_index),z=Number(y.value.tick_upper_index)):(ie=v.priceToSqrtPriceX64(new k(E),u.value.decimals,p.value.decimals),ve=v.priceToSqrtPriceX64(new k(D),u.value.decimals,p.value.decimals)),V.value=j,oe.value=z,D!=="âˆž"&&j>=z){l.value=!0,i.value="",b.value=!0,s.value="";return}if(D=="âˆž"||ne>=j&&ne<=z){l.value=!1,b.value=!1;let de;if(i.value||s.value){if(r.value){const ge=new k(i.value).mul(Math.pow(10,u.value.decimals)).toString();de=new qe(ge)}else{const ge=new k(s.value).mul(Math.pow(10,p.value.decimals)).toString();de=new qe(ge)}const{liquidityAmount:ke,tokenMaxA:A,tokenMaxB:W,tokenMaxAOrigin:N,tokenMaxBOrigin:re}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:u.value,tokenB:p.value,lowerTick:j,upperTick:z,coinAmount:de,iscoinA:a.value?r.value:!r.value,roundUp:!0,slippage:Number(G.value)/100,curSqrtPrice:new qe(y.value.current_sqrt_price)});le.value={liquidityAmount:ke,tokenMaxA:A,tokenMaxB:W,tokenMaxAOrigin:N,tokenMaxBOrigin:re},a.value?r.value?s.value=Number(W)>0?W:"":i.value=Number(A)>0?A:"":r.value?s.value=A:i.value=W}}else if(ne>z){if(i.value="",l.value=!0,b.value=!1,i.value||s.value){let de;const ke=new k(s.value).mul(Math.pow(10,(B=p.value)==null?void 0:B.decimals)).toString();de=new qe(ke),le.value={liquidityAmount:No(ie,ve,de),tokenMaxA:0,tokenMaxB:s.value}}}else if(ne<j){if(l.value=!1,b.value=!0,s.value="",i.value||s.value){let de;const ke=new k(i.value).mul(Math.pow(10,u.value.decimals)).toString();de=new qe(ke),le.value={liquidityAmount:Ro(ie,ve,de),tokenMaxA:i.value,tokenMaxB:0}}}else l.value=!0,i.value="",b.value=!0,s.value="";c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};we(()=>o.value.currentPositionInfo,v=>{if(v&&!me(v)){y.value=v,u.value=y.value.token_a,p.value=y.value.token_b;let I=Number(y.value.tick_lower_index),E=Number(y.value.tick_upper_index);const D=Number(y.value.current_tick_index);(v.maxPrice.indexOf("+")>0||v.maxPrice==="âˆž"?"âˆž":v.maxPrice)=="âˆž"||D>=I&&D<=E?(l.value=!1,b.value=!1):D>E?(i.value="",l.value=!0,b.value=!1):D<I?(l.value=!1,b.value=!0,s.value=""):(l.value=!0,i.value="",b.value=!0,s.value=""),X()}},{immediate:!0}),we(i,(v,I)=>{v&&X(),v==""&&(s.value="")}),we(s,(v,I)=>{v&&X(),v==""&&(i.value="")});const C=w(()=>{var v,I;return(I=(v=y.value)==null?void 0:v.poolInfo)==null?void 0:I.needReverse}),U=w(()=>o.value.RATES),O=w(()=>{var z,ne,ie,ve;const v=((ne=U.value[(z=u.value)==null?void 0:z.address])==null?void 0:ne.price)||0,I=((ve=U.value[(ie=p.value)==null?void 0:ie.address])==null?void 0:ve.price)||0,E=new k(v).mul(new k(i.value||0)),D=new k(I).mul(new k(s.value||0)),j=E.add(D);return j.toNumber()?j.toNumber()>0&&j.toNumber()>.01?Z(j.toString(),2):"<0.01":"--"}),Y=q(!1),{t:x,locale:Q}=yo(),te=w(()=>{const v=Number(i.value)>Number(T.value),I=Number(s.value)>Number(m.value);return!i.value&&!s.value?x("button.enterAmount"):v?x("button.insufficientBalance",{name:u.value.symbol}):I?x("button.insufficientBalance",{name:p.value.symbol}):x("newAdd.addMore")}),K=w(()=>{const v=Number(i.value)>Number(T.value),I=Number(s.value)>Number(m.value);return!!(!i.value&&!s.value||v||I)}),{setIsShowSuccess:pe,setIsShowRejected:M,setIsShowWaiting:he,setTransactionDesc:_e,setTransactionTxid:Be,setPositiomNum:Me}=S,Ce=q(!1);return{theme:P,showFromCoinLock:l,showToCoinLock:b,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:T,toCoinBlance:m,fromCoin:u,toCoin:p,maxBtnSelect:R,halfBtnSelect:f,fixedFromCoin:r,needReverse:C,totalAmount:O,wallet:ee,addLiquidityBtnText:te,isShowLiquidityModal:Y,indexStore:S,positionInfo:y,actionLoading:Ce,toAdd:async()=>{var z,ne,ie,ve,Ie,L,B,de,ke,A;Y.value=!1,Ce.value=!0,Be("");const v=l.value?"":`${i.value} ${(z=u.value)==null?void 0:z.symbol}`,I=b.value?"":`${s.value} ${(ne=p.value)==null?void 0:ne.symbol}`;_e(x("tips.increaseLiquiditySuccess",{from:C.value?I:v,and:!l.value&&!b.value?"and":"",to:C.value?v:I})),he(!0);const E=r.value,D=y.value.poolInfo.rewarder_infos;let j={};j.coinTypeC=D[0]?D[0].coinAddress:"",j.coinTypeD=D[1]?D[1].coinAddress:"",j.coinTypeE=D[2]?D[2].coinAddress:"";try{const W=await H.value.getAddLiquidityTransactionPayload({pool:{poolAddress:y.value.poolAddress,token_a:y.value.token_a,token_b:y.value.token_b},amount:E?le.value.tokenMaxA:le.value.tokenMaxB,fix_amount_a:E,tick_lower:V.value,tick_upper:oe.value,index:g.value==="Aptos"?y.value.index:y.value.pos_object_id,slippage:Number(G.value)/100,roundUp:!0,collect_fee:!0,...j,curSqrtPrice:new qe(y==null?void 0:y.value.poolInfo.current_sqrt_price),positionInfo:y});let N;if(g.value==="Aptos")N=await ee.value.currentWallet.signAndSubmitTransaction(W);else{const re=await H.value.signAndExecuteTransactionBlock(ee.value.currentWallet,W==null?void 0:W.txb,W==null?void 0:W.payloadParams);N=H.value.handleTx(re)}if(console.log("toAdd###tx###",N),N&&N.hash){Be(N.hash),he(!1),pe(!0);const re={title:"Supplied",desc:x("tips.addLiquiditySuccessText",{from:l.value?"":`${i.value} ${(ie=u.value)==null?void 0:ie.symbol}`,and:!l.value&&!b.value?"and":"",to:b.value?"":`${s.value} ${(ve=p.value)==null?void 0:ve.symbol}`}),hash:N.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:C.value?`${(L=p.value)==null?void 0:L.address}`:`${(Ie=u.value)==null?void 0:Ie.address}`,numa:C.value?`- ${s.value}`:`- ${i.value}`,logoa:C.value?o.value.tokensObj&&p.value&&p.value.address&&o.value.tokensObj[p.value.address]&&o.value.tokensObj[p.value.address].logoURI:o.value.tokensObj&&u.value&&u.value.address&&o.value.tokensObj[u.value.address]&&o.value.tokensObj[u.value.address].logoURI,tokenb:C.value?`${(de=u.value)==null?void 0:de.address}`:`${(B=p.value)==null?void 0:B.address}`,numb:C.value?`- ${i.value}`:`- ${s.value}`,logob:C.value?o.value.tokensObj&&u.value&&u.value.address&&o.value.tokensObj[u.value.address]&&o.value.tokensObj[u.value.address].logoURI:o.value.tokensObj&&p.value&&p.value.address&&o.value.tokensObj[p.value.address]&&o.value.tokensObj[p.value.address].logoURI},text:`Deopsit ${l.value?"":`${i.value} ${(ke=u.value)==null?void 0:ke.symbol}`} ${!l.value&&!b.value?"and":""} ${b.value?"":`${s.value} ${(A=p.value)==null?void 0:A.symbol}`}`};g.value!=="Aptos"&&(re.res=N.res),H.value.showTransitionPending(re),await H.value.watchTransaction(re)&&setTimeout(()=>{t.emit("getDetails"),H.value.getAccount(ee.value.address)},1e3),Me()}else he(!1),M(!0);i.value="",s.value="",Ce.value=!1}catch(W){i.value="",s.value="",console.log("addError###",W),Ce.value=!1,he(!1),M(!0)}},addLiquidityBtnDisabled:K,poolStore:c}}});const ts={class:"new-position-asset"},is={class:"add-or-remove"},ss={class:"liquidity-action-tab"},as=n("div",{class:"increase tab-active"}," Increase ",-1),ls={class:"card-item"},rs={class:"card-item"},us={key:0,class:"add",src:bn},ds={key:1,class:"add",src:kn},cs={class:"total-amount"},ms=n("span",null,"Total Amount",-1);function vs(e,t,i,s,S,h){var b;const P=ho,c=hn,o=mo,l=gn;return _(),$("div",ts,[n("div",is,[n("div",ss,[as,n("div",{class:"remove",onClick:t[0]||(t[0]=r=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ls,[ae(P,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=r=>{e.fromCoinAmount=r}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(_(),Te(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ue("",!0)]),n("div",rs,[ae(P,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=r=>{e.toCoinAmount=r}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(_(),Te(c,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ue("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(_(),$("img",us)):ue("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(_(),$("img",ds)):ue("",!0)],2),n("div",cs,[ms,n("span",null,"$"+F(e.totalAmount),1)])]),e.wallet.connected?(_(),Te(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=r=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(_(),Te(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(_(),Te(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(b=e.positionInfo)==null?void 0:b.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=r=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):ue("",!0)])}const Go=Ye(ns,[["render",vs]]),fs=ze({components:{AssetsCard:ho},setup(e,t){const i=q(""),s=q(""),S=Xe(),h=w(()=>S),P=w(()=>h.value.theme),c=xe(),o=w(()=>c),l=q(!1),b=q(!1),r=q(!0),g=w(()=>h.value.chainName),H=w(()=>g.value?io(g.value):{}),se=co(),ee=w(()=>se),G=w(()=>h.value.slippage),u=q(),p=q(),T=w(()=>{var A,W;return(W=(A=a.value)==null?void 0:A.poolInfo)==null?void 0:W.needReverse}),m=w(()=>{var A;return be(a==null?void 0:a.value.amountA,(A=a==null?void 0:a.value.token_a)==null?void 0:A.decimals)}),R=w(()=>{var A;return be(a==null?void 0:a.value.amountB,(A=a==null?void 0:a.value.token_b)==null?void 0:A.decimals)}),f=A=>{A==="fromCoin"?r.value=!0:r.value=!1,O.value=100,x({value:1})},y=A=>{A==="fromCoin"?(r.value=!0,i.value=Ue(new k(Number(m.value)).div(2).toString(),u.value.decimals).toString()):(r.value=!1,s.value=Ue(new k(Number(R.value)).div(2).toString(),p.value.decimals).toString()),C.value=!1},a=q({}),le=q(!0),V=q({}),oe=q(),X=q(),C=q(!0),U=()=>{var Qe;if(C.value||!a.value||!i.value&&!s.value||Number(i.value)>Number(m.value)||Number(s.value)>Number(R.value))return;if(i.value==m.value&&s.value==R.value){O.value=100,x({value:1}),C.value=!0;return}const{TickMath:A,TickUtil:W}=H.value;let N=a.value.minPrice,re=a.value.maxPrice.indexOf("+")>0?"âˆž":a.value.maxPrice,ge=Number(a.value.tick_lower_index),$e=Number(a.value.tick_upper_index);const Ne=Number(a.value.current_tick_index);let Ae,Re,Ee=Number(N).toString(),De=a.value.maxPrice.indexOf("+")>0||a.value.maxPrice==="âˆž"?"âˆž":Number(re);if(Ee=="0"&&De=="âˆž"?(ge=Number(a.value.tick_lower_index),$e=Number(a.value.tick_upper_index)):(Ae=A.priceToSqrtPriceX64(new k(N),u.value.decimals,p.value.decimals),Re=A.priceToSqrtPriceX64(new k(re),u.value.decimals,p.value.decimals)),oe.value=ge,X.value=$e,re!=="âˆž"&&ge>=$e){l.value=!0,i.value="",b.value=!0,s.value="";return}if(re=="âˆž"||Ne>=ge&&Ne<=$e){l.value=!1,b.value=!1;let Oe;if(i.value||s.value){if(r.value){const fe=new k(i.value).mul(Math.pow(10,u.value.decimals)).toString();Oe=new qe(fe)}else{const fe=new k(s.value).mul(Math.pow(10,p.value.decimals)).toString();Oe=new qe(fe)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:ye}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:u.value,tokenB:p.value,lowerTick:ge,upperTick:$e,coinAmount:Oe,iscoinA:le.value?r.value:!r.value,roundUp:g.value!="Sui",slippage:Number(G.value)/100,curSqrtPrice:new qe(a.value.current_sqrt_price)});V.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:ye},le.value?r.value?s.value=Number(We)>0?We:"":i.value=Number(Fe)>0?Fe:"":r.value?s.value=Fe:i.value=We}}else if(Ne>$e){if(i.value="",l.value=!0,b.value=!1,i.value||s.value){let Oe;const je=new k(s.value).mul(Math.pow(10,(Qe=p.value)==null?void 0:Qe.decimals)).toString();Oe=new qe(je),V.value={liquidityAmount:No(Ae,Re,Oe),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<ge){if(l.value=!1,b.value=!0,s.value="",i.value||s.value){let Oe;const je=new k(i.value).mul(Math.pow(10,u.value.decimals)).toString();Oe=new qe(je),V.value={liquidityAmount:Ro(Ae,Re,Oe),tokenMaxA:i.value,tokenMaxB:0}}}else l.value=!0,b.value=!0;C.value=!1,O.value=new k(V.value.liquidityAmount.toString()).div(a.value.liquidity).mul(100).toNumber().toFixed(2),Y.value=V.value.liquidityAmount,c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})},O=q(50),Y=q("0"),x=A=>{if(!C.value)return;C.value=!0;const W=a.value.token_a.decimals,N=a.value.token_b.decimals,re=a.value.tick_lower_index,ge=a.value.tick_upper_index,$e=Co.tickIndexToSqrtPriceX64(re),Ne=Co.tickIndexToSqrtPriceX64(ge);let Ae="";A.value!==1?Ae=new k(a.value.liquidity).mul(A.value).toString():Ae=a.value.liquidity,Ae=Ue(Ae,0)||"0",Y.value=Ae;const Re=nn.getCoinAmountFromLiquidity(new qe(Ae),new qe(a.value.current_sqrt_price),$e,Ne,g.value!="Sui"),Ee=new k(Re.coinA.toString()).div(Math.pow(10,W)).toString(),De=new k(Re.coinB.toString()).div(Math.pow(10,N)).toString();i.value=Number(Ee)>0?Ee:"",s.value=Number(De)>0?De:"",c.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};we(()=>o.value.currentPositionInfo,A=>{if(A&&!me(A)){a.value=A,u.value=a.value.token_a,p.value=a.value.token_b,x({value:O.value/100});let W=Number(a.value.tick_lower_index),N=Number(a.value.tick_upper_index);const re=Number(a.value.current_tick_index);(A.maxPrice.indexOf("+")>0||A.maxPrice==="âˆž"?"âˆž":A.maxPrice)=="âˆž"||re>=W&&re<=N?(l.value=!1,b.value=!1):re>N?(i.value="",l.value=!0,b.value=!1):re<W?(l.value=!1,b.value=!0,s.value=""):(l.value=!0,i.value="",b.value=!0,s.value=""),U()}},{immediate:!0}),we(i,(A,W)=>{A&&U(),A==""&&(s.value="",O.value=0)}),we(s,(A,W)=>{A&&U(),A==""&&(i.value="",O.value=0)});const Q=w(()=>o.value.RATES),te=w(()=>{var $e,Ne,Ae,Re;const A=((Ne=Q.value[($e=u.value)==null?void 0:$e.address])==null?void 0:Ne.price)||0,W=((Re=Q.value[(Ae=p.value)==null?void 0:Ae.address])==null?void 0:Re.price)||0,N=new k(A).mul(new k(i.value||0)),re=new k(W).mul(new k(s.value||0)),ge=N.add(re);return Z(ge.toString(),2)}),K=q(!1),{t:pe,locale:M}=yo(),he=w(()=>{const A=Number(i.value)>Number(m.value),W=Number(s.value)>Number(R.value);return!i.value&&!s.value?pe("button.enterAmount"):A||W?"Invalid Amount":pe("button.remove")}),_e=w(()=>{const A=Number(i.value)>Number(m.value),W=Number(s.value)>Number(R.value);return!!(!i.value&&!s.value||A||W)}),{setIsShowSuccess:Be,setIsShowRejected:Me,setIsShowWaiting:Ce,setTransactionDesc:d,setTransactionTxid:v,setPositiomNum:I,setTransactionDescText:E}=S,D=q(!1);we(O,rn((A,W)=>{A!==W&&(Number(A)>100?O.value=100:A&&a.value?(O.value=A,x({value:O.value/100})):(i.value="",s.value=""))},300)),we(G,A=>{A&&a.value&&x({value:O.value/100})});const j=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],z=jo(),ne=w(()=>z),ie=w(()=>ne.value.status),ve=q(!1),Ie=A=>{A.sources.forEach(N=>{const{pool_address:re,position_index:ge}=JSON.parse(N.blockchainAddress);re==a.value.poolAddress&&Number(ge)==Number(a.value.index)&&(ve.value=!0)})},L=async()=>{await z.getSources();let A;ne.value.allSources.forEach(W=>{const{pool_address:N,position_index:re}=JSON.parse(W.blockchainAddress);N==a.value.poolAddress&&re==a.value.index&&(A=W.id)}),z.deleteSource(A)};we(()=>[ne.value.sourceGroups,a.value],([A,W])=>{A&&A.sources&&A.sources.length>0&&W&&!me(W)&&Ie(A)},{immediate:!0,deep:!0});const B=lo(),de=fo();return{theme:P,showFromCoinLock:l,showToCoinLock:b,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:m,toCoinBlance:R,fromCoin:u,toCoin:p,maxBtnSelect:f,halfBtnSelect:y,fixedFromCoin:r,needReverse:T,totalAmount:te,wallet:ee,addLiquidityBtnText:he,isShowLiquidityModal:K,indexStore:S,positionInfo:a,actionLoading:D,addLiquidityBtnDisabled:_e,sliderVal:O,ratioArr:j,setPercent:x,poolStore:c,isSlider:C,toRemove:async()=>{var ge,$e,Ne,Ae,Re,Ee,De,Qe,Oe,je,Fe,We,Ze;D.value=!0,v("");const A=Z(i.value,u.value.decimals)==0?"":`${be(i.value,u.value.decimals)} ${u.value.symbol}`,W=Z(s.value,p.value.decimals)==0?"":`${be(s.value,p.value.decimals)} ${p.value.symbol}`;d(pe("tips.removeLiquidiyText",{from:T.value?W:A,and:Z(i.value,u.value.decimals)==0||Z(s.value,p.value.decimals)==0?"":"and",to:T.value?A:W})),Ce(!0);const N=a.value.poolInfo.rewarder_infos,re=N&&N.length>0&&g.value=="Sui"||N&&N.length>0&&O.value==100?pe("modal.removeLiquidityText1"):pe("modal.removeLiquidityText2");E(re);try{let ye={};ye={pool:{...a.value.poolInfo,coinA:a.value.token_a,coinB:a.value.token_b},coinTypeA:a.value.poolInfo.coinTypeA,coinTypeB:a.value.poolInfo.coinTypeB,position:a.value,delta_liquidity:O.value==100?new qe(a.value.liquidity):new qe(Ue(Y.value,0)),slippage:Number(G.value),rewards_num:N.length,positionInfo:a.value},ye.coinTypeC=N[0]?N[0].coinAddress:"",ye.coinTypeD=N[1]?N[1].coinAddress:"",ye.coinTypeE=N[2]?N[2].coinAddress:"";const fe=await H.value.getRemoveLiquidityTransactionPayload(ye);let He;if(g.value==="Aptos")He=await ee.value.currentWallet.signAndSubmitTransaction(fe);else{const ro=await H.value.signAndExecuteTransactionBlock(ee.value.currentWallet,fe.txb,fe==null?void 0:fe.payloadParams);He=H.value.handleTx(ro),console.log("0331###remove###tx####",He)}if(He&&He.hash){v(He.hash),Ce(!1),Be(!0);const ro={title:pe("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${i.value} ${(ge=u.value)==null?void 0:ge.symbol} and ${s.value} ${($e=p.value)==null?void 0:$e.symbol} 
             from the pool`,sender:ee.value.address,chainName:g.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:T.value?`${(Ae=p.value)==null?void 0:Ae.address}`:`${(Ne=u.value)==null?void 0:Ne.address}`,numa:T.value?`+ ${s.value}`:`+ ${i.value}`,logoa:T.value?o.value.tokensObj&&p.value&&p.value.address&&o.value.tokensObj[p.value.address]&&o.value.tokensObj[p.value.address].logoURI:o.value.tokensObj&&u.value&&u.value.address&&o.value.tokensObj[u.value.address]&&o.value.tokensObj[u.value.address].logoURI,tokenb:T.value?`${(Re=u.value)==null?void 0:Re.address}`:`${(Ee=p.value)==null?void 0:Ee.address}`,numb:T.value?`+ ${i.value}`:`+ ${s.value}`,logob:T.value?o.value.tokensObj&&u.value&&u.value.address&&o.value.tokensObj[u.value.address]&&o.value.tokensObj[u.value.address].logoURI:o.value.tokensObj&&p.value&&p.value.address&&o.value.tokensObj[p.value.address]&&o.value.tokensObj[p.value.address].logoURI},text:`Withdraw ${i.value} ${(De=u.value)==null?void 0:De.symbol} and ${s.value} ${(Qe=p.value)==null?void 0:Qe.symbol}`};g.value!=="Aptos"&&(ro.res=He.res),H.value.showTransitionPending(ro);const Io=await H.value.watchTransaction(ro);if(N.value&&N.value.length>0&&(Number((Oe=N[0])==null?void 0:Oe.amount)!==0||ye.coinTypeD&&Number((je=N[1])==null?void 0:je.amount)!==0||ye.coinTypeE&&Number((Fe=N[2])==null?void 0:Fe.amount)!==0)){const go={title:pe("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:N[0].symbol,numa:`+ ${Number(N[0].amount)}`,logoa:o.value.tokensObj&&N[0]&&N[0].address&&o.value.tokensObj[N[0].address]&&o.value.tokensObj[N[0].address].logoURI,tokenb:ye.coinTypeD?N[1].symbol:"",numb:ye.coinTypeD?`+ ${Number(N[1].amount)}`:"",logob:ye.coinTypeD?o.value.tokensObj&&N[1]&&N[1].address&&o.value.tokensObj[N[1].address]&&o.value.tokensObj[N[1].address].logoURI:"",tokenc:ye.coinTypeE?N[2].symbol:"",numc:ye.coinTypeE?`+ ${Number(N[2].amount)}`:"",logoc:ye.coinTypeE?o.value.tokensObj&&N[2]&&N[2].address&&o.value.tokensObj[N[2].address]&&o.value.tokensObj[N[2].address].logoURI:""},text:`Withdraw ${i.value} ${(We=u.value)==null?void 0:We.symbol} and ${s.value} ${(Ze=p.value)==null?void 0:Ze.symbol}`},Ko=await H.value.setTransations(go)}if(Se(a.value.feeOwedA,a.value.token_a.decimals)!==0||Se(a.value.feeOwedB,a.value.token_b.decimals)!==0){const go={title:"Claim",desc:"",hash:He.hash,chainName:g.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${a.value.token_a.symbol}`,numa:Z(a.value.feeOwedA,a.value.token_a.decimals)==0?"":`+ ${Se(a.value.feeOwedA,a.value.token_a.decimals)}`,logoa:Z(a.value.feeOwedA,a.value.token_a.decimals)==0?"":o.value.tokensObj&&a.value&&a.value.token_a.address&&o.value.tokensObj[a.value.token_a.address]&&o.value.tokensObj[a.value.token_a.address].logoURI,tokenb:`${a.value.token_b.symbol}`,numb:Z(a.value.feeOwedB,a.value.token_b.decimals)==0?"":`+ ${Se(a.value.feeOwedB,a.value.token_b.decimals)}`,logob:Z(a.value.feeOwedB,a.value.token_b.decimals)==0?"":o.value.tokensObj&&a.value&&a.value.token_b.address&&o.value.tokensObj[a.value.token_b.address]&&o.value.tokensObj[a.value.token_b.address].logoURI}},Ko=await H.value.setTransations(go)}Io&&Number(O.value)==100&&ie.value=="authenticated"&&ve.value&&(await z.subscribePosition({pool_address:a.value.poolAddress,position_index:a.value.index},a.value.nftHash,!1),L()),Io&&(i.value="",s.value="",setTimeout(()=>{Number(O.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(O.value)!==100&&t.emit("getDetails")},6e3),Number(O.value)==100&&de.name=="new-position-detail"&&(g.value==="Aptos"?B.push("/position"):B.push("/pool/position")),O.value=0)}else Ce(!1),Me(!0);D.value=!1}catch(ye){console.log("Remove error",ye),D.value=!1,Ce(!1),Me(!0)}},sFixD:Ue}}});const ps={class:"new-position-asset"},hs={class:"add-or-remove"},gs={class:"liquidity-action-tab"},bs=n("div",{class:"remove tab-active"},"Remove",-1),ks={class:"card-item"},_s={key:0,class:"assets-card-mask"},ws={class:"card-item"},ys={key:0,class:"assets-card-mask"},Is={class:"remove-ratio"},As=n("div",{class:"remove-ratio-title"},"Amount",-1),Cs={class:"remove-ratio-select"},$s={key:0,class:"ratio"},Ss={key:1,class:"ratio"},Ps={class:"ratio-list"},Ts=["onClick"];function Ns(e,t,i,s,S,h){const P=ho,c=un,o=mo;return _(),$("div",ps,[n("div",hs,[n("div",gs,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),bs]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ks,[ae(P,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(_(),$("div",_s)):ue("",!0)]),n("div",ws,[ae(P,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(_(),$("div",ys)):ue("",!0)])],2),n("div",Is,[As,n("div",Cs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(_(),$("div",$s,F(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):(_(),$("div",Ss," -- ")),n("div",Ps,[(_(!0),$(Ve,null,no(e.ratioArr,(l,b)=>(_(),$("div",{key:b,class:vo(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},F(l.name),11,Ts))),128))])]),ae(c,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(_(),Te(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(_(),Te(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1}))])}const Jo=Ye(fs,[["render",Ns]]),Rs=ze({setup(){const e=xe(),t=w(()=>e),i=Eo(),s=w(()=>i),S=lo(),h=w(()=>t.value.currentPositionInfo),P=q(),c=X=>{var C;return((C=t.value.tokensObj[X])==null?void 0:C.logo_url)||to("/image/coins/sui-unknown.png")},o=tn("Sui"),l=q(),b=async X=>{l.value=0;try{const C=await o.calculateFarmingRewards([{pool_id:X.pool_id,position_nft_id:X.id}]),U=[];let O=new k(0);C[X.id].forEach((Y,x)=>{var K;const Q=(K=t.value.tokensObj[Y.rewarder_type])==null?void 0:K.decimals;let te=new k(Y.rewarder_amount).div(Math.pow(10,Q)).toString();Number(te)>0&&g.value.rewarders[x]&&(O=O.add(te),U.push({...Y,rewarderAmount:te,rewarderAmountPer:te}))}),l.value=O,P.value=U}catch(C){console.log(C,"getRewarder")}},r=w(()=>s.value.farmsPoolObj),g=w(()=>r.value[h.value.poolAddress]);we(()=>[h.value,r.value,g.value],([X,C,U])=>{var O;!me(X)&&X.positionSource=="farming"&&!me(U)?b(X):!me(C)&&!me(X)&&(P.value=(O=C[X.poolAddress])==null?void 0:O.rewarders)},{immediate:!0});const H=co(),se=w(()=>H),ee=Xe(),G=io("Sui"),{setIsShowSuccess:u,setIsShowRejected:p,setIsShowWaiting:T,setTransactionDesc:m,setTransactionTxid:R}=ee,f=q(!1),y=async()=>{f.value=!0,R(""),m("Claim rewards"),T(!0);const X={pool_id:h.value.pool_id,position_nft_id:h.value.id};try{const C=await o.harvestFarms(X),U=await G.signAndExecuteTransactionBlock(se.value.currentWallet,C.txb,C.payloadParams);console.log("0221###sui swap res###",U);let O=G.handleTx(U);if(O&&O.hash){R(O.hash),T(!1),u(!0);let Y={title:"Claim",res:O.res,hash:O.hash};G.showTransitionPending(Y),await G.watchTransaction(Y)&&setTimeout(()=>{b(h.value)},2e3)}else T(!1),p(!0);f.value=!1}catch(C){console.log("farmsDeposit error",C),T(!1),p(!0),f.value=!1}},a=async()=>{f.value=!0,R(""),m(`Unstake ${h.value.name}`),T(!0);const X=h.value.pool_id,C=h.value.id;try{const U=await o.farmsWithdraw(X,C),O=await G.signAndExecuteTransactionBlock(se.value.currentWallet,U.txb,U.payloadParams);console.log("0221###sui swap res###",O);let Y=G.handleTx(O);if(Y&&Y.hash){R(Y.hash),T(!1),u(!0);let x={res:Y.res,title:"Unstake",hash:Y.hash};G.showTransitionPending(x),await G.watchTransaction(x)&&setTimeout(()=>{S.replace(`/new-position-detail?token=${h.value.tokenName}&address=${h.value.clmm_pool_id}&pos=${h.value.clmm_position_id}`),t.value.setCurrentPositionInfo(h.value.clmm_pool_id,"",h.value.tokenName,"Sui",h.value.clmm_position_id),l.value=0,f.value=!1},2e3)}else T(!1),p(!0)}catch(U){console.log("farmsDeposit error",U),T(!1),p(!0),f.value=!1}},le=async()=>{f.value=!0,R(""),m(`Stake ${h.value.name}`),T(!0);const X={clmm_pool_id:h.value.poolAddress,clmm_position_id:h.value.pos_object_id,coinTypeA:h.value.coin_type_a,coinTypeB:h.value.coin_type_b},C=r.value[h.value.poolAddress].id;try{const U=await o.farmsDeposit(X,C),O=await G.signAndExecuteTransactionBlock(se.value.currentWallet,U.txb,U.payloadParams);console.log("0221###sui swap res###",O);let Y=G.handleTx(O);if(Y&&Y.hash){R(Y.hash),T(!1),u(!0);let x={res:Y.res,title:"Staked",hash:Y.hash};G.showTransitionPending(x);const Q=await G.watchTransaction(x,!0);let te;Q!=null&&Q.status&&setTimeout(async()=>{var K,pe;(pe=(K=Q==null?void 0:Q.res)==null?void 0:K.events)==null||pe.forEach(M=>{M.type.indexOf("::pool::DepositEvent")>-1&&(te=M.parsedJson.wrapped_position_id)}),S.replace(`/new-position-detail?position_nft_id=${te}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",te,"farming"),f.value=!1},2e3)}else T(!1),p(!0)}catch(U){console.log("farmsDeposit error",U),T(!1),p(!0),f.value=!1}},V=w(()=>ee),oe=w(()=>V.value.addressLpTokens);return{getCoinIcon:c,rewardList:P,sFixD:Ue,addCommom:Z,claim:y,unStake:a,loading:f,totalRewardAmount:l,currentPositionInfo:h,stake:le,farmsPoolObj:r,addressLpTokens:oe,farmsPoolInfo:g}}});const eo=e=>(so("data-v-deedd8aa"),e=e(),ao(),e),Os={key:0,class:"farms-position-detail"},qs={class:"farms-top"},Ls=eo(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Bs={class:"right"},Ms={class:"apr"},Us={class:"apr-tips-box"},js=eo(()=>n("span",null,"View",-1)),Es=eo(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ds=[js,Es],Fs={class:"farms-bottom"},Ws=eo(()=>n("div",{class:"title"},"Farming Rewards",-1)),Hs={key:0,class:"reward-list"},Xs={key:0,class:"rewards-item-bg"},zs={class:"rewards-item-box"},Ys={alt:""},Gs={key:1},Js={class:"rewards-item-bg"},Qs={class:"rewards-item-box"},Zs={alt:""},Ks=eo(()=>n("span",null,"0",-1)),Vs={key:1,class:"reward-list"},xs={key:0,class:"rewards-item-bg"},ea={class:"rewards-item-box"},oa={alt:""},na=eo(()=>n("span",null,"0",-1)),ta={key:1},ia={class:"rewards-item-bg"},sa={class:"rewards-item-box"},aa={alt:""},la=eo(()=>n("span",null,"0",-1)),ra={class:"actions-box"};function ua(e,t,i,s,S,h){var b,r;const P=_n,c=mo,o=Bo,l=wo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(_(),$("div",Os,[n("div",qs,[Ls,n("div",Bs,[n("div",Ms,[ce(" APRÂ  "),n("span",null,[ce(F(("addCommom"in e?e.addCommom:J(Z))(e.farmsPoolInfo.total_apr*100,2))+"%Â  ",1),n("div",Us,[ae(P,{"l-item":e.farmsPoolInfo,"rewarder-info":(r=(b=e.farmsPoolInfo)==null?void 0:b.rewarder)==null?void 0:r.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=g=>e.$router.push("/farms"))},Ds)])]),n("div",Fs,[Ws,e.rewardList&&e.rewardList.length>0?(_(),$("div",Hs,[(_(!0),$(Ve,null,no(e.rewardList,g=>(_(),$("div",{key:g,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),$("div",Xs,[n("div",zs,[Pe(n("img",Ys,null,512),[[l,e.getCoinIcon(g.rewarder_type)]]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(g.rewarderAmount||0)),1)])])):(_(),$("div",Gs,[n("div",Js,[n("div",Qs,[Pe(n("img",Zs,null,512),[[l,e.getCoinIcon(g.reward_coin)]]),Ks])])]))]))),128))])):(_(),$("div",Vs,[(_(!0),$(Ve,null,no(e.currentPositionInfo.rewards,g=>(_(),$("div",{key:g,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),$("div",xs,[n("div",ea,[Pe(n("img",oa,null,512),[[l,e.getCoinIcon(g.rewarder_type)]]),na])])):(_(),$("div",ta,[n("div",ia,[n("div",sa,[Pe(n("img",aa,null,512),[[l,e.getCoinIcon(g.reward_coin)]]),la])])]))]))),128))])),n("div",ra,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(_(),Te(c,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[ce("Unstake")]),_:1},8,["loading","onClick"])):ue("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(_(),Te(o,{key:1},{title:Le(()=>[ce("Farming rewards are only available for active positions.")]),default:Le(()=>[ae(c,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[ce("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(_(),Te(c,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[ce("Stake")]),_:1},8,["loading","onClick"])):ue("",!0),ae(c,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Mo(e.claim,["stop"])},{default:Le(()=>[ce("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):ue("",!0)}const Qo=Ye(Rs,[["render",ua],["__scopeId","data-v-deedd8aa"]]),da=ze({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),i=w(()=>t),s=w(()=>i.value.status),S=Xe(),h=q(!1);we(()=>s.value,l=>{l=="authenticated",h.value=!1},{immediate:!0});const P=q(!1),c=async()=>{P.value=!P.value;const l={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},b=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(l,b,P.value)}catch{P.value=!P.value}},o=l=>{const b=l.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",b),P.value=b.some(r=>JSON.parse(r.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(r.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return lo(),we(()=>[i.value.sourceGroups,e.positionInfo],([l,b])=>{P.value=!1,l&&l.length>0&&l[0]&&b&&!me(b)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(l[0]))},{immediate:!0,deep:!0}),{importIcon:to,isShowSetUp:h,changeSwitch:c,checked:P,notifiStatus:s,store:S}}});const ca=e=>(so("data-v-1a37a36d"),e=e(),ao(),e),ma={class:"range-alerts"},va={class:"range-alerts-top"},fa={class:"title"},pa=ca(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ha={key:1,class:"h5-switch-box"},ga={class:"range-alerts-bottom"},ba={key:0,class:"pc-switch-box"};function ka(e,t,i,s,S,h){const P=mo,c=dn;return _(),$("div",ma,[n("div",va,[n("div",fa,[pa,e.isShowSetUp||e.notifiStatus!=="authenticated"?(_(),Te(P,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Mo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[ce(" Set up ")]),_:1})):ue("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),$("div",ha,[ae(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ue("",!0)])]),n("div",ga,[ce(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),$("div",ba,[ae(c,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ue("",!0)])])}const Zo=Ye(da,[["render",ka],["__scopeId","data-v-1a37a36d"]]),_a=ze({components:{NewPositionTitle:Ho,NewPositionInfo:zo,NewPositionLiquidity:Yo,NewPositionAssetAdd:Go,NewPositionAssetRemove:Jo,NewPositionNotifi:Zo,FarmsPositionDetail:Qo},setup(){const e=q(),t=q(),i=q(),s=Xe(),S=w(()=>s),h=w(()=>S.value.chainName),P=xe(),c=w(()=>P),o=Eo(),l=lo();qo(()=>{e.value={},P.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),c.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const b=async()=>{c.value.setCurrentPositionLoading(!0);const u=l.currentRoute.value.query.token||"",p=l.currentRoute.value.query.collect||"",T=l.currentRoute.value.query.address||"",m=l.currentRoute.value.query.pos||"",R=l.currentRoute.value.query.id||"",f=l.currentRoute.value.query.positionSource||"",y=l.currentRoute.value.query.position_nft_id||"";h.value==="Aptos"?u&&p&&T&&c.value.setCurrentPositionInfo(T,p,u,h.value):u&&T&&m?c.value.setCurrentPositionInfo(T,p,u,h.value,m):R&&!f?c.value.setCurrentPositionInfo("","","",h.value,R):c.value.setCurrentPositionInfo("","","",h.value,y,f)};we(()=>c.value.poolConfigObj,u=>{u&&!me(u)&&b()},{immediate:!0});const r=w(()=>c.value.currentPositionLoading),g=w(()=>{var p,T,m;const u=((m=(T=(p=l==null?void 0:l.currentRoute)==null?void 0:p.value)==null?void 0:T.query)==null?void 0:m.address)||"";return u&&c.value.addressLpTokens&&!me(c.value.addressLpTokens)&&c.value.addressLpTokens[u]?c.value.addressLpTokens[u]:null});we(()=>g.value,(u,p)=>{u&&!me(u)&&(e.value=u),u&&!me(u)&&u.current_sqrt_price!==(p==null?void 0:p.current_sqrt_price)&&b()},{immediate:!0});const H=fo();we(()=>[c.value.currentPositionInfo,h.value],([u,p])=>{var T;(p=="Aptos"&&u||p=="Sui"&&u&&(u==null?void 0:u.nftHash)==((T=H==null?void 0:H.query)==null?void 0:T.pos))&&(e.value=u,t.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const se=w(()=>c.value.positionDetailCurrentTab),ee=co();w(()=>ee),w(()=>S.value.theme);const G=()=>{b()};return Oo(()=>{P.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:i,getDetails:b,currentPositionLoading:r,positionDetailCurrentTab:se,clickRefresh:G,chainName:h}}});const wa={class:"new-position-detail"},ya={class:"new-position-content"},Ia={class:"left"},Aa={class:"right"},Ca={class:"loading-global"};function $a(e,t,i,s,S,h){const P=Ho,c=zo,o=Yo,l=Go,b=Jo,r=Qo,g=Zo,H=cn;return _(),$("div",wa,[ae(P,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ya,[n("div",Ia,[ae(c),ae(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",Aa,[e.positionDetailCurrentTab=="increase"?(_(),Te(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(_(),Te(b,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ae(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(_(),Te(r,{key:2})):ue("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(_(),Te(g,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):ue("",!0)])]),Pe(n("div",Ca,[ae(H)],512),[[Lo,e.currentPositionLoading]])])}const ol=Ye(_a,[["render",$a],["__scopeId","data-v-2fdfeeff"]]);export{ol as default};
